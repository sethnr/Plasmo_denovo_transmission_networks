#!/bin/bash


#use FASTX-Toolkit
declare -A clip

clip[1F]=GgaaaaaaAACAAGAGGGGGAGT
clip[1R]=CCCCCTCGACGATGTAGTTG
clip[2F]=GGACATGTCTCCCAAGGTCG
clip[2R]=AACGCTTTGACCTTAAAAGATGT
clip[3F]=AAGCACGTTCCCTTAAGTGT
clip[3R]=TGCGACCTGAAATTACACCTCA
clip[4F]=TTGGGGTACAGGGAAATCTATATTT
clip[4R]=TGATGCAAAAAAGGGATTGAATTTG
clip[5F]=TGTGGGGGTCCTTATGATCT
clip[5R]=ACCCCCTTTGGATGGTTCAG
clip[6F]=CATTCCTCCCACCAATGGCT
clip[6R]=TGTTGTAAGGCAGTGTGTTGC
clip[7F]=CGTATGTTCGTCTTCTTCATTCCA
clip[7R]=TGCAAAGAATTCGAAAGTTCAGA
clip[8F]=ATTCAATTGCTGCGTGACCC
clip[8R]=AGAACATCGCGATTTATGTACTTCT
clip[9F]=TTCACGCCAAGTTTCATCAAC
clip[9R]=TGCATGTATATGGTTCTTTCCCG
clip[10F]=TCCCGAAGAAGAAGTTGTCACA
clip[10R]=GTGTTTACACAACTGTGGATGAGA


for PRIM in "${!clip[@]}"
do
    for FILE in `ls *${PRIM}.ab1.seq`
    do
#        echo $FILE
	fasta_formatter -i $FILE | fastx_clipper -d1 -a clip[$PRIM]
    done
done
