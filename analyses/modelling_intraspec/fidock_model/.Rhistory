load("~/Google Drive/misc/macports_150504/pkglist.Rdata")
install.packages(save.pkg.list)
source("http://bioconductor.org/biocLite.R")
biocLite()
?write.table
afs_small <- data.frame(t(read.table("Scratch/gits/pfdisco/analyses/modelling_intraspec/qstages.C1.5m.L0.01mb.G36.mtp.AFs.txt",sep="\t",row.names=1)))
colnames(afs_small)<-c("mth","halfyr","yr")
afs_large <- data.frame(t(read.table("Scratch/gits/pfdisco/analyses/modelling_intraspec/qstages.C100.0m.L0.01mb.G36.mtp.AFs.txt",sep="\t",row.names=1)))
colnames(afs_large)<-c("mth","halfyr","yr")
plot(density(afs_large$mth),col="red") + lines(density(afs_small$yr),col="blue")
plot(density(subset(afs_large,mth>0.01)$mth),col="red") + lines(density(subset(afs_small,yr>0.01)$yr),col="blue")
plot(density(subset(afs_large,mth>0.01)$mth),col="red",xlim=c(0,0.1)) + lines(density(subset(afs_small,yr>0.01)$yr),col="blue")
plot(density(afs_large$mth),col="red") + lines(density(afs_small$yr),col="blue")
plot(density(subset(afs_large,mth>0.01)$mth),col="red",xlim=c(0,0.1)) + lines(density(subset(afs_small,yr>0.01)$yr),col="blue")
subset(afs_small,yr>0.01)$yr
length(subset(afs_small,yr>0.01)$yr)
length(subset(afs_large,mth>0.01)$mth)
length(subset(afs_small,yr>0.04)$yr)
length(subset(afs_small,yr>0.02)$yr)
length(subset(afs_large,mth>0.02)$mth)
c(length(subset(afs_large,mth>0.02)$mth),length(subset(afs_small,yr>0.02)$yr)
)
c(length(subset(afs_large,mth>0.02)$mth),length(subset(afs_small,yr>0.02)$yr))
c(length(subset(afs_large,mth>0.01)$mth),length(subset(afs_small,yr>0.01)$yr))
c(length(subset(afs_large,mth>0.02)$mth),length(subset(afs_small,yr>0.02)$yr))
c(length(subset(afs_large,mth>0.03)$mth),length(subset(afs_small,yr>0.03)$yr))
c(length(subset(afs_large,mth>0.02)$mth),length(subset(afs_small,halfyr>0.02)$halfyr)
)
c(length(subset(afs_large,mth>0.02)$mth),length(subset(afs_small,halfyr>0.02)$halfyr))
plot(density(subset(afs_large,mth>0.01)$mth),col="red",xlim=c(0,0.1)) +
lines(density(subset(afs_small,halfyr>0.01)$halfyr),col="blue") +
lines(density(subset(afs_small,yr>0.01)$yr),col="dark blue")
plot(density(subset(afs_large,mth>0.01)$mth),col="red",xlim=c(0,0.1)) +
lines(density(subset(afs_small,halfyr>0.01)$halfyr),col="blue") +
lines(density(subset(afs_small,yr>0.01)$yr),col="dark blue")
plot(density(subset(afs_large,mth>0.01)$mth),col="red",xlim=c(0,0.1)) +
lines(density(subset(afs_small,halfyr>0.01)$halfyr),col="blue")
plot(density(subset(afs_large,mth>0.01)$mth),col="red",xlim=c(0,0.1))
plot(density(subset(afs_large,mth>0.01)$mth),col="red",xlim=c(0,0.1)) +
lines(density(subset(afs_small,halfyr>0.01)$halfyr),col="blue") +
lines(density(subset(afs_small,yr>0.01)$yr),col="dark blue")
setwd("Scratch/gits/pfdisco/analyses/modelling_intraspec/fidock_model/")
library(ggplot2)
library(reshape2)
popSizes <- t(read.table("Asexuals_100.txt",sep="\t"))
popSizes <- as.data.frame(popSizes)
popSizes$gen <- c(1:dim(popSizes)[[1]])
popSizes.m <- melt(popSizes,id.vars=c("gen"))
ggplot(popSizes.m,aes(x=gen,y=value,group=variable)) + geom_line() + scale_y_log10()
popSizes$max <- smooth(popSizes$max)
ggplot(popSizes,aes(x=gen,y=mean)) + geom_line() + geom_line(aes(x=gen,y=max)) + scale_y_log10()
popSizes$max <- smooth(popSizes$max)
popSizes$mean <- apply(popSizes[,1:100],1,FUN=mean,na.rm=T)
popSizes$max <- apply(popSizes[,1:100],1,FUN=max,na.rm=T)
popSizes$max <- as.vector(smooth(popSizes$max))
ggplot(popSizes,aes(x=gen,y=mean)) + geom_line() + geom_line(aes(x=gen,y=max)) + scale_y_log10()
popSizes$max <- as.vector(smooth(popSizes$max))
ggplot(popSizes,aes(x=gen,y=mean)) + geom_line() + geom_line(aes(x=gen,y=max)) + scale_y_log10()
popSizes$max <- as.vector(smooth(popSizes$max))
ggplot(popSizes,aes(x=gen,y=mean)) + geom_line() + geom_line(aes(x=gen,y=max)) + scale_y_log10()
popSizes$max <- as.vector(smooth(popSizes$max,kind = "10R"))
popSizes$max <- as.vector(smooth(popSizes$max,kind = "S"))
ggplot(popSizes,aes(x=gen,y=mean)) + geom_line() + geom_line(aes(x=gen,y=max)) + scale_y_log10()
rollapply(popSizes$max,)
library(plyr)
rollapply(popSizes$max,)
library(reshape)
rollapply(popSizes$max,)
rollapply(popSizes$max)
popSizes$max <- as.vector(loess(popSizes$max))
loess(popSizes$max)
loess(popSizes$max ~ .)
loess(max ~ gen, span=0.75, popSizes)
loess(max ~ gen, span=5, popSizes)
smoothmax <- loess(max ~ gen, span=5, popSizes)
smoothmax$y
popSizes$smax <- smoothmax$y
ggplot(popSizes,aes(x=gen,y=mean)) + geom_line() + geom_line(aes(x=gen,y=max)) + scale_y_log10()
ggplot(popSizes,aes(x=gen,y=mean)) + geom_line() + geom_line(aes(x=gen,y=smax)) + scale_y_log10()
smoothmax <- loess(value ~ gen, span=5, popSizes.m)
ggplot2(smoothmax,aes(x=x,y=y)) + geom_line()
ggplot(smoothmax,aes(x=x,y=y)) + geom_line()
ggplot(as.data.frame(smoothmax),aes(x=x,y=y)) + geom_line()
lowss
loess
ggplot(as.data.frame(smoothmax),aes(x=x,y=y)) + geom_line()
smoothmax$x
smoothmax$x,smoothmax$y
cbind(smoothmax$x,smoothmax$y)
smoothmax <- cbind(smoothmax$x,smoothmax$y)
head(smoothmax)
colnames(smoothmax) <- c("x","y")
ggplot(as.data.frame(smoothmax),aes(x=x,y=y)) + geom_line()
predict(smoothmax, data.frame(x=x))
smoothmax <- loess(value ~ gen, span=5, popSizes.m)
predict(smoothmax, data.frame(x=x))
predict(smoothmax, data.frame(x=popSizes$gen))
predict(smoothmax, data.frame(x=popSizes$gen))
predict(smoothmax, popSizes$gen)
quantile
?quantile
popSizes$uq <- apply(popSizes[,1:100],1,FUN=quantile,na.rm=T)
apply(popSizes[,1:100],1,FUN=quantile,na.rm=T)
popSizes$uq <- apply(popSizes[,1:100],2,FUN=quantile,na.rm=T)
apply(popSizes[,1:100],2,FUN=quantile,na.rm=T)
apply(popSizes[,1:100],2,FUN=quantile,na.rm=T)
popSizes$uq <- apply(popSizes[,1:100],2,FUN=function(x) {return quantile[4]},na.rm=T)
popSizes$uq <- apply(popSizes[,1:100],2,FUN=function(x) {return quantile(x)[4]},na.rm=T)
popSizes$uq <- apply(popSizes[,1:100],2,FUN=function(x) {quantile(x)[4]},na.rm=T)
popSizes$uq <- apply(popSizes[,1:100],2,FUN=function(x) {quantile(x)[4]})
popSizes$uq <- apply(popSizes[,1:100],2,FUN=function(x) {quantile(x)[4]},na.rm=T)
ggplot(popSizes,aes(x=gen,y=mean)) + geom_line() + geom_line(aes(x=gen,y=uq)) + scale_y_log10()
ggplot(popSizes,aes(x=gen,y=mean)) + geom_line() + geom_line(aes(x=gen,y=uq)) + scale_y_log10()
popSizes$mean <- apply(popSizes[,1:100],1,FUN=mean,na.rm=T)
popSizes$max <- apply(popSizes[,1:100],1,FUN=max,na.rm=T)
popSizes$uq <- apply(popSizes[,1:100],2,FUN=function(x) {quantile(x)[4]},na.rm=T)
popSizes$uq <- apply(popSizes[,1:100],2,FUN=function(x) {quantile(x,na.rm=T)[4]})
popSizes$mean <- apply(popSizes[,1:100],1,FUN=mean,na.rm=T)
popSizes$max <- apply(popSizes[,1:100],1,FUN=max,na.rm=T)
popSizes$uq <- apply(popSizes[,1:100],1,FUN=function(x) {quantile(x,na.rm=T)[4]})
ggplot(popSizes,aes(x=gen,y=mean)) + geom_line() + geom_line(aes(x=gen,y=uq)) + scale_y_log10()
quantile(x)
popSizes$uq <- apply(popSizes[,1:100],1,FUN=function(x) {quantile(x,na.rm=T)[5]})
ggplot(popSizes,aes(x=gen,y=mean)) + geom_line() + geom_line(aes(x=gen,y=uq)) + scale_y_log10()
library(zoo)
popSizes$meanuq <- apply(popSizes[,1:100],1,FUN=function(x) {mean(x[x > quantile(x)[4]])})
popSizes$meanuq <- apply(popSizes[,1:100],1,FUN=function(x) {mean(x[x > quantile(x,na.rm=T)[4]])})
ggplot(popSizes,aes(x=gen,y=mean)) + geom_line() + geom_line(aes(x=gen,y=meanuq)) + scale_y_log10()
rollapply(popSizes$meanuq)
rollapply(popSizes$meanuq,width = 10,FUN=mean)
rollapply(popSizes$meanuq,width = 10,FUN=mean,fill = 0)
popSizes$uqsmth <- rollapply(popSizes$meanuq,width = 10,FUN=mean,fill = 0)
popSizes$smoothuq <- rollapply(popSizes$meanuq,width = 10,FUN=mean,fill = 0)
ggplot(popSizes,aes(x=gen,y=mean)) + geom_line() + geom_line(aes(x=gen,y=meanuq)) + geom_line(aes(x=gen,y=smoothuq)) + scale_y_log10()
popSizes$smoothuq <- rollapply(popSizes$meanuq,width = 20,FUN=mean,fill = 0)
ggplot(popSizes,aes(x=gen,y=mean)) + geom_line() + geom_line(aes(x=gen,y=meanuq)) + geom_line(aes(x=gen,y=smoothuq)) + scale_y_log10()
popSizes$smoothuq <- rollapply(popSizes$meanuq,width = 30,FUN=mean,fill = 0)
ggplot(popSizes,aes(x=gen,y=mean)) + geom_line() + geom_line(aes(x=gen,y=meanuq)) + geom_line(aes(x=gen,y=smoothuq)) + scale_y_log10()
popSizes$smoothuq <- rollapply(popSizes$meanuq,width = 50,FUN=mean,fill = 0)
ggplot(popSizes,aes(x=gen,y=mean)) + geom_line() + geom_line(aes(x=gen,y=meanuq)) + geom_line(aes(x=gen,y=smoothuq)) + scale_y_log10()
ggplot(popSizes,aes(x=gen,y=mean)) + geom_line() + geom_line(aes(x=gen,y=meanuq)) + geom_line(aes(x=gen,y=smoothuq),colour="red") + scale_y_log10()
popSizes$mean <- apply(popSizes[,1:100],1,FUN=mean,na.rm=T)
popSizes$median <- apply(popSizes[,1:100],1,FUN=median,na.rm=T)
popSizes$max <- apply(popSizes[,1:100],1,FUN=max,na.rm=T)
popSizes$meanuq <- apply(popSizes[,1:100],1,FUN=function(x) {mean(x[x > quantile(x,na.rm=T)[4]])})
popSizes$smoothuq <- rollapply(popSizes$meanuq,width = 50,FUN=mean,fill = 0)
ggplot(popSizes,aes(x=gen,y=median)) + geom_line() + geom_line(aes(x=gen,y=meanuq)) + geom_line(aes(x=gen,y=smoothuq),colour="red") + scale_y_log10()
ggplot(popSizes,aes(x=gen,y=mean)) + geom_line() + geom_line(aes(x=gen,y=max)) + scale_y_log10()
ggplot(popSizes,aes(x=gen,y=median)) + geom_line() + geom_line(aes(x=gen,y=meanuq)) + geom_line(aes(x=gen,y=smoothuq),colour="red") + scale_y_log10()
smoothmax <- loess(value ~ gen, span=5, popSizes.m)
predict(smoothmax, data.frame(x=x))
?loess.smooth
smoothmax
predict(smoothmax,data.frame(gen=x)
)
predict(smoothmax,data.frame(gen=popSizes$gen))
smoothmax <- loess(value ~ gen, span=0.75, popSizes.m)
predict(smoothmax,data.frame(gen=popSizes$gen))
popSizes$smooth <- predict(smoothmax, data.frame(x=x))
popSizes$smooth <- predict(smoothmax,data.frame(gen=popSizes$gen))
ggplot(popSizes,aes(x=gen,y=median)) + geom_line() + geom_line(aes(x=gen,y=meanuq)) + geom_line(aes(x=gen,y=smooth),colour="red") + scale_y_log10()
smoothmax <- loess(value ~ gen, span=0.2, popSizes.m)
popSizes$smooth <- predict(smoothmax,data.frame(gen=popSizes$gen))
ggplot(popSizes,aes(x=gen,y=median)) + geom_line() + geom_line(aes(x=gen,y=meanuq)) + geom_line(aes(x=gen,y=smooth),colour="red") + scale_y_log10()
smoothmax <- loess(value ~ gen, span=0.1, popSizes.m)
popSizes$smooth <- predict(smoothmax,data.frame(gen=popSizes$gen))
ggplot(popSizes,aes(x=gen,y=median)) + geom_line() + geom_line(aes(x=gen,y=meanuq)) + geom_line(aes(x=gen,y=smooth),colour="red") + scale_y_log10()
smoothmax <- loess(value ~ gen, span=0.05, popSizes.m)
popSizes$smooth <- predict(smoothmax,data.frame(gen=popSizes$gen))
ggplot(popSizes,aes(x=gen,y=median)) + geom_line() + geom_line(aes(x=gen,y=meanuq)) + geom_line(aes(x=gen,y=smooth),colour="red") + scale_y_log10()
smoothmax <- loess(value ~ gen, span=0.15, popSizes.m)
popSizes$smooth <- predict(smoothmax,data.frame(gen=popSizes$gen))
ggplot(popSizes,aes(x=gen,y=median)) + geom_line() + geom_line(aes(x=gen,y=meanuq)) + geom_line(aes(x=gen,y=smooth),colour="red") + scale_y_log10()
smoothmax <- loess(value ~ gen, span=0.11, popSizes.m)
popSizes$smooth <- predict(smoothmax,data.frame(gen=popSizes$gen))
ggplot(popSizes,aes(x=gen,y=median)) + geom_line() + geom_line(aes(x=gen,y=meanuq)) + geom_line(aes(x=gen,y=smooth),colour="red") + scale_y_log10()
smoothmax <- loess(value ~ gen, span=0.101, popSizes.m)
popSizes$smooth <- predict(smoothmax,data.frame(gen=popSizes$gen))
smoothmax <- loess(value ~ gen, span=0.1, popSizes.m)
popSizes$smooth <- predict(smoothmax,data.frame(gen=popSizes$gen))
smoothmax <- loess(value ~ gen, span=0.05, popSizes.m)
popSizes$smooth <- predict(smoothmax,data.frame(gen=popSizes$gen))
ggplot(popSizes,aes(x=gen,y=median)) + geom_line() + geom_line(aes(x=gen,y=meanuq)) + geom_line(aes(x=gen,y=smooth),colour="red") + scale_y_log10()
popSizes$smooth*5000
popSizes$smooth*5e6
popSizes$smooth*5e9
ggplot(popSizes,aes(x=gen,y=smooth*5e9)) + geom_line() + scale_y_log10()
popSizes$smooth*5e6
ggplot(popSizes,aes(x=gen,y=smooth*5e6)) + geom_line() + scale_y_log10()
ggplot(popSizes,aes(x=gen,y=smooth*m)) + geom_line() + geom_line(aes(x=gen,y=max*m),colour="red") + scale_y_log10()
m=5e6
ggplot(popSizes,aes(x=gen,y=smooth*m)) + geom_line() + geom_line(aes(x=gen,y=max*m),colour="red") + scale_y_log10()
cbind(popSizes$gen,predict(smoothmax,data.frame(gen=popSizes$gen))*m)
maxtab <- cbind(popSizes$gen,predict(smoothmax,data.frame(gen=popSizes$gen))*m)
ggplot(popSizes,aes(x=gen,y=smooth*m)) + geom_line() + geom_line(aes(x=gen,y=max*m),colour="red") + scale_y_log10()
maxtab <- cbind(popSizes$gen,predict(smoothmax,data.frame(gen=popSizes$gen))*m)
colnames(maxtab) <- c("T","C")
popSizes.m <- melt(popSizes,id.vars=c("t"))
popSizes <- t(read.table("Asexuals_100.txt",sep="\t"))
popSizes <- as.data.frame(popSizes)
popSizes$t <- c(1:dim(popSizes)[[1]])
popSizes.m <- melt(popSizes,id.vars=c("t"))
ggplot(popSizes.m,aes(x=t,y=value,group=variable)) + geom_line() + scale_y_log10()
ggplot(popSizes.m,aes(x=t,y=value,group=variable)) + geom_line(alpha=0.5) + scale_y_log10()
ggplot(popSizes.m,aes(x=t,y=value,group=variable)) + geom_line(alpha=0.1) + scale_y_log10()
ggplot(popSizes,aes(x=t,y=mean)) + geom_line() + geom_line(aes(x=t,y=max)) + scale_y_log10()
popSizes.m <- melt(popSizes,id.vars=c("t"))
ggplot(popSizes.m,aes(x=t,y=value,group=variable)) + geom_line(alpha=0.1) + scale_y_log10()
popSizes$mean <- apply(popSizes[,1:100],1,FUN=mean,na.rm=T)
popSizes$max <- apply(popSizes[,1:100],1,FUN=max,na.rm=T)
ggplot(popSizes,aes(x=t,y=mean)) + geom_line() + geom_line(aes(x=t,y=max)) + scale_y_log10()
ggplot(popSizes,aes(x=t,y=mean)) + geom_line() + geom_line(aes(x=t,y=max),colour="red") + scale_y_log10()
smoothmax <- loess(value ~ t, span=0.05, popSizes.m)
popSizes$smooth <- predict(smoothmax,data.frame(t=popSizes$t))
ggplot(popSizes,aes(x=t,y=median)) + geom_line(colour="red") + geom_line(aes(x=t,y=mean)) + geom_line(aes(x=t,y=smooth),colour="red") + scale_y_log10()
smoothmax <- loess(value ~ t, span=0.05, popSizes.m)
popSizes$smooth <- predict(smoothmax,data.frame(t=popSizes$t))
popSizes$smooth*5e6
m=5e6
ggplot(popSizes,aes(x=t,y=smooth*m)) + geom_line() + geom_line(aes(x=t,y=max*m),colour="red") + scale_y_log10()
maxtab <- cbind(popSizes$t,predict(smoothmax,data.frame(t=popSizes$t))*m)
colnames(maxtab) <- c("T","C")
popSizes$smooth*5e6
write.table(maxtab,colnames=T,rownames=F,sep="\t")
write.table(maxtab,col.names=T,row.names=F,sep="\t",quote=F)
write.table(maxtab,"popSize_max_loess.txt", col.names=T,row.names=F,sep="\t",quote=F)
maxtab <- cbind(popSizes$t,round(predict(smoothmax,data.frame(t=popSizes$t))*m))
colnames(maxtab) <- c("T","C")
write.table(maxtab,"popSize_max_loess.txt", col.names=T,row.names=F,sep="\t",quote=F)
head(maxtab)
ggplot(popSizes.m,aes(x=t,y=value,group=variable)) + geom_line(alpha=0.1) + scale_y_log10()
ggplot(popSizes.m,aes(x=t,y=value,group=variable)) + geom_line(alpha=0.1) + scale_y_log10() + xlim(0,30)
ggplot(popSizes.m[1:20,1:20],aes(x=t,y=value,group=variable)) + geom_line(alpha=0.1) + scale_y_log10()
ggplot(popSizes.m[1:20,],aes(x=t,y=value,group=variable)) + geom_line(alpha=0.1) + scale_y_log10()
ggplot(popSizes.m[1:200,],aes(x=t,y=value,group=variable)) + geom_line(alpha=0.1) + scale_y_log10()
ggplot(popSizes.m[1:2000,],aes(x=t,y=value,group=variable)) + geom_line(alpha=0.1) + scale_y_log10()
ggplot(subset(popSizes.m,gen<50)[1:2000,],aes(x=t,y=value,group=variable)) + geom_line(alpha=0.1) + scale_y_log10()
ggplot(subset(popSizes.m,T<50)[1:2000,],aes(x=t,y=value,group=variable)) + geom_line(alpha=0.1) + scale_y_log10()
ggplot(subset(popSizes.m,T<50)[1:2000,],aes(x=t,y=value,group=variable)) + geom_line(alpha=0.5) + scale_y_log10()
ggplot(subset(popSizes.m,T<50)[1:2000,],aes(x=t,y=value,group=variable,colour=variable)) + geom_line(alpha=0.5) + scale_y_log10()
ggplot(subset(popSizes.m,T<50)[1:2000,],aes(x=t,y=value,group=variable,colour=variable)) + geom_line(alpha=0.5)
ggplot(subset(popSizes.m,T<50)[1:2000,],aes(x=t,y=value,group=variable,colour=variable)) + geom_line(alpha=0.5) + scale_y_log10()
library(ggplot2)
library(reshape2)
library(zoo)
popSizes <- t(read.table("Asexuals_100.txt",sep="\t"))
popSizes <- as.data.frame(popSizes)
popSizes$t <- c(1:dim(popSizes)[[1]])
popSizes.m <- melt(popSizes,id.vars=c("t"))
ggplot(popSizes.m,aes(x=t,y=value,group=variable)) + geom_line(alpha=0.1) + scale_y_log10()
popSizes$mean <- apply(popSizes[,1:100],1,FUN=mean,na.rm=T)
popSizes$max <- apply(popSizes[,1:100],1,FUN=max,na.rm=T)
ggplot(popSizes,aes(x=t,y=mean)) + geom_line() + geom_line(aes(x=t,y=max),colour="red") + scale_y_log10()
smoothmax <- loess(value ~ t, span=0.05, popSizes.m)
popSizes$smooth <- predict(smoothmax,data.frame(t=popSizes$t))
popSizes$max <- apply(popSizes[,1:100],1,FUN=max,na.rm=T)
ggplot(popSizes,aes(x=t,y=mean)) + geom_line() + geom_line(aes(x=t,y=max),colour="red") + scale_y_log10()
smoothmax <- loess(value ~ t, span=0.05, popSizes.m)
popSizes$smooth <- predict(smoothmax,data.frame(t=popSizes$t))
m=5e6
ggplot(popSizes,aes(x=t,y=smooth*m)) + geom_line() + geom_line(aes(x=t,y=max*m),colour="red") + scale_y_log10()
