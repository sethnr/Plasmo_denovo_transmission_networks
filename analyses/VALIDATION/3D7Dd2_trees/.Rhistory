load("~/Google Drive/misc/macports_150504/pkglist.Rdata")
install.packages(save.pkg.list)
source("http://bioconductor.org/biocLite.R")
biocLite()
?write.table
cbind(c(0,499,510),c(0,0,72))
rbind(c(0,499,510),c(0,0,72))
rbind(c(0,499,510),c(0,0,72),c(0,0,0))
mat <- rbind(c(0,499,510),c(0,0,72),c(0,0,0))
colnames(mat) <- c("PFX","2D4","FDK")
rownames(mat) <- c("PFX","2D4","FDK")
mat
njtree <- nj(as.dist(mat))
use ape
library(ape)
njtree <- nj(as.dist(mat))
plot(njtree,show.node.label = T,show.tip.label = T,
main=paste("NJ tree, ",fileroot),type="fan",cex = 1.1)
plot(njtree,show.node.label = T,show.tip.label = T,
main=paste("NJ tree, ",
"inPFX"),type="cladogram",cex=1.1)
?plot
plot(njtree,show.node.label = T,show.tip.label = T,
main=paste("NJ tree, ",fileroot),type="phylogram",cex = 1.1)
fileroot="PFX"
plot(njtree,show.node.label = T,show.tip.label = T,
main=paste("NJ tree, ",fileroot),type="phylogram",cex = 1.1)
plot(njtree,show.node.label = T,show.tip.label = T,
main=paste("NJ tree, ",fileroot),type="cladogram",cex = 1.1)
plot(njtree,show.node.label = T,show.tip.label = T,
main=paste("NJ tree, ",fileroot),cex = 1.1)
dev.off()
plot(njtree,show.node.label = T,show.tip.label = T,
main=paste("NJ tree, ",fileroot),cex = 1.1)
plot(njtree,show.node.label = T,show.tip.label = T,
main=paste("NJ tree, ",fileroot),type="radial",cex = 1.1)
plot(njtree,show.node.label = T,show.tip.label = T,
main=paste("NJ tree, ",fileroot),type="clado",cex = 1.1)
as.dist(distmat)
as.dist(mat)
mat
rbind(c(0,499,510),c(499,0,72),c(510,72,0))
mat <- rbind(c(0,499,510),c(499,0,72),c(510,72,0))
colnames(mat) <- c("PFX","2D4","FDK")
rownames(mat) <- c("PFX","2D4","FDK")
as.dist(mat)
njtree <- nj(as.dist(mat))
plot(njtree,show.node.label = T,show.tip.label = T,
main=paste("NJ tree, ",fileroot),type="clado",cex = 1.1)
plot(njtree,show.node.label = T,show.tip.label = T,
main=paste("NJ tree, ",fileroot),type="phylo",cex = 1.1)
setwd("~/Scratch/gits/pfdisco/analyses/3D7Dd2_trees/")
fileroot
fileroot <- "DD2_noAbsent_PFX_manual"
ped=paste(fileroot,'ped',sep='.')
outpng=paste(fileroot,'png',sep='.')
outnex=paste(fileroot,'nexus',sep='.')
outtab=paste(fileroot,'dist.tab.txt',sep='.')
png(filename=outpng,type="cairo-png")
plot(njtree,show.node.label = T,show.tip.label = T,
main=paste("NJ tree, ",fileroot),type="phylo",cex = 1.1)
dev.off()
write.nexus(njtree,file=outnex)
distmat[lower.tri(distmat)] <- ''
distmat <- mat
for (i in rownames(genos)){
\c
njtree <- nj(as.dist(distmat))
Sys.setenv("DISPLAY"=":0.0")
png(filename=outpng,type="cairo-png")
plot(njtree,show.node.label = T,show.tip.label = T,
main=paste("NJ tree, ",fileroot),type="phylo",cex = 1.1)
dev.off()
write.nexus(njtree,file=outnex)
distmat[lower.tri(distmat)] <- ''
write.table(distmat,sep="\t",file=outtab,quote=F)
