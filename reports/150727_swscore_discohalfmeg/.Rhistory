load("~/Google Drive/misc/macports_150504/pkglist.Rdata")
install.packages(save.pkg.list)
source("http://bioconductor.org/biocLite.R")
biocLite()
library(ggplot2)
library(knitr)
library(reshape2)
opts_chunk$set(fig.width=9, fig.height=6)
SWscores <- read.table("disco.qDD2vr3D7.SW.txt",stringsAsFactors = F,sep='\t',header=T)
colnames(SWscores)[1:2] <- c("i","var")
SWscores <- cbind(t(as.data.frame(strsplit(SWscores$var,split = ':'))),SWscores)
colnames(SWscores)[1:2] <- c("chr","pos")
SWscores$pos <- as.integer(as.character(SWscores$pos))
setwd("~/Scratch/gits/pfdisco/reports/150727_swscore_discohalfmeg/")
SWscores <- read.table("disco.qDD2vr3D7.SW.txt",stringsAsFactors = F,sep='\t',header=T)
colnames(SWscores)[1:2] <- c("i","var")
SWscores <- cbind(t(as.data.frame(strsplit(SWscores$var,split = ':'))),SWscores)
colnames(SWscores)[1:2] <- c("chr","pos")
SWscores$pos <- as.integer(as.character(SWscores$pos))
nuccfs <- read.table("cfNucmerDiscoHaplo_150722_leftAlignGATKSPLIT.txt",sep="\t",stringsAsFactors = F)
colnames(nuccfs) <- c("file","chr","pos","type","concordance","matched","quality","length","alleles","complexity",
"STR","period","exponent","STRlength",
"STRcomplexity","Apc","Tpc","Cpc","Gpc" )
matchlevels <- c("",     "NUCMER","DISCO","HAPLO","NUCMER,DISCO","NUCMER,HAPLO","DISCO,HAPLO","NUCMER,DISCO,HAPLO")
colours <-     c("black","green", "red",  "blue", "yellow",      "cyan",        "magenta",     "white")
names(colours) <- matchlevels
nuccfs$matched <- factor(nuccfs$matched,levels = matchlevels)
nuccfs$polyA = (nuccfs$Apc==1 | nuccfs$Tpc==1)
nuccfs$TA = (nuccfs$Apc==0.5 & nuccfs$Tpc==0.5)
nuccfs$STRtype=""
nuccfs$STRtype <- factor(nuccfs$STRtype,levels=c("","STR","TA","polyA"))
nuccfs[nuccfs$STR != "NULL",]$STRtype = "STR"
nuccfs[nuccfs$TA,]$STRtype = "TA"
nuccfs[nuccfs$polyA,]$STRtype = "polyA"
nuccfs$quality <- as.numeric(nuccfs$quality)
nuccfs <- nuccfs[which(nuccfs$concordance!="MISMATCH"),]
```
SWcf <- merge(nuccfs,SWscores,by=c("pos","chr"))
SWcf <- SWcf[SWcf$XS > 0,]
ggplot(SWcf,aes(NM,colour=matched)) +
geom_density(size=1) +  scale_colour_manual(values = colours)
ggplot(SWcf,aes(NM,colour=STRtype)) +
geom_density(size=1)
ggplot(SWcf,aes(RS,colour=matched)) +
geom_density(size=1) +  scale_colour_manual(values = colours)
ggplot(SWcf,aes(RS,colour=STRtype)) +
geom_density(size=1)
ggplot(SWcf,aes(LD,NM,colour=matched)) +
geom_point(size=3) +  scale_colour_manual(values = colours) + geom_abline()
ggplot(SWcf,aes(LD,NM,colour=STRtype)) +
geom_point(size=3) + geom_abline()
ggplot(SWcf,aes(LD,RS,colour=matched,shape=NM>LD)) +
geom_point(size=3) +  scale_colour_manual(values = colours)
ggplot(SWcf,aes(LD,RS,colour=STRtype,shape=NM>LD)) +
geom_point(size=3)
ggplot(SWcf,aes(LD,RS,colour=NM>LD,shape=RS>1)) +
geom_point(size=3)
ggplot(SWcf,aes(NM,RS,colour=matched,shape=NM>LD)) +
geom_point(size=3) +  scale_colour_manual(values = colours)
ggplot(SWcf,aes(NM,RS,colour=STRtype,shape=NM>LD)) +
geom_point(size=3)
SWcf$error=""
SWcf[SWcf$NM>0,"error"]="LDimperfect"
SWcf[SWcf$NM>SWcf$LD,"error"]="LDerror"
SWcf[SWcf$RS>1,"error"]="RSerror"
ggplot(SWcf,aes(LD,concordance,colour=error)) +
geom_point(size=3)
table(SWcf$error)
table(SWcf[,c("error","concordance")])
ggplot(SWcf,aes(NM,colour=matched)) +
geom_density(size=1) +  scale_colour_manual(values = colours)
ggplot(SWcf,aes(RS,colour=matched)) +
geom_density(size=1) +  scale_colour_manual(values = colours)
ggplot(SWcf,aes(LD,NM,colour=matched)) +
geom_point(size=3) +  scale_colour_manual(values = colours) + geom_abline()
ggplot(SWcf,aes(LD,RS,colour=matched,shape=NM>LD)) +
geom_point(size=3) +  scale_colour_manual(values = colours)
ggplot(SWcf,aes(LD,RS,colour=STRtype,shape=NM>LD)) +
geom_point(size=3)
ggplot(SWcf,aes(LD,RS,colour=NM>LD,shape=RS>1)) +
geom_point(size=3)
ggplot(SWcf,aes(NM,RS,colour=matched,shape=NM>LD)) +
geom_point(size=3) +  scale_colour_manual(values = colours)
ggplot(SWcf,aes(LD,concordance,colour=error)) +
geom_point(size=3)
ggplot(SWcf,aes(concordance,LD,colour=error)) +
geom_boxplot() + facet_grid(error ~ .)
ggplot(SWcf,aes(concordance,LD,colour=error)) +
geom_boxplot() + facet_grid(concordance ~ .)
ggplot(SWcf,aes(error,LD,colour=error)) +
geom_boxplot() + facet_grid(concordance ~ .)
ggplot(SWcf,aes(error,LD,colour=error)) +
geom_bar() + facet_grid(concordance ~ .)
ggplot(SWcf,aes(error,LD,colour=error)) +
geom_histogram() + facet_grid(concordance ~ .)
ggplot(SWcf,aes(error,colour=error)) +
geom_histogram() + facet_grid(concordance ~ .)
ggplot(SWcf,aes(error,colour=error)) +
geom_histogram(position="stack") + facet_grid(concordance ~ .)
ggplot(SWcf,aes(error,fill=error)) +
geom_histogram(position="stack") + facet_grid(concordance ~ .)
ggplot(SWcf,aes(x=concordance,error,fill=error)) +
geom_histogram(position="stack")
ggplot(SWcf,aes(x=concordance,y=error,fill=error)) +
geom_histogram(position="stack")
ggplot(SWcf,aes(x=concordance,group==error,fill=error)) +
geom_histogram(position="stack")
ggplot(SWcf,aes(x=concordance,group=error,fill=error)) +
geom_histogram(position="stack")
ggplot(SWcf,aes(error,LD,colour=error)) +
geom_boxplot() + facet_grid(concordance ~ .)
ggplot(SWcf,aes(error,NM,colour=error)) +
geom_boxplot() + facet_grid(concordance ~ .)
ggplot(SWcf,aes(concordance,NM,colour=error)) +
geom_boxplot() + facet_grid(concordance ~ .)
ggplot(SWcf,aes(concordance,NM,colour=error)) +
geom_boxplot()
ggplot(SWcf,aes(concordance,NM)) +
geom_boxplot()
error
ggplot(SWcf,aes(error,NM,colour=error)) +
geom_boxplot() + facet_grid(concordance ~ .)
ggplot(SWcf,aes(x=concordance,group=error,fill=error)) +
geom_histogram(position="stack")
ggplot(SWcf,aes(LD,complexity,colour=error,shape=STRtype)) +
geom_point(size=3,alpha=0.7)
ggplot(SWcf,aes(LD-length,complexity,colour=error,shape=concordance)) +
geom_point(size=3,alpha=0.7)
ggplot(SWcf,aes(LD-length,complexity,colour=error,shape=concordance)) +
geom_point(size=3,alpha=0.7) + ggtitle("levenshtein distance (flank only) x indel complexity")
ggplot(SWcf,aes(LD,complexity,colour=error,shape=STRtype)) +
geom_point(size=3,alpha=0.7) + ggtitle("levenshtein distance (flank only) x indel complexity")
ggplot(SWcf,aes(LD-length,complexity,colour=error,shape=concordance)) +
geom_point(size=3,alpha=0.7) + ggtitle("levenshtein distance (flank only) x indel complexity")
ggplot(SWcf,aes(LD,complexity,colour=error,shape=concordance)) +
geom_point(size=3,alpha=0.7) + scale_x_log10() + scale_y_log10() +
ggtitle("levenshtein distance x indel complexity [log scale]")
