}
}
for (i in c(0:length(meta$name))) {
for (j in c(i:length(meta$name))) {
write(paste(i,j),stderr())
}
}
rownames(meta) <- meta$name
for (i in c(0:length(meta$name))) {
for (j in c(i:length(meta$name))) {
write(paste(i,j),meta$name[i],meta$name[j],abs(meta$year[i]-meta$year[j]),indelDists[i,j],stderr())
}
}
for (i in c(0:length(meta$name))) {
for (j in c(i:length(meta$name))) {
write(paste(i,j,meta$name[i],meta$name[j],abs(meta$year[i]-meta$year[j]),indelDists[i,j]),stderr())
}
}
for (i in c(0:length(meta$name))) {
for (j in c(i:length(meta$name))) {
write(paste(i,j,meta$name[i],meta$name[j],abs(meta$year[i]-meta$year[j]),indelDists[i,j],snpDists[i,j]),stderr())
}
}
indelDists <- read.table("Thies_all_manual.PASS.Cls.miss0.5.LMRG.HAP.INDEL.recode.vcf.dist.tab.txt",header=T,sep="\t")
snpDists <- read.table("Thies_all_manual.PASS.Cls.miss0.5.LMRG.HAP.SNP.recode.vcf.dist.tab.txt",header=T,sep="\t")
meta <- subset(meta,name %in% names(indelDists))
rownames(meta) <- meta$name
```
```{r message=FALSE}
for (i in c(0:length(meta$name))) {
for (j in c(i:length(meta$name))) {
write(paste(i,j,meta$name[i],meta$name[j],abs(meta$year[i]-meta$year[j]),indelDists[i,j],snpDists[i,j]),stderr())
}
}
for (i in c(0:length(meta$name))) {
for (j in c(i:length(meta$name))) {
interval <- abs(meta$year[i]-meta$year[j])
write(paste(meta$name[i],meta$name[j],interval,indelDists[i,j],snpDists[i,j]),stderr())
}
}
?data.frame
rates <- data.frame(
from=character(),
to=character(),
interval=numeric(),
SNP=numeric(),
INDEL=numeric(),
stringsAsFactors=FALSE)
for (i in c(0:length(meta$name))) {
for (j in c(i:length(meta$name))) {
interval <- abs(meta$year[i]-meta$year[j])
write(paste(meta$name[i],meta$name[j],interval,indelDists[i,j],snpDists[i,j]),stderr())
rates <- rbind(rates,c(meta$name[i],meta$name[j],interval,indelDists[i,j],snpDists[i,j]))
}
}
rates
rates <- data.frame(
from=character(),
to=character(),
interval=numeric(),
SNP=numeric(),
INDEL=numeric(),
stringsAsFactors=FALSE)
rates
for (i in c(0:length(meta$name))) {
for (j in c(i:length(meta$name))) {
interval <- abs(meta$year[i]-meta$year[j])
write(paste(meta$name[i],meta$name[j],interval,indelDists[i,j],snpDists[i,j]),stderr())
rates <- rbind(rates,c(meta$name[i],meta$name[j],interval,indelDists[i,j],snpDists[i,j]))
}
}
rates <- data.frame(
from=character(),
to=character(),
interval=numeric(),
SNP=numeric(),
INDEL=numeric(),
stringsAsFactors=FALSE)
for (i in c(1:length(meta$name))) {
for (j in c(i:length(meta$name))) {
interval <- abs(meta$year[i]-meta$year[j])
write(paste(meta$name[i],meta$name[j],interval,indelDists[i,j],snpDists[i,j]),stderr())
rates <- rbind(rates,c(meta$name[i],meta$name[j],interval,indelDists[i,j],snpDists[i,j]))
}
}
rates
n=0
for (i in c(1:length(meta$name))) {
for (j in c(i:length(meta$name))) {
n<-n+1
interval <- abs(meta$year[i]-meta$year[j])
write(paste(meta$name[i],meta$name[j],interval,indelDists[i,j],snpDists[i,j]),stderr())
rates[n,] <- c(meta$name[i],meta$name[j],interval,indelDists[i,j],snpDists[i,j]))
}
for (i in c(1:length(meta$name))) {
for (j in c(i:length(meta$name))) {
n<-n+1
interval <- abs(meta$year[i]-meta$year[j])
rates[n,] <- c(meta$name[i],meta$name[j],interval,indelDists[i,j],snpDists[i,j]))
n=0
for (i in c(1:length(meta$name))) {
for (j in c(i:length(meta$name))) {
n<-n+1
interval <- abs(meta$year[i]-meta$year[j])
write(paste(meta$name[i],meta$name[j],interval,indelDists[i,j],snpDists[i,j]),stderr())
rates[n,] <- c(meta$name[i],meta$name[j],interval,indelDists[i,j],snpDists[i,j])
}
}
rates
rates <- data.frame(
from=character(),
to=character(),
interval=numeric(),
SNP=numeric(),
INDEL=numeric(),
stringsAsFactors=FALSE)
n=0
for (i in c(1:length(meta$name))) {
for (j in c(i:length(meta$name))) {
n<-n+1
interval <- abs(meta$year[i]-meta$year[j])
#write(paste(meta$name[i],meta$name[j],interval,indelDists[i,j],snpDists[i,j]),stderr())
rates[n,] <- c(meta$name[i],meta$name[j],interval,indelDists[i,j],snpDists[i,j])
}
}
rates
meta$name[i]
for (i in c(1:length(meta$name))) {
for (j in c(i:length(meta$name))) {
n<-n+1
interval <- abs(meta$year[i]-meta$year[j])
#write(paste(meta$name[i],meta$name[j],interval,indelDists[i,j],snpDists[i,j]),stderr())
rates[n,] <- c(as.character(meta$name[i]),
as.character(meta$name[j]),interval,indelDists[i,j],snpDists[i,j])
}
}
rates
rates <- data.frame(
from=character(),
to=character(),
interval=numeric(),
SNP=numeric(),
INDEL=numeric(),
stringsAsFactors=FALSE)
n=0
for (i in c(1:length(meta$name))) {
for (j in c(i:length(meta$name))) {
n<-n+1
interval <- abs(meta$year[i]-meta$year[j])
#write(paste(meta$name[i],meta$name[j],interval,indelDists[i,j],snpDists[i,j]),stderr())
rates[n,] <- c(as.character(meta$name[i]),
as.character(meta$name[j]),interval,indelDists[i,j],snpDists[i,j])
}
}
rates
ggplot(rates,aes(x=interval,y=INDEL/interval) + geom_point()
)
library(ggplot2)
ggplot(rates,aes(x=interval,y=INDEL/interval)) + geom_point()
rates$INDEL/rates$interval
is.numeric(rates$interval)
is.numeric(rates$INDEL)
n=0
for (i in c(1:length(meta$name))) {
for (j in c(i:length(meta$name))) {
n<-n+1
interval <- abs(meta$year[i]-meta$year[j])
#write(paste(meta$name[i],meta$name[j],interval,indelDists[i,j],snpDists[i,j]),stderr())
rates[n,1:2] <- c(as.character(meta$name[i]),
as.character(meta$name[j]))
rates[n,3:5] <- c(interval,indelDists[i,j],snpDists[i,j])
}
}
ggplot(rates,aes(x=interval,y=INDEL/interval)) + geom_point()
rates <- data.frame(
from=character(),
to=character(),
interval=numeric(),
SNP=numeric(),
INDEL=numeric(),
stringsAsFactors=FALSE)
n=0
for (i in c(1:length(meta$name))) {
for (j in c(i:length(meta$name))) {
n<-n+1
interval <- abs(meta$year[i]-meta$year[j])
#write(paste(meta$name[i],meta$name[j],interval,indelDists[i,j],snpDists[i,j]),stderr())
rates[n,1:2] <- c(as.character(meta$name[i]),
as.character(meta$name[j]))
rates[n,3:5] <- c(interval,indelDists[i,j],snpDists[i,j])
}
}
ggplot(rates,aes(x=interval,y=INDEL/interval)) + geom_point()
rates <- data.frame(
from=character(),
to=character(),
interval=numeric(),
haplotype=numeric(),
SNP=numeric(),
INDEL=numeric(),
stringsAsFactors=FALSE)
n=0
for (i in c(1:length(meta$name))) {
for (j in c(i:length(meta$name))) {
if (meta$haplotype.number[i]==meta$haplotype.number[j]) {
n<-n+1
interval <- abs(meta$year[i]-meta$year[j])
#write(paste(meta$name[i],meta$name[j],interval,indelDists[i,j],snpDists[i,j]),stderr())
rates[n,1:2] <- c(as.character(meta$name[i]),
as.character(meta$name[j]))
rates[n,3:5] <- c(interval,meta$haplotype.number[i],
indelDists[i,j],snpDists[i,j])
}
}
}
ggplot(rates,aes(x=interval,y=INDEL/interval,colour=haplotype)) + geom_point()
rates <- data.frame(
from=character(),
to=character(),
interval=numeric(),
haplotype=numeric(),
SNP=numeric(),
INDEL=numeric(),
stringsAsFactors=FALSE)
n=0
for (i in c(1:length(meta$name))) {
for (j in c(i:length(meta$name))) {
if (meta$haplotype.number[i]==meta$haplotype.number[j]) {
n<-n+1
interval <- abs(meta$year[i]-meta$year[j])
#write(paste(meta$name[i],meta$name[j],interval,indelDists[i,j],snpDists[i,j]),stderr())
rates[n,1:2] <- c(as.character(meta$name[i]),
as.character(meta$name[j]))
rates[n,3:5] <- c(interval,meta$haplotype.number[i],
indelDists[i,j],snpDists[i,j])
}
}
}
ggplot(rates,aes(x=interval,y=INDEL/interval,colour=haplotype)) + geom_point()
rates
ggplot(rates,aes(x=interval,y=INDEL/interval,colour=haplotype)) + geom_point()
ggplot(rates,aes(x=interval,y=INDEL,colour=haplotype)) + geom_point()
ggplot(rates,aes(x=interval,y=INDEL/interval)) + geom_point()
rates <- data.frame(
from=character(),
to=character(),
interval=numeric(),
haplotype=numeric(),
SNP=numeric(),
INDEL=numeric(),
stringsAsFactors=FALSE)
n=0
for (i in c(1:length(meta$name))) {
for (j in c(i:length(meta$name))) {
if (meta$haplotype.number[i]==meta$haplotype.number[j]) {
n<-n+1
interval <- abs(meta$year[i]-meta$year[j])
#write(paste(meta$name[i],meta$name[j],interval,indelDists[i,j],snpDists[i,j]),stderr())
rates[n,1:2] <- c(as.character(meta$name[i]),
as.character(meta$name[j]))
rates[n,3:5] <- c(interval,meta$haplotype.number[i],
indelDists[i,j],snpDists[i,j])
}
}
}
ggplot(rates,aes(x=interval,y=INDEL/interval)) + geom_point()
rates
indelDists <- read.table("Thies_all_manual.PASS.Cls.miss0.5.LMRG.HAP.INDEL.recode.vcf.dist.tab.txt",header=T,sep="\t")
snpDists <- read.table("Thies_all_manual.PASS.Cls.miss0.5.LMRG.HAP.SNP.recode.vcf.dist.tab.txt",header=T,sep="\t")
meta <- subset(meta,name %in% names(indelDists))
rownames(meta) <- meta$name
```
```{r message=FALSE}
rates <- data.frame(
from=character(),
to=character(),
interval=numeric(),
haplotype=numeric(),
SNP=numeric(),
INDEL=numeric(),
stringsAsFactors=FALSE)
n=0
for (i in c(1:length(meta$name))) {
for (j in c(i:length(meta$name))) {
if (meta$haplotype.number[i]==meta$haplotype.number[j]) {
n<-n+1
interval <- abs(meta$year[i]-meta$year[j])
#write(paste(meta$name[i],meta$name[j],interval,indelDists[i,j],snpDists[i,j]),stderr())
rates[n,1:2] <- c(as.character(meta$name[i]),
as.character(meta$name[j]))
rates[n,3:5] <- c(interval,meta$haplotype.number[i],
indelDists[i,j],snpDists[i,j])
}
}
}
ggplot(rates,aes(x=interval,y=INDEL/interval)) + geom_point()
warnings()
rates <- data.frame(
from=character(),
to=character(),
interval=numeric(),
haplotype=numeric(),
SNP=numeric(),
INDEL=numeric(),
stringsAsFactors=FALSE)
n=0
for (i in c(1:length(meta$name))) {
for (j in c(i:length(meta$name))) {
if (meta$haplotype.number[i]==meta$haplotype.number[j]) {
n<-n+1
interval <- abs(meta$year[i]-meta$year[j])
#write(paste(meta$name[i],meta$name[j],interval,indelDists[i,j],snpDists[i,j]),stderr())
rates[n,1:2] <- c(as.character(meta$name[i]),
as.character(meta$name[j]))
rates[n,3:6] <- c(interval,meta$haplotype.number[i],
indelDists[i,j],snpDists[i,j])
}
}
}
ggplot(rates,aes(x=interval,y=INDEL/interval)) + geom_point()
ggplot(rates,aes(x=interval,y=INDEL/interval,colour=haplotypes)) + geom_point()
ggplot(rates,aes(x=interval,y=INDEL/interval,colour=haplotype)) + geom_point()
rates <- data.frame(
from=character(),
to=character(),
haplotype=numeric(),
interval=numeric(),
SNP=numeric(),
INDEL=numeric(),
stringsAsFactors=FALSE)
n=0
for (i in c(1:length(meta$name))) {
for (j in c(i:length(meta$name))) {
if (meta$haplotype.number[i]==meta$haplotype.number[j]) {
n<-n+1
interval <- abs(meta$year[i]-meta$year[j])
#write(paste(meta$name[i],meta$name[j],interval,indelDists[i,j],snpDists[i,j]),stderr())
rates[n,1:3] <- c(as.character(meta$name[i]),
as.character(meta$name[j]),
meta$haplotype.number[i])
rates[n,4:6] <- c(interval,
indelDists[i,j],snpDists[i,j])
}
}
}
ggplot(rates,aes(x=interval,y=INDEL/interval,colour=haplotype)) + geom_point()
ggplot(subset(rates,haplotype=="29",aes(x=interval,y=INDEL/interval,colour=haplotype)) + geom_point()
ggplot(subset(rates,haplotype=="29"),aes(x=interval,y=INDEL/interval,colour=haplotype)) + geom_point()
ggplot(subset(rates,haplotype=="29"),aes(x=interval,y=INDEL/interval,colour=haplotype)) + geom_point()
ggplot(subset(rates,haplotype=="29"),aes(x=interval,y=INDEL/interval,colour=to,shape=from)) + geom_point()
ggplot(subset(rates,haplotype=="29"),aes(x=interval,y=INDEL/interval,colour=to,shape=from)) + geom_point()
ggplot(subset(rates,haplotype=="29"),aes(x=interval,y=INDEL/interval,colour=to,shape=from)) + geom_point(size=6)
rates)
rates
ggplot(subset(rates,interval > 0),aes(x=interval,y=INDEL/interval,colour=haplotype)) + geom_point()
ggplot(subset(rates,interval > 1),aes(x=interval,y=INDEL/interval,colour=haplotype)) + geom_point()
snpRates
snpDists
names <- colnames(snpDists)
names
meta$haplotype.number[jname]==meta$haplotype.number[jname]
iname <-names[i]; jname <- names[j]
meta$haplotype.number[jname]==meta$haplotype.number[jname]
meta$haplotype.number[i]
meta$haplotype.number[jname]
jname
meta[jname,]
meta[jname,"haplotype.number"]
rates <- data.frame(
from=character(),
to=character(),
haplotype=numeric(),
interval=numeric(),
SNP=numeric(),
INDEL=numeric(),
stringsAsFactors=FALSE)
n=0
names <- colnames(snpDists)
for (i in c(1:length(meta$name))) {
for (j in c(i:length(meta$name))) {
iname <-names[i]; jname <- names[j]
if (meta[iname,"haplotype.number"]==meta[jname,"haplotype.number"]) {
n<-n+1
interval <- abs(meta[jname,"year"]-meta[iname,"year"])
#write(paste(meta$name[i],meta$name[j],interval,indelDists[i,j],snpDists[i,j]),stderr())
rates[n,1:3] <- c(as.character(iname),
as.character(jname),
meta[iname,"haplotype.number"])
rates[n,4:6] <- c(interval,
indelDists[iname,jname],snpDists[iname,jname])
}
}
}
rates
ggplot(subset(rates,interval > 1),aes(x=interval,y=INDEL/interval,colour=haplotype)) + geom_point()
ggplot(subset(rates,interval > 0),aes(x=interval,y=INDEL/interval,colour=haplotype)) + geom_point()
ggplot(subset(rates,interval > 0),aes(x=interval,y=INDEL/interval,colour=haplotype)) + geom_boxplot()
ggplot(subset(rates,interval > 0),aes(y=INDEL/interval,colour=haplotype)) + geom_boxplot()
ggplot(subset(rates,interval > 0),aes(x=INDEL/interval,colour=haplotype)) + geom_boxplot()
ggplot(subset(rates,interval > 0),aes(x=INDEL/interval,group=haplotype)) + geom_boxplot()
ggplot(subset(rates,interval > 0),aes(x=haplotype,y=INDEL/interval,group=haplotype)) + geom_boxplot()
ggplot(subset(rates,interval > 0),aes(x=haplotype,y=INDEL/interval,colour=haplotype)) + geom_boxplot()
sample(rates$interval)
sample(rates$interval)
rates$interval <- sample(rates$interval)
ggplot(subset(rates,interval > 0),aes(x=haplotype,y=INDEL/interval,colour=haplotype)) + geom_boxplot()
rates$interval <- sample(rates$interval)
ggplot(subset(rates,interval > 0),aes(x=haplotype,y=INDEL/interval,colour=haplotype)) + geom_boxplot()
rates <- subset(rates,haplotype=="29")
ggplot(subset(rates,interval > 0),aes(x=haplotype,y=INDEL/interval,colour=haplotype)) + geom_boxplot()
rates$irate <- rates$irate/rates$interval
rates <- subset(rates,haplotype=="29")
rates$irate <- rates$irate/rates$interval
rates <- data.frame(
from=character(),
to=character(),
haplotype=numeric(),
interval=numeric(),
SNP=numeric(),
INDEL=numeric(),
stringsAsFactors=FALSE)
n=0
names <- colnames(snpDists)
for (i in c(1:length(meta$name))) {
for (j in c(i:length(meta$name))) {
iname <-names[i]; jname <- names[j]
if (meta[iname,"haplotype.number"]==meta[jname,"haplotype.number"]) {
n<-n+1
interval <- abs(meta[jname,"year"]-meta[iname,"year"])
#write(paste(meta$name[i],meta$name[j],interval,indelDists[i,j],snpDists[i,j]),stderr())
rates[n,1:3] <- c(as.character(iname),
as.character(jname),
meta[iname,"haplotype.number"])
rates[n,4:6] <- c(interval,
indelDists[iname,jname],snpDists[iname,jname])
}
}
}
rates <- subset(rates,haplotype=="29")
rates$irate <- rates$irate/rates$interval
rates$irate
rates$irate <- rates$INDEL/rates$interval
rates$irate <- rates$INDEL/rates$interval
rates$irate1 <- rates$INDEL/sample(rates$interval)
rates$irate2 <- rates$INDEL/sample(rates$interval)
rates$irate3 <- rates$INDEL/sample(rates$interval)
rates$irate4 <- rates$INDEL/sample(rates$interval)
rates$irate5 <- rates$INDEL/sample(rates$interval)
melt(rates,id.vars=c("from","to","interval","haplotype","SNP","INDEL")
)
library(reshape2)
rates$irate <- rates$INDEL/rates$interval
rates$irate1 <- rates$INDEL/sample(rates$interval)
rates$irate2 <- rates$INDEL/sample(rates$interval)
rates$irate3 <- rates$INDEL/sample(rates$interval)
rates$irate4 <- rates$INDEL/sample(rates$interval)
rates$irate5 <- rates$INDEL/sample(rates$interval)
melt(rates,id.vars=c("from","to","interval","haplotype","SNP","INDEL"))
rates <- melt(rates,id.vars=c("from","to","interval","haplotype","SNP","INDEL"))
ggplot(subset(rates,interval > 0),aes(x=haplotype,y=INDEL/interval,colour=haplotype)) + geom_boxplot()
ggplot(subset(rates,interval > 0),aes(x=value,y=variable,colour=haplotype)) + geom_boxplot()
ggplot(subset(rates,interval > 0),aes(y=value,x=variable,colour=haplotype)) + geom_boxplot()
subset(rates,value > 0 & is.finite(value))
rates <- subset(rates,value > 0 & is.finite(value))
ggplot(subset(rates,interval > 0),aes(y=value,x=variable,colour=haplotype)) + geom_boxplot()
rates$interval <- sample(rates$interval)
ggplot(subset(rates,interval > 0),aes(x=haplotype,y=INDEL/interval,colour=haplotype)) + geom_boxplot()
rates$irate <- rates$INDEL/rates$interval
rates$irate1 <- rates$INDEL/sample(rates$interval)
rates$irate2 <- rates$INDEL/sample(rates$interval)
rates$irate3 <- rates$INDEL/sample(rates$interval)
rates$irate4 <- rates$INDEL/sample(rates$interval)
rates$irate5 <- rates$INDEL/sample(rates$interval)
rates <- melt(rates,id.vars=c("from","to","interval","haplotype","SNP","INDEL"))
rates <- subset(rates,value > 0 & is.finite(value))
ggplot(subset(rates,interval > 0),aes(y=value,x=variable,colour=haplotype)) + geom_boxplot()
rates <- data.frame(
from=character(),
to=character(),
haplotype=numeric(),
interval=numeric(),
SNP=numeric(),
INDEL=numeric(),
stringsAsFactors=FALSE)
n=0
names <- colnames(snpDists)
for (i in c(1:length(meta$name))) {
for (j in c(i:length(meta$name))) {
iname <-names[i]; jname <- names[j]
if (meta[iname,"haplotype.number"]==meta[jname,"haplotype.number"]) {
n<-n+1
interval <- abs(meta[jname,"year"]-meta[iname,"year"])
#write(paste(meta$name[i],meta$name[j],interval,indelDists[i,j],snpDists[i,j]),stderr())
rates[n,1:3] <- c(as.character(iname),
as.character(jname),
meta[iname,"haplotype.number"])
rates[n,4:6] <- c(interval,
indelDists[iname,jname],snpDists[iname,jname])
}
}
}
rates <- subset(rates,haplotype=="29")
rates$irate <- rates$INDEL/rates$interval
rates$irate1 <- rates$INDEL/sample(rates$interval)
rates$irate2 <- rates$INDEL/sample(rates$interval)
rates$irate3 <- rates$INDEL/sample(rates$interval)
rates$irate4 <- rates$INDEL/sample(rates$interval)
rates$irate5 <- rates$INDEL/sample(rates$interval)
rates <- melt(rates,id.vars=c("from","to","interval","haplotype","SNP","INDEL"))
rates <- subset(rates,value > 0 & is.finite(value))
ggplot(subset(rates,interval > 0),aes(y=value,x=variable,colour=haplotype)) + geom_boxplot()
ggplot(subset(rates,interval > 0),aes(y=value,x=variable,colour=haplotype)) + geom_jitter()
