daisyContigs <- read.table("AaegL_daisy_hiC.rename.nucmer.20.tiling",col.names=c("start","end","qstart","qend","mle","len","cov","chrsize","contigsize","chrpc","contpc","chrom","contig"),stringsAsFactors = F)
unique(daisyContigs$contig)
starts <- as.data.frame(aggregate(daisyContigs$start,by=list(daisyContigs$contig),FUN=min))
ends <- as.data.frame(aggregate(daisyContigs$end,by=list(daisyContigs$contig),FUN=max))
chroms <- as.data.frame(aggregate(daisyContigs$chrom,by=list(daisyContigs$contig),FUN=function(x){x[1]}))
aligns <- as.data.frame(aggregate(daisyContigs$chrom,by=list(daisyContigs$contig),FUN=function(x){length(unique(x))}))
colnames(starts)<-c("contig","start")
daisyContigs[aligns$x>1,]
colnames(starts)<-c("contig","start")
colnames(ends)  <-c("contig","end")
colnames(chroms)<-c("contig","chrom")
daisyContigs <- merge(chroms,merge(starts,ends))
daisyContigs$chrom <- as.numeric(gsub("daisy_","",daisyContigs$chrom))
daisyContigs <- daisyContigs[order(daisyContigs$chrom,daisyContigs$start),]
joins <- read.table("all_0_3125ng_AaPB.RG.n20.noBC.bam_40000_fragScaff.f.nucmer.coords.joins",col.names=c("to","from","scaff","count","program"),stringsAsFactors = F)
dim(joins)
joins <- subset(joins,to %in% daisyContigs$contig & from %in% daisyContigs$contig)
dim(joins)
#joins <- merge(joins,daisyContigs,by.x="from",by.y="contig")
joins$to <- factor(joins$to,levels=daisyContigs$contig,ordered=T)
joins$from <- factor(joins$from,levels=daisyContigs$contig,ordered=T)
#ggplot(joins,aes(y=to,x=from,fill=scaff)) + geom_tile(aes(size=size/10000)) + theme(legend.position="none",axis.text=element_blank() )
ggplot(joins,aes(y=to,x=from,fill=scaff)) + geom_tile() + theme(legend.position="none",axis.text=element_blank() )
joins <- read.table("fragscaff_AaegPB_0_156_n10_40k.nucmer.coords.joins",col.names=c("to","from","scaff","size","program"),stringsAsFactors = F)
dim(joins)
joins <- subset(joins,to %in% daisyContigs$contig & from %in% daisyContigs$contig)
joins$to <- factor(joins$to,levels=daisyContigs$contig,ordered=T)
joins$from <- factor(joins$from,levels=daisyContigs$contig,ordered=T)
dim(joins)
ggplot(joins,aes(y=to,x=from,fill=scaff)) + geom_tile() + theme(legend.position="none",axis.text=element_blank() )
```
```{r}
joins <- read.table("AaegL_daisy_hiC.rename.nucmer.coords.joins",col.names=c("to","from","scaff","size","program"),stringsAsFactors = F)
dim(joins)
joins <- subset(joins,to %in% daisyContigs$contig & from %in% daisyContigs$contig)
joins$to <- factor(joins$to,levels=daisyContigs$contig,ordered=T)
joins$from <- factor(joins$from,levels=daisyContigs$contig,ordered=T)
ggplot(joins,aes(y=to,x=from,fill=scaff)) + geom_tile() + theme(legend.position="none",axis.text=element_blank() )
joins <- read.table("Aaeg_dovetail_pacbio_22Aug2016.nucmer.coords.joins",col.names=c("to","from","scaff","size","program"),stringsAsFactors = F)
dim(joins)
joins <- subset(joins,to %in% daisyContigs$contig & from %in% daisyContigs$contig)
joins$to <- factor(joins$to,levels=daisyContigs$contig,ordered=T)
joins$from <- factor(joins$from,levels=daisyContigs$contig,ordered=T)
chroms <- as.data.frame(aggregate(daisyContigs$contig,by=list(daisyContigs$chr),FUN=function(x) {x[length(x)]}))
#ggplot(joins,aes(y=to,x=from,fill=scaff)) + geom_tile() + geom_vline(aes(xintercept=x),data=chroms) +
#  theme(legend.position="none",axis.text=element_blank() )
ggplot(joins,aes(y=to,x=from,fill=scaff)) + geom_tile() +
theme(legend.position="none",axis.text=element_blank() )
chroms
joins <- read.table("Aaeg_dovetail_pacbio_22Aug2016.nucmer.coords.joins",col.names=c("to","from","scaff","size","program"),stringsAsFactors = F)
dim(joins)
joins <- subset(joins,to %in% daisyContigs$contig & from %in% daisyContigs$contig)
joins$to <- factor(joins$to,levels=daisyContigs$contig,ordered=T)
joins$from <- factor(joins$from,levels=daisyContigs$contig,ordered=T)
#ggplot(joins,aes(y=to,x=from,fill=scaff)) + geom_tile() + geom_vline(aes(xintercept=x),data=chroms) +
#  theme(legend.position="none",axis.text=element_blank() )
ggplot(joins,aes(y=to,x=from,fill=scaff)) + geom_tile() +
theme(legend.position="none",axis.text=element_blank() )
joins <- read.table("Aaeg_dovetail_bionano_02Sep2016_ALIGN.RG.n10.noBC.bam_40000_fragScaff.nucmer.coords.joins",col.names=c("to","from","scaff","size","program"),stringsAsFactors = F)
dim(joins)
joins <- subset(joins,to %in% daisyContigs$contig & from %in% daisyContigs$contig)
joins$to <- factor(joins$to,levels=daisyContigs$contig,ordered=T)
joins$from <- factor(joins$from,levels=daisyContigs$contig,ordered=T)
ggplot(joins,aes(y=to,x=from,fill=scaff)) + geom_tile() + theme(legend.position="none",axis.text=element_blank() )
dim(daisyContigs)
daisyContigs <- read.table("AaegL_daisy_hiC.rename.nucmer.10.tiling",col.names=c("start","end","qstart","qend","mle","len","cov","chrsize","contigsize","chrpc","contpc","chrom","contig"),stringsAsFactors = F)
unique(daisyContigs$contig)
starts <- as.data.frame(aggregate(daisyContigs$start,by=list(daisyContigs$contig),FUN=min))
ends <- as.data.frame(aggregate(daisyContigs$end,by=list(daisyContigs$contig),FUN=max))
chroms <- as.data.frame(aggregate(daisyContigs$chrom,by=list(daisyContigs$contig),FUN=function(x){x[1]}))
aligns <- as.data.frame(aggregate(daisyContigs$chrom,by=list(daisyContigs$contig),FUN=function(x){length(unique(x))}))
daisyContigs[aligns$x>1,]
colnames(starts)<-c("contig","start")
colnames(ends)  <-c("contig","end")
colnames(chroms)<-c("contig","chrom")
daisyContigs <- merge(chroms,merge(starts,ends))
daisyContigs$chrom <- as.numeric(gsub("daisy_","",daisyContigs$chrom))
daisyContigs <- daisyContigs[order(daisyContigs$chrom,daisyContigs$start),]
dim(daisyContigs)
joins <- read.table("all_0_3125ng_AaPB.RG.n20.noBC.bam_40000_fragScaff.f.nucmer.coords.joins",col.names=c("to","from","scaff","count","program"),stringsAsFactors = F)
dim(joins)
joins <- subset(joins,to %in% daisyContigs$contig & from %in% daisyContigs$contig)
dim(joins)
#joins <- merge(joins,daisyContigs,by.x="from",by.y="contig")
joins$to <- factor(joins$to,levels=daisyContigs$contig,ordered=T)
joins$from <- factor(joins$from,levels=daisyContigs$contig,ordered=T)
#ggplot(joins,aes(y=to,x=from,fill=scaff)) + geom_tile(aes(size=size/10000)) + theme(legend.position="none",axis.text=element_blank() )
ggplot(joins,aes(y=to,x=from,fill=scaff)) + geom_tile() + theme(legend.position="none",axis.text=element_blank() )
```
```{r}
joins <- read.table("fragscaff_AaegPB_0_156_n10_40k.nucmer.coords.joins",col.names=c("to","from","scaff","size","program"),stringsAsFactors = F)
dim(joins)
joins <- subset(joins,to %in% daisyContigs$contig & from %in% daisyContigs$contig)
joins$to <- factor(joins$to,levels=daisyContigs$contig,ordered=T)
joins$from <- factor(joins$from,levels=daisyContigs$contig,ordered=T)
dim(joins)
ggplot(joins,aes(y=to,x=from,fill=scaff)) + geom_tile() + theme(legend.position="none",axis.text=element_blank() )
```
```{r}
joins <- read.table("AaegL_daisy_hiC.rename.nucmer.coords.joins",col.names=c("to","from","scaff","size","program"),stringsAsFactors = F)
dim(joins)
joins <- subset(joins,to %in% daisyContigs$contig & from %in% daisyContigs$contig)
joins$to <- factor(joins$to,levels=daisyContigs$contig,ordered=T)
joins$from <- factor(joins$from,levels=daisyContigs$contig,ordered=T)
ggplot(joins,aes(y=to,x=from,fill=scaff)) + geom_tile() + theme(legend.position="none",axis.text=element_blank() )
```
```{r}
joins <- read.table("Aaeg_dovetail_pacbio_22Aug2016.nucmer.coords.joins",col.names=c("to","from","scaff","size","program"),stringsAsFactors = F)
dim(joins)
joins <- subset(joins,to %in% daisyContigs$contig & from %in% daisyContigs$contig)
joins$to <- factor(joins$to,levels=daisyContigs$contig,ordered=T)
joins$from <- factor(joins$from,levels=daisyContigs$contig,ordered=T)
#ggplot(joins,aes(y=to,x=from,fill=scaff)) + geom_tile() + geom_vline(aes(xintercept=x),data=chroms) +
#  theme(legend.position="none",axis.text=element_blank() )
ggplot(joins,aes(y=to,x=from,fill=scaff)) + geom_tile() +
theme(legend.position="none",axis.text=element_blank() )
joins <- read.table("Aaeg_dovetail_bionano_02Sep2016_ALIGN.RG.n10.noBC.bam_40000_fragScaff.nucmer.coords.joins",col.names=c("to","from","scaff","size","program"),stringsAsFactors = F)
dim(joins)
joins <- subset(joins,to %in% daisyContigs$contig & from %in% daisyContigs$contig)
joins$to <- factor(joins$to,levels=daisyContigs$contig,ordered=T)
joins$from <- factor(joins$from,levels=daisyContigs$contig,ordered=T)
ggplot(joins,aes(y=to,x=from,fill=scaff)) + geom_tile() + theme(legend.position="none",axis.text=element_blank() )
joins <- merge(joins,daisyContigs,by.x="from",by.y="contig")
head(joins)
joins <- merge(joins,daisyContigs,by.x="from",by.y="contig")
joins <- merge(joins,daisyContigs,by.x="to",by.y="contig")
joins <- read.table("all_0_3125ng_AaPB.RG.n20.noBC.bam_40000_fragScaff.f.nucmer.coords.joins",col.names=c("to","from","scaff","count","program"),stringsAsFactors = F)
dim(joins)
joins <- subset(joins,to %in% daisyContigs$contig & from %in% daisyContigs$contig)
dim(joins)
joins <- merge(joins,daisyContigs,by.x="from",by.y="contig")
joins <- merge(joins,daisyContigs,by.x="to",by.y="contig")
head(joins)
joins <- merge(joins,daisyContigs,by.x="from",by.y="contig",suffixes = c("",".fr"))
joins <- merge(joins,daisyContigs,by.x="to",by.y="contig",suffixes = c("",".to"))
joins <- read.table("all_0_3125ng_AaPB.RG.n20.noBC.bam_40000_fragScaff.f.nucmer.coords.joins",col.names=c("to","from","scaff","count","program"),stringsAsFactors = F)
dim(joins)
joins <- subset(joins,to %in% daisyContigs$contig & from %in% daisyContigs$contig)
dim(joins)
joins <- merge(joins,daisyContigs,by.x="from",by.y="contig",suffixes = c("",".fr"))
joins <- merge(joins,daisyContigs,by.x="to",by.y="contig",suffixes = c("",".to"))
head(joins)
joins <- read.table("all_0_3125ng_AaPB.RG.n20.noBC.bam_40000_fragScaff.f.nucmer.coords.joins",col.names=c("to","from","scaff","count","program"),stringsAsFactors = F)
dim(joins)
joins <- subset(joins,to %in% daisyContigs$contig & from %in% daisyContigs$contig)
dim(joins)
joins <- merge(joins,daisyContigs,by.x="from",by.y="contig")
joins <- merge(joins,daisyContigs,by.x="to",by.y="contig",suffixes = c(".from",".to"))
joins$to <- factor(joins$to,levels=daisyContigs$contig,ordered=T)
joins$from <- factor(joins$from,levels=daisyContigs$contig,ordered=T)
head(joins)
ggplot(subset(joins,chrom.from in c(1:3) and chrom.to in c(1:3)),aes(ymin=to,x=from,fill=scaff)) + geom_tile(aes(size=size/10000)) + theme(legend.position="none",axis.text=element_blank() )
head(daisyContigs)
ggplot(subset(joins,chrom.from %in% c(1:3) and chrom.to %in% c(1:3)),aes(ymin=start.from,ymax=end.from, xmin=start.to,xmax=end.to,fill=scaff)) + geom_rect() + theme(legend.position="none",axis.text=element_blank() )
ggplot(subset(joins,chrom.from %in% c(1:3) & chrom.to %in% c(1:3)),aes(ymin=start.from,ymax=end.from, xmin=start.to,xmax=end.to,fill=scaff)) + geom_rect() + theme(legend.position="none",axis.text=element_blank() )
```
ggplot(subset(joins,chrom.from %in% c(1:3) & chrom.to %in% c(1:3)),aes(ymin=start.from,ymax=end.from, xmin=start.to,xmax=end.to,fill=scaff)) + geom_rect() + theme(legend.position="none",axis.text=element_blank() ) + facet_grid(. ~ chrom.to)
head(joins)
subset(joins,chrom.from %in% c(1:3) & chrom.to %in% c(1:3)),
subset(joins,chrom.from %in% c(1:3) & chrom.to %in% c(1:3))
ggplot(subset(joins,chrom.from %in% c(1:3) & chrom.to == chrom.from),aes(ymin=start.from,ymax=end.from, xmin=start.to,xmax=end.to,fill=scaff)) + geom_rect() + theme(legend.position="none",axis.text=element_blank() ) + facet_grid(. ~ chrom.to)
subset(joins,chrom.from %in% c(1:3) & chrom.to == chrom.from)
head(subset(joins,chrom.from %in% c(1:3) & chrom.to == chrom.from))
ggplot(subset(joins,chrom.from %in% c(1:3) & chrom.to == chrom.from),aes(ymin=start.from,ymax=end.from, xmin=start.to,xmax=end.to,fill="blue")) + geom_rect() + theme(legend.position="none",axis.text=element_blank() ) + facet_grid(. ~ chrom.to)
ggplot(subset(joins,chrom.from %in% c(1:3) & chrom.to == chrom.from),aes(ymin=start.from,ymax=end.from, xmin=start.to,xmax=end.to,fill=scaff)) + geom_rect()  + facet_grid(. ~ chrom.to)
ggplot(subset(joins,chrom.from %in% c(1:3) & chrom.to == chrom.from),aes(ymin=start.from,ymax=end.from, xmin=start.to,xmax=end.to,fill=scaff)) + geom_rect() + theme(legend.position="none",axis.text=element_blank() ) + facet_grid(. ~ chrom.to)
ggplot(subset(joins,chrom.from %in% c(1) & chrom.to == chrom.from),aes(ymin=start.from,ymax=end.from, xmin=start.to,xmax=end.to,fill=scaff)) + geom_rect() + theme(legend.position="none",axis.text=element_blank() ) + facet_grid(. ~ chrom.to)
ggplot(subset(joins,chrom.from %in% c(1) & chrom.to == chrom.from),aes(ymin=start.from,ymax=end.from, xmin=start.to,xmax=end.to,fill=scaff)) + geom_rect() + theme(legend.position="none") + facet_grid(. ~ chrom.to)
ggplot(subset(joins,chrom.from %in% c(1) & chrom.to == chrom.from),aes(ymin=start.from,ymax=end.from, xmin=start.to,xmax=end.to)) + geom_rect() + theme(legend.position="none") + facet_grid(. ~ chrom.to)
ggplot(joins,aes(y=to,x=from,fill=scaff)) + geom_tile() + theme(legend.position="none",axis.text=element_blank() )
ggplot(subset(joins,chrom.from %in% c(1) & chrom.to == chrom.from),aes(ymin=start.from,ymax=end.from, xmin=start.to,xmax=end.to)) + geom_rect() + theme(legend.position="none") + facet_grid(. ~ chrom.to)
joins <- merge(joins,daisyContigs,by.x="from",by.y="contig")
joins <- merge(joins,daisyContigs,by.x="to",by.y="contig",suffixes = c(".from",".to"))
ggplot(subset(joins,chrom.from %in% c(1) & chrom.to == chrom.from),aes(ymin=start.from,ymax=end.from, xmin=start.to,xmax=end.to)) + geom_rect() + theme(legend.position="none") + facet_grid(. ~ chrom.to)
joins <- read.table("all_0_3125ng_AaPB.RG.n20.noBC.bam_40000_fragScaff.f.nucmer.coords.joins",col.names=c("to","from","scaff","count","program"),stringsAsFactors = F)
dim(joins)
joins <- subset(joins,to %in% daisyContigs$contig & from %in% daisyContigs$contig)
dim(joins)
joins$to <- factor(joins$to,levels=daisyContigs$contig,ordered=T)
joins$from <- factor(joins$from,levels=daisyContigs$contig,ordered=T)
#ggplot(joins,aes(y=to,x=from,fill=scaff)) + geom_tile(aes(size=size/10000)) + theme(legend.position="none",axis.text=element_blank() )
ggplot(joins,aes(y=to,x=from,fill=scaff)) + geom_tile() + theme(legend.position="none",axis.text=element_blank() )
joins <- merge(joins,daisyContigs,by.x="from",by.y="contig")
joins <- merge(joins,daisyContigs,by.x="to",by.y="contig",suffixes = c(".from",".to"))
ggplot(subset(joins,chrom.from %in% c(1) & chrom.to == chrom.from),aes(ymin=start.from,ymax=end.from, xmin=start.to,xmax=end.to)) + geom_rect() + theme(legend.position="none") + facet_grid(. ~ chrom.to)
joins <- read.table("Aaeg_dovetail_bionano_02Sep2016_ALIGN.RG.n10.noBC.bam_40000_fragScaff.nucmer.coords.joins",col.names=c("to","from","scaff","size","program"),stringsAsFactors = F)
dim(joins)
joins <- subset(joins,to %in% daisyContigs$contig & from %in% daisyContigs$contig)
joins$to <- factor(joins$to,levels=daisyContigs$contig,ordered=T)
joins$from <- factor(joins$from,levels=daisyContigs$contig,ordered=T)
ggplot(joins,aes(y=to,x=from,fill=scaff)) + geom_tile() + theme(legend.position="none",axis.text=element_blank() )
joins <- merge(joins,daisyContigs,by.x="from",by.y="contig")
joins <- merge(joins,daisyContigs,by.x="to",by.y="contig",suffixes = c(".from",".to"))
ggplot(subset(joins,chrom.from %in% c(1) & chrom.to == chrom.from),aes(ymin=start.from,ymax=end.from, xmin=start.to,xmax=end.to)) + geom_rect() + theme(legend.position="none") + facet_grid(. ~ chrom.to)
daisyContigs <- read.table("AaegL_daisy_hiC.rename.nucmer.1.tiling",col.names=c("start","end","qstart","qend","mle","len","cov","chrsize","contigsize","chrpc","contpc","chrom","contig"),stringsAsFactors = F)
unique(daisyContigs$contig)
starts <- as.data.frame(aggregate(daisyContigs$start,by=list(daisyContigs$contig),FUN=min))
ends <- as.data.frame(aggregate(daisyContigs$end,by=list(daisyContigs$contig),FUN=max))
chroms <- as.data.frame(aggregate(daisyContigs$chrom,by=list(daisyContigs$contig),FUN=function(x){x[1]}))
aligns <- as.data.frame(aggregate(daisyContigs$chrom,by=list(daisyContigs$contig),FUN=function(x){length(unique(x))}))
daisyContigs[aligns$x>1,]
colnames(starts)<-c("contig","start")
colnames(ends)  <-c("contig","end")
colnames(chroms)<-c("contig","chrom")
daisyContigs <- merge(chroms,merge(starts,ends))
daisyContigs$chrom <- as.numeric(gsub("daisy_","",daisyContigs$chrom))
daisyContigs <- daisyContigs[order(daisyContigs$chrom,daisyContigs$start),]
joins <- read.table("all_0_3125ng_AaPB.RG.n20.noBC.bam_40000_fragScaff.f.nucmer.coords.joins",col.names=c("to","from","scaff","count","program"),stringsAsFactors = F)
dim(joins)
joins <- subset(joins,to %in% daisyContigs$contig & from %in% daisyContigs$contig)
dim(joins)
joins$to <- factor(joins$to,levels=daisyContigs$contig,ordered=T)
joins$from <- factor(joins$from,levels=daisyContigs$contig,ordered=T)
#ggplot(joins,aes(y=to,x=from,fill=scaff)) + geom_tile(aes(size=size/10000)) + theme(legend.position="none",axis.text=element_blank() )
ggplot(joins,aes(y=to,x=from,fill=scaff)) + geom_tile() + theme(legend.position="none",axis.text=element_blank() )
```
```{r}
joins <- read.table("fragscaff_AaegPB_0_156_n10_40k.nucmer.coords.joins",col.names=c("to","from","scaff","size","program"),stringsAsFactors = F)
dim(joins)
joins <- subset(joins,to %in% daisyContigs$contig & from %in% daisyContigs$contig)
joins$to <- factor(joins$to,levels=daisyContigs$contig,ordered=T)
joins$from <- factor(joins$from,levels=daisyContigs$contig,ordered=T)
dim(joins)
ggplot(joins,aes(y=to,x=from,fill=scaff)) + geom_tile() + theme(legend.position="none",axis.text=element_blank() )
```
```{r}
joins <- read.table("AaegL_daisy_hiC.rename.nucmer.coords.joins",col.names=c("to","from","scaff","size","program"),stringsAsFactors = F)
dim(joins)
joins <- subset(joins,to %in% daisyContigs$contig & from %in% daisyContigs$contig)
joins$to <- factor(joins$to,levels=daisyContigs$contig,ordered=T)
joins$from <- factor(joins$from,levels=daisyContigs$contig,ordered=T)
ggplot(joins,aes(y=to,x=from,fill=scaff)) + geom_tile() + theme(legend.position="none",axis.text=element_blank() )
joins <- read.table("Aaeg_dovetail_pacbio_22Aug2016.nucmer.coords.joins",col.names=c("to","from","scaff","size","program"),stringsAsFactors = F)
dim(joins)
joins <- subset(joins,to %in% daisyContigs$contig & from %in% daisyContigs$contig)
joins$to <- factor(joins$to,levels=daisyContigs$contig,ordered=T)
joins$from <- factor(joins$from,levels=daisyContigs$contig,ordered=T)
#ggplot(joins,aes(y=to,x=from,fill=scaff)) + geom_tile() + geom_vline(aes(xintercept=x),data=chroms) +
#  theme(legend.position="none",axis.text=element_blank() )
ggplot(joins,aes(y=to,x=from,fill=scaff)) + geom_tile() +
theme(legend.position="none",axis.text=element_blank() )
joins <- read.table("Aaeg_dovetail_bionano_02Sep2016_ALIGN.RG.n10.noBC.bam_40000_fragScaff.nucmer.coords.joins",col.names=c("to","from","scaff","size","program"),stringsAsFactors = F)
dim(joins)
joins <- subset(joins,to %in% daisyContigs$contig & from %in% daisyContigs$contig)
joins$to <- factor(joins$to,levels=daisyContigs$contig,ordered=T)
joins$from <- factor(joins$from,levels=daisyContigs$contig,ordered=T)
ggplot(joins,aes(y=to,x=from,fill=scaff)) + geom_tile() + theme(legend.position="none",axis.text=element_blank() )
daisyContigs <- read.table("AaegL_daisy_hiC.rename.nucmer.10.tiling",col.names=c("start","end","qstart","qend","mle","len","cov","chrsize","contigsize","chrpc","contpc","chrom","contig"),stringsAsFactors = F)
unique(daisyContigs$contig)
starts <- as.data.frame(aggregate(daisyContigs$start,by=list(daisyContigs$contig),FUN=min))
ends <- as.data.frame(aggregate(daisyContigs$end,by=list(daisyContigs$contig),FUN=max))
chroms <- as.data.frame(aggregate(daisyContigs$chrom,by=list(daisyContigs$contig),FUN=function(x){x[1]}))
aligns <- as.data.frame(aggregate(daisyContigs$chrom,by=list(daisyContigs$contig),FUN=function(x){length(unique(x))}))
daisyContigs[aligns$x>1,]
colnames(starts)<-c("contig","start")
colnames(ends)  <-c("contig","end")
colnames(chroms)<-c("contig","chrom")
daisyContigs <- merge(chroms,merge(starts,ends))
daisyContigs$chrom <- as.numeric(gsub("daisy_","",daisyContigs$chrom))
daisyContigs <- daisyContigs[order(daisyContigs$chrom,daisyContigs$start),]
ggplot(joins,aes(y=to,x=from,fill=scaff)) + geom_tile() + theme(legend.position="none",axis.text=element_blank() )
joins <- read.table("Aaeg_dovetail_bionano_02Sep2016_ALIGN.RG.n10.noBC.bam_40000_fragScaff.nucmer.coords.joins",col.names=c("to","from","scaff","size","program"),stringsAsFactors = F)
dim(joins)
joins <- subset(joins,to %in% daisyContigs$contig & from %in% daisyContigs$contig)
joins$to <- factor(joins$to,levels=daisyContigs$contig,ordered=T)
joins$from <- factor(joins$from,levels=daisyContigs$contig,ordered=T)
ggplot(joins,aes(y=to,x=from,fill=scaff)) + geom_tile() + theme(legend.position="none",axis.text=element_blank() )
daisyContigs <- read.table("daisy_order_scaffs.txt",col.names=c("contig","chr","pos","cov","size","hits"),stringsAsFactors = F)
joins <- read.table("Aaeg_dovetail_bionano_02Sep2016_ALIGN.RG.n10.noBC.bam_40000_fragScaff.nucmer.coords.joins",col.names=c("to","from","scaff","size","program"),stringsAsFactors = F)
dim(joins)
joins <- subset(joins,to %in% daisyContigs$contig & from %in% daisyContigs$contig)
joins$to <- factor(joins$to,levels=daisyContigs$contig,ordered=T)
joins$from <- factor(joins$from,levels=daisyContigs$contig,ordered=T)
ggplot(joins,aes(y=to,x=from,fill=scaff)) + geom_tile() + theme(legend.position="none",axis.text=element_blank() )
daisyContigs <- read.table("Aaeg_dovetail_bionano_02Sep2016_ALIGN.RG.n10.noBC.bam_40000_fragScaff.nucmer.5.tiling",col.names=c("start","end","qstart","qend","mle","len","cov","chrsize","contigsize","chrpc","contpc","chrom","contig"),stringsAsFactors = F)
unique(daisyContigs$contig)
starts <- as.data.frame(aggregate(daisyContigs$start,by=list(daisyContigs$contig),FUN=min))
ends <- as.data.frame(aggregate(daisyContigs$end,by=list(daisyContigs$contig),FUN=max))
chroms <- as.data.frame(aggregate(daisyContigs$chrom,by=list(daisyContigs$contig),FUN=function(x){x[1]}))
aligns <- as.data.frame(aggregate(daisyContigs$chrom,by=list(daisyContigs$contig),FUN=function(x){length(unique(x))}))
daisyContigs[aligns$x>1,]
colnames(starts)<-c("contig","start")
colnames(ends)  <-c("contig","end")
colnames(chroms)<-c("contig","chrom")
daisyContigs <- merge(chroms,merge(starts,ends))
daisyContigs$chrom <- as.numeric(gsub("daisy_","",daisyContigs$chrom))
daisyContigs <- daisyContigs[order(daisyContigs$chrom,daisyContigs$start),]
head(daisyContigs)
daisyContigs <- read.table("Aaeg_dovetail_bionano_02Sep2016_ALIGN.RG.n10.noBC.bam_40000_fragScaff.nucmer.5.tiling",col.names=c("start","end","qstart","qend","mle","len","cov","chrsize","contigsize","chrpc","contpc","chrom","contig"),stringsAsFactors = F)
unique(daisyContigs$contig)
starts <- as.data.frame(aggregate(daisyContigs$start,by=list(daisyContigs$contig),FUN=min))
ends <- as.data.frame(aggregate(daisyContigs$end,by=list(daisyContigs$contig),FUN=max))
chroms <- as.data.frame(aggregate(daisyContigs$chrom,by=list(daisyContigs$contig),FUN=function(x){x[1]}))
aligns <- as.data.frame(aggregate(daisyContigs$chrom,by=list(daisyContigs$contig),FUN=function(x){length(unique(x))}))
daisyContigs[aligns$x>1,]
colnames(starts)<-c("contig","start")
colnames(ends)  <-c("contig","end")
colnames(chroms)<-c("contig","chrom")
daisyContigs <- merge(chroms,merge(starts,ends))
daisyContigs$chrom <- as.numeric(gsub("daisy_","",daisyContigs$chrom))
daisyContigs <- daisyContigs[order(daisyContigs$chrom,daisyContigs$start),]
daisyContigs <- read.table("Aaeg_dovetail_bionano_02Sep2016_ALIGN.RG.n10.noBC.bam_40000_fragScaff.nucmer.5.tiling",col.names=c("start","end","qstart","qend","mle","len","cov","chrsize","contigsize","chrpc","contpc","chrom","contig"),stringsAsFactors = F)
unique(daisyContigs$contig)
starts <- as.data.frame(aggregate(daisyContigs$start,by=list(daisyContigs$contig),FUN=min))
ends <- as.data.frame(aggregate(daisyContigs$end,by=list(daisyContigs$contig),FUN=max))
chroms <- as.data.frame(aggregate(daisyContigs$chrom,by=list(daisyContigs$contig),FUN=function(x){x[1]}))
aligns <- as.data.frame(aggregate(daisyContigs$chrom,by=list(daisyContigs$contig),FUN=function(x){length(unique(x))}))
daisyContigs[aligns$x>1,]
colnames(starts)<-c("contig","start")
colnames(ends)  <-c("contig","end")
colnames(chroms)<-c("contig","chrom")
daisyContigs <- merge(chroms,merge(starts,ends))
#daisyContigs$chrom <- as.numeric(gsub("daisy_","",daisyContigs$chrom))
daisyContigs <- daisyContigs[order(daisyContigs$chrom,daisyContigs$start),]
daisyContigs <- read.table("Aaeg_dovetail_bionano_02Sep2016_ALIGN.RG.n10.noBC.bam_40000_fragScaff.nucmer.5.tiling",col.names=c("start","end","qstart","qend","mle","len","cov","chrsize","contigsize","chrpc","contpc","chrom","contig"),stringsAsFactors = F)
unique(daisyContigs$contig)
starts <- as.data.frame(aggregate(daisyContigs$start,by=list(daisyContigs$contig),FUN=min))
ends <- as.data.frame(aggregate(daisyContigs$end,by=list(daisyContigs$contig),FUN=max))
daisyContigs <- read.table("AaegL_daisy_hiC.rename.nucmer.10.tiling",col.names=c("start","end","qstart","qend","mle","len","cov","chrsize","contigsize","chrpc","contpc","chrom","contig"),stringsAsFactors = F)
unique(daisyContigs$contig)
starts <- as.data.frame(aggregate(daisyContigs$start,by=list(daisyContigs$contig),FUN=min))
ends <- as.data.frame(aggregate(daisyContigs$end,by=list(daisyContigs$contig),FUN=max))
chroms <- as.data.frame(aggregate(daisyContigs$chrom,by=list(daisyContigs$contig),FUN=function(x){x[1]}))
aligns <- as.data.frame(aggregate(daisyContigs$chrom,by=list(daisyContigs$contig),FUN=function(x){length(unique(x))}))
daisyContigs[aligns$x>1,]
colnames(starts)<-c("contig","start")
colnames(ends)  <-c("contig","end")
colnames(chroms)<-c("contig","chrom")
daisyContigs <- merge(chroms,merge(starts,ends))
daisyContigs$chrom <- as.numeric(gsub("daisy_","",daisyContigs$chrom))
daisyContigs <- daisyContigs[order(daisyContigs$chrom,daisyContigs$start),]
fragContigs <- read.table("Aaeg_dovetail_bionano_02Sep2016_ALIGN.RG.n10.noBC.bam_40000_fragScaff.nucmer.5.tiling",col.names=c("start","end","qstart","qend","mle","len","cov","chrsize","contigsize","chrpc","contpc","chrom","contig"),stringsAsFactors = F)
unique(fragContigs$contig)
starts <- as.data.frame(aggregate(fragContigs$start,by=list(fragContigs$contig),FUN=min))
ends <- as.data.frame(aggregate(fragContigs$end,by=list(fragContigs$contig),FUN=max))
chroms <- as.data.frame(aggregate(fragContigs$chrom,by=list(fragContigs$contig),FUN=function(x){x[1]}))
aligns <- as.data.frame(aggregate(fragContigs$chrom,by=list(fragContigs$contig),FUN=function(x){length(unique(x))}))
fragContigs[aligns$x>1,]
colnames(starts)<-c("contig","start")
colnames(ends)  <-c("contig","end")
colnames(chroms)<-c("contig","chrom")
fragContigs <- merge(chroms,merge(starts,ends))
fragContigs <- fragContigs[order(fragContigs$chrom,fragContigs$start),]
joins <- read.table("all_0_3125ng_AaPB.RG.n20.noBC.bam_40000_fragScaff.f.nucmer.coords.joins",col.names=c("to","from","scaff","count","program"),stringsAsFactors = F)
dim(joins)
joins <- subset(joins,to %in% daisyContigs$contig & from %in% daisyContigs$contig)
dim(joins)
joins$to <- factor(joins$to,levels=daisyContigs$contig,ordered=T)
joins$from <- factor(joins$from,levels=daisyContigs$contig,ordered=T)
#ggplot(joins,aes(y=to,x=from,fill=scaff)) + geom_tile(aes(size=size/10000)) + theme(legend.position="none",axis.text=element_blank() )
ggplot(joins,aes(y=to,x=from,fill=scaff)) + geom_tile() + theme(legend.position="none",axis.text=element_blank() )
daisyContigs<-fragContigs
joins <- read.table("all_0_3125ng_AaPB.RG.n20.noBC.bam_40000_fragScaff.f.nucmer.coords.joins",col.names=c("to","from","scaff","count","program"),stringsAsFactors = F)
dim(joins)
joins <- subset(joins,to %in% daisyContigs$contig & from %in% daisyContigs$contig)
dim(joins)
joins$to <- factor(joins$to,levels=daisyContigs$contig,ordered=T)
joins$from <- factor(joins$from,levels=daisyContigs$contig,ordered=T)
#ggplot(joins,aes(y=to,x=from,fill=scaff)) + geom_tile(aes(size=size/10000)) + theme(legend.position="none",axis.text=element_blank() )
ggplot(joins,aes(y=to,x=from,fill=scaff)) + geom_tile() + theme(legend.position="none",axis.text=element_blank() )
library(hexbin)
library(reshape2)
library(knitr)
library(ggplot2)
```{r setup, include=F}
opts_chunk$set(fig.width=10, fig.height=10,dev=c('png','postscript'),warning=F)
#setwd("/Volumes//gsap_garage-protistvector/sredmond/Aedes_AGWG/reports/161019_assembly_comp_matrix/")
```
```{r}
#orderContigs <- read.table("daisy_order_scaffs.txt",col.names=c("contig","chr","pos","cov","size","hits"),stringsAsFactors = F)
daisyContigs <- read.table("AaegL_daisy_hiC.rename.nucmer.10.tiling",col.names=c("start","end","qstart","qend","mle","len","cov","chrsize","contigsize","chrpc","contpc","chrom","contig"),stringsAsFactors = F)
unique(daisyContigs$contig)
starts <- as.data.frame(aggregate(daisyContigs$start,by=list(daisyContigs$contig),FUN=min))
ends <- as.data.frame(aggregate(daisyContigs$end,by=list(daisyContigs$contig),FUN=max))
chroms <- as.data.frame(aggregate(daisyContigs$chrom,by=list(daisyContigs$contig),FUN=function(x){x[1]}))
aligns <- as.data.frame(aggregate(daisyContigs$chrom,by=list(daisyContigs$contig),FUN=function(x){length(unique(x))}))
daisyContigs[aligns$x>1,]
colnames(starts)<-c("contig","start")
colnames(ends)  <-c("contig","end")
colnames(chroms)<-c("contig","chrom")
daisyContigs <- merge(chroms,merge(starts,ends))
daisyContigs$chrom <- as.numeric(gsub("daisy_","",daisyContigs$chrom))
daisyContigs <- daisyContigs[order(daisyContigs$chrom,daisyContigs$start),]
```
```{r}
fragContigs <- read.table("Aaeg_dovetail_bionano_02Sep2016_ALIGN.RG.n10.noBC.bam_40000_fragScaff.nucmer.5.tiling",col.names=c("start","end","qstart","qend","mle","len","cov","chrsize","contigsize","chrpc","contpc","chrom","contig"),stringsAsFactors = F)
unique(fragContigs$contig)
starts <- as.data.frame(aggregate(fragContigs$start,by=list(fragContigs$contig),FUN=min))
ends <- as.data.frame(aggregate(fragContigs$end,by=list(fragContigs$contig),FUN=max))
chroms <- as.data.frame(aggregate(fragContigs$chrom,by=list(fragContigs$contig),FUN=function(x){x[1]}))
aligns <- as.data.frame(aggregate(fragContigs$chrom,by=list(fragContigs$contig),FUN=function(x){length(unique(x))}))
fragContigs[aligns$x>1,]
colnames(starts)<-c("contig","start")
colnames(ends)  <-c("contig","end")
colnames(chroms)<-c("contig","chrom")
fragContigs <- merge(chroms,merge(starts,ends))
#fragContigs$chrom <- as.numeric(gsub("daisy_","",fragContigs$chrom))
fragContigs <- fragContigs[order(fragContigs$chrom,fragContigs$start),]
```
```{r}
orderContigs<-fragContigs
```
```{r}
#orderContigs <- subset(orderContigs,hits==1)
joins <- read.table("all_0_3125ng_AaPB.RG.n20.noBC.bam_40000_fragScaff.f.nucmer.coords.joins",col.names=c("to","from","scaff","count","program"),stringsAsFactors = F)
dim(joins)
joins <- subset(joins,to %in% orderContigs$contig & from %in% orderContigs$contig)
dim(joins)
joins$to <- factor(joins$to,levels=orderContigs$contig,ordered=T)
joins$from <- factor(joins$from,levels=orderContigs$contig,ordered=T)
#ggplot(joins,aes(y=to,x=from,fill=scaff)) + geom_tile(aes(size=size/10000)) + theme(legend.position="none",axis.text=element_blank() )
ggplot(joins,aes(y=to,x=from,fill=scaff)) + geom_tile() + theme(legend.position="none",axis.text=element_blank() )
```
```{r}
joins <- read.table("fragscaff_AaegPB_0_156_n10_40k.nucmer.coords.joins",col.names=c("to","from","scaff","size","program"),stringsAsFactors = F)
dim(joins)
joins <- subset(joins,to %in% orderContigs$contig & from %in% orderContigs$contig)
joins$to <- factor(joins$to,levels=orderContigs$contig,ordered=T)
joins$from <- factor(joins$from,levels=orderContigs$contig,ordered=T)
dim(joins)
ggplot(joins,aes(y=to,x=from,fill=scaff)) + geom_tile() + theme(legend.position="none",axis.text=element_blank() )
```
```{r}
joins <- read.table("AaegL_daisy_hiC.rename.nucmer.coords.joins",col.names=c("to","from","scaff","size","program"),stringsAsFactors = F)
dim(joins)
joins <- subset(joins,to %in% orderContigs$contig & from %in% orderContigs$contig)
joins$to <- factor(joins$to,levels=orderContigs$contig,ordered=T)
joins$from <- factor(joins$from,levels=orderContigs$contig,ordered=T)
ggplot(joins,aes(y=to,x=from,fill=scaff)) + geom_tile() + theme(legend.position="none",axis.text=element_blank() )
```
```{r}
joins <- read.table("Aaeg_dovetail_pacbio_22Aug2016.nucmer.coords.joins",col.names=c("to","from","scaff","size","program"),stringsAsFactors = F)
dim(joins)
joins <- subset(joins,to %in% orderContigs$contig & from %in% orderContigs$contig)
joins$to <- factor(joins$to,levels=orderContigs$contig,ordered=T)
joins$from <- factor(joins$from,levels=orderContigs$contig,ordered=T)
#ggplot(joins,aes(y=to,x=from,fill=scaff)) + geom_tile() + geom_vline(aes(xintercept=x),data=chroms) +
#  theme(legend.position="none",axis.text=element_blank() )
ggplot(joins,aes(y=to,x=from,fill=scaff)) + geom_tile() +
theme(legend.position="none",axis.text=element_blank() )
```
```{r}
joins <- read.table("Aaeg_dovetail_bionano_02Sep2016_ALIGN.RG.n10.noBC.bam_40000_fragScaff.nucmer.coords.joins",col.names=c("to","from","scaff","size","program"),stringsAsFactors = F)
dim(joins)
joins <- subset(joins,to %in% orderContigs$contig & from %in% orderContigs$contig)
joins$to <- factor(joins$to,levels=orderContigs$contig,ordered=T)
joins$from <- factor(joins$from,levels=orderContigs$contig,ordered=T)
ggplot(joins,aes(y=to,x=from,fill=scaff)) + geom_tile() + theme(legend.position="none",axis.text=element_blank() )
```
```{r}
joins <- merge(joins,orderContigs,by.x="from",by.y="contig")
joins <- merge(joins,orderContigs,by.x="to",by.y="contig",suffixes = c(".from",".to"))
ggplot(subset(joins,chrom.from %in% c(1) & chrom.to == chrom.from),aes(ymin=start.from,ymax=end.from, xmin=start.to,xmax=end.to)) + geom_rect() + theme(legend.position="none") + facet_grid(. ~ chrom.to)
```
knit("assembliesMatrix.Rmd")
knit("assembliesMatrix.Rmd")
knit("assembliesMatrix.Rmd")
knit("assembliesMatrix.Rmd")
orderContigs<-daisyContigs
joins <- read.table("all_0_3125ng_AaPB.RG.n20.noBC.bam_40000_fragScaff.f.nucmer.coords.joins",col.names=c("to","from","scaff","count","program"),stringsAsFactors = F)
dim(joins)
joins <- subset(joins,to %in% orderContigs$contig & from %in% orderContigs$contig)
dim(joins)
joins$to <- factor(joins$to,levels=orderContigs$contig,ordered=T)
joins$from <- factor(joins$from,levels=orderContigs$contig,ordered=T)
#ggplot(joins,aes(y=to,x=from,fill=scaff)) + geom_tile(aes(size=size/10000)) + theme(legend.position="none",axis.text=element_blank() )
ggplot(joins,aes(y=to,x=from,fill=scaff)) + geom_tile() + theme(legend.position="none",axis.text=element_blank() )
ggplot(joins,aes(y=to,x=from,fill=scaff)) + geom_tile(aes(size=size/10000)) + theme(legend.position="none",axis.text=element_blank() )
setwd("~/Scratch/gits/pfdisco/reports/161207_measurably_evolving_pop2/")
knit("MEP.Rmd")
library(ape)
library(adegenet)
library(phangorn)
library(knitr)
library(igraph)
library(RColorBrewer)
library(ggplot2)
library(reshape2)
opts_chunk$set(fig.width=9, fig.height=9)
opts_chunk$set(dev=c('png','postscript'))
knit("MEP.Rmd")
knit("MEP.Rmd")
library(outbreaker)
install.packages("outbreaker", dependencies=TRUE)
library(outbreaker)
library("Outbreaker")
library("OutbreakTools")
?read.dna
data(woodmouse)
woodmouse
is.phyDat(woodmouse)
setwd("~/Scratch/gits/pfdisco/reports/161207_measurably_evolving_pop2/")
ped <- read.table("Thies_all_manual.PASS.Cls.miss0.5.LMRG.HAP.incTriallelic.ped.gz",colClasses="character",na.strings = "0")
#ped <- read.table("Thies_all_manual.PASS.Cls.miss0.5.LMRG.HAP.incTriallelic.ped.gz",colClasses="character")
inds <- ped[,1]
ped <- ped[,seq(7,dim(ped)[[2]],2)]
genos <- apply(ped,2,function(x) {as.numeric(factor(x))})
genos
genos[is.na(genos)] <- 0
rownames(genos)=inds
genosDat <- as.phyDat(genos, type="USER", levels = c(0:max(genos,na.rm=T),drop_null = F))
genosDat
as.dnaBin(genosDat)
as.DNAbin(genosDat)
genos[1:10,1:10]
outbreaker(genosDat)
?outbreaker
?Outbreaker
??Outbreaker
outbreaker(dna=genosDat)
install.packages("outbreaker", dependencies=TRUE)
install.packages("outbreaker", dependencies=TRUE)
