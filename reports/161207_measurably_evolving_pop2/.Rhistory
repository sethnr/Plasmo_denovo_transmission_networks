cl1yrs <- as.numeric(gsub(".*\\.","",cl1))
cl1 <- c("Th086.07", "Th106.09", "Th106.11", "Th117.11", "Th132.11", "Th134.11", "Th162.12", "Th196.12", "Th230.12", "Th074.13")
cl1yrs <- as.numeric(gsub(".*\\.","",cl1))
og1<-"Th166.12"
og2<-"Th068.12"
cog1 <- c(cl1,og1)
cog2 <- c(cl1,og2)
indelDists[cog1,cog1]
njtree1 <- nj(as.dist(sym(indelDists[cog1,cog1])))
njtree1 <- root(njtree1,og1)
plot(njtree1)
diag(vcv.phylo(njtree1)[cl1,cl1])
rtdist1 <- diag(vcv.phylo(njtree2)[cl1,cl1])
rtdist2 <- diag(vcv.phylo(njtree2)[cl1,cl1])
rtdist1 <- diag(vcv.phylo(njtree1)[cl1,cl1])
rtdist2 <- diag(vcv.phylo(njtree2)[cl1,cl1])
rtdist2 <- data.frame("yrs"=cl1yrs,"rtdist"=rtdist2)
plot(rtdist2,x=yrs,y=rtdist) + geom_point()
rtdist2
rtdist2$yrs
plot(rtdist2,x=yrs,y=rtdist) + geom_point()
plot(rtdist2,aes(x=yrs,y=rtdist)) + geom_point()
plot(rtdist2,aes(x=yrs,y=rtdist)) + geom_point() + geom_smooth(method = "lm",se = F)
plot(rtdist2,aes(x=yrs,y=rtdist)) + geom_point() + geom_smooth(method = lm,se = F)
plot(rtdist2,aes(x=yrs,y=rtdist)) + geom_point() + geom_smooth(se = F)
is.numeric(rtdist2$yrs)
is.numeric(rtdist2$rtdist)
plot(rtdist2,aes(x=yrs,y=rtdist)) + geom_point() + geom_label() + geom_smooth(se = F)
plot(rtdist2,aes(x=yrs,y=rtdist)) + geom_point() + geom_smooth(se = F)
plot(rtdist2,aes(x=yrs,y=rtdist)) + geom_point() + geom_smooth()
plot(rtdist2,aes(x=yrs,y=rtdist)) + geom_point()
rtdist2
rtdist2 <- data.frame(sample=cl1,yrs=cl1yrs,rtdist=rtdist2)
rtdist2 <- diag(vcv.phylo(njtree2)[cl1,cl1])
rtdist2 <- data.frame(sample=cl1,yrs=cl1yrs,rtdist=rtdist2)
plot(rtdist2,aes(x=yrs,y=rtdist)) + geom_point()
rtdist2
ggplot(rtdist2,aes(x=yrs,y=rtdist)) + geom_point()
ggplot(rtdist2,aes(x=yrs,y=rtdist,label=sample)) + geom_point() + geom_smooth(method = lm,se=F)
ggplot(rtdist2,aes(x=yrs,y=rtdist,label=sample)) + geom_point() + geom_smooth(method = lm,se=F,linetype=2)
ggplot(rtdist1,aes(x=yrs,y=rtdist,label=sample)) + geom_point() + geom_smooth(method = lm,se=F,linetype=2)
TDtab2 <- data.frame(sample=cl1,yrs=cl1yrs,rtdist=rtdist1)
TDtab2 <- data.frame(sample=cl1,yrs=cl1yrs,rtdist=rtdist2)
ggplot(TDtab1,aes(x=yrs,y=rtdist,label=sample)) + geom_point() + geom_smooth(method = lm,se=F,linetype=2)
TDtab1 <- data.frame(sample=cl1,yrs=cl1yrs,rtdist=rtdist1)
TDtab2 <- data.frame(sample=cl1,yrs=cl1yrs,rtdist=rtdist2)
ggplot(TDtab1,aes(x=yrs,y=rtdist,label=sample)) + geom_point() + geom_smooth(method = lm,se=F,linetype=2)
ggplot(TDtab2,aes(x=yrs,y=rtdist,label=sample)) + geom_point() + geom_smooth(method = lm,se=F,linetype=2)
rtdist1 <- diag(vcv.phylo(njtree1)[cl1,cl1])
TDtab1 <- data.frame("sample"=cl1,"yrs"=cl1yrs,"rtdist"=rtdist1)
indelDists[cog2,cog2]
njtree2 <- nj(as.dist(sym(indelDists[cog2,cog2])))
njtree2 <- root(njtree2,og2)
plot(njtree2)
rtdist2 <- diag(vcv.phylo(njtree2)[cl1,cl1])
TDtab2 <- data.frame("sample"=cl1,"yrs"=cl1yrs,"rtdist"=rtdist2)
ggplot(TDtab1,aes(x=yrs,y=rtdist,label=sample)) + geom_point() + geom_smooth(method = lm,se=F,linetype=2)
ggplot(TDtab2,aes(x=yrs,y=rtdist,label=sample)) + geom_point() + geom_smooth(method = lm,se=F,linetype=2)
ggplot(TDtab1,aes(x=yrs,y=rtdist,label=sample)) + geom_point() + geom_text() + geom_smooth(method = lm,se=F,linetype=2) + geom_label(paste(round(cor(TDtab1$yrs,TDtab1rtdist)))
ggplot(TDtab2,aes(x=yrs,y=rtdist,label=sample)) + geom_point() + geom_text() + geom_smooth(method = lm,se=F,linetype=2)
ggplot(TDtab2,aes(x=yrs,y=rtdist,label=sample)) + geom_point() + geom_text() + geom_smooth(method = lm,se=F,linetype=2)
ggplot(TDtab1,aes(x=yrs,y=rtdist,label=sample)) + geom_text() + geom_smooth(method = lm,se=F,linetype=2) + geom_label(paste(round(cor(TDtab1$yrs,TDtab1rtdist)))
)
ggplot(TDtab1,aes(x=yrs,y=rtdist,label=sample)) + geom_text() + geom_smooth(method = lm,se=F,linetype=2) + geom_label(paste(round(cor(TDtab1$yrs,TDtab1$rtdist))))
ggplot(TDtab1,aes(x=yrs,y=rtdist,label=sample)) + geom_text() + geom_smooth(method = lm,se=F,linetype=2) + geom_label(x=8,y=100,label=paste(round(cor(TDtab1$yrs,TDtab1$rtdist))))
ggplot(TDtab1,aes(x=yrs,y=rtdist,label=sample)) + geom_text() + geom_smooth(method = lm,se=F,linetype=2) + geom_label(x=8,y=100,label=paste(round(cor(TDtab1$yrs,TDtab1$rtdist),2)))
ggplot(TDtab1,aes(x=yrs,y=rtdist,label=sample)) + geom_text() + geom_smooth(method = lm,se=F,linetype=2) + geom_label(x=8,y=100,label=paste("R=",round(cor(TDtab1$yrs,TDtab1$rtdist),2)))
ggplot(TDtab1,aes(x=yrs,y=rtdist,label=sample)) + geom_text() + geom_smooth(method = lm,se=F,linetype=2) + geom_label(x=8,y=100,label=paste("R=",round(cor(TDtab1$yrs,TDtab1$rtdist),2)),size=4)
ggplot(TDtab1,aes(x=yrs,y=rtdist,label=sample)) + geom_text() + geom_smooth(method = lm,se=F,linetype=2) + geom_label(x=8,y=100,label=paste("R=",round(cor(TDtab1$yrs,TDtab1$rtdist),2)),size=12)
ggplot(TDtab1,aes(x=yrs,y=rtdist,label=sample)) + geom_text() + geom_smooth(method = lm,se=F,linetype=2) + geom_label(x=8,y=100,label=paste("R=",round(cor(TDtab1$yrs,TDtab1$rtdist),2)),size=8)
ggplot(TDtab1,aes(x=yrs,y=rtdist,label=sample)) + geom_text(size=2) + geom_smooth(method = lm,se=F,linetype=2) + geom_label(x=8,y=100,label=paste("R=",round(cor(TDtab1$yrs,TDtab1$rtdist),2)),size=8)
ggplot(TDtab1,aes(x=yrs,y=rtdist,label=sample)) + geom_text(size=8) + geom_smooth(method = lm,se=F,linetype=2) + geom_label(x=8,y=100,label=paste("R=",round(cor(TDtab1$yrs,TDtab1$rtdist),2)),size=8)
ggplot(TDtab1,aes(x=yrs,y=rtdist,label=sample)) + geom_text(size=6) + geom_smooth(method = lm,se=F,linetype=2) + geom_label(x=8,y=100,label=paste("R=",round(cor(TDtab1$yrs,TDtab1$rtdist),2)),size=8)
ggplot(TDtab2,aes(x=yrs,y=rtdist,label=sample)) + geom_text() + geom_smooth(method = lm,se=F,linetype=2)+
geom_label(x=8,y=100,label=paste("R=",round(cor(TDtab2$yrs,TDtab2$rtdist),2)),size=8)
cor.test(TDtab2$yrs,TDtab2$rtdist),2))
cor.test(TDtab2$yrs,TDtab2$rtdist)
ct2 <- cor.test(TDtab2$yrs,TDtab2$rtdist)
ct1 <- cor.test(TDtab1$yrs,TDtab1$rtdist)
ct2 <- cor.test(TDtab2$yrs,TDtab2$rtdist)
ct1$p.value
ct1$parameter
ct1$statistic
ct1$estimate
ggplot(TDtab2,aes(x=yrs,y=rtdist,label=sample)) + geom_text() + geom_smooth(method = lm,se=F,linetype=2)+
geom_label(x=8,y=100,label=paste("R=",round(ct2$estimate,2),"p=",round(ct2$p.value,3)),size=8)
ggplot(TDtab1,aes(x=yrs,y=rtdist,label=sample)) + geom_text(size=6) + geom_smooth(method = lm,se=F,linetype=2) +
geom_label(x=8,y=100,label=paste("R=",round(ct1$estimate,2)," p=",round(ct1$p.value,3),sep=""),size=8)
ggplot(TDtab2,aes(x=yrs,y=rtdist,label=sample)) + geom_text() + geom_smooth(method = lm,se=F,linetype=2)+
geom_label(x=8,y=100,label=paste("R=",round(ct2$estimate,2)," p=",round(ct2$p.value,3),sep=""),size=8)
ggplot(TDtab1,aes(x=yrs,y=rtdist,label=sample)) + geom_text(size=6) + geom_smooth(method = lm,se=F,linetype=2) +
geom_label(x=8,y=100,label=paste("R=",round(ct1$estimate,2)," p=",round(ct1$p.value,3),sep=""),size=8)
ggplot(TDtab2,aes(x=yrs,y=rtdist,label=sample)) + geom_text(size=6) + geom_smooth(method = lm,se=F,linetype=2)+
geom_label(x=8,y=100,label=paste("R=",round(ct2$estimate,2)," p=",round(ct2$p.value,3),sep=""),size=8)
ggplot(TDtab1,aes(x=yrs,y=rtdist,label=sample)) + geom_text(size=6) + geom_smooth(method = lm,se=F,linetype=2) +
geom_label(x=8,y=100,label=paste("R=",round(ct1$estimate,3)," p=",round(ct1$p.value,3),sep=""),size=8)
ggplot(TDtab2,aes(x=yrs,y=rtdist,label=sample)) + geom_text(size=6) + geom_smooth(method = lm,se=F,linetype=2)+
geom_label(x=8,y=100,label=paste("R=",round(ct2$estimate,3)," p=",round(ct2$p.value,3),sep=""),size=8)
knit("MEP.Rmd")
indelDists+snpDists[cog2,cog2]
njtree2 <- nj(as.dist(sym(indelDists[cog2,cog2])))
indelDists[cog2,cog2]+snpDists[cog2,cog2]
combDists <- indelDists+snpDists
s
combDists <- indelDists+snpDists
njtree1 <- nj(as.dist(sym(combDists[cog1,cog1])))
njtree1 <- root(njtree1,og1)
plot(njtree1)
rtdist1 <- diag(vcv.phylo(njtree1)[cl1,cl1])
TDtab1 <- data.frame("sample"=cl1,"yrs"=cl1yrs,"rtdist"=rtdist1)
ct1 <- cor.test(TDtab1$yrs,TDtab1$rtdist)
ct1
indelDists[cog1,cog1]
njtree1 <- nj(as.dist(sym(combDists[cog1,cog1])))
njtree1 <- root(njtree1,og1)
plot(njtree1)
rtdist1 <- diag(vcv.phylo(njtree1)[cl1,cl1])
TDtab1 <- data.frame("sample"=cl1,"yrs"=cl1yrs,"rtdist"=rtdist1)
ct1 <- cor.test(TDtab1$yrs,TDtab1$rtdist)
ct1
indelDists[cog2,cog2]+snpDists[cog2,cog2]
njtree2 <- nj(as.dist(sym(indelDists[cog2,cog2])))
njtree2 <- root(njtree2,og2)
plot(njtree2)
rtdist2 <- diag(vcv.phylo(njtree2)[cl1,cl1])
TDtab2 <- data.frame("sample"=cl1,"yrs"=cl1yrs,"rtdist"=rtdist2)
ct2 <- cor.test(TDtab2$yrs,TDtab2$rtdist)
ct2
ggplot(TDtab1,aes(x=yrs,y=rtdist,label=sample)) + geom_text(size=6) + geom_smooth(method = lm,se=F,linetype=2) +
geom_label(x=8,y=100,label=paste("R=",round(ct1$estimate,3)," p=",round(ct1$p.value,3),sep=""),size=8)
ggplot(TDtab2,aes(x=yrs,y=rtdist,label=sample)) + geom_text(size=6) + geom_smooth(method = lm,se=F,linetype=2)+
geom_label(x=8,y=100,label=paste("R=",round(ct2$estimate,3)," p=",round(ct2$p.value,3),sep=""),size=8)
ggplot(TDtab1,aes(x=yrs,y=rtdist,label=sample)) + geom_text(size=6) + geom_smooth(method = lm,se=F,linetype=2) +
geom_label(x=8,y=350,label=paste("R=",round(ct1$estimate,3)," p=",round(ct1$p.value,3),sep=""),size=8)
njtree2 <- nj(as.dist(sym(combDists[cog2,cog2])))
njtree2 <- root(njtree2,og2)
plot(njtree2)
rtdist2 <- diag(vcv.phylo(njtree2)[cl1,cl1])
TDtab2 <- data.frame("sample"=cl1,"yrs"=cl1yrs,"rtdist"=rtdist2)
ct2 <- cor.test(TDtab2$yrs,TDtab2$rtdist)
ct2
ggplot(TDtab1,aes(x=yrs,y=rtdist,label=sample)) + geom_text(size=6) + geom_smooth(method = lm,se=F,linetype=2) +
geom_label(x=8,y=350,label=paste("R=",round(ct1$estimate,3)," p=",round(ct1$p.value,3),sep=""),size=8)
ggplot(TDtab2,aes(x=yrs,y=rtdist,label=sample)) + geom_text(size=6) + geom_smooth(method = lm,se=F,linetype=2)+
geom_label(x=8,y=100,label=paste("R=",round(ct2$estimate,3)," p=",round(ct2$p.value,3),sep=""),size=8)
ggplot(TDtab2,aes(x=yrs,y=rtdist,label=sample)) + geom_text(size=6) + geom_smooth(method = lm,se=F,linetype=2)+
geom_label(x=8,y=350,label=paste("R=",round(ct2$estimate,3)," p=",round(ct2$p.value,3),sep=""),size=8)
ggplot(TDtab1,aes(x=yrs,y=rtdist,label=sample)) + geom_text(size=6) + geom_smooth(method = lm,se=F,linetype=2) +
geom_label(x=8,y=350,label=paste("R=",round(ct1$estimate,3)," p=",round(ct1$p.value,3),sep=""),size=8)
ggplot(TDtab2,aes(x=yrs,y=rtdist,label=sample)) + geom_text(size=6) + geom_smooth(method = lm,se=F,linetype=2)+
geom_label(x=8,y=350,label=paste("R=",round(ct2$estimate,3)," p=",round(ct2$p.value,3),sep=""),size=8)
combDists
cl2 <- c("Th166.12", "Th092.13", "Th211.13", "Th245.13", "Th246.13")
oc2 <- c("Th068.12", "Th061.13", "Th095.13")
cl1 <- c("Th086.07", "Th106.09", "Th106.11", "Th117.11", "Th132.11", "Th134.11", "Th162.12", "Th196.12", "Th230.12", "Th074.13")
cl1yrs <- as.numeric(gsub(".*\\.","",cl1))
og1<-"Th166.12"
oc1 <- c("Th166.12", "Th092.13", "Th211.13", "Th245.13", "Th246.13")
og2<-"Th068.12"
oc2 <- c("Th068.12", "Th061.13", "Th095.13")
cog1 <- c(cl1,og1)
cog2 <- c(cl1,og2)
cog1 <- c(cl1,oc1)
cog2 <- c(cl1,oc2)
indelDists[cog1,cog1]
njtree1 <- nj(as.dist(sym(combDists[cog1,cog1])))
njtree1 <- root(njtree1,og1)
plot(njtree1)
rtdist1 <- diag(vcv.phylo(njtree1)[cl1,cl1])
TDtab1 <- data.frame("sample"=cl1,"yrs"=cl1yrs,"rtdist"=rtdist1)
ct1 <- cor.test(TDtab1$yrs,TDtab1$rtdist)
ct1
indelDists[cog2,cog2]+snpDists[cog2,cog2]
njtree2 <- nj(as.dist(sym(combDists[cog2,cog2])))
njtree2 <- root(njtree2,og2)
plot(njtree2)
rtdist2 <- diag(vcv.phylo(njtree2)[cl1,cl1])
TDtab2 <- data.frame("sample"=cl1,"yrs"=cl1yrs,"rtdist"=rtdist2)
ct2 <- cor.test(TDtab2$yrs,TDtab2$rtdist)
ct2
ggplot(TDtab1,aes(x=yrs,y=rtdist,label=sample)) + geom_text(size=6) + geom_smooth(method = lm,se=F,linetype=2) +
geom_label(x=8,y=350,label=paste("R=",round(ct1$estimate,3)," p=",round(ct1$p.value,3),sep=""),size=8)
ggplot(TDtab2,aes(x=yrs,y=rtdist,label=sample)) + geom_text(size=6) + geom_smooth(method = lm,se=F,linetype=2)+
geom_label(x=8,y=350,label=paste("R=",round(ct2$estimate,3)," p=",round(ct2$p.value,3),sep=""),size=8)
njtree1 <- nj(as.dist(sym(snpDists[cog1,cog1])))
njtree1 <- root(njtree1,og1)
plot(njtree1)
rtdist1 <- diag(vcv.phylo(njtree1)[cl1,cl1])
TDtab1 <- data.frame("sample"=cl1,"yrs"=cl1yrs,"rtdist"=rtdist1)
ct1 <- cor.test(TDtab1$yrs,TDtab1$rtdist)
ct1
njtree2 <- nj(as.dist(sym(snpDists[cog2,cog2])))
njtree2 <- root(njtree2,og2)
plot(njtree2)
rtdist2 <- diag(vcv.phylo(njtree2)[cl1,cl1])
TDtab2 <- data.frame("sample"=cl1,"yrs"=cl1yrs,"rtdist"=rtdist2)
ct2 <- cor.test(TDtab2$yrs,TDtab2$rtdist)
ct2
ggplot(TDtab1,aes(x=yrs,y=rtdist,label=sample)) + geom_text(size=6) + geom_smooth(method = lm,se=F,linetype=2) +
geom_label(x=8,y=350,label=paste("R=",round(ct1$estimate,3)," p=",round(ct1$p.value,3),sep=""),size=8)
ggplot(TDtab1,aes(x=yrs,y=rtdist,label=sample)) + geom_text(size=6) + geom_smooth(method = lm,se=F,linetype=2) +
geom_label(x=8,y=8050,label=paste("R=",round(ct1$estimate,3)," p=",round(ct1$p.value,3),sep=""),size=8)
ggplot(TDtab2,aes(x=yrs,y=rtdist,label=sample)) + geom_text(size=6) + geom_smooth(method = lm,se=F,linetype=2)+
geom_label(x=8,y=8050,label=paste("R=",round(ct2$estimate,3)," p=",round(ct2$p.value,3),sep=""),size=8)
ggplot(TDtab2,aes(x=yrs,y=rtdist,label=sample)) + geom_text(size=6) + geom_smooth(method = lm,se=F,linetype=2)+
geom_label(x=8,y=mean(TDtab2$rtdist),label=paste("R=",round(ct2$estimate,3)," p=",round(ct2$p.value,3),sep=""),size=8)
ggplot(TDtab1,aes(x=yrs,y=rtdist,label=sample)) + geom_text(size=6) + geom_smooth(method = lm,se=F,linetype=2) +
geom_label(x=8,y=mean(TDtab2$rtdist),label=paste("R=",round(ct1$estimate,3)," p=",round(ct1$p.value,3),sep=""),size=8)
ggplot(TDtab1,aes(x=yrs,y=rtdist,label=sample)) + geom_text(size=6) + geom_smooth(method = lm,se=F,linetype=2) +
geom_label(x=8,y=mean(TDtab1$rtdist),label=paste("R=",round(ct1$estimate,3)," p=",round(ct1$p.value,3),sep=""),size=8)
ggplot(TDtab2,aes(x=yrs,y=rtdist,label=sample)) + geom_text(size=6) + geom_smooth(method = lm,se=F,linetype=2)+
geom_label(x=8,y=mean(TDtab2$rtdist),label=paste("R=",round(ct2$estimate,3)," p=",round(ct2$p.value,3),sep=""),size=8)
njtree2
njtree1 <- nj(as.dist(sym(combDists[cog1,cog1])))
njtree1 <- root(njtree1,og1)
plot(njtree1)
rtdist1 <- diag(vcv.phylo(njtree1)[cl1,cl1])
TDtab1 <- data.frame("sample"=cl1,"yrs"=cl1yrs,"rtdist"=rtdist1)
cog1 <- c(cl1,og1)
cog2 <- c(cl1,og2)
njtree1 <- nj(as.dist(sym(combDists[cog1,cog1])))
njtree1 <- root(njtree1,og1)
plot(njtree1)
rtdist1 <- diag(vcv.phylo(njtree1)[cl1,cl1])
TDtab1 <- data.frame("sample"=cl1,"yrs"=cl1yrs,"rtdist"=rtdist1)
ct1 <- cor.test(TDtab1$yrs,TDtab1$rtdist)
ct1
njtree2 <- nj(as.dist(sym(combDists[cog2,cog2])))
njtree2 <- root(njtree2,og2)
plot(njtree2)
rtdist2 <- diag(vcv.phylo(njtree2)[cl1,cl1])
TDtab2 <- data.frame("sample"=cl1,"yrs"=cl1yrs,"rtdist"=rtdist2)
ct2 <- cor.test(TDtab2$yrs,TDtab2$rtdist)
ct2
ggplot(TDtab1,aes(x=yrs,y=rtdist,label=sample)) + geom_text(size=6) + geom_smooth(method = lm,se=F,linetype=2) +
geom_label(x=8,y=350,label=paste("R=",round(ct1$estimate,3)," p=",round(ct1$p.value,3),sep=""),size=8)
ggplot(TDtab2,aes(x=yrs,y=rtdist,label=sample)) + geom_text(size=6) + geom_smooth(method = lm,se=F,linetype=2)+
geom_label(x=8,y=350,label=paste("R=",round(ct2$estimate,3)," p=",round(ct2$p.value,3),sep=""),size=8)
vcv.phylo(njtree2)[cl1,cl1]
vcv.phylo(njtree2)
plot(drop.tip(njtree2,og2))
njtree2 <- nj(as.dist(sym(combDists[cog2,cog2])))
njtree2 <- root(njtree2,og2)
plot(njtree2)
njtree2 <- plot(drop.tip(njtree2,og2))
plot(njtree2)
njtree2 <- nj(as.dist(sym(combDists[cog2,cog2])))
njtree2 <- root(njtree2,og2)
plot(njtree2)
njtree2 <- drop.tip(njtree2,og2)
plot(njtree2)
rtdist2 <- diag(vcv.phylo(njtree2)[cl1,cl1])
TDtab2 <- data.frame("sample"=cl1,"yrs"=cl1yrs,"rtdist"=rtdist2)
ct2 <- cor.test(TDtab2$yrs,TDtab2$rtdist)
ct2
njtree1 <- nj(as.dist(sym(combDists[cog1,cog1])))
njtree1 <- root(njtree1,og1)
plot(njtree1)
njtree1 <- drop.tip(njtree1,og1)
plot(njtree1)
rtdist1 <- diag(vcv.phylo(njtree1)[cl1,cl1])
TDtab1 <- data.frame("sample"=cl1,"yrs"=cl1yrs,"rtdist"=rtdist1)
ct1 <- cor.test(TDtab1$yrs,TDtab1$rtdist)
ct1
njtree2 <- nj(as.dist(sym(combDists[cog2,cog2])))
njtree2 <- root(njtree2,og2)
plot(njtree2)
njtree2 <- drop.tip(njtree2,og2)
plot(njtree2)
rtdist2 <- diag(vcv.phylo(njtree2)[cl1,cl1])
TDtab2 <- data.frame("sample"=cl1,"yrs"=cl1yrs,"rtdist"=rtdist2)
ct2 <- cor.test(TDtab2$yrs,TDtab2$rtdist)
ct2
ggplot(TDtab1,aes(x=yrs,y=rtdist,label=sample)) + geom_text(size=6) + geom_smooth(method = lm,se=F,linetype=2) +
geom_label(x=8,y=350,label=paste("R=",round(ct1$estimate,3)," p=",round(ct1$p.value,3),sep=""),size=8)
ggplot(TDtab2,aes(x=yrs,y=rtdist,label=sample)) + geom_text(size=6) + geom_smooth(method = lm,se=F,linetype=2)+
geom_label(x=8,y=350,label=paste("R=",round(ct2$estimate,3)," p=",round(ct2$p.value,3),sep=""),size=8)
njtree2 <- nj(as.dist(sym(combDists[cog2,cog2])))
njtree2 <- root(njtree2,og2)
njtree2 <- drop.tip(njtree2,og2)
plot(njtree2)
rtdist2 <- diag(vcv.phylo(njtree2)[cl1,cl1])
TDtab2 <- data.frame("sample"=cl1,"yrs"=cl1yrs,"rtdist"=rtdist2)
ct2 <- cor.test(TDtab2$yrs,TDtab2$rtdist)
ct2
ggplot(TDtab1,aes(x=yrs,y=rtdist,label=sample)) + geom_text(size=6) + geom_smooth(method = lm,se=F,linetype=2) +
geom_label(x=8,y=350,label=paste("R=",round(ct1$estimate,3)," p=",round(ct1$p.value,3),sep=""),size=8)
ggplot(TDtab2,aes(x=yrs,y=rtdist,label=sample)) + geom_text(size=6) + geom_smooth(method = lm,se=F,linetype=2)+
geom_label(x=8,y=350,label=paste("R=",round(ct2$estimate,3)," p=",round(ct2$p.value,3),sep=""),size=8)
njtree1 <- nj(as.dist(sym(indelDists[cog1,cog1])))
njtree1 <- root(njtree1,og1)
plot(njtree1)
njtree1 <- drop.tip(njtree1,og1)
plot(njtree1)
rtdist1 <- diag(vcv.phylo(njtree1)[cl1,cl1])
TDtab1 <- data.frame("sample"=cl1,"yrs"=cl1yrs,"rtdist"=rtdist1)
ct1 <- cor.test(TDtab1$yrs,TDtab1$rtdist)
ct1
njtree2 <- nj(as.dist(sym(combDists[cog2,cog2])))
njtree2 <- root(njtree2,og2)
njtree2 <- drop.tip(njtree2,og2)
plot(njtree2)
rtdist2 <- diag(vcv.phylo(njtree2)[cl1,cl1])
TDtab2 <- data.frame("sample"=cl1,"yrs"=cl1yrs,"rtdist"=rtdist2)
ct2 <- cor.test(TDtab2$yrs,TDtab2$rtdist)
ct2
ggplot(TDtab1,aes(x=yrs,y=rtdist,label=sample)) + geom_text(size=6) + geom_smooth(method = lm,se=F,linetype=2) +
geom_label(x=8,y=350,label=paste("R=",round(ct1$estimate,3)," p=",round(ct1$p.value,3),sep=""),size=8)
ggplot(TDtab2,aes(x=yrs,y=rtdist,label=sample)) + geom_text(size=6) + geom_smooth(method = lm,se=F,linetype=2)+
geom_label(x=8,y=350,label=paste("R=",round(ct2$estimate,3)," p=",round(ct2$p.value,3),sep=""),size=8)
ggplot(TDtab1,aes(x=yrs,y=rtdist,label=sample)) + geom_text(size=6) + geom_smooth(method = lm,se=F,linetype=2) +
geom_label(x=8,y=mean(TDtab1$rtdist),label=paste("R=",round(ct1$estimate,3)," p=",round(ct1$p.value,3),sep=""),size=8)
ggplot(TDtab2,aes(x=yrs,y=rtdist,label=sample)) + geom_text(size=6) + geom_smooth(method = lm,se=F,linetype=2)+
geom_label(x=8,y=mean(TDtab1$rtdist),label=paste("R=",round(ct2$estimate,3)," p=",round(ct2$p.value,3),sep=""),size=8)
ggplot(TDtab2,aes(x=yrs,y=rtdist,label=sample)) + geom_text(size=6) + geom_smooth(method = lm,se=F,linetype=2)+
geom_label(x=8,y=mean(TDtab2$rtdist),label=paste("R=",round(ct2$estimate,3)," p=",round(ct2$p.value,3),sep=""),size=8)
ggplot(TDtab1,aes(x=yrs,y=rtdist,label=sample)) + geom_text(size=6) + geom_smooth(method = lm,se=F,linetype=2) +
geom_label(x=8,y=mean(TDtab1$rtdist),label=paste("R=",round(ct1$estimate,3)," p=",round(ct1$p.value,3),sep=""),size=8)
ggplot(TDtab2,aes(x=yrs,y=rtdist,label=sample)) + geom_text(size=6) + geom_smooth(method = lm,se=F,linetype=2)+
geom_label(x=8,y=mean(TDtab2$rtdist),label=paste("R=",round(ct2$estimate,3)," p=",round(ct2$p.value,3),sep=""),size=8)
njtree1 <- nj(as.dist(sym(snpDists[cog1,cog1])))
njtree1 <- root(njtree1,og1)
plot(njtree1)
njtree1 <- drop.tip(njtree1,og1)
plot(njtree1)
rtdist1 <- diag(vcv.phylo(njtree1)[cl1,cl1])
TDtab1 <- data.frame("sample"=cl1,"yrs"=cl1yrs,"rtdist"=rtdist1)
ct1 <- cor.test(TDtab1$yrs,TDtab1$rtdist)
ct1
njtree2 <- nj(as.dist(sym(combDists[cog2,cog2])))
njtree2 <- root(njtree2,og2)
njtree2 <- drop.tip(njtree2,og2)
plot(njtree2)
rtdist2 <- diag(vcv.phylo(njtree2)[cl1,cl1])
TDtab2 <- data.frame("sample"=cl1,"yrs"=cl1yrs,"rtdist"=rtdist2)
ct2 <- cor.test(TDtab2$yrs,TDtab2$rtdist)
ct2
ggplot(TDtab1,aes(x=yrs,y=rtdist,label=sample)) + geom_text(size=6) + geom_smooth(method = lm,se=F,linetype=2) +
geom_label(x=8,y=mean(TDtab1$rtdist),label=paste("R=",round(ct1$estimate,3)," p=",round(ct1$p.value,3),sep=""),size=8)
ggplot(TDtab2,aes(x=yrs,y=rtdist,label=sample)) + geom_text(size=6) + geom_smooth(method = lm,se=F,linetype=2)+
geom_label(x=8,y=mean(TDtab2$rtdist),label=paste("R=",round(ct2$estimate,3)," p=",round(ct2$p.value,3),sep=""),size=8)
njtree1 <- nj(as.dist(sym(indelDists[cog1,cog1])))
njtree1 <- root(njtree1,og1)
plot(njtree1)
njtree1 <- drop.tip(njtree1,og1)
plot(njtree1)
rtdist1 <- diag(vcv.phylo(njtree1)[cl1,cl1])
TDtab1 <- data.frame("sample"=cl1,"yrs"=cl1yrs,"rtdist"=rtdist1)
ct1 <- cor.test(TDtab1$yrs,TDtab1$rtdist)
ct1
njtree2 <- nj(as.dist(sym(combDists[cog2,cog2])))
njtree2 <- root(njtree2,og2)
njtree2 <- drop.tip(njtree2,og2)
plot(njtree2)
rtdist2 <- diag(vcv.phylo(njtree2)[cl1,cl1])
TDtab2 <- data.frame("sample"=cl1,"yrs"=cl1yrs,"rtdist"=rtdist2)
ct2 <- cor.test(TDtab2$yrs,TDtab2$rtdist)
ct2
ggplot(TDtab1,aes(x=yrs,y=rtdist,label=sample)) + geom_text(size=6) + geom_smooth(method = lm,se=F,linetype=2) +
geom_label(x=8,y=mean(TDtab1$rtdist),label=paste("R=",round(ct1$estimate,3)," p=",round(ct1$p.value,3),sep=""),size=8)
ggplot(TDtab2,aes(x=yrs,y=rtdist,label=sample)) + geom_text(size=6) + geom_smooth(method = lm,se=F,linetype=2)+
geom_label(x=8,y=mean(TDtab2$rtdist),label=paste("R=",round(ct2$estimate,3)," p=",round(ct2$p.value,3),sep=""),size=8)
njtree2 <- nj(as.dist(sym(indelDists[cog2,cog2])))
njtree2 <- root(njtree2,og2)
njtree2 <- drop.tip(njtree2,og2)
plot(njtree2)
rtdist2 <- diag(vcv.phylo(njtree2)[cl1,cl1])
TDtab2 <- data.frame("sample"=cl1,"yrs"=cl1yrs,"rtdist"=rtdist2)
ct2 <- cor.test(TDtab2$yrs,TDtab2$rtdist)
ct2
ggplot(TDtab1,aes(x=yrs,y=rtdist,label=sample)) + geom_text(size=6) + geom_smooth(method = lm,se=F,linetype=2) +
geom_label(x=8,y=mean(TDtab1$rtdist),label=paste("R=",round(ct1$estimate,3)," p=",round(ct1$p.value,3),sep=""),size=8)
ggplot(TDtab2,aes(x=yrs,y=rtdist,label=sample)) + geom_text(size=6) + geom_smooth(method = lm,se=F,linetype=2)+
geom_label(x=8,y=mean(TDtab2$rtdist),label=paste("R=",round(ct2$estimate,3)," p=",round(ct2$p.value,3),sep=""),size=8)
ct1
ggplot(TDtab1,aes(x=yrs,y=rtdist,label=sample)) + geom_text(size=6) + geom_smooth(method = lm,se=F,linetype=2) +
geom_label(x=8,y=mean(TDtab1$rtdist),label=paste("R=",round(ct1$estimate,4)," p=",round(ct1$p.value,3),sep=""),size=8)
ggplot(TDtab1,aes(x=yrs,y=rtdist,label=sample)) + geom_text(size=6) + geom_smooth(method = lm,se=F,linetype=2) +
geom_label(x=8,y=mean(TDtab1$rtdist),label=paste("R=",round(ct1$estimate,3)," p=",round(ct1$p.value,4),sep=""),size=8)
ggplot(TDtab2,aes(x=yrs,y=rtdist,label=sample)) + geom_text(size=6) + geom_smooth(method = lm,se=F,linetype=2)+
geom_label(x=8,y=mean(TDtab2$rtdist),label=paste("R=",round(ct2$estimate,4)," p=",round(ct2$p.value,4),sep=""),size=8)
ggplot(TDtab1,aes(x=yrs,y=rtdist,label=sample)) + geom_text(size=6) + geom_smooth(method = lm,se=F,linetype=2) +
geom_label(x=8,y=mean(TDtab1$rtdist),label=paste("R=",round(ct1$estimate,3)," p=",round(ct1$p.value,4),sep=""),size=8)
ggplot(TDtab2,aes(x=yrs,y=rtdist,label=sample)) + geom_text(size=6) + geom_smooth(method = lm,se=F,linetype=2)+
geom_label(x=8,y=mean(TDtab2$rtdist),label=paste("R=",round(ct2$estimate,3)," p=",round(ct2$p.value,4),sep=""),size=8)
ggplot(TDtab1,aes(x=yrs,y=rtdist,label=sample)) + geom_text(size=6) + geom_smooth(method = lm,se=F,linetype=2) +
geom_label(x=8,y=mean(TDtab1$rtdist),label=paste("R=",round(ct1$estimate,3)," p=",round(ct1$p.value,4),sep=""),size=8)
ggplot(TDtab2,aes(x=yrs,y=rtdist,label=sample)) + geom_text(size=6) + geom_smooth(method = lm,se=F,linetype=2)+
geom_label(x=8,y=mean(TDtab2$rtdist),label=paste("R=",round(ct2$estimate,3)," p=",round(ct2$p.value,4),sep=""),size=8)
knit("MEP.Rmd")
plot(njtree2)
njtree2 <- nj(as.dist(sym(combDists[cog2,cog2])))
njtree2 <- root(njtree2,og2)
plot(njtree2)
njtree2 <- drop.tip(njtree2,og2)
plot(njtree2)
njtree1 <- root(njtree1,cl1[1])
plot(njtree1)
rtdist1 <- diag(vcv.phylo(njtree1)[cl1,cl1])
TDtab1 <- data.frame("sample"=cl1,"yrs"=cl1yrs,"rtdist"=rtdist1)
ct1 <- cor.test(TDtab1$yrs,TDtab1$rtdist)
ct1
njtree2 <- root(njtree2,cl1[1])
plot(njtree2)
rtdist2 <- diag(vcv.phylo(njtree2)[cl1,cl1])
TDtab2 <- data.frame("sample"=cl1,"yrs"=cl1yrs,"rtdist"=rtdist2)
ct2 <- cor.test(TDtab2$yrs,TDtab2$rtdist)
ct2
njtree2 <- nj(as.dist(sym(combDists[cl1,cl1])))
njtree2 <- root(njtree2,cl1[1])
plot(njtree2)
rtdist2 <- diag(vcv.phylo(njtree2)[cl1,cl1])
TDtab2 <- data.frame("sample"=cl1,"yrs"=cl1yrs,"rtdist"=rtdist2)
plot(njtree2)
njtree2 <- nj(as.dist(sym(combDists[cl1,cl1])))
njtree2 <- root(njtree2,cl1[1])
plot(njtree2)
rtdist2 <- diag(vcv.phylo(njtree2)[cl1,cl1])
TDtab2 <- data.frame("sample"=cl1,"yrs"=cl1yrs,"rtdist"=rtdist2)
ct2 <- cor.test(TDtab2$yrs,TDtab2$rtdist)
ct2
combDists[cl1,cl1]
njtree2 <- nj(as.dist(sym(combDists[cl1,cl1])))
njtree2 <- root(njtree2,cl1[1])
cl1[1]
njtree1 <- nj(as.dist(sym(combDists[cl1,cl1])))
njtree1 <- root(njtree1,"Th086.07")
plot(njtree1)
rtdist1 <- diag(vcv.phylo(njtree1)[cl1,cl1])
TDtab1 <- data.frame("sample"=cl1,"yrs"=cl1yrs,"rtdist"=rtdist1)
ct1 <- cor.test(TDtab1$yrs,TDtab1$rtdist)
ct1
njtree2 <- nj(as.dist(sym(combDists[cl1,cl1])))
njtree2 <- root(njtree2,"Th086.07")
plot(njtree2)
rtdist2 <- diag(vcv.phylo(njtree2)[cl1,cl1])
TDtab2 <- data.frame("sample"=cl1,"yrs"=cl1yrs,"rtdist"=rtdist2)
ct2 <- cor.test(TDtab2$yrs,TDtab2$rtdist)
ct2
ggplot(TDtab1,aes(x=yrs,y=rtdist,label=sample)) + geom_text(size=6) + geom_smooth(method = lm,se=F,linetype=2) +
geom_label(x=8,y=mean(TDtab1$rtdist),label=paste("R=",round(ct1$estimate,3)," p=",round(ct1$p.value,4),sep=""),size=8)
ggplot(TDtab2,aes(x=yrs,y=rtdist,label=sample)) + geom_text(size=6) + geom_smooth(method = lm,se=F,linetype=2)+
geom_label(x=8,y=mean(TDtab2$rtdist),label=paste("R=",round(ct2$estimate,3)," p=",round(ct2$p.value,4),sep=""),size=8)
knit("MEP.Rmd")
njtree1 <- nj(as.dist(sym(combDists[cl1,cl1])))
njtree1 <- root(njtree1,"Th086.07")
plot(njtree1)
rtdist1 <- diag(vcv.phylo(njtree1)[cl1,cl1])
TDtab1 <- data.frame("sample"=cl1,"yrs"=cl1yrs,"rtdist"=rtdist1)
ct1 <- cor.test(TDtab1$yrs,TDtab1$rtdist)
ct1
ggplot(TDtab1,aes(x=yrs,y=rtdist,label=sample)) + geom_text(size=6) + geom_smooth(method = lm,se=F,linetype=2) +
geom_label(x=8,y=mean(TDtab1$rtdist),label=paste("R=",round(ct1$estimate,3)," p=",round(ct1$p.value,4),sep=""),size=8) +
ggmain("combined, clade1 only")
ggplot(TDtab1,aes(x=yrs,y=rtdist,label=sample)) + geom_text(size=6) + geom_smooth(method = lm,se=F,linetype=2) +
geom_label(x=8,y=mean(TDtab1$rtdist),label=paste("R=",round(ct1$estimate,3)," p=",round(ct1$p.value,4),sep=""),size=8) +
ggtitle("combined, clade1 only")
ggplot(TDtab1,aes(x=yrs,y=rtdist,label=sample)) + geom_text(size=6) + geom_smooth(method = lm,se=F,linetype=2) +
geom_label(x=8,y=mean(TDtab1$rtdist),label=paste("R=",round(ct1$estimate,3)," p=",round(ct1$p.value,4),sep=""),size=8) +
ggtitle("combined, outgroup "+og1)
ggtitle(paste("combined, outgroup",og1))
ggplot(TDtab1,aes(x=yrs,y=rtdist,label=sample)) + geom_text(size=6) + geom_smooth(method = lm,se=F,linetype=2) +
geom_label(x=8,y=mean(TDtab1$rtdist),label=paste("R=",round(ct1$estimate,3)," p=",round(ct1$p.value,4),sep=""),size=8) +
ggtitle(paste("combined, outgroup",og1))
knit("MEP.Rmd")
knit("MEP.Rmd")
njtree1 <- nj(as.dist(sym(combDists)))
njtree1
is.phylo(njtree1)
midpoint(njtree1)
library(phangorn)
midpoint(njtree1)
plot(midpoint(njtree1))
njtree1 <- nj(as.dist(sym(combDists)))
njtree1 <- midpoint(njtree1)
drop.tip(njtree1,cl2)
drop.tip(njtree1,c(cl2,cl3))
drop.tip(njtree1,c(oc1,oc2))
plot(drop.tip(njtree1,c(oc1,oc2)))
njtree1 <- nj(as.dist(sym(combDists)))
njtree1 <- midpoint(njtree1)
njtree1 <- drop.tip(njtree1,c(oc1,oc2))
plot(njtree1)
rtdist1 <- diag(vcv.phylo(njtree1)[cl1,cl1])
TDtab1 <- data.frame("sample"=cl1,"yrs"=cl1yrs,"rtdist"=rtdist1)
ct1 <- cor.test(TDtab1$yrs,TDtab1$rtdist)
ct1
ggplot(TDtab1,aes(x=yrs,y=rtdist,label=sample)) + geom_text(size=4) + geom_smooth(method = lm,se=F,linetype=2) +
geom_label(x=8,y=mean(TDtab1$rtdist),label=paste("R=",round(ct1$estimate,3)," p=",round(ct1$p.value,4),sep=""),size=5) +
ggtitle("combined, clade1 only")
ggplot(TDtab1,aes(x=yrs,y=rtdist,label=sample)) + geom_text(size=4) + geom_smooth(method = lm,se=F,linetype=2) +
geom_label(x=8,y=mean(TDtab1$rtdist),label=paste("R=",round(ct1$estimate,3)," p=",round(ct1$p.value,4),sep=""),size=5) +
ggtitle("combined, all samples, midpoint root")
knit("MEP.Rmd")
njtree1 <- nj(as.dist(sym(combDists[cl1,cl1])))
plot(njtree1)
njtree1 <- root(njtree1,"Th086.07")
plot(njtree1)
knit("MEP.Rmd")
knit("MEP.Rmd")
knit("MEP.Rmd")
library("phangorn")
midpoint(njtree2)
plot(midpoint(njtree2))
plot(midpoint(njtree1))
plot(njtree1)
?midpoint
getRoot(njtree)
getRoot(midpoint(njtree))
getRoot(midpoint(njtree2))
getRoot(midpoint(njtree1))
getRoot(njtree1)
