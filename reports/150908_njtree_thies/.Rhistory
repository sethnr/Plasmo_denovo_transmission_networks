for (code in codes) {
#  write(code,stderr())
#country region data:
cshape<-getData("GADM", country=code, level=1)
#get tile of climate data
climdata<-getData("worldclim", var="alt", res=0.5, lon=35, lat=-14)
cntdata <- list()
cdata[code] <- climdata
cshapes[code] <- cshape
}
cshapes$BEN
cdata$BEN
cshapes$DZA
library(rworldmap)
library(ggmap)
install.packaged("rworldmap")
install.packages("rworldmap")
library(rworldmap)
library(ggmap)
newmap <- getMap(resolution = "high")
africa <- plot(newmap, xlim = c(-16, 50), ylim = c(-35, 35), asp = 0)
CE.africa <- plot(newmap, xlim = c(-8, 25), ylim = c(-12, 12), asp = 0)
cshapes$DZA
sumary(cshapes$DZA)
summary(cshapes$DZA)
?SpatialPolygonsDataFrame
cshapes$DZA$coords
cshapes$DZA$sr1
cshapes$DZA$Sr1
?SpatialPolygons
cshapes$DZA$polygones
cshapes$DZA$polygons
coordinates(cshapes$DZA)
coordinates(cshape)
max(coordinates(cshape))
apply(coordinates(cshape),1,FUN=max)
apply(coordinates(cshape),2,FUN=max)
apply(coordinates(cshape),2,FUN=min)
maxlonlat <- apply(coordinates(cshape),2,FUN=max)
minlonlat <- apply(coordinates(cshape),2,FUN=min)
minlonlat + ((maxlonlat-minlonlat)/2)
colnames(coords) <- c("lon","lat")
coords <- coordinates(cshape)
colnames(coords) <- c("lon","lat")
max <- apply(coords,2,FUN=max)
min <- apply(coords,2,FUN=min)
mid <- minlonlat + ((maxlonlat-minlonlat)/2)
mid
mid$lon
mid[[1]]
mid[1]
plot(cshapes$DZA)
plot(cshapes$ZBE)
plot(cshapes$BFA)
plot(cdata$BFA)
plot(cdata$ZMB)
cdata$ZMB$alt_37
cdata$ZMB$alt_37
cshapes$ZMB
coordiates(cshapes$ZMB)
coordinates(cshapes$ZMB)
plot(cshapes$ZMB)
centers(cshapes$ZMB)
names(cshapes$ZMB)
?sp
names(cshapes$ZMB[[1]])
names(cshapes$ZMB[1])
names(cshapes$ZMB\$)
coords <- coordinates(cshapes$KEN)
max <- apply(coords,2,FUN=max)
min <- apply(coords,2,FUN=min)
mid <- minlonlat + ((maxlonlat-minlonlat)/2)
mid
coords <- coordinates(cshapes$CAR)
coords <- coordinates(cshapes$CAF)
max <- apply(coords,2,FUN=max)
min <- apply(coords,2,FUN=min)
mid <- minlonlat + ((maxlonlat-minlonlat)/2)
mid
max <- apply(coords,2,FUN=max)
min <- apply(coords,2,FUN=min)
mid <- min + ((max-min)/2)
mid
coords <- coordinates(cshapes$KEN)
max <- apply(coords,2,FUN=max)
min <- apply(coords,2,FUN=min)
mid <- min + ((max-min)/2)
mid
coords <- coordinates(cshapes$CAM)
coords <- coordinates(cshapes$CMR)
max <- apply(coords,2,FUN=max)
min <- apply(coords,2,FUN=min)
mid <- min + ((max-min)/2)
mid
coords <- coordinates(cshapes$NGA)
max <- apply(coords,2,FUN=max)
min <- apply(coords,2,FUN=min)
mid <- min + ((max-min)/2)
mid
extract(cshapes$BFA,cdata$BFA,fun=mean, na.rm=T)
library(rgeos)
?extract
extract(cdata$BFA,cshapes$BFA,fun=mean, na.rm=T)
cshapes$BFA
extract(altdata,cshape,fun=mean, na.rm=T)
library(ggplot2)
library(reshape2)
library(splines)
#plot depth graphs windows
if(!interactive()) {
cmd_args = commandArgs(trailingOnly = T);
flagdepthsfile = cmd_args[1]
winsize = as.numeric(cmd_args[2])
} else {
flagdepthsfile <- "~/Work_Sanger/anopheles_analyses/unmapPairs/data/AB0090_C.2R.flagdepths.w10000.txt"
winsize <- 10000
}
#cnames <- c("chr","pos",
#            "mappairs","notpaired","mateunmap","faceaway","mapnotpair")
# flagdepths <- read.table(flagdepthsfile)
# colnames(flagdepths) <- cnames
# flagdepths$block <- ceiling(flagdepths$pos/winsize) * winsize
# blocksums_a <- aggregate(. ~ block,
#                        data=flagdepths[,c("block","mappairs","notpaired","mateunmap","faceaway","mapnotpair")],
#                        FUN=sum)
# blocksums <- blocksums_a
#read blocksums from pre-calc'd file
cnames <- c("chr","block","pcfilled",
"mappairs","notpaired","mateunmap","faceaway","mapnotpair")
blocksums <- read.table(flagdepthsfile)
colnames(blocksums) <- cnames
blocksums <- cbind(blocksums[,c("block","pcfilled","mappairs")],
blocksums[,c("notpaired","mateunmap","faceaway","mapnotpair")]/blocksums$mappairs)
blocksums$depthfilled <- round(blocksums$mappairs / (blocksums$pcfilled * winsize))
blockmelt <- melt(blocksums,id.vars=c("block","pcfilled","depthfilled","mappairs"))
outroot <- gsub(".txt","",gsub(".gz","",flagdepthsfile))
rollapply
library(plyr)
rollapply
library(zoo)
?rollapply
install.packages("zoo")
library(zoo)
?rollapply
?rollmean
rollmean(blocksums,100)
head(rollmean(blocksums,100))
blocksums_raw <- blocksums
blocksums <- rollmean(blocksums,100)
blockmelt <- melt(blocksums,id.vars=c("block","pcfilled","depthfilled","mappairs"))
outroot <- gsub(".txt","",gsub(".gz","",flagdepthsfile))
#blockplot <- ggplot(subset(blockmelt,mappairs >= (20 * winsize)),aes(x=block,y=value,colour=variable)) +
blockplot <- ggplot(subset(blockmelt,pcfilled >= 0.8 & (depthfilled >= 14 & depthfilled <= 60)),aes(x=block,y=value,colour=variable)) +
geom_point(alpha=0.5) + ylim(0,0.5) + ggtitle(outroot) +
facet_grid(variable ~ .)
blocksums
head(blocksums)
blocksums <- rollmean(blocksums,100)
blockmelt <- melt(blocksums,id.vars=c("block","pcfilled","depthfilled","mappairs"))
outroot <- gsub(".txt","",gsub(".gz","",flagdepthsfile))
#blockplot <- ggplot(subset(blockmelt,mappairs >= (20 * winsize)),aes(x=block,y=value,colour=variable)) +
blockplot <- ggplot(subset(blockmelt,pcfilled >= 0.8 & (depthfilled >= 14 & depthfilled <= 60)),aes(x=block,y=value,colour=variable)) +
geom_point(alpha=0.5) + ylim(0,0.5) + ggtitle(outroot) +
facet_grid(variable ~ .)
head(blockmelt)
head(blocksums)
is.data.frame(blocksums)
as.data.frame(blocksums)
blocksums <- as.data.frame(rollmean(blocksums,100))
blocksums <- blocksums_raw
blocksums_raw <- blocksums
blocksums <- as.data.frame(rollmean(blocksums,100))
blockmelt <- melt(blocksums,id.vars=c("block","pcfilled","depthfilled","mappairs"))
outroot <- gsub(".txt","",gsub(".gz","",flagdepthsfile))
#blockplot <- ggplot(subset(blockmelt,mappairs >= (20 * winsize)),aes(x=block,y=value,colour=variable)) +
blockplot <- ggplot(subset(blockmelt,pcfilled >= 0.8 & (depthfilled >= 14 & depthfilled <= 60)),aes(x=block,y=value,colour=variable)) +
geom_point(alpha=0.5) + ylim(0,0.5) + ggtitle(outroot) +
facet_grid(variable ~ .)
blockplot
blockplot <- ggplot(subset(blockmelt,pcfilled >= 0.7 & (depthfilled >= 10 & depthfilled <= 100)),aes(x=block,y=value,colour=variable)) +
geom_line() + ylim(0,0.2) + ggtitle(outroot) +
facet_grid(variable ~ .)
blockplot
library(ggplot2)
library(reshape2)
library(splines)
#plot depth graphs windows
if(!interactive()) {
cmd_args = commandArgs(trailingOnly = T);
flagdepthsfile = cmd_args[1]
winsize = as.numeric(cmd_args[2])
} else {
flagdepthsfile <- "~/Work_Sanger/anopheles_analyses/unmapPairs/data/AB0090_C.2R.flagdepths.w1000.txt"
winsize <- 1000
}
#cnames <- c("chr","pos",
#            "mappairs","notpaired","mateunmap","faceaway","mapnotpair")
# flagdepths <- read.table(flagdepthsfile)
# colnames(flagdepths) <- cnames
# flagdepths$block <- ceiling(flagdepths$pos/winsize) * winsize
# blocksums_a <- aggregate(. ~ block,
#                        data=flagdepths[,c("block","mappairs","notpaired","mateunmap","faceaway","mapnotpair")],
#                        FUN=sum)
# blocksums <- blocksums_a
#read blocksums from pre-calc'd file
cnames <- c("chr","block","pcfilled",
"mappairs","notpaired","mateunmap","faceaway","mapnotpair")
blocksums <- read.table(flagdepthsfile)
colnames(blocksums) <- cnames
blocksums <- cbind(blocksums[,c("block","pcfilled","mappairs")],
blocksums[,c("notpaired","mateunmap","faceaway","mapnotpair")]/blocksums$mappairs)
blocksums$depthfilled <- round(blocksums$mappairs / (blocksums$pcfilled * winsize))
#blocksums <- blocksums_raw
blocksums_raw <- blocksums
blocksums <- as.data.frame(rollmean(blocksums,100))
blockmelt <- melt(blocksums,id.vars=c("block","pcfilled","depthfilled","mappairs"))
outroot <- gsub(".txt","",gsub(".gz","",flagdepthsfile))
#blockplot <- ggplot(subset(blockmelt,mappairs >= (20 * winsize)),aes(x=block,y=value,colour=variable)) +
blockplot <- ggplot(subset(blockmelt,pcfilled >= 0.7 & (depthfilled >= 10 & depthfilled <= 100)),aes(x=block,y=value,colour=variable)) +
geom_line() + ylim(0,0.2) + ggtitle(outroot) +
facet_grid(variable ~ .)
blockplot
head(blocksums)
head(blocksums_raw)
dim(blocksums_raw)
?rollmean
dim(blocksums)
dim(blocksums_raw)
dim(blocksums)
blocksums <- as.data.frame(rollmean(blocksums,100))
dim(blocksums)
head(blocksums_raw)
blocksums <- blocksums_raw
blocksums <- as.data.frame(rollmean(blocksums,100))
head(blocksums)
tail(blocksums)
blockmelt <- melt(blocksums,id.vars=c("block","pcfilled","depthfilled","mappairs"))
outroot <- gsub(".txt","",gsub(".gz","",flagdepthsfile))
#blockplot <- ggplot(subset(blockmelt,mappairs >= (20 * winsize)),aes(x=block,y=value,colour=variable)) +
blockplot <- ggplot(subset(blockmelt,pcfilled >= 0.7 & (depthfilled >= 10 & depthfilled <= 100)),aes(x=block,y=value,colour=variable)) +
geom_line() + ylim(0,0.2) + ggtitle(outroot) +
facet_grid(variable ~ .)
blocksums <- as.data.frame(rollmean(blocksums,100,partial=T))
tail(blocksums)
blocksums <- blocksums_raw
rollmean(blocksums,100,partial=T)
tail(rollmean(blocksums,100,partial=T))
tail(rollmean(blocksums,100,partial=T),100)
?rollapply
?mean
blocksums <- blocksums_raw
blocksums <- as.data.frame(rollapply(blocksums,100,FUN=mean,partial=T,na.rm=T))
tail(blocksums)
blockmelt <- melt(blocksums,id.vars=c("block","pcfilled","depthfilled","mappairs"))
outroot <- gsub(".txt","",gsub(".gz","",flagdepthsfile))
#blockplot <- ggplot(subset(blockmelt,mappairs >= (20 * winsize)),aes(x=block,y=value,colour=variable)) +
blockplot <- ggplot(subset(blockmelt,pcfilled >= 0.7 & (depthfilled >= 10 & depthfilled <= 100)),aes(x=block,y=value,colour=variable)) +
geom_line() + ylim(0,0.2) + ggtitle(outroot) +
facet_grid(variable ~ .)
blockplot
blockplot <- ggplot(subset(blockmelt,pcfilled >= 0.7 & (depthfilled >= 10 & depthfilled <= 100)),aes(x=block,y=value,colour=variable)) +
geom_line() + ylim(0,0.5) + ggtitle(outroot) +
facet_grid(variable ~ .)
blockplot
ggplot(subset(blockmelt,pcfilled >= 0.7 & (depthfilled >= 10 & depthfilled <= 100)),aes(x=block,y=value,colour=variable)) +
geom_line() + ggtitle(outroot) +
facet_grid(variable ~ .)
head(blocksums)
blocksums <- blocksums_raw
blocksums$pcfilled < 0.8
sum(blocksums$pcfilled < 0.8)
head(blocksums[blocksums$pcfilled < 0.8,])
head(blocksums[blocksums$pcfilled < 0.8,3:6])
head(blocksums[blocksums$pcfilled < 0.8,4:7])
blocksums[blocksums$pcfilled < 0.8,4:7] <- NA
blocksums <- as.data.frame(rollapply(blocksums,100,FUN=mean,partial=T,na.rm=T))
blockmelt <- melt(blocksums,id.vars=c("block","pcfilled","depthfilled","mappairs"))
outroot <- gsub(".txt","",gsub(".gz","",flagdepthsfile))
#blockplot <- ggplot(subset(blockmelt,mappairs >= (20 * winsize)),aes(x=block,y=value,colour=variable)) +
blockplot <- ggplot(subset(blockmelt,pcfilled >= 0.7 & (depthfilled >= 10 & depthfilled <= 100)),aes(x=block,y=value,colour=variable)) +
geom_line() + ggtitle(outroot) +
facet_grid(variable ~ .)
blockplot
library(zoo)
blockplot <- ggplot(subset(blockmelt,pcfilled >= 0.7 & (depthfilled >= 10 & depthfilled <= 100)),aes(x=block,y=value,colour=variable)) +
geom_line() + ggtitle(outroot) +
facet_grid(variable ~ .,scales="free_y")
blockplot
blockplot <- ggplot(blockmelt),aes(x=block,y=value,colour=variable)) +
geom_line() + ggtitle(outroot) +
facet_grid(variable ~ .,scales="free_y")
blockplot <- ggplot(blockmelt,aes(x=block,y=value,colour=variable)) +
geom_line() + ggtitle(outroot) +
facet_grid(variable ~ .,scales="free_y")
blockplot
blocksums <- blocksums_raw
blocksums[blocksums$pcfilled < 0.8,4:7] <- NA
blocksums <- as.data.frame(rollapply(blocksums,1000,FUN=mean,partial=T,na.rm=T))
blockmelt <- melt(blocksums,id.vars=c("block","pcfilled","depthfilled","mappairs"))
outroot <- gsub(".txt","",gsub(".gz","",flagdepthsfile))
#blockplot <- ggplot(subset(blockmelt,mappairs >= (20 * winsize)),aes(x=block,y=value,colour=variable)) +
#blockplot <- ggplot(subset(blockmelt,pcfilled >= 0.7 & (depthfilled >= 10 & depthfilled <= 100)),aes(x=block,y=value,colour=variable)) +
blockplot <- ggplot(blockmelt,aes(x=block,y=value,colour=variable)) +
geom_line() + ggtitle(outroot) +
facet_grid(variable ~ .,scales="free_y")
blockplot
blocksums <- blocksums_raw
blocksums[blocksums$pcfilled < 0.8,4:7] <- NA
blocksums_loc <- as.data.frame(rollapply(blocksums,100,FUN=mean,partial=T,na.rm=T))
blocksums_region <- as.data.frame(rollapply(blocksums,1000,FUN=mean,partial=T,na.rm=T))
head(blocksums(loc))
head(blocksums_loc)
head(blocksums_region)
head(blocksums_region[4:7])
head(blocksums_loc[,4:7]/blocksums_region[,4:7])
blocksums <- blocksums_raw
blocksums[blocksums$pcfilled < 0.8,4:7] <- NA
blocksums_loc <- as.data.frame(rollapply(blocksums,100,FUN=mean,partial=T,na.rm=T))
blocksums_region <- as.data.frame(rollapply(blocksums,1000,FUN=mean,partial=T,na.rm=T))
dim(blocksums_loc)
dim(blocksums_region)
dim(blocksums)
dim(as.data.frame(rollapply(blocksums,100,FUN=mean,partial=T,na.rm=T)))
View(blocksums)
View(blocksums)
dim(as.data.frame(rollapply(blocksums,100,FUN=mean,partial=F,na.rm=T)))
blocksums[,4:7] <- blocksums_loc[,4:7]/blocksums_region[,4:7]
head(blocksums)
blockmelt <- melt(blocksums,id.vars=c("block","pcfilled","depthfilled","mappairs"))
outroot <- gsub(".txt","",gsub(".gz","",flagdepthsfile))
#blockplot <- ggplot(subset(blockmelt,mappairs >= (20 * winsize)),aes(x=block,y=value,colour=variable)) +
#blockplot <- ggplot(subset(blockmelt,pcfilled >= 0.7 & (depthfilled >= 10 & depthfilled <= 100)),aes(x=block,y=value,colour=variable)) +
blockplot <- ggplot(blockmelt,aes(x=block,y=value,colour=variable)) +
geom_line() + ggtitle(outroot) +
facet_grid(variable ~ .,scales="free_y")
blockplot
blocksums <- blocksums_raw
blocksums[blocksums$pcfilled < 0.8,4:7] <- NA
blocksums_loc <- as.data.frame(rollapply(blocksums,1000,FUN=mean,partial=T,na.rm=T))
blocksums_region <- as.data.frame(rollapply(blocksums,10000,FUN=mean,partial=T,na.rm=T))
blocksums[,4:7] <- blocksums_loc[,4:7]/blocksums_region[,4:7]
blockmelt <- melt(blocksums,id.vars=c("block","pcfilled","depthfilled","mappairs"))
outroot <- gsub(".txt","",gsub(".gz","",flagdepthsfile))
#blockplot <- ggplot(subset(blockmelt,mappairs >= (20 * winsize)),aes(x=block,y=value,colour=variable)) +
#blockplot <- ggplot(subset(blockmelt,pcfilled >= 0.7 & (depthfilled >= 10 & depthfilled <= 100)),aes(x=block,y=value,colour=variable)) +
blockplot <- ggplot(blockmelt,aes(x=block,y=value,colour=variable)) +
geom_line() + ggtitle(outroot) +
facet_grid(variable ~ .,scales="free_y")
blockplot
blocksums <- blocksums_raw
blocksums[blocksums$pcfilled < 0.8,4:7] <- NA
blocksums_loc <- as.data.frame(rollapply(blocksums,100,FUN=mean,partial=T,na.rm=T))
blocksums_region <- as.data.frame(rollapply(blocksums,10000,FUN=mean,partial=T,na.rm=T))
blocksums_rel[,4:7] <- blocksums_loc[,4:7]/blocksums_region[,4:7]
blockmelt <- melt(blocksums_rel,id.vars=c("block","pcfilled","depthfilled","mappairs"))
outroot <- gsub(".txt","",gsub(".gz","",flagdepthsfile))
#blockplot <- ggplot(subset(blockmelt,mappairs >= (20 * winsize)),aes(x=block,y=value,colour=variable)) +
#blockplot <- ggplot(subset(blockmelt,pcfilled >= 0.7 & (depthfilled >= 10 & depthfilled <= 100)),aes(x=block,y=value,colour=variable)) +
blockplot <- ggplot(blockmelt,aes(x=block,y=value,colour=variable)) +
geom_line() + ggtitle(outroot) +
facet_grid(variable ~ .,scales="free_y")
blockplot
blocksums_rel <- blocksums
blocksums_rel[,4:7] <- blocksums_loc[,4:7]/blocksums_region[,4:7]
blockmelt <- melt(blocksums_rel,id.vars=c("block","pcfilled","depthfilled","mappairs"))
outroot <- gsub(".txt","",gsub(".gz","",flagdepthsfile))
#blockplot <- ggplot(subset(blockmelt,mappairs >= (20 * winsize)),aes(x=block,y=value,colour=variable)) +
#blockplot <- ggplot(subset(blockmelt,pcfilled >= 0.7 & (depthfilled >= 10 & depthfilled <= 100)),aes(x=block,y=value,colour=variable)) +
blockplot <- ggplot(blockmelt,aes(x=block,y=value,colour=variable)) +
geom_line() + ggtitle(outroot) +
facet_grid(variable ~ .,scales="free_y")
blockplot
blockplot <- ggplot(blockmelt,aes(x=block,y=value,colour=variable)) +
geom_line() + ggtitle(paste(outroot," [",locsize,"/",winsize,"]",sep="") +
facet_grid(variable ~ .,scales="free_y")
blockplot
blockplot <- ggplot(blockmelt,aes(x=block,y=value,colour=variable)) +
geom_line() + ggtitle(paste(outroot," [",locsize,"/",winsize,"]",sep="")) +
facet_grid(variable ~ .,scales="free_y")
blockplot
locsize <-  10000
regsize <- 100000
blockplot <- ggplot(blockmelt,aes(x=block,y=value,colour=variable)) +
geom_line() + ggtitle(paste(outroot," [",locsize,"/",winsize,"]",sep="")) +
facet_grid(variable ~ .,scales="free_y")
blockplot
blockplot <- ggplot(blockmelt,aes(x=block,y=value,colour=variable)) +
geom_line() + ggtitle(paste(outroot," [",(locsize/1000),"/",(regsize/1000),"]",sep="")) +
facet_grid(variable ~ .,scales="free_y")
blockplot
?mean
save.pkg.list <- installed.packages()[is.na(installed.packages()[,"priority"]), 1]
is.na(installed.packages()[,"priority"])
installed.packages()
installed.packages()[,"priority"]
installed.packages()[,"Priority"]
save.pkg.list <- installed.packages()[is.na(installed.packages()[,"Priority"]), 1]
save.pkg.list
save(save.pkg.list,file="~/Google Drive/misc/macports_150504/pkglist.Rdata")
library(raster)
library(maptools)
library(rgdal)
library(RColorBrewer)
library (ggplot2)
library(rgeos)
#library(animation)
library(rgeos)
library(myGeoFuncs)
codesTab <- as.data.frame(ccodes())
codesTab
africa.c <- as.vector(subset(codesTab,NAME %in% african.countries))
codesTab <- as.data.frame(ccodes())
codes <- as.character(unlist(subset(codesTab,NAME %in% african.countries,ISO3)))
africa.c <- as.vector(subset(codesTab,NAME %in% african.countries))
calt <- list()
cshapes <- list()
for (code in codes) {
#  write(code,stderr())
#country region data:
cshape<-getData("GADM", country=code, level=1)
#get midpoint of climate data
coords <- coordinates(cshape)
max <- apply(coords,2,FUN=max)
min <- apply(coords,2,FUN=min)
mid <- min + ((max-min)/2)
mid
altdata<-getData("worldclim", var="alt", res=0.5, lon=mid[1], lat=mid[2])
extract(altdata,cshape,fun=mean, na.rm=T)
calt[code] <- altdata
cshapes[code] <- cshape
}
codes
codesTab
subset(codesTab,NAME %in% african.countries,ISO3)
subset(codesTab,NAME %in% african.countries)
african.countries
malpe<-extract(malp,malb,fun=mean, na.rm=T)
malp<-getData("worldclim", var="prec", res=0.5, lon=35, lat=-14)
malpe<-extract(malp,malb,fun=mean, na.rm=T)
?getData
?extract
malp
setwd("~/Scratch/gits/pfdisco/reports/150908_njtree_thies/")
library(ggplot2)
library(ape)
library(stringdist)
library(reshape2)
genos <- read.table("daniels_2015.tab.txt",colClasses="character",sep="\t",skip=1)
inds <- genos[,1]
genos <- genos[,4:dim(genos)[[2]]]
rownames(genos)=inds
distDan = matrix(nrow=length(inds),ncol=length(inds))
colnames(distDan) = inds
rownames(distDan) = inds
distdan<-stringdistmatrix(genos,method="hamming")
is.list(genos)
head(genos)
is.matrix(genos)
as.matrix(genos)
stringdistmatrix(as.matrix(genos),method="hamming")
distDan = matrix(nrow=length(inds),ncol=length(inds))
colnames(distDan) = inds
rownames(distDan) = inds
#distdan<-stringdistmatrix(genos,method="hamming")
n=0
for (i in rownames(genos)){
n = n+1
write(paste(n,i),stderr())
for (j in rownames(genos)){
distDan[i,j] = sum(genos[i,]!=genos[j,])
}
}
discoNJ <- nj(as.dist(distDan))
plot(njtree,show.node.label = T,show.tip.label = T,
main="NJ tree, barcode SNPs, Daniels '15",type="cladogram",cex = 1.1)
plot(discoNJ,show.node.label = T,show.tip.label = T,
main="NJ tree, barcode SNPs, Daniels '15",type="cladogram",cex = 1.1)
plot(discoNJ,show.node.label = T,show.tip.label = T,
main="NJ tree, barcode SNPs, Daniels '15",type="radial",cex = 1.1)
?nj
write.nexus(discoNJ,"discovar.thies.nexus")
write.nexus(discoNJ,file="discovar.thies.nexus")
write.nexus(discoNJ,"daniels.thies.nexus")
write.nexus(discoNJ,file="daniels.thies.nexus")
danielsNJ <- nj(as.dist(distDan))
plot(danielsNJ,show.node.label = T,show.tip.label = T,
main="NJ tree, barcode SNPs, Daniels '15",type="radial",cex = 1.1)
write.nexus(danielsNJ,file="daniels.thies.nexus")
discoNJ <- nj(as.dist(distDisco))
plot(discoNJ,show.node.label = T,show.tip.label = T,
main="NJ tree, barcode SNPs, Discovar samples",type="cladogram",cex = 1.1)
write.nexus(discoNJ,file="daniels.thies.nexus")
genos <- read.table("GATK_calls_daniels_Thies.ped",colClasses="character")
inds <- genos[,1]
genos <- genos[,seq(7,dim(genos)[[2]],2)]
rownames(genos)=inds
distDisco = matrix(nrow=length(inds),ncol=length(inds))
colnames(distDisco) = inds
rownames(distDisco) = inds
for (i in rownames(genos)){
for (j in rownames(genos)){
#    write(i,stderr())
distDisco[i,j] = sum(genos[i,]!=genos[j,])
}
}
discoNJ <- nj(as.dist(distDisco))
plot(discoNJ,show.node.label = T,show.tip.label = T,
main="NJ tree, barcode SNPs, Discovar samples",type="cladogram",cex = 1.1)
write.nexus(discoNJ,file="daniels.thies.nexus")
main="NJ tree, barcode SNPs, Discovar samples",type="fan",cex = 1.1)
plot(discoNJ,show.node.label = T,show.tip.label = T,
main="NJ tree, barcode SNPs, Discovar samples",type="fan",cex = 1.1)
