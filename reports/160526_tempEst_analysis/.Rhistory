outroot <- gsub(".txt","",gsub(".gz","",flagdepthsfile))
#blockplot <- ggplot(subset(blockmelt,mappairs >= (20 * winsize)),aes(x=block,y=value,colour=variable)) +
blockplot <- ggplot(subset(blockmelt,pcfilled >= 0.7 & (depthfilled >= 10 & depthfilled <= 100)),aes(x=block,y=value,colour=variable)) +
geom_line() + ylim(0,0.2) + ggtitle(outroot) +
facet_grid(variable ~ .)
blockplot
blockplot <- ggplot(subset(blockmelt,pcfilled >= 0.7 & (depthfilled >= 10 & depthfilled <= 100)),aes(x=block,y=value,colour=variable)) +
geom_line() + ylim(0,0.5) + ggtitle(outroot) +
facet_grid(variable ~ .)
blockplot
ggplot(subset(blockmelt,pcfilled >= 0.7 & (depthfilled >= 10 & depthfilled <= 100)),aes(x=block,y=value,colour=variable)) +
geom_line() + ggtitle(outroot) +
facet_grid(variable ~ .)
head(blocksums)
blocksums <- blocksums_raw
blocksums$pcfilled < 0.8
sum(blocksums$pcfilled < 0.8)
head(blocksums[blocksums$pcfilled < 0.8,])
head(blocksums[blocksums$pcfilled < 0.8,3:6])
head(blocksums[blocksums$pcfilled < 0.8,4:7])
blocksums[blocksums$pcfilled < 0.8,4:7] <- NA
blocksums <- as.data.frame(rollapply(blocksums,100,FUN=mean,partial=T,na.rm=T))
blockmelt <- melt(blocksums,id.vars=c("block","pcfilled","depthfilled","mappairs"))
outroot <- gsub(".txt","",gsub(".gz","",flagdepthsfile))
#blockplot <- ggplot(subset(blockmelt,mappairs >= (20 * winsize)),aes(x=block,y=value,colour=variable)) +
blockplot <- ggplot(subset(blockmelt,pcfilled >= 0.7 & (depthfilled >= 10 & depthfilled <= 100)),aes(x=block,y=value,colour=variable)) +
geom_line() + ggtitle(outroot) +
facet_grid(variable ~ .)
blockplot
library(zoo)
blockplot <- ggplot(subset(blockmelt,pcfilled >= 0.7 & (depthfilled >= 10 & depthfilled <= 100)),aes(x=block,y=value,colour=variable)) +
geom_line() + ggtitle(outroot) +
facet_grid(variable ~ .,scales="free_y")
blockplot
blockplot <- ggplot(blockmelt),aes(x=block,y=value,colour=variable)) +
geom_line() + ggtitle(outroot) +
facet_grid(variable ~ .,scales="free_y")
blockplot <- ggplot(blockmelt,aes(x=block,y=value,colour=variable)) +
geom_line() + ggtitle(outroot) +
facet_grid(variable ~ .,scales="free_y")
blockplot
blocksums <- blocksums_raw
blocksums[blocksums$pcfilled < 0.8,4:7] <- NA
blocksums <- as.data.frame(rollapply(blocksums,1000,FUN=mean,partial=T,na.rm=T))
blockmelt <- melt(blocksums,id.vars=c("block","pcfilled","depthfilled","mappairs"))
outroot <- gsub(".txt","",gsub(".gz","",flagdepthsfile))
#blockplot <- ggplot(subset(blockmelt,mappairs >= (20 * winsize)),aes(x=block,y=value,colour=variable)) +
#blockplot <- ggplot(subset(blockmelt,pcfilled >= 0.7 & (depthfilled >= 10 & depthfilled <= 100)),aes(x=block,y=value,colour=variable)) +
blockplot <- ggplot(blockmelt,aes(x=block,y=value,colour=variable)) +
geom_line() + ggtitle(outroot) +
facet_grid(variable ~ .,scales="free_y")
blockplot
blocksums <- blocksums_raw
blocksums[blocksums$pcfilled < 0.8,4:7] <- NA
blocksums_loc <- as.data.frame(rollapply(blocksums,100,FUN=mean,partial=T,na.rm=T))
blocksums_region <- as.data.frame(rollapply(blocksums,1000,FUN=mean,partial=T,na.rm=T))
head(blocksums(loc))
head(blocksums_loc)
head(blocksums_region)
head(blocksums_region[4:7])
head(blocksums_loc[,4:7]/blocksums_region[,4:7])
blocksums <- blocksums_raw
blocksums[blocksums$pcfilled < 0.8,4:7] <- NA
blocksums_loc <- as.data.frame(rollapply(blocksums,100,FUN=mean,partial=T,na.rm=T))
blocksums_region <- as.data.frame(rollapply(blocksums,1000,FUN=mean,partial=T,na.rm=T))
dim(blocksums_loc)
dim(blocksums_region)
dim(blocksums)
dim(as.data.frame(rollapply(blocksums,100,FUN=mean,partial=T,na.rm=T)))
View(blocksums)
View(blocksums)
dim(as.data.frame(rollapply(blocksums,100,FUN=mean,partial=F,na.rm=T)))
blocksums[,4:7] <- blocksums_loc[,4:7]/blocksums_region[,4:7]
head(blocksums)
blockmelt <- melt(blocksums,id.vars=c("block","pcfilled","depthfilled","mappairs"))
outroot <- gsub(".txt","",gsub(".gz","",flagdepthsfile))
#blockplot <- ggplot(subset(blockmelt,mappairs >= (20 * winsize)),aes(x=block,y=value,colour=variable)) +
#blockplot <- ggplot(subset(blockmelt,pcfilled >= 0.7 & (depthfilled >= 10 & depthfilled <= 100)),aes(x=block,y=value,colour=variable)) +
blockplot <- ggplot(blockmelt,aes(x=block,y=value,colour=variable)) +
geom_line() + ggtitle(outroot) +
facet_grid(variable ~ .,scales="free_y")
blockplot
blocksums <- blocksums_raw
blocksums[blocksums$pcfilled < 0.8,4:7] <- NA
blocksums_loc <- as.data.frame(rollapply(blocksums,1000,FUN=mean,partial=T,na.rm=T))
blocksums_region <- as.data.frame(rollapply(blocksums,10000,FUN=mean,partial=T,na.rm=T))
blocksums[,4:7] <- blocksums_loc[,4:7]/blocksums_region[,4:7]
blockmelt <- melt(blocksums,id.vars=c("block","pcfilled","depthfilled","mappairs"))
outroot <- gsub(".txt","",gsub(".gz","",flagdepthsfile))
#blockplot <- ggplot(subset(blockmelt,mappairs >= (20 * winsize)),aes(x=block,y=value,colour=variable)) +
#blockplot <- ggplot(subset(blockmelt,pcfilled >= 0.7 & (depthfilled >= 10 & depthfilled <= 100)),aes(x=block,y=value,colour=variable)) +
blockplot <- ggplot(blockmelt,aes(x=block,y=value,colour=variable)) +
geom_line() + ggtitle(outroot) +
facet_grid(variable ~ .,scales="free_y")
blockplot
blocksums <- blocksums_raw
blocksums[blocksums$pcfilled < 0.8,4:7] <- NA
blocksums_loc <- as.data.frame(rollapply(blocksums,100,FUN=mean,partial=T,na.rm=T))
blocksums_region <- as.data.frame(rollapply(blocksums,10000,FUN=mean,partial=T,na.rm=T))
blocksums_rel[,4:7] <- blocksums_loc[,4:7]/blocksums_region[,4:7]
blockmelt <- melt(blocksums_rel,id.vars=c("block","pcfilled","depthfilled","mappairs"))
outroot <- gsub(".txt","",gsub(".gz","",flagdepthsfile))
#blockplot <- ggplot(subset(blockmelt,mappairs >= (20 * winsize)),aes(x=block,y=value,colour=variable)) +
#blockplot <- ggplot(subset(blockmelt,pcfilled >= 0.7 & (depthfilled >= 10 & depthfilled <= 100)),aes(x=block,y=value,colour=variable)) +
blockplot <- ggplot(blockmelt,aes(x=block,y=value,colour=variable)) +
geom_line() + ggtitle(outroot) +
facet_grid(variable ~ .,scales="free_y")
blockplot
blocksums_rel <- blocksums
blocksums_rel[,4:7] <- blocksums_loc[,4:7]/blocksums_region[,4:7]
blockmelt <- melt(blocksums_rel,id.vars=c("block","pcfilled","depthfilled","mappairs"))
outroot <- gsub(".txt","",gsub(".gz","",flagdepthsfile))
#blockplot <- ggplot(subset(blockmelt,mappairs >= (20 * winsize)),aes(x=block,y=value,colour=variable)) +
#blockplot <- ggplot(subset(blockmelt,pcfilled >= 0.7 & (depthfilled >= 10 & depthfilled <= 100)),aes(x=block,y=value,colour=variable)) +
blockplot <- ggplot(blockmelt,aes(x=block,y=value,colour=variable)) +
geom_line() + ggtitle(outroot) +
facet_grid(variable ~ .,scales="free_y")
blockplot
blockplot <- ggplot(blockmelt,aes(x=block,y=value,colour=variable)) +
geom_line() + ggtitle(paste(outroot," [",locsize,"/",winsize,"]",sep="") +
facet_grid(variable ~ .,scales="free_y")
blockplot
blockplot <- ggplot(blockmelt,aes(x=block,y=value,colour=variable)) +
geom_line() + ggtitle(paste(outroot," [",locsize,"/",winsize,"]",sep="")) +
facet_grid(variable ~ .,scales="free_y")
blockplot
locsize <-  10000
regsize <- 100000
blockplot <- ggplot(blockmelt,aes(x=block,y=value,colour=variable)) +
geom_line() + ggtitle(paste(outroot," [",locsize,"/",winsize,"]",sep="")) +
facet_grid(variable ~ .,scales="free_y")
blockplot
blockplot <- ggplot(blockmelt,aes(x=block,y=value,colour=variable)) +
geom_line() + ggtitle(paste(outroot," [",(locsize/1000),"/",(regsize/1000),"]",sep="")) +
facet_grid(variable ~ .,scales="free_y")
blockplot
?mean
save.pkg.list <- installed.packages()[is.na(installed.packages()[,"priority"]), 1]
is.na(installed.packages()[,"priority"])
installed.packages()
installed.packages()[,"priority"]
installed.packages()[,"Priority"]
save.pkg.list <- installed.packages()[is.na(installed.packages()[,"Priority"]), 1]
save.pkg.list
save(save.pkg.list,file="~/Google Drive/misc/macports_150504/pkglist.Rdata")
library(raster)
library(maptools)
library(rgdal)
library(RColorBrewer)
library (ggplot2)
library(rgeos)
#library(animation)
library(rgeos)
library(myGeoFuncs)
codesTab <- as.data.frame(ccodes())
codesTab
africa.c <- as.vector(subset(codesTab,NAME %in% african.countries))
codesTab <- as.data.frame(ccodes())
codes <- as.character(unlist(subset(codesTab,NAME %in% african.countries,ISO3)))
africa.c <- as.vector(subset(codesTab,NAME %in% african.countries))
calt <- list()
cshapes <- list()
for (code in codes) {
#  write(code,stderr())
#country region data:
cshape<-getData("GADM", country=code, level=1)
#get midpoint of climate data
coords <- coordinates(cshape)
max <- apply(coords,2,FUN=max)
min <- apply(coords,2,FUN=min)
mid <- min + ((max-min)/2)
mid
altdata<-getData("worldclim", var="alt", res=0.5, lon=mid[1], lat=mid[2])
extract(altdata,cshape,fun=mean, na.rm=T)
calt[code] <- altdata
cshapes[code] <- cshape
}
codes
codesTab
subset(codesTab,NAME %in% african.countries,ISO3)
subset(codesTab,NAME %in% african.countries)
african.countries
malpe<-extract(malp,malb,fun=mean, na.rm=T)
malp<-getData("worldclim", var="prec", res=0.5, lon=35, lat=-14)
malpe<-extract(malp,malb,fun=mean, na.rm=T)
?getData
?extract
malp
g <- graph.de.bruijn(2,1)
graph.de.bruijn(2,2)
line.graph(g)
install.packages("igraph")
install.packages("stringr")
install.packages("stringr")
install.packages("igraph")
g <- graph.de.bruijn(2,1)
graph.de.bruijn(2,2)
line.graph(g)
library(igraph)
g <- graph.de.bruijn(2,1)
graph.de.bruijn(2,2)
line.graph(g)
g <- graph.de.bruijn(2,1)
g
g <- graph.de.bruijn(55)
g <- graph.de.bruijn(5,5)
g
line.graph(g)
anyNA
V(g)
E(g)
version()
session.info()
sessioninfo()
sessionInfo()
sessioninfo()
sessionInfo()
anyNA
library(igraph)
g <- graph.de.bruijn(5,5)
E(g)
line.graph(g)
plot(g)
g <- graph.de.bruijn(2,5)
plot(g)
g <- graph.de.bruijn(5,2)
plot(g)
g <- graph.de.bruijn(10,2)
plot(g)
g <- graph.de.bruijn(10,1)
plot(g)
g <- graph.de.bruijn(20,5,)
g <- graph.de.bruijn(20,5)
plot(g)
g <- graph.de.bruijn(20,2)
plot(g)
g <- graph.de.bruijn(10,2)
plot(g)
g <- graph.de.bruijn(6,2)
g <- graph.de.bruijn(6,2)
g <- graph.de.bruijn(5,2)
plot(g)
plot(g,mark.shape=0)
plot(g,mark.shape=1)
plot(g,mark.shape=0.1)
plot(g,shape="none")
plot(g,Shape="none")
plot(g,vertex.shape="none")
plot(g,edge.shape="none")
plot(g,arrow.size=0.2)
g <- graph.de.bruijn(5,10)
g <- graph.de.bruijn(5,3)
plot(g, layout=layout_with_fr)
plot(g, layout='layout_with_fr')
plot(g)
plot(g, layout=layout_with_fr, vertex.size=4,
vertex.label.dist=0.5, vertex.color="red", edge.arrow.size=0.5)
g<-barabasi.game(10)
plot(g, layout=layout_with_fr, vertex.size=4,
vertex.label.dist=0.5, vertex.color="red", edge.arrow.size=0.5)
g <- graph.de.bruijn(5,2)
plot(g)
plot(g,cex.main=0.2)
plot(g,cex.main=0.1)
plot.igraph(g,mark.shape=0)
plot.igraph(g,mark.shape=0,arrow.size=0.3)
g<-barabasi.game(10)
plot(g)
g<-barabasi.game(30)
plot(g)
?igraph
g<-erdos.renyi.game(30)
g<-erdos.renyi.game(n=20,p.or.m=p)
g<-erdos.renyi.game(n=20,p.or.m="p")
g<-erdos.renyi.game(n=20,p.or.m=T)
plot(g)
g<-erdos.renyi.game(n=20,p.or.m=F)
plot(g)
g <- graph.de.bruijn(5,2)
plot(g)
plot(g,xlim(0,10))
plot.igraph(g,mark.expand=20)
plot.igraph(g,mark.expand=30)
plot.igraph(g,mark.expand=10)
g <- graph.kautz(5,2)
plot(g,xlim(0,10))
plot(g\)
plot(g)
g <- graph.kautz(5,1)
plot(g)
read.table("Scratch/gits/pfdisco/analyses/modelling_intraspec/")
read.table("Scratch/gits/pfdisco/analyses/modelling_intraspec/qstages.C1.5m.L0.01mb.G36.mtp.AFs.txt")
afs <- read.table("Scratch/gits/pfdisco/analyses/modelling_intraspec/qstages.C1.5m.L0.01mb.G36.mtp.AFs.txt",sep="\t")
afs <- read.table("Scratch/gits/pfdisco/analyses/modelling_intraspec/qstages.C1.5m.L0.01mb.G36.mtp.AFs.txt",sep="\t")
afs <- read.table("Scratch/gits/pfdisco/analyses/modelling_intraspec/qstages.C1.5m.L0.01mb.G36.mtp.AFs.txt",sep="\t",row.names=1)
library(ggplot2)
ggplot(afs[1,]) + geom_dist()
ggplot(afs[1,]) + geom_density()
ggplot(t(afs),aes(x="14") + geom_density()
\c
ggplot(t(afs),aes(x="14")) + geom_density()
afs <- as.data.frame(t(afs))
ggplot(afs,aes(x="14")) + geom_density()
head(afs)
ggplot(afs,aes(x=14)) + geom_density()
colnames(afs) <- c("month","half_yr","yr")
ggplot(afs,aes(x=month)) + geom_density()
afs_small <- as.data.frame(t(read.table("Scratch/gits/pfdisco/analyses/modelling_intraspec/qstages.C1.5m.L0.01mb.G36.mtp.AFs.txt",sep="\t",row.names=1)),col.names=c("month","halfyr","yr"))
head(afs_small)
afs_small <- data.frame(t(read.table("Scratch/gits/pfdisco/analyses/modelling_intraspec/qstages.C1.5m.L0.01mb.G36.mtp.AFs.txt",sep="\t",row.names=1)),col.names=c("month","halfyr","yr"))
afs_small <- data.frame(t(read.table("Scratch/gits/pfdisco/analyses/modelling_intraspec/qstages.C1.5m.L0.01mb.G36.mtp.AFs.txt",sep="\t",row.names=1)))
colnames(afs_small)<-c("mth","halfyr","yr")
afs_large <- data.frame(t(read.table("Scratch/gits/pfdisco/analyses/modelling_intraspec/qstages.C100.0m.L0.01mb.G36.mtp.AFs.txt",sep="\t",row.names=1)))
colnames(afs_large)<-c("mth","halfyr","yr")
ggplot(afs_small,aes(x="yr")) + geom_density(colour="blue") + geom_density(data=afs_large,aes(x="mth"),colour="red")
ggplot(afs_small,aes(x=yr)) + geom_density(colour="blue") + geom_density(data=afs_large,aes(x=mth),colour="red")
ggplot(afs_small,aes(x=yr)) + geom_density()
ggplot(afs_large,aes(x=mth)) + geom_density()
density(afs_large$mth)
plot(density(afs_large$mth))
plot(density(afs_large$mth),colour="red") + lines(density(afs_small$yr),colour="blue")
plot(density(afs_large$mth),col="red") + lines(density(afs_small$yr),col="blue")
plot(density(afs_small$yr),colour="blue") + lines(density(afs_large$mth),colour="red")
plot(density(afs_small$yr),col="blue") + lines(density(afs_large$mth),col="red")
plot(density(subset(afs_small,yr>0.01,yr),col="blue") + lines(density(afs_large$mth),col="red")
\c
plot(density(subset(afs_small,yr>0.01,yr)),col="blue") + lines(density(afs_large$mth),col="red")
subset(afs_small,yr>0.01,yr)
plot(density(subset(afs_small,yr>0.01,yr)),col="blue") + lines(density(afs_large$mth),col="red")
plot(density(subset(afs_small,yr>0.01,yr)),col="blue")
plot(density(subset(afs_small,yr>0.01)$yr),col="blue")
plot(density(subset(afs_small,yr>0.01)$yr),col="blue") + lines(density(subset(afs_large,mth>0.01)$mth),col="red")
plot(density(subset(afs_small,yr>=0.01)$yr),col="blue") + lines(density(subset(afs_large,mth>=0.01)$mth),col="red")
njtree
library(ape)
setwd("Scratch/gits/pfdisco/reports/160415_this_tree_stats/")
setwd("~/Scratch/gits/pfdisco/reports/160526_tempEst_analysis/")
library(knitr)
library(igraph)
library("RColorBrewer")
opts_chunk$set(fig.width=9, fig.height=9)
opts_chunk$set(dev=c('png'))
opts_chunk$set(dev=c('png','postscript'))
temp <- read.table("Thies_ALL.green.txt")
temp
temp <- read.table("Thies_ALL.green.txt",header=T)
ggplot(temp,aes(x=date,y=distance,color=residual)) + geom_point()
library(ggplot2)
ggplot(temp,aes(x=date,y=distance,color=residual)) + geom_point()
ggplot(temp,aes(x=date,y=distance,color=residual)) + geom_label()
ggplot(temp,aes(x=date,y=distance,label=tip,color=residual)) + geom_label()
ggplot(temp,aes(x=date,y=distance,label=tip,color=residual)) + geom_text()
ggplot(all,aes(x=date,y=distance,label=tip,color=residual)) + geom_text() + geom_smooth(method="lm")
ggplot(all,aes(x=date,y=distance,label=tip,color=residual)) + geom_text() + geom_smooth(method="lm",se=F)
ggplot(all,aes(x=date,y=distance,label=tip,color=residual)) + geom_smooth(method="lm",se=F) + geom_text()
ggplot(all,aes(x=date,y=distance,label=tip,color=residual)) + geom_smooth(method="lm",se=F)
ggplot(all,aes(x=date,y=distance,label=tip,color=residual)) + geom_text() #$+ geom_smooth(method="lm",se=F)
ggplot(all,aes(x=date,y=distance,label=tip,color=residual)) + geom_text()
all <- read.table("Thies_ALL.green.txt",header=T)
ggplot(all,aes(x=date,y=distance,label=tip,color=residual)) + geom_text()
ggplot(all,aes(x=date,y=distance,label=tip,color=residual)) + geom_text() + geom_smooth(method="lm",se=F)
ggplot(all,aes(x=date,y=distance,label=tip,color=residual)) + geom_text() + geom_smooth(method="lm",se=F) + xlim(2000,2013)
ggplot(all,aes(x=date,y=distance,label=tip,color=residual)) + geom_text() + geom_smooth(method="lm",se=F) + xlim(2005,2013)
indel <- read.table("Thies_INDEL.green.txt",header=T)
ggplot(indel,aes(x=date,y=distance,label=tip,color=residual)) + geom_text() + geom_smooth(method="lm",se=F) + xlim(2005,2013)
```
snp <- read.table("Thies_SNP.green.txt",header=T)
ggplot(snp,aes(x=date,y=distance,label=tip,color=residual)) + geom_text() + geom_smooth(method="lm",se=F) + xlim(2005,2013)
indel <- read.table("Thies_INDEL.green.txt",header=T)
ggplot(indel,aes(x=date,y=distance,label=tip,color=residual)) + geom_text() + geom_smooth(method="lm",se=F) + xlim(2005,2013)
ggplot(indel,aes(x=date,y=distance,label=tip,color=residual)) + geom_text() + geom_smooth(method="lm",se=F) + xlim(2005,2013) + scale_color_continuous(low="blue",high="red")
ggplot(indel,aes(x=date,y=distance,label=tip,color=residual)) + geom_text() + geom_smooth(method="lm",se=F) + xlim(2005,2013) + scale_color_continuous(low="blue",mid="black",high="red")
ggplot(indel,aes(x=date,y=distance,label=tip,color=residual)) + geom_text() + geom_smooth(method="lm",se=F) + xlim(2005,2013) + scale_color_gradient2(low="blue",mid="black",high="red")
ggplot(indel,aes(x=date,y=distance,label=tip,color=residual)) + geom_text() + geom_smooth(method="lm",se=F) + xlim(2005,2013) + scale_color_gradient2(low="blue",mid="black",high="red")
grad <- scale_color_gradient2(low="blue",mid="black",high="red")
cols <- scale_color_gradient2(low="blue",mid="black",high="red")
ggplot(all,aes(x=date,y=distance,label=tip,color=residual)) + geom_text() + geom_smooth(method="lm",se=F) + xlim(2005,2013) + cols
ggplot(snp,aes(x=date,y=distance,label=tip,color=residual)) + geom_text() + geom_smooth(method="lm",se=F) + xlim(2005,2013) + cols
ggplot(indel,aes(x=date,y=distance,label=tip,color=residual)) + geom_text() + geom_smooth(method="lm",se=F) + xlim(2005,2013)+ cols
cor(indel$distance,indel$date)
cor(all$distance,all$date)
cor(snp$distance,snp$date)
cor(indel$distance,indel$date)
knit("tempEst_residuals.Rmd")
cor(all$distance,all$date,method="kendall")
cor(all$distance,all$date,method="spearman")
ggplot(all,aes(x=date,y=distance,label=tip)) + geom_text() + geom_smooth(method="lm",se=F) + xlim(2005,2013)
ggplot(all,aes(x=date,y=distance,label=tip)) + geom_text() + geom_smooth(method="lm",se=F) + xlim(2006,2013)
ggplot(all,aes(x=date,y=distance,label=tip)) + geom_text() + geom_smooth(method="lm",se=F) + xlim(2006,2013) + ylim(0,max(all$distance))
ggplot(snp,aes(x=date,y=distance,label=tip)) + geom_text() + geom_smooth(method="lm",se=F) + xlim(2006,2013) + ylim(0,max(snp$distance))
ggplot(indel,aes(x=date,y=distance,label=tip)) + geom_text() + geom_smooth(method="lm",se=F) + xlim(2006,2013) + ylim(0,max(indel$distance))
ggplot(all,aes(x=date,y=distance,label=tip)) + geom_text() + geom_smooth(method="lm",se=F) + xlim(2006,2013) + ylim(0,max(all$distance))
ggplot(snp,aes(x=date,y=distance,label=tip)) + geom_text() + geom_smooth(method="lm",se=F) + xlim(2006,2013) + ylim(0,max(snp$distance))
ggplot(indel,aes(x=date,y=distance,label=tip)) + geom_text() + geom_smooth(method="lm",se=F) + xlim(2006,2013) + ylim(0,max(indel$distance))
ggplot(all,aes(x=date,y=distance,label=tip)) + geom_text() + geom_smooth(method="lm",se=F) + xlim(2006,2013)
knit("tempEst_residuals.Rmd")
knit("tempEst_residuals.Rmd")
all <- read.table("Thies_ALL.green.txt",header=T)
ggplot(all,aes(x=date,y=distance,label=tip,color=residual)) + geom_text() + geom_smooth(method="lm",se=F) + xlim(2005,2013) + cols
snp <- read.table("Thies_SNP.green.txt",header=T)
ggplot(snp,aes(x=date,y=distance,label=tip,color=residual)) + geom_text() + geom_smooth(method="lm",se=F) + xlim(2005,2013) + cols
indel <- read.table("Thies_INDEL.green.txt",header=T)
ggplot(indel,aes(x=date,y=distance,label=tip,color=residual)) + geom_text() + geom_smooth(method="lm",se=F) + xlim(2005,2013)+ cols
cor(all$distance,all$date)
cor(snp$distance,snp$date)
cor(indel$distance,indel$date)
knit("tempEst_residuals.Rmd")
knit("tempEst_residuals.Rmd")
indel <- read.table("Thies_INDEL.green.txt",header=T)
ggplot(indel,aes(x=date,y=distance,label=tip,color=residual)) + geom_text() + geom_smooth(method="lm",se=F) + xlim(2005,2013)+ cols
ggplot(all,aes(x=date,y=distance,label=tip)) + geom_text() + geom_smooth(method="lm",se=F) + xlim(2006,2013)
ggplot(indel,aes(x=date,y=distance,label=tip)) + geom_text() + geom_smooth(method="lm",se=F) + xlim(2006,2013) #+ ylim(0,max(indel$distance))
ggplot(indel,aes(x=date,y=distance,label=tip)) + geom_text() + geom_smooth(data=subset(indel,year!=2007),method="lm",se=F) + xlim(2006,2013) #+ ylim(0,max(indel$distance))
ggplot(indel,aes(x=date,y=distance,label=tip)) + geom_text() + geom_smooth(data=subset(indel,date!=2007),method="lm",se=F) + xlim(2006,2013) #+ ylim(0,max(indel$distance))
ggplot(all,aes(x=date,y=distance,label=tip)) + geom_text() + geom_smooth(method="lm",se=F) + xlim(2006,2013)
ggplot(indel,aes(x=date,y=distance,label=tip)) + geom_text() + geom_smooth(data=subset(indel,date!=2007),method="lm",se=F) + xlim(2006,2013) #+ ylim(0,max(indel$distance))
ggplot(all,aes(x=date,y=distance,label=tip)) + geom_text() + geom_smooth(data=subset(all,date!=2007),method="lm",se=F) + xlim(2006,2013) #+ ylim(0,max(indel$distance))
indel$year>2007
indel$year>2007
indel$year >= 2007
(indel$year >= 2007)
(indel$year != 2007)
indel$year != 2007
indel$date > 2007
d <- indel$date > 2007
c(cor(all$distance,all$date),
cor(snp$distance,snp$date),
cor(indel$distance,indel$date))
c(cor(all$distance[d],all$date[d]),
cor(snp$distance[d],snp$date[d]),
cor(indel$distance[d],indel$date[d]))
correlation indices
c(cor(all$distance,all$date),
cor(snp$distance,snp$date),
cor(indel$distance,indel$date))
ggplot(all,aes(x=date,y=distance,label=tip)) + geom_text() + geom_smooth(data=subset(all,date!=2007),method="lm",se=F) + xlim(2006,2013) #+ ylim(0,max(indel$distance))
ggplot(all,aes(x=date,y=distance,label=tip)) + geom_text() + geom_smooth(method="lm",se=F) + xlim(2006,2013)
ggplot(indel,aes(x=date,y=distance,label=tip)) + geom_text() + geom_smooth(data=subset(indel,date!=2007),method="lm",se=F) + xlim(2006,2013) #+ ylim(0,max(indel$distance))
ggplot(indel,aes(x=date,y=distance,label=tip)) + geom_text() + geom_smooth(method="lm",se=F) + xlim(2006,2013) #+ ylim(0,max(indel$distance))
knit("tempEst_residuals.Rmd")
all <- read.table("Thies_ALL.green.txt",header=T)
ggplot(all,aes(x=date,y=distance,label=tip,color=residual)) + geom_text() + geom_smooth(method="lm",se=F) + xlim(2005,2013) + cols
all <- read.table("Thies_ALL.green.txt",header=T)
ggplot(all,aes(x=date,y=distance,label=tip,color=residual)) + geom_text() + geom_smooth(method="lm",se=F) + xlim(2000,2015) + cols
ggplot(all,aes(x=date,y=distance,label=tip,color=residual)) + geom_text() + geom_smooth(method="lm",se=F) + cols + xlim(2000,2015) + ylim(0,max(all$distance))
snp <- read.table("Thies_SNP.green.txt",header=T)
ggplot(snp,aes(x=date,y=distance,label=tip,color=residual)) + geom_text() + geom_smooth(method="lm",se=F) + cols + xlim(2000,2015) + ylim(0,max(all$distance))
snp <- read.table("Thies_SNP.green.txt",header=T)
ggplot(snp,aes(x=date,y=distance,label=tip,color=residual)) + geom_text() + geom_smooth(method="lm",se=F) + cols + xlim(2000,2015) + ylim(0,max(snp$distance))
indel <- read.table("Thies_INDEL.green.txt",header=T)
ggplot(indel,aes(x=date,y=distance,label=tip,color=residual)) + geom_text() + geom_smooth(method="lm",se=F) + cols+ xlim(2000,2015) + ylim(0,max(indel$distance))
lm(data=snp[,c("date","distance")])
ggplot(snp,aes(x=date,y=distance,label=tip,color=residual)) + geom_text() + geom_smooth(method="lm",se=F) + cols + xlim(2000,2015) + ylim(0,max(snp$distance)) + geom_abline(lm(data=snp[,c("date","distance")]))
snp <- read.table("Thies_SNP.green.txt",header=T)
snplm = lm(data=snp[,c("date","distance")])
snplm$model
snplm
snplm$coefficients
snplm$coefficients
snplm$coefficients[[1]]
snplm$coefficients[[2]]
coef(lm(date ~ distance, data = snp))
coef(lm(distance ~ date, data = snp))
snplm = lm(data=snp[,c("date","distance")])$coefficients
ggplot(snp,aes(x=date,y=distance,label=tip,color=residual)) + geom_text() + geom_smooth(method="lm",se=F) + cols + xlim(2000,2015) + ylim(0,max(snp$distance)) + geom_abline(intercept=snplm[[1]],slope=snplm[[2]])
ggplot(snp,aes(x=date,y=distance,label=tip,color=residual)) + geom_text() + geom_smooth(method="lm",se=F) + cols + xlim(2000,2015) + ylim(0,max(snp$distance)) + geom_abline(intercept=2000,slope=snplm[[2]])
ggplot(snp,aes(x=date,y=distance,label=tip,color=residual)) + geom_text()  + geom_abline(intercept=2000,slope=snplm[[2]]) + cols + xlim(2000,2015) + ylim(0,max(snp$distance))
snplm
snplm = lm(data=snp[,c("distance","date")])$coefficients
snplm
snp <- read.table("Thies_SNP.green.txt",header=T,stringsAsFactors=F)
snplm = lm(data=snp[,c("distance","date")])$coefficients
snplm
snp
ggplot(all,aes(x=date,y=distance,label=tip,color=residual)) + geom_text() + geom_smooth(method="lm",se=F,fullrange=T) + cols + xlim(2000,2015) + ylim(0,max(all$distance))
ggplot(snp,aes(x=date,y=distance,label=tip,color=residual)) + geom_text() + geom_smooth(method="lm",se=F,fullrange=T) + cols + xlim(2000,2015) + ylim(0,max(snp$distance))
indel <- read.table("Thies_INDEL.green.txt",header=T)
ggplot(indel,aes(x=date,y=distance,label=tip,color=residual)) + geom_text() + geom_smooth(method="lm",se=F,fullrange=T) + cols+ xlim(2000,2015) + ylim(0,max(indel$distance))
all <- read.table("Thies_ALL.green.txt",header=T)
ggplot(all,aes(x=date,y=distance,label=tip,color=residual)) + geom_text() + geom_smooth(method="lm",se=F,fullrange=T) + cols + xlim(2000,2015) + ylim(0,max(all$distance))
snp <- read.table("Thies_SNP.green.txt",header=T)
snplm = lm(data=snp[,c("date","distance")])$coefficients
ggplot(snp,aes(x=date,y=distance,label=tip,color=residual)) + geom_text() + geom_smooth(method="lm",se=F,fullrange=T) + cols + xlim(2000,2015) + ylim(0,max(snp$distance))
indel <- read.table("Thies_INDEL.green.txt",header=T)
ggplot(indel,aes(x=date,y=distance,label=tip,color=residual)) + geom_text() + geom_smooth(method="lm",se=F,fullrange=T) + cols+ xlim(2000,2015) + ylim(0,max(indel$distance))
c(cor(all$distance,all$date),
cor(snp$distance,snp$date),
cor(indel$distance,indel$date))
ggplot(all,aes(x=date,y=distance,label=tip)) + geom_text() + geom_smooth(method="lm",se=F,fullrange=T) + xlim(2006,2013)
ggplot(all,aes(x=date,y=distance,label=tip)) + geom_text() + geom_smooth(method="lm",se=F,fullrange=T) + xlim(2000,2015)
knit("tempEst_residuals.Rmd")
d = !all$tip %in% c("Th134.11","Th106.11","Th117.11")
c(cor(all$distance[d],all$date[d]),
cor(snp$distance[d],snp$date[d]),
cor(indel$distance[d],indel$date[d]))
c(cor(all$distance,all$date),
cor(snp$distance,snp$date),
cor(indel$distance,indel$date))
d = !all$tip %in% c("Th134.11","Th106.11","Th117.11")
c(cor(all$distance[d],all$date[d]),
cor(snp$distance[d],snp$date[d]),
cor(indel$distance[d],indel$date[d]))
#2011 clade and root only
d = all$tip %in% c("Th086.07","Th134.11","Th106.11","Th117.11")
c(cor(all$distance[d],all$date[d]),
cor(snp$distance[d],snp$date[d]),
cor(indel$distance[d],indel$date[d]))
knit("tempEst_residuals.Rmd")
ggplot(all,aes(x=date,y=distance,label=tip)) + geom_point() + geom_label() + geom_smooth(method="lm",se=F,fullrange=T) + xlim(2000,2015)
ggplot(all,aes(x=date,y=distance,label=tip)) + geom_point() + geom_text() + geom_smooth(method="lm",se=F,fullrange=T) + xlim(2000,2015)
ggplot(all,aes(x=date,y=distance,label=tip)) + geom_point() + geom_text() + geom_smooth(method="lm",se=F,fullrange=T,colour="black",linetype=2) + xlim(2000,2015)
knit("tempEst_residuals.Rmd")
