callable5k$dustpc <- 0
for (i in 1:dim(callable5k)[1]) {
chr <- callable5k[i,1]
st <- callable5k[i,2]
en <- callable5k[i,3]
dusted <- sum(subset(dust,chr==chr & st>=st & en <en)$len)
olmin <- min(subset(dust,chr==chr & st>=st & en <en)$st)
olmax <- max(subset(dust,chr==chr & st>=st & en <en)$en)
if (olmin<st) {dusted<-dusted-(st-olmin)}
if (olmax>en) {dusted<-dusted-(olmax-en)}
dustpc = dusted/en-st
callable5k[i,"dustpc"]<-dustpc
}
View(callable5k)
dust <- read.table("Pf3D7_v3.dust.bed.gz",col.names=c("chr","st","en"))
levels(dust$chr) <- c("MIT","01","02","03","04","05","06","07","08","09","10","11","12","13","14","API")
dust$len = dust$en-dust$st
callable5k$dustpc <- 0
for (i in 1:dim(callable5k)[1]) {
chr <- callable5k[i,1]
st <- callable5k[i,2]
en <- callable5k[i,3]
dustset <- subset(dust,chr==chr & st>=st & en <en
dusted <- sum(dustset$len)
olmin <- min(dustset$st)
olmax <- max(dustset$en)
if (olmin<st) {dusted<-dusted-(st-olmin)}
if (olmax>en) {dusted<-dusted-(olmax-en)}
dustpc = dusted/(en-st)
callable5k[i,"dustpc"]<-dustpc
}
callable5k$dustpc <- 0
for (i in 1:dim(callable5k)[1]) {
chr <- callable5k[i,1]
st <- callable5k[i,2]
en <- callable5k[i,3]
dustset <- subset(dust,chr==chr & st>=st & en <en)
dusted <- sum(dustset$len)
olmin <- min(dustset$st)
olmax <- max(dustset$en)
if (olmin<st) {dusted<-dusted-(st-olmin)}
if (olmax>en) {dusted<-dusted-(olmax-en)}
dustpc = dusted/(en-st)
callable5k[i,"dustpc"]<-dustpc
}
warnings()
dustset
View(callable5k)
chr <- callable5k[i,1]
st <- callable5k[i,2]
en <- callable5k[i,3]
dustset <- subset(dust,chr==chr & st>=st & en <en)
dustset
chr
st
en
i
i<50
i<-50
chr <- callable5k[i,1]
st <- callable5k[i,2]
en <- callable5k[i,3]
dustset <- subset(dust,chr==chr & st>=st & en <en)
dustset
dustset <- subset(dust,chr==chr)
dustset
dustset <- subset(dust,chr==chr & st>=st)
dustset
dustset <- subset(dust,chr==chr & en>=st & st <en)
dustset
callable5k$dustpc <- 0
for (i in 1:dim(callable5k)[1]) {
chr <- callable5k[i,1]
st <- callable5k[i,2]
en <- callable5k[i,3]
dustset <- subset(dust,chr==chr & en>=st & st<en)
dusted <- sum(dustset$len)
olmin <- min(dustset$st)
olmax <- max(dustset$en)
if (olmin<st) {dusted<-dusted-(st-olmin)}
if (olmax>en) {dusted<-dusted-(olmax-en)}
dustpc = dusted/(en-st)
callable5k[i,"dustpc"]<-dustpc
}
View(callable5k)
callable5k[i,1]
callable5k[200,1]
callable5k[2000,1]
rm(i)
callable5k$dustpc <- 0
for (i in 1:dim(callable5k)[1]) {
chr <- callable5k[i,1]
st <- callable5k[i,2]
en <- callable5k[i,3]
dustset <- subset(dust,chr==chr & en>=st & st<en)
if (dim(dustset)[1]>0){
dusted <- sum(dustset$len)
olmin <- min(dustset$st)
olmax <- max(dustset$en)
if (olmin<st) {dusted<-dusted-(st-olmin)}
if (olmax>en) {dusted<-dusted-(olmax-en)}
dustpc = dusted/(en-st)
callable5k[i,"dustpc"]<-dustpc
}
}
View(callable5k)
i
chr <- callable5k[i,1]
st <- callable5k[i,2]
en <- callable5k[i,3]
dustset <- subset(dust,chr==chr & en>=st & st<en)
if (dim(dustset)[1]>0){
dusted <- sum(dustset$len)
olmin <- min(dustset$st)
olmax <- max(dustset$en)
if (olmin<st) {dusted<-dusted-(st-olmin)}
if (olmax>en) {dusted<-dusted-(olmax-en)}
dustpc = dusted/(en-st)
callable5k[i,"dustpc"]<-dustpc
}
dustpc
dusted <- sum(dustset$len)
olmin <- min(dustset$st)
olmax <- max(dustset$en)
dusted
dustset
st
en
dustset <- subset(dust,chr==chr && en>=st && st<en)
dustset
en
st
mychr <- callable5k[i,1]
myst <- callable5k[i,2]
myen <- callable5k[i,3]
dustset <- subset(dust,chr==mychr && en>=myst && st<myen)
dustset
callable5k$dustpc <- 0
for (i in 1:dim(callable5k)[1]) {
mychr <- callable5k[i,1]
myst <- callable5k[i,2]
myen <- callable5k[i,3]
dustset <- subset(dust,chr==mychr && en>=myst && st<myen)
if (dim(dustset)[1]>0){
dusted <- sum(dustset$len)
olmin <- min(dustset$st)
olmax <- max(dustset$en)
if (olmin<st) {dusted<-dusted-(st-olmin)}
if (olmax>en) {dusted<-dusted-(olmax-en)}
dustpc = dusted/(en-st)
callable5k[i,"dustpc"]<-dustpc
}
}
View(callable5k)
dusted
en
st
dustset
subset(dust,chr==mychr && en>=myst && st<myen)
myst
myen
subset(dust,chr==mychr & en>=myst & st<myen)
callable5k$dustpc <- 0
for (i in 1:dim(callable5k)[1]) {
mychr <- callable5k[i,1]
myst <- callable5k[i,2]
myen <- callable5k[i,3]
dustset <- subset(dust,chr==mychr & en>=myst & st<myen)
if (dim(dustset)[1]>0){
dusted <- sum(dustset$len)
olmin <- min(dustset$st)
olmax <- max(dustset$en)
if (olmin<st) {dusted<-dusted-(st-olmin)}
if (olmax>en) {dusted<-dusted-(olmax-en)}
dustpc = dusted/(en-st)
callable5k[i,"dustpc"]<-dustpc
}
}
View(callable5k)
i
dustset <- subset(dust,chr==mychr & en>=myst & st<myen)
dustset
dusted <- sum(dustset$len)
dusted
olmin <- min(dustset$st)
olmax <- max(dustset$en)
olmin
callable5k$dustpc <- 0
for (i in 1:dim(callable5k)[1]) {
mychr <- callable5k[i,1]
myst <- callable5k[i,2]
myen <- callable5k[i,3]
dustset <- subset(dust,chr==mychr & en>=myst & st<myen)
if (dim(dustset)[1]>0){
dusted <- sum(dustset$len)
olmin <- min(dustset$st)
olmax <- max(dustset$en)
if (olmin<st) {dusted<-dusted-(myst-olmin)}
if (olmax>en) {dusted<-dusted-(olmax-myen)}
dustpc = dusted/(en-st)
callable5k[i,"dustpc"]<-dustpc
}
}
head(callable5k)
View(callable5k)
call5kM <- melt(callable5k,id.vars = c("chr","st","en","accessible","dustpc"))
head(call5Km)
head(call5kM)
ggplot(subset(callable5k,chr=="05"),aes(xmin=st,xmax=en,ymin=0,ymax=1)) +
geom_rect(aes(fill=disco),colour="blue")) + scale_fill_manual(values=c("blue","orange","grey","#888888"))+
ggplot(subset(callable5k,chr=="05"),aes(xmin=st,xmax=en,ymin=0,ymax=1)) +
geom_rect(aes(fill=disco),colour="blue")) + scale_fill_manual(values=c("blue","orange","grey","#888888"))+
ggplot(subset(callable5k,chr=="05"),aes(xmin=st,xmax=en,ymin=0,ymax=1)) +
geom_rect(aes(fill=disco),colour="blue") + scale_fill_manual(values=c("blue","orange","grey","#888888"))+
geom_rect(data=chrlen,fill=NA,colour="black") +
facet_grid(variable ~ .)   + theme(axis.text.y = element_blank(),axis.ticks.y=element_blank(),legend.position="bottom") +
theme(panel.background = element_rect(fill='white'), panel.grid.major = element_blank(), panel.grid.minor = element_blank())
ggplot(subset(callable5k,chr=="05"),aes(xmin=st,xmax=en,ymin=0,ymax=1)) +
geom_rect(aes(fill=disco),colour=variable) + scale_fill_manual(values=c("blue","orange","grey","#888888"))+
geom_rect(data=chrlen,fill=NA,colour="black") +
facet_grid(variable ~ .)   + theme(axis.text.y = element_blank(),axis.ticks.y=element_blank(),legend.position="bottom") +
theme(panel.background = element_rect(fill='white'), panel.grid.major = element_blank(), panel.grid.minor = element_blank())
ggplot(subset(call5kM,chr=="05"),aes(xmin=st,xmax=en,ymin=0,ymax=1)) +
geom_rect(aes(fill=disco),colour=variable) + scale_fill_manual(values=c("blue","orange","grey","#888888"))+
geom_rect(data=chrlen,fill=NA,colour="black") +
facet_grid(variable ~ .)   + theme(axis.text.y = element_blank(),axis.ticks.y=element_blank(),legend.position="bottom") +
theme(panel.background = element_rect(fill='white'), panel.grid.major = element_blank(), panel.grid.minor = element_blank())
subset(call5kM,chr=="05")
ggplot(subset(call5kM,chr=="05"),aes(xmin=st,xmax=en,ymin=0,ymax=1)) +
geom_rect(aes(fill=disco),colour=variable) + scale_fill_manual(values=c("blue","orange","grey","#888888"))+
geom_rect(data=chrlen,fill=NA,colour="black") +
theme(panel.background = element_rect(fill='white'), panel.grid.major = element_blank(), panel.grid.minor = element_blank())
ggplot(subset(call5kM,chr=="05"),aes(xmin=st,xmax=en,ymin=0,ymax=1)) +
geom_rect(aes(fill=variable)) + scale_fill_manual(values=c("blue","orange","grey","#888888"))+
geom_rect(data=chrlen,fill=NA,colour="black") +
facet_grid(variable ~ .)   + theme(axis.text.y = element_blank(),axis.ticks.y=element_blank(),legend.position="bottom") +
theme(panel.background = element_rect(fill='white'), panel.grid.major = element_blank(), panel.grid.minor = element_blank())
ggplot(subset(call5kM,chr=="05"),aes(xmin=st,xmax=en,ymin=0,ymax=1)) +
geom_rect(aes(fill=variable)) + scale_fill_manual(values=c("blue","orange","grey","#888888"))+
geom_rect(data=subset(chrlen,chr=="05",fill=NA,colour="black") +
facet_grid(variable ~ .)   + theme(axis.text.y = element_blank(),axis.ticks.y=element_blank(),legend.position="bottom") +
theme(panel.background = element_rect(fill='white'), panel.grid.major = element_blank(), panel.grid.minor = element_blank())
ggplot(subset(call5kM,chr=="05"),aes(xmin=st,xmax=en,ymin=0,ymax=1)) +
geom_rect(aes(fill=variable)) + scale_fill_manual(values=c("blue","orange","grey","#888888"))+
geom_rect(data=subset(chrlen,chr=="05"),fill=NA,colour="black") +
facet_grid(variable ~ .)   + theme(axis.text.y = element_blank(),axis.ticks.y=element_blank(),legend.position="bottom") +
theme(panel.background = element_rect(fill='white'), panel.grid.major = element_blank(), panel.grid.minor = element_blank())
```
ggplot(subset(call5kM,chr=="05"),aes(xmin=st,xmax=en,ymin=0,ymax=1)) +
geom_rect(aes(fill=variable)) + scale_fill_manual(values=c("blue","orange","grey","#888888"))+
geom_rect(data=subset(chrlen,chr=="05"),fill=NA,colour="black") +
facet_grid(variable ~ .)   + theme(axis.text.y = element_blank(),axis.ticks.y=element_blank(),legend.position="bottom") +
theme(panel.background = element_rect(fill='white'), panel.grid.major = element_blank(), panel.grid.minor = element_blank())
ggplot(subset(call5kM,chr=="05"),aes(xmin=st,xmax=en,ymin=0,ymax=1)) +
geom_rect(aes(fill=value)) + scale_fill_manual(values=c("blue","orange","grey","#888888"))+
geom_rect(data=subset(chrlen,chr=="05"),fill=NA,colour="black") +
facet_grid(variable ~ .)   + theme(axis.text.y = element_blank(),axis.ticks.y=element_blank(),legend.position="bottom") +
theme(panel.background = element_rect(fill='white'), panel.grid.major = element_blank(), panel.grid.minor = element_blank())
ggplot(subset(call5kM,chr=="05",value==T),aes(xmin=st,xmax=en,ymin=0,ymax=1)) +
geom_rect(aes(fill=value)) + scale_fill_manual(values=c("blue","orange","grey","#888888"))+
geom_rect(data=subset(chrlen,chr=="05"),fill=NA,colour="black") +
facet_grid(variable ~ chr)   + theme(axis.text.y = element_blank(),axis.ticks.y=element_blank(),legend.position="bottom") +
theme(panel.background = element_rect(fill='white'), panel.grid.major = element_blank(), panel.grid.minor = element_blank())
ggplot(subset(call5kM,chr=="05" & value==T),aes(xmin=st,xmax=en,ymin=0,ymax=1)) +
geom_rect(aes(fill=value)) + scale_fill_manual(values=c("blue","orange","grey","#888888"))+
geom_rect(data=subset(chrlen,chr=="05"),fill=NA,colour="black") +
facet_grid(variable ~ chr)   + theme(axis.text.y = element_blank(),axis.ticks.y=element_blank(),legend.position="bottom") +
theme(panel.background = element_rect(fill='white'), panel.grid.major = element_blank(), panel.grid.minor = element_blank())
ggplot(subset(call5kM,chr=="05" & value==T),aes(xmin=st,xmax=en,ymin=0,ymax=1)) +
geom_rect(aes(fill=variable)) + scale_fill_manual(values=c("blue","orange","grey","#888888"))+
geom_rect(data=subset(chrlen,chr=="05"),fill=NA,colour="black") +
facet_grid(variable ~ chr)   + theme(axis.text.y = element_blank(),axis.ticks.y=element_blank(),legend.position="bottom") +
theme(panel.background = element_rect(fill='white'), panel.grid.major = element_blank(), panel.grid.minor = element_blank())
call5kM <- melt(callable5k,id.vars = c("chr","st","en","accessible","dustpc","telo"))
ggplot(subset(call5kM,chr=="05" & value==T),aes(xmin=st,xmax=en,ymin=0,ymax=1)) +
geom_rect(aes(fill=variable)) + scale_fill_manual(values=c("blue","orange","grey","#888888"))+
geom_rect(aes(fill=telo),colour="grey") +
geom_rect(data=subset(chrlen,chr=="05"),fill=NA,colour="black") +
facet_grid(variable ~ chr)   + theme(axis.text.y = element_blank(),axis.ticks.y=element_blank(),legend.position="bottom") +
theme(panel.background = element_rect(fill='white'), panel.grid.major = element_blank(), panel.grid.minor = element_blank())
ggplot(subset(call5kM,chr=="05" & value==T),aes(xmin=st,xmax=en,ymin=0,ymax=1)) +
geom_rect(aes(fill=telo),colour="grey") +
geom_rect(data=subset(chrlen,chr=="05"),fill=NA,colour="black") +
facet_grid(variable ~ chr)   + theme(axis.text.y = element_blank(),axis.ticks.y=element_blank(),legend.position="bottom") +
theme(panel.background = element_rect(fill='white'), panel.grid.major = element_blank(), panel.grid.minor = element_blank())
ggplot(subset(call5kM,chr=="05" & value==T),aes(xmin=st,xmax=en,ymin=0,ymax=1)) +
geom_rect(aes(fill=variable)) + scale_fill_manual(values=c("blue","orange","grey","#888888"))+
geom_rect(data=subset(chrlen,chr=="05"),fill=NA,colour="black") +
facet_grid(variable ~ chr)   + theme(axis.text.y = element_blank(),axis.ticks.y=element_blank(),legend.position="bottom") +
theme(panel.background = element_rect(fill='white'), panel.grid.major = element_blank(), panel.grid.minor = element_blank())
head(callable5K)
callable5k$accessible=F
callable5k$accessible[callable5k$disco & !callable5k$haplo] <- "DISCOVAR"
callable5k$accessible[callable5k$haplo & !callable5k$disco] <- "GATK"
callable5k$accessible[callable5k$haplo & callable5k$disco] <- NA
callable5k$accessible[!callable5k$disco & !callable5k$haplo] <- "INACCESSIBLE"
callable5k$accessible[!callable5k$disco & !callable5k$haplo & callable5k$telo] <- "INACCESSIBLE (TELOMERE)"
callable5k$accessible <- factor(callable5k$accessible,levels=c("DISCOVAR",
"GATK",
"INACCESSIBLE",
"INACCESSIBLE (TELOMERE)"
))
head(callable5k)
dust <- read.table("Pf3D7_v3.dust.bed.gz",col.names=c("chr","st","en"))
levels(dust$chr) <- c("MIT","01","02","03","04","05","06","07","08","09","10","11","12","13","14","API")
dust$len = dust$en-dust$st
callable5k$dustpc <- 0
#for (i in 1:20) {
for (i in 1:dim(callable5k)[1]) {
mychr <- callable5k[i,1]
myst <- callable5k[i,2]
myen <- callable5k[i,3]
dustset <- subset(dust,chr==mychr & en>=myst & st<myen)
if (dim(dustset)[1]>0){
dusted <- sum(dustset$len)
olmin <- min(dustset$st)
olmax <- max(dustset$en)
if (olmin<st) {dusted<-dusted-(myst-olmin)}
if (olmax>en) {dusted<-dusted-(olmax-myen)}
dustpc = dusted/(en-st)
callable5k[i,"dustpc"]<-dustpc
}
}
head(callable5k)
call5kM <- melt(callable5k,id.vars = c("chr","st","en","accessible","dustpc","telo"))
ggplot(subset(call5kM,chr=="05" & value==T),aes(xmin=st,xmax=en,ymin=0,ymax=1)) +
geom_rect(aes(fill=variable)) + scale_fill_manual(values=c("blue","orange","grey","#888888"))+
geom_rect(data=subset(chrlen,chr=="05"),fill=NA,colour="black") +
facet_grid(variable ~ chr)   + theme(axis.text.y = element_blank(),axis.ticks.y=element_blank(),legend.position="bottom") +
theme(panel.background = element_rect(fill='white'), panel.grid.major = element_blank(), panel.grid.minor = element_blank())
```
ggplot(subset(call5kM, value==T),aes(xmin=st,xmax=en,ymin=0,ymax=1)) +
geom_rect(aes(fill=variable)) + scale_fill_manual(values=c("blue","orange","grey","#888888"))+
geom_rect(data=chrlen,fill=NA,colour="black") +
facet_grid(variable ~ chr)   + theme(axis.text.y = element_blank(),axis.ticks.y=element_blank(),legend.position="bottom") +
theme(panel.background = element_rect(fill='white'), panel.grid.major = element_blank(), panel.grid.minor = element_blank())
```
ggplot(subset(call5kM, value==T),aes(xmin=st,xmax=en,ymin=0,ymax=1)) +
geom_rect(aes(fill=variable)) + scale_fill_manual(values=c("blue","orange","grey","#888888"))+
geom_rect(data=chrlen,fill=NA,colour="black") +
facet_grid(chr ~ variable)   + theme(axis.text.y = element_blank(),axis.ticks.y=element_blank(),legend.position="bottom") +
theme(panel.background = element_rect(fill='white'), panel.grid.major = element_blank(), panel.grid.minor = element_blank())
ggplot(callable5k,aes(xmin=st,xmax=en,ymin=0,ymax=1)) +
ggtitle(paste("callable regions (5kb windows)")) +
geom_rect(aes(fill=accessible,colour=accessible)) + scale_fill_manual(values=c("blue","orange","grey","#888888"))+ scale_colour_manual(values=c("blue","orange","grey","#888888"))+
geom_rect(data=chrlen,fill=NA,colour="black") +
facet_grid(chr ~ .)   + theme(axis.text.y = element_blank(),axis.ticks.y=element_blank(),legend.position="bottom") +
theme(panel.background = element_rect(fill='white'), panel.grid.major = element_blank(), panel.grid.minor = element_blank())
ggplot(subset(callable5k,chr==mychr),aes(xmin=st,xmax=en,ymin=0,ymax=1)) +
ggtitle(paste("callable regions (5kb windows)")) +
geom_rect(aes(fill=accessible,colour=accessible)) + scale_fill_manual(values=c("blue","orange","grey","#888888"))+ scale_colour_manual(values=c("blue","orange","grey","#888888"))+
geom_rect(data=chrlen,fill=NA,colour="black") +
facet_grid(chr ~ .)   + theme(axis.text.y = element_blank(),axis.ticks.y=element_blank(),legend.position="bottom") +
theme(panel.background = element_rect(fill='white'), panel.grid.major = element_blank(), panel.grid.minor = element_blank())
ggplot(subset(callable5k,chr==mychr),aes(xmin=st,xmax=en,ymin=0,ymax=1)) +
ggtitle(paste("callable regions (5kb windows)")) +
geom_rect(aes(fill=accessible,colour=accessible)) + scale_fill_manual(values=c("blue","orange","grey","#888888"))+ scale_colour_manual(values=c("blue","orange","grey","#888888"))+
geom_rect(data=subset(chrlen,chr==mychr),fill=NA,colour="black") +
facet_grid(chr ~ .)   + theme(axis.text.y = element_blank(),axis.ticks.y=element_blank(),legend.position="bottom") +
theme(panel.background = element_rect(fill='white'), panel.grid.major = element_blank(), panel.grid.minor = element_blank())
ggplot(subset(callable5k,chr==mychr),aes(xmin=st,xmax=en,ymin=0,ymax=1)) +
ggtitle(paste("callable regions (5kb windows)")) +
geom_rect(aes(fill=accessible,colour=accessible)) + scale_fill_manual(values=c("blue","orange","grey","#888888"))+ scale_colour_manual(values=c("blue","orange","grey","#888888"))+
geom_rect(data=subset(chrlen,chr==mychr),fill=NA,colour="black") +
theme(axis.text.y = element_blank(),axis.ticks.y=element_blank(),legend.position="bottom") +
theme(panel.background = element_rect(fill='white'), panel.grid.major = element_blank(), panel.grid.minor = element_blank())
callable5k$pos<-callable5k$st+(callable5k$en-callable5k$st)
ggplot(subset(callable5k,chr==mychr),aes(x=pos,y=dust)) +
geom_line()
ggplot(subset(callable5k,chr==mychr),aes(x=pos,y=dustpc)) +
geom_line()
accgr <- ggplot(subset(callable5k,chr==mychr),aes(xmin=st,xmax=en,ymin=0,ymax=1)) +
ggtitle(paste("callable regions (5kb windows)")) +
geom_rect(aes(fill=accessible,colour=accessible)) + scale_fill_manual(values=c("blue","orange","grey","#888888"))+ scale_colour_manual(values=c("blue","orange","grey","#888888"))+
geom_rect(data=subset(chrlen,chr==mychr),fill=NA,colour="black") +
theme(axis.text.y = element_blank(),axis.ticks.y=element_blank(),legend.position="bottom") +
theme(panel.background = element_rect(fill='white'), panel.grid.major = element_blank(), panel.grid.minor = element_blank())
dustgr <- ggplot(subset(callable5k,chr==mychr),aes(x=pos,y=dustpc)) +
geom_line()
grid.arrange(dustgr, accgr, ncol=1,widths=c(1),heights=c(2,8))
grid.arrange(dustgr, accgr, ncol=1,widths=c(1),heights=c(4,6))
accgr <- ggplot(subset(callable5k,chr==mychr),aes(xmin=st,xmax=en,ymin=0,ymax=1)) +
geom_rect(aes(fill=accessible,colour=accessible)) + scale_fill_manual(values=c("blue","orange","grey","#888888"))+ scale_colour_manual(values=c("blue","orange","grey","#888888"))+
geom_rect(data=subset(chrlen,chr==mychr),fill=NA,colour="black") +
theme(axis.text.y = element_blank(),axis.ticks.y=element_blank(),legend.position="bottom") +
theme(panel.background = element_rect(fill='white'), panel.grid.major = element_blank(), panel.grid.minor = element_blank())
dustgr <- ggplot(subset(callable5k,chr==mychr),aes(x=pos,y=dustpc)) +
geom_line()
dustgr <- ggplot(subset(callable5k,chr==mychr),aes(x=pos,y=dustpc)) +
geom_line()+
theme(axis.text.x = element_blank(),axis.ticks.x=element_blank()) +
grid.arrange(dustgr, accgr, ncol=1,widths=c(1),heights=c(4,6))
dustgr <- ggplot(subset(callable5k,chr==mychr),aes(x=pos,y=dustpc)) +
geom_line()+
theme(axis.text.x = element_blank(),axis.ticks.x=element_blank()) +
theme(axis.text.x = element_blank(),axis.ticks.x=element_blank())
dustgr <- ggplot(subset(callable5k,chr==mychr),aes(x=pos,y=dustpc)) +
geom_line()+
theme(axis.text.x = element_blank(),axis.ticks.x=element_blank())
grid.arrange(dustgr, accgr, ncol=1,widths=c(1),heights=c(4,6))
dustgr <- ggplot(subset(callable5k,chr==mychr),aes(x=pos,y=dustpc)) +
geom_line()+
theme(axis.text.x = element_blank(),axis.ticks.x=element_blank(),axis.label.x=element_blank())
dustgr <- ggplot(subset(callable5k,chr==mychr),aes(x=pos,y=dustpc)) +
geom_line()+xlab("")+
theme(axis.text.x = element_blank(),axis.ticks.x=element_blank())
grid.arrange(dustgr, accgr, ncol=1,widths=c(1),heights=c(4,6))
dustgr <- ggplot(subset(callable5k,chr==mychr),aes(x=pos,y=dustpc)) +
geom_line()+xlab("")+ylab("repeat content")+
theme(axis.text.x = element_blank(),axis.ticks.x=element_blank())
grid.arrange(dustgr, accgr, ncol=1,widths=c(1),heights=c(4,6))
ggplot(subset(call5kM, value==T),aes(xmin=st,xmax=en,ymin=0,ymax=1)) +
geom_rect(aes(fill=variable)) + scale_fill_manual(values=c("blue","orange","grey","#888888"))+
geom_rect(data=chrlen,fill=NA,colour="black") +
facet_grid(chr ~ variable)   + theme(axis.text.y = element_blank(),axis.ticks.y=element_blank(),legend.position="bottom") +
theme(panel.background = element_rect(fill='white'), panel.grid.major = element_blank(), panel.grid.minor = element_blank())
mychr="07"
callable5k$pos<-callable5k$st+(callable5k$en-callable5k$st)
accgr <- ggplot(subset(callable5k,chr==mychr),aes(xmin=st,xmax=en,ymin=0,ymax=1)) +
geom_rect(aes(fill=accessible,colour=accessible)) + scale_fill_manual(values=c("blue","orange","grey","#888888"))+ scale_colour_manual(values=c("blue","orange","grey","#888888"))+
geom_rect(data=subset(chrlen,chr==mychr),fill=NA,colour="black") +
theme(axis.text.y = element_blank(),axis.ticks.y=element_blank(),legend.position="bottom") +
theme(panel.background = element_rect(fill='white'), panel.grid.major = element_blank(), panel.grid.minor = element_blank())
dustgr <- ggplot(subset(callable5k,chr==mychr),aes(x=pos,y=dustpc)) +
geom_line()+xlab("")+ylab("repeat content")+
theme(axis.text.x = element_blank(),axis.ticks.x=element_blank())
grid.arrange(dustgr, accgr, ncol=1,widths=c(1),heights=c(4,6))
ggplot(subset(call5kM, chr==mychr & value==T),aes(xmin=st,xmax=en,ymin=0,ymax=1)) +
geom_rect(aes(fill=variable)) + scale_fill_manual(values=c("blue","orange","grey","#888888"))+
geom_rect(data=subset(chrlen,chr==mychr),fill=NA,colour="black") +
facet_grid(chr ~ variable)   + theme(axis.text.y = element_blank(),axis.ticks.y=element_blank(),legend.position="bottom") +
theme(panel.background = element_rect(fill='white'), panel.grid.major = element_blank(), panel.grid.minor = element_blank())
accgrsep <- ggplot(subset(call5kM, chr==mychr & value==T),aes(xmin=st,xmax=en,ymin=0,ymax=1)) +
geom_rect(aes(fill=variable)) + scale_fill_manual(values=c("blue","orange","grey","#888888"))+
geom_rect(data=subset(chrlen,chr==mychr),fill=NA,colour="black") +
facet_grid(chr ~ variable)   + theme(axis.text.y = element_blank(),axis.ticks.y=element_blank(),legend.position="bottom") +
theme(panel.background = element_rect(fill='white'), panel.grid.major = element_blank(), panel.grid.minor = element_blank())
dustgr <- ggplot(subset(callable5k,chr==mychr),aes(x=pos,y=dustpc)) +
geom_line()+xlab("")+ylab("repeat content")+
theme(axis.text.x = element_blank(),axis.ticks.x=element_blank())
grid.arrange(dustgr, accgr, accgrsep,ncol=1,widths=c(1),heights=c(2,3,5))
accgrsep <- ggplot(subset(call5kM, chr==mychr & value==T),aes(xmin=st,xmax=en,ymin=0,ymax=1)) +
geom_rect(aes(fill=variable)) + scale_fill_manual(values=c("blue","orange","grey","#888888"))+
geom_rect(data=subset(chrlen,chr==mychr),fill=NA,colour="black") +
facet_grid(variable ~ .)   + theme(axis.text.y = element_blank(),axis.ticks.y=element_blank(),legend.position="bottom") +
theme(panel.background = element_rect(fill='white'), panel.grid.major = element_blank(), panel.grid.minor = element_blank())
dustgr <- ggplot(subset(callable5k,chr==mychr),aes(x=pos,y=dustpc)) +
geom_line()+xlab("")+ylab("repeat content")+
theme(axis.text.x = element_blank(),axis.ticks.x=element_blank())
grid.arrange(dustgr, accgr, accgrsep,ncol=1,widths=c(1),heights=c(2,3,5))
accgrsep <- ggplot(subset(call5kM, chr==mychr & value==T),aes(xmin=st,xmax=en,ymin=0,ymax=1)) +
geom_rect(aes(fill=variable)) + scale_fill_manual(values=c("blue","orange","grey","#888888"))+
geom_rect(data=subset(chrlen,chr==mychr),fill=NA,colour="black") +
facet_grid(variable ~ .)   + theme(axis.text.y = element_blank(),axis.ticks.y=element_blank(),legend.position="none") +
theme(panel.background = element_rect(fill='white'), panel.grid.major = element_blank(), panel.grid.minor = element_blank())
dustgr <- ggplot(subset(callable5k,chr==mychr),aes(x=pos,y=dustpc)) +
geom_line()+xlab("")+ylab("repeat content")+
theme(axis.text.x = element_blank(),axis.ticks.x=element_blank())
grid.arrange(dustgr, accgr, accgrsep,ncol=1,widths=c(1),heights=c(2,3,5))
grid.arrange(dustgr, accgrsep,accgr, ncol=1,widths=c(1),heights=c(2,3,5))
grid.arrange(dustgr, accgrsep,accgr, ncol=1,widths=c(1),heights=c(3,2,5))
grid.arrange(dustgr, accgrsep,accgr, ncol=1,widths=c(1),heights=c(3,3,4))
grid.arrange(dustgr, accgrsep,accgr, ncol=1,widths=c(1),heights=c(3,3,2))
accgrsep <- ggplot(subset(call5kM, chr==mychr & value==T),aes(xmin=st,xmax=en,ymin=0,ymax=1)) +
geom_rect(aes(fill=variable)) + scale_fill_manual(values=c("blue","orange","grey","#888888"))+
geom_rect(data=subset(chrlen,chr==mychr),fill=NA,colour="black") +
facet_grid(variable ~ .)   + theme(axis.text.y = element_blank(),axis.ticks.y=element_blank(),legend.position="none") +
theme(panel.background = element_rect(fill='white'), panel.grid.major = element_blank(),strip.text.y = element_blank(), panel.grid.minor = element_blank())
dustgr <- ggplot(subset(callable5k,chr==mychr),aes(x=pos,y=dustpc)) +
geom_line()+xlab("")+ylab("repeat content")+
theme(axis.text.x = element_blank(),axis.ticks.x=element_blank())
grid.arrange(dustgr, accgrsep,accgr, ncol=1,widths=c(1),heights=c(3,3,2))
dustgr <- ggplot(subset(callable5k,chr==mychr),aes(x=pos,y=dustpc)) +
geom_line()+xlab("")+ylab("repeat content")+xlim(0,1.5e6)+
theme(axis.text.x = element_blank(),axis.ticks.x=element_blank())
grid.arrange(dustgr, accgrsep,accgr, ncol=1,widths=c(1),heights=c(3,3,2))
dustgr <- ggplot(subset(callable5k,chr==mychr),aes(x=pos,y=dustpc)) +
geom_line()+xlab("")+ylab("repeat content")+xlim(0,1.5e6)
grid.arrange(dustgr, accgrsep,accgr, ncol=1,widths=c(1),heights=c(3,3,2))
knit("compare_callable_genomes.Rmd")
accgrsep <- ggplot(subset(call5kM, chr==mychr & value==T),aes(xmin=st,xmax=en,ymin=0,ymax=1)) +
geom_rect(aes(fill=variable)) + scale_fill_manual(values=c("blue","orange","grey","#888888"))+
geom_rect(data=subset(chrlen,chr==mychr),fill=NA,colour="black") +
facet_grid(variable ~ .)   + theme(axis.text.y = element_blank(),axis.ticks.y=element_blank(),legend.position="none") +
theme(panel.background = element_rect(fill='white'), panel.grid.major = element_blank(),strip.text.y = element_blank(), panel.grid.minor = element_blank())
dustgr <- ggplot(subset(callable5k,chr==mychr),aes(x=pos,y=dustpc)) +
geom_line()+xlab("")+ylab("repeat content")+xlim(0,1.5e6)+
theme(axis.text.x = element_blank(),axis.ticks.x=element_blank())
grid.arrange(dustgr, accgrsep,accgr, ncol=1,widths=c(1),heights=c(3,3,2))
dustgr <- ggplot(subset(callable5k,chr==mychr),aes(x=pos,y=dustpc)) +
geom_line()+xlab("")+ylab("repeat content")+xlim(0,1.5e6)+
theme(axis.ticks.x=element_blank())
grid.arrange(dustgr, accgrsep,accgr, ncol=1,widths=c(1),heights=c(3,3,2))
dustgr <- ggplot(subset(callable5k,chr==mychr),aes(x=pos,y=dustpc)) +
geom_line()+xlab("")+ylab("repeat content")+xlim(0,1.5e6)+
theme(axis.ticks.x=element_blank(),panel.background = element_rect(fill='white'), panel.grid.major = element_blank(), panel.grid.minor = element_blank())
grid.arrange(dustgr, accgrsep,accgr, ncol=1,widths=c(1),heights=c(3,3,2))
dustgr <- ggplot(subset(callable5k,chr==mychr),aes(x=pos,y=dustpc)) +
geom_line()+xlab("")+ylab("repeat content")+xlim(0,1.5e6)+
theme(axis.text.x=element_blank(),panel.background = element_rect(fill='white'), panel.grid.major = element_blank(), panel.grid.minor = element_blank())
grid.arrange(dustgr, accgrsep,accgr, ncol=1,widths=c(1),heights=c(3,3,2))
dustgr <- ggplot(subset(callable5k,chr==mychr),aes(x=pos,y=dustpc)) +
geom_line()+xlab("")+ylab("repeat content")+xlim(0,1.5e6)+
theme(axis.text.x=element_blank())
grid.arrange(dustgr, accgrsep,accgr, ncol=1,widths=c(1),heights=c(3,3,2))
knit("compare_callable_WG_plot.Rmd")
knit("compare_callable_WG_plot.Rmd")
opts_chunk$set(fig.width=12, fig.height=7, fig.path="figure/chrs-")
opts_chunk$set(dev=c('png','postscript'))
knit("compare_callable_WG_plot.Rmd")
knit("compare_callable_WG_plot.Rmd")
knit("compare_callable_genomes.Rmd")
