thies <- get_map(location=c(min(gpspos[,1])-b,min(gpspos[,2])-b,max(gpspos[,1])-b,max(gpspos[,2]-b)),zoom=12,maptype = "roadmap")
ggmap(thies)
thies <- get_map(location=c(min(gpspos[,2])-b,min(gpspos[,1])-b,max(gpspos[,2])-b,max(gpspos[,1]-b)),zoom=12,maptype = "roadmap")
ggmap(thies)
ggmap(thies)+
geom_point(data=igf[is.na(igf$weight),], aes(x = lon, y = lat), size=2) +
geom_text(data=igf[is.na(igf$weight),],aes(label = vertex.names)) +
geom_edges(data = igf[!is.na(igf$weight),],aes(x = lon, y = lat, xend = lonend, yend = latend),arrow=arrow(length = unit(6, "pt"), type = "closed"),colour="black") +
theme_blank()
igf
igf <- fortify(netAllVars)
igf$vertex.names <- as.character(igf$name)
igf$vertex.names[1:10] <- inds
igf$lat <- gpspos[,2]
igf$lon <- gpspos[,1]
igf
igf$latend[!is.na(igf$weight)] <- igf$lat[!is.na(igf$weight)]
igf$lonend[!is.na(igf$weight)] <- igf$lon[!is.na(igf$weight)]
library(ggmap)
b=0.0
thies <- get_map(location=c(min(gpspos[,2])-b,min(gpspos[,1])-b,max(gpspos[,2])-b,max(gpspos[,1]-b)),zoom=12,maptype = "roadmap")
ggmap(thies)
ggmap(thies)+
geom_point(data=igf[is.na(igf$weight),], aes(x = lon, y = lat), size=2) +
geom_text(data=igf[is.na(igf$weight),],aes(label = vertex.names)) +
geom_edges(data = igf[!is.na(igf$weight),],aes(x = lon, y = lat, xend = lonend, yend = latend),arrow=arrow(length = unit(6, "pt"), type = "closed"),colour="black") +
theme_blank()
ggmap(thies)+
geom_point(data=igf[is.na(igf$weight),], aes(x = lon, y = lat), size=2) +
geom_text(data=igf[is.na(igf$weight),],aes(label = vertex.names)) +
geom_edge(data = igf[!is.na(igf$weight),],aes(x = lon, y = lat, xend = lonend, yend = latend),arrow=arrow(length = unit(6, "pt"), type = "closed"),colour="black") +
theme_blank()
library(ggnetwork)
ggmap(thies)+
geom_point(data=igf[is.na(igf$weight),], aes(x = lon, y = lat), size=2) +
geom_text(data=igf[is.na(igf$weight),],aes(label = vertex.names)) +
geom_edges(data = igf[!is.na(igf$weight),],aes(x = lon, y = lat, xend = lonend, yend = latend),arrow=arrow(length = unit(6, "pt"), type = "closed"),colour="black") +
theme_blank()
igf
gpspos[na.omit(netAllVars$ances),2]
igf$latend[!is.na(igf$weight)] <- gpspos[na.omit(netAllVars$ances),2]
igf$lonend[!is.na(igf$weight)] <- gpspos[na.omit(netAllVars$ances),1]
ggmap(thies)+
geom_point(data=igf[is.na(igf$weight),], aes(x = lon, y = lat), size=2) +
geom_text(data=igf[is.na(igf$weight),],aes(label = vertex.names)) +
geom_edges(data = igf[!is.na(igf$weight),],aes(x = lon, y = lat, xend = lonend, yend = latend),arrow=arrow(length = unit(6, "pt"), type = "closed"),colour="black") +
theme_blank()
igf$lat <- gpspos[,1]
igf$lon <- gpspos[,2]
igf$latend[!is.na(igf$weight)] <- gpspos[na.omit(netAllVars$ances),1]
igf$lonend[!is.na(igf$weight)] <- gpspos[na.omit(netAllVars$ances),2]
igf
thies <- get_map(location=c(min(gpspos[,2])-b,min(gpspos[,1])-b,max(gpspos[,2])-b,max(gpspos[,1]-b)),zoom=12,maptype = "roadmap")
ggmap(thies)
ggmap(thies)+
geom_point(data=igf[is.na(igf$weight),], aes(x = lon, y = lat), size=2) +
geom_text(data=igf[is.na(igf$weight),],aes(label = vertex.names)) +
geom_edges(data = igf[!is.na(igf$weight),],aes(x = lon, y = lat, xend = lonend, yend = latend),arrow=arrow(length = unit(6, "pt"), type = "closed"),colour="black") +
theme_blank()
ggmap(thies)+
geom_point(data=igf[is.na(igf$weight),], aes(x = lon, y = lat), size=2) +
geom_text(data=igf[is.na(igf$weight),],aes(label = name)) +
geom_edges(data = igf[!is.na(igf$weight),],aes(x = lon, y = lat, xend = lonend, yend = latend),arrow=arrow(length = unit(6, "pt"), type = "closed"),colour="black") +
theme_blank()
igf[is.na(igf$weight),]
ggmap(thies)+
geom_point(data=igf[is.na(igf$weight),], aes(x = lon, y = lat), size=2) +
geom_text(data=igf,aes(label = name)) +
geom_edges(data = igf[!is.na(igf$weight),],aes(x = lon, y = lat, xend = lonend, yend = latend),arrow=arrow(length = unit(6, "pt"), type = "closed"),colour="black") +
theme_blank()
igf <- fortify(netAllVars)
igf$vertex.names <- as.character(igf$name)
igf$vertex.names[1:10] <- inds
igf$lat[!is.na(igf$weight)] <- gpspos[na.omit(netAllVars$ances),1]
igf$lon[!is.na(igf$weight)] <- gpspos[na.omit(netAllVars$ances),2]
igf$latend <- gpspos[,1]
igf$lonend <- gpspos[,2]
igf
igf$latend <- gpspos[,1]
igf$lonend <- gpspos[,2]
igf$lat[!is.na(igf$weight)] <- gpspos[na.omit(netAllVars$ances),1]
igf$lon[!is.na(igf$weight)] <- gpspos[na.omit(netAllVars$ances),2]
igf <- fortify(netAllVars)
igf$vertex.names <- as.character(igf$name)
igf$vertex.names[1:10] <- inds
igf$latend <- gpspos[,1]
igf$lonend <- gpspos[,2]
igf$lat[!is.na(igf$weight)] <- gpspos[na.omit(netAllVars$ances),1]
igf$lon[!is.na(igf$weight)] <- gpspos[na.omit(netAllVars$ances),2]
igf
library(ggmap)
b=0.0
thies <- get_map(location=c(min(gpspos[,2])-b,min(gpspos[,1])-b,max(gpspos[,2])-b,max(gpspos[,1]-b)),zoom=12,maptype = "roadmap")
ggmap(thies)
ggmap(thies)+
geom_point(data=igf[is.na(igf$weight),], aes(x = lon, y = lat), size=2) +
geom_text(data=igf,aes(label = name)) +
geom_edges(data = igf[!is.na(igf$weight),],aes(x = lon, y = lat, xend = lonend, yend = latend),arrow=arrow(length = unit(6, "pt"), type = "closed"),colour="black") +
theme_blank()
ggmap(thies)+
geom_label(data=igf[is.na(igf$weight),],aes(x = lon, y = lat, label = vertex.names),fontface = "bold") +
geom_edges(data = igf[!is.na(igf$weight),],aes(x = lon, y = lat, xend = lonend, yend = latend),arrow=arrow(length = unit(6, "pt"), type = "closed"),colour="black") +
theme_blank()
ggmap(thies)+
geom_point(data=igf[is.na(igf$weight),], aes(x = lon, y = lat), size=2) +
geom_text(data=igf,aes(label = name)) +
geom_edges(data = igf[!is.na(igf$weight),],aes(x = lon, y = lat, xend = lonend, yend = latend),arrow=arrow(length = unit(6, "pt"), type = "closed"),colour="black") +
theme_blank()
igf
ggmap(thies)+
geom_point(data=igf, aes(x = lon, y = lat), size=2) +
geom_text(data=igf,aes(label = name)) +
geom_edges(data = igf[!is.na(igf$weight),],aes(x = lon, y = lat, xend = lonend, yend = latend),arrow=arrow(length = unit(6, "pt"), type = "closed"),colour="black") +
theme_blank()
igf <- fortify(netAllVars)
igf$vertex.names <- as.character(igf$name)
igf$vertex.names[1:10] <- inds
igf$latend <- gpspos[,1]
igf$lonend <- gpspos[,2]
igf$lat[!is.na(igf$weight)] <- gpspos[na.omit(netAllVars$ances),1]
igf$lon[!is.na(igf$weight)] <- gpspos[na.omit(netAllVars$ances),2]
igf
igf <- fortify(netAllVars)
igf$vertex.names <- as.character(igf$name)
igf$vertex.names[1:10] <- inds
igf$lat <- gpspos[,1]
igf$lon <- gpspos[,2]
igf$latend[!is.na(igf$weight)] <- gpspos[na.omit(netAllVars$ances),1]
igf$lonend[!is.na(igf$weight)] <- gpspos[na.omit(netAllVars$ances),2]
igf
library(ggmap)
b=0.0
thies <- get_map(location=c(min(gpspos[,2])-b,min(gpspos[,1])-b,max(gpspos[,2])-b,max(gpspos[,1]-b)),zoom=12,maptype = "roadmap")
ggmap(thies)
ggmap(thies)+
geom_point(data=igf, aes(x = lon, y = lat), size=2) +
geom_text(data=igf,aes(label = name)) +
geom_edges(data = igf[!is.na(igf$weight),],aes(x = lon, y = lat, xend = lonend, yend = latend),arrow=arrow(length = unit(6, "pt"), type = "closed"),colour="black") +
theme_blank()
ggmap(thies)+
geom_point(data=igf, aes(x = lon, y = lat), size=2) +
geom_text(data=igf,aes(label = name)) +
geom_edges(data = igf[!is.na(igf$weight),],aes(x = lonend, y = latend, xend = lon, yend = lat),arrow=arrow(length = unit(6, "pt"), type = "closed"),colour="black") +
theme_blank()
ggmap(thies)+
geom_label(data=igf[is.na(igf$weight),],aes(x = lon, y = lat, label = vertex.names),fontface = "bold") +
geom_edges(data = igf[!is.na(igf$weight),],aes(x = lon, y = lat, xend = lonend, yend = latend),arrow=arrow(length = unit(6, "pt"), type = "closed"),colour="black") +
theme_blank()
ggmap(thies)+
geom_label(data=igf[is.na(igf$weight),],aes(x = lon, y = lat, label = vertex.names),fontface = "bold") +
geom_edges(data = igf[!is.na(igf$weight),],aes(x = lonend, y = latend, xend = lon, yend = lat),arrow=arrow(length = unit(6, "pt"), type = "closed"),colour="black") +
theme_blank()
ggmap(thies)+
geom_label(data=igf,aes(x = lon, y = lat, label = vertex.names),fontface = "bold") +
geom_edges(data = igf[!is.na(igf$weight),],aes(x = lonend, y = latend, xend = lon, yend = lat),arrow=arrow(length = unit(6, "pt"), type = "closed"),colour="black") +
theme_blank()
knit("seqtrack_geo.Rmd")
meta <- read.table("Thies_metadata_1701.txt",sep="\t",header=T)
colnames(meta)[1]<-"name"
meta <- meta[meta$name %in% inds,]
row.names(meta) <- inds
meta$Date <- as.Date(as.character(meta$Date),"%d/%m/%Y",origin = "2000-01-01")
net <- netAllVars
net$type = "core"
net$boot = 0
ig <- as.igraph(net)
V(ig)$name <- netAllVars$name
V(ig)$color <- cols[netAllVars$year-min(netAllVars$year)+1]
V(ig)$label.cex <- ts
E(ig)$lty <- as.numeric(factor(net$type,levels=c("core","boot"))[2:15])
E(ig)$label <- paste(net$weight,(net$boot/100),sep="/")[2:15]
V(ig)$label.cex <- ts
E(ig)$label <- paste(net$weight,(net$boot/100),sep="/")[2:15]
meta <- read.table("Thies_metadata_1701.txt",sep="\t",header=T)
colnames(meta)[1]<-"name"
meta <- meta[meta$name %in% inds,]
row.names(meta) <- inds
meta$Date <- as.Date(as.character(meta$Date),"%d/%m/%Y",origin = "2000-01-01")
net <- netAllVars
net$type = "core"
net$boot = 0
meta$GPS <- as.character(meta$GPS)
meanLat <- mean(as.numeric(t(as.data.frame(strsplit(meta$GPS,", ")[3:10]))[,1]))
meanLon <- mean(as.numeric(t(as.data.frame(strsplit(meta$GPS,", ")[3:10]))[,2]))
maxLat <- max(as.numeric(t(as.data.frame(strsplit(meta$GPS,", ")[3:10]))[,1]))
medianLon <- median(as.numeric(t(as.data.frame(strsplit(meta$GPS,", ")[3:10]))[,2]))
meta$GPS[1] <- paste(maxLat+0.02,medianLon+0.01,sep=", ")
meta$GPS[2] <- paste(maxLat+0.02,medianLon-0.01,sep=", ")
gpspos <- matrix(as.numeric(t(as.data.frame(strsplit(meta$GPS,", ")))),ncol = 2)
gpspos <- gpspos[,c(2,1)]
gpscurves <- rep(0,14)
gpscurves[c(2,5)] <- c(+0.2,0)
plot.new()
plot(ig,layout=gpspos,vertex.size=5,
edge.curved=gpscurves,edge.width=as.numeric(factor(net$type,levels=c("boot","core"))[2:15]),
edge.label.cex=1,edge.label.family="Arial",vertex.label.family="Arial",edge.label=NA)
igW <- igA
E(igW)$weight <- 1
gdists <- distances(igW)
distdist <- data.frame(from=character(),
to=character(),
graphdist=integer(),
geodist=numeric(),
stringsAsFactors=F)
igW <- igA
E(igW)$weight <- 1
gdists <- distances(igW)
distdist <- data.frame(from=character(),
to=character(),
graphdist=integer(),
geodist=numeric(),
stringsAsFactors=F)
for (i in c(2:10)) {
for (j in c(i:10)) {
if (i != j) {
di <- dim(distdist)[[1]]+1
dist = sqrt(abs(gpspos[i,1]-gpspos[j,1])**2+abs(gpspos[i,2]-gpspos[j,2])**2)
write(paste(inds[i],inds[j],gdists[i,j],dist),stderr())
distdist[di,c(1:2)] <- c(inds[i],inds[j])
distdist[di,c(3:4)] <- c(gdists[i,j],dist)
}
}
}
opts_chunk$set(fig.width=18, fig.height=18)
opts_chunk$set(dev=c('png','postscript'))
ggmap(thies)
igA <- as.igraph(netAllVars)
E(igA)$latend <- gpspos[2:10,2]
E(igA)$lonend <- gpspos[2:10,1]
E(igA)$lat <- gpspos[na.omit(netAllVars$ances),2]
E(igA)$lon <- gpspos[na.omit(netAllVars$ances),1]
igf <- fortify(netAllVars)
igf$vertex.names <- as.character(igf$name)
igf$vertex.names[1:10] <- inds
igf$lat <- gpspos[,1]
igf$lon <- gpspos[,2]
igf$latend[!is.na(igf$weight)] <- gpspos[na.omit(netAllVars$ances),1]
igf$lonend[!is.na(igf$weight)] <- gpspos[na.omit(netAllVars$ances),2]
igf
library(ggmap)
b=0.0
thies <- get_map(location=c(min(gpspos[,2])-b,min(gpspos[,1])-b,max(gpspos[,2])-b,max(gpspos[,1]-b)),zoom=12,maptype = "roadmap")
ggmap(thies)
ggmap(thies)
igA <- as.igraph(netAllVars)
E(igA)$latend <- gpspos[2:10,2]
E(igA)$lonend <- gpspos[2:10,1]
E(igA)$lat <- gpspos[na.omit(netAllVars$ances),2]
E(igA)$lon <- gpspos[na.omit(netAllVars$ances),1]
igf <- fortify(netAllVars)
igf$vertex.names <- as.character(igf$name)
igf$vertex.names[1:10] <- inds
igf$lat <- gpspos[,1]
igf$lon <- gpspos[,2]
igf$latend[!is.na(igf$weight)] <- gpspos[na.omit(netAllVars$ances),1]
igf$lonend[!is.na(igf$weight)] <- gpspos[na.omit(netAllVars$ances),2]
igf
library(ggmap)
b=0.0
thies <- get_map(location=c(min(gpspos[,2])-b,min(gpspos[,1])-b,max(gpspos[,2])-b,max(gpspos[,1]-b)),zoom=12,maptype = "roadmap")
ggmap(thies)
meta$GPS
ggmap(thies)
igA <- as.igraph(netAllVars)
E(igA)$latend <- gpspos[2:10,2]
E(igA)$lonend <- gpspos[2:10,1]
E(igA)$lat <- gpspos[na.omit(netAllVars$ances),2]
E(igA)$lon <- gpspos[na.omit(netAllVars$ances),1]
igf <- fortify(netAllVars)
igf$vertex.names <- as.character(igf$name)
igf$vertex.names[1:10] <- inds
igf$lat <- gpspos[,2]
igf$lon <- gpspos[,1]
igf$latend[!is.na(igf$weight)] <- gpspos[na.omit(netAllVars$ances),2]
igf$lonend[!is.na(igf$weight)] <- gpspos[na.omit(netAllVars$ances),1]
igf
library(ggmap)
b=0.0
thies <- get_map(location=c(min(gpspos[,2])-b,min(gpspos[,1])-b,max(gpspos[,2])-b,max(gpspos[,1]-b)),zoom=12,maptype = "roadmap")
ggmap(thies)
knit("seqtrack_geo.Rmd")
knit("seqtrack_geo.Rmd")
thies <- get_map(location=c(min(gpspos[,1])-b,min(gpspos[,2])-b,max(gpspos[,1])-b,max(gpspos[,2]-b)),zoom=12,maptype = "roadmap")
ggmap(thies)
knit("seqtrack_geo.Rmd")
knit("seqtrack_geo.Rmd")
ggmap(thies)+
geom_point(data=igf, aes(x = lon, y = lat), size=2) +
geom_text(data=igf,aes(label = name), size=4) +
geom_edges(data = igf[!is.na(igf$weight),],aes(x = lonend, y = latend, xend = lon, yend = lat),arrow=arrow(length = unit(6, "pt"), type = "closed"),colour="black") +
theme_blank()
ggmap(thies)+
geom_point(data=igf, aes(x = lon, y = lat), size=2) +
geom_text(data=igf,aes(label = name), size=6) +
geom_edges(data = igf[!is.na(igf$weight),],aes(x = lonend, y = latend, xend = lon, yend = lat),arrow=arrow(length = unit(6, "pt"), type = "closed"),colour="black") +
theme_blank()
knit("seqtrack_geo.Rmd")
knit("seqtrack_geo.Rmd")
knit("seqtrack_geo.Rmd")
knit("seqtrack_geo.Rmd")
knit("seqtrack_geo.Rmd")
gpspos[,c(2,1)]
knit("seqtrack_geo.Rmd")
?get_map
thies <- get_map(location=c(min(gpspos[,1])-b,min(gpspos[,2])-b,max(gpspos[,1])-b,max(gpspos[,2]-b)),zoom=12,maptype = "terrain")
ggmap(thies)
thies <- get_map(location=c(min(gpspos[,1])-b,min(gpspos[,2])-b,max(gpspos[,1])-b,max(gpspos[,2]-b)),zoom=12,maptype = "sattelite")
thies <- get_map(location=c(min(gpspos[,1])-b,min(gpspos[,2])-b,max(gpspos[,1])-b,max(gpspos[,2]-b)),zoom=12,maptype = "satellite")
ggmap(thies)
ggmap(thies)+
geom_point(data=igf, aes(x = lon, y = lat), size=5) +
geom_text(data=igf,aes(label = name), size=8) +
geom_edges(data = igf[!is.na(igf$weight),],aes(x = lonend, y = latend, xend = lon, yend = lat),arrow=arrow(length = unit(8, "pt"), type = "closed"),colour="black",size=2) +
theme_blank()
ggmap(thies)+
geom_label(data=igf,aes(x = lon, y = lat, label = vertex.names),fontface = "bold") +
geom_edges(data = igf[!is.na(igf$weight),],aes(x = lonend, y = latend, xend = lon, yend = lat),arrow=arrow(length = unit(6, "pt"), type = "closed"),colour="black") +
theme_blank()
thies <- get_map(location=c(min(gpspos[,1])-b,min(gpspos[,2])-b,max(gpspos[,1])-b,max(gpspos[,2]-b)),zoom=12,maptype = "watercolour")
ggmap(thies)
thies <- get_map(location=c(min(gpspos[,1])-b,min(gpspos[,2])-b,max(gpspos[,1])-b,max(gpspos[,2]-b)),zoom=12,maptype = "watercolor")
ggmap(thies)
thies <- get_map(location=c(min(gpspos[,1])-b,min(gpspos[,2])-b,max(gpspos[,1])-b,max(gpspos[,2]-b)),zoom=12,maptype = "toner")
ggmap(thies)
thies <- get_map(location=c(min(gpspos[,1])-b,min(gpspos[,2])-b,max(gpspos[,1])-b,max(gpspos[,2]-b)),zoom=12,maptype = "terrain-lines")
ggmap(thies)
thies <- get_map(location=c(min(gpspos[,1])-b,min(gpspos[,2])-b,max(gpspos[,1])-b,max(gpspos[,2]-b)),zoom=12,maptype = "terrain-labels")
ggmap(thies)
thies <- get_map(location=c(min(gpspos[,1])-b,min(gpspos[,2])-b,max(gpspos[,1])-b,max(gpspos[,2]-b)),zoom=12,maptype = "terrain")
ggmap(thies)
thies <- get_map(location=c(min(gpspos[,1])-b,min(gpspos[,2])-b,max(gpspos[,1])-b,max(gpspos[,2]-b)),zoom=12,maptype = "hybrid")
ggmap(thies)
get_map(location=c(min(gpspos[,1])-b,min(gpspos[,2])-b,max(gpspos[,1])-b,max(gpspos[,2]-b)),zoom=12,maptype = "hybrid")
thies <- get_map(location=c(min(gpspos[,1])-b,min(gpspos[,2])-b,max(gpspos[,1])-b,max(gpspos[,2]-b)),zoom=12,maptype = "hybrid"); ggmap(thies)
thies <- get_map(location=c(min(gpspos[,1])-b,min(gpspos[,2])-b,max(gpspos[,1])-b,max(gpspos[,2]-b)),zoom=12,maptype = "terrain-lines"); ggmap(thies)
thies <- get_map(location=c(min(gpspos[,1])-b,min(gpspos[,2])-b,max(gpspos[,1])-b,max(gpspos[,2]-b)),zoom=12,maptype = "terrain-labels"); ggmap(thies)
thies <- get_map(location=c(min(gpspos[,1])-b,min(gpspos[,2])-b,max(gpspos[,1])-b,max(gpspos[,2]-b)),zoom=12,maptype = "terrain"); ggmap(thies)
thies <- get_map(location=c(min(gpspos[,1])-b,min(gpspos[,2])-b,max(gpspos[,1])-b,max(gpspos[,2]-b)),zoom=12,maptype = "toner"); ggmap(thies)
thies <- get_map(location=c(min(gpspos[,1])-b,min(gpspos[,2])-b,max(gpspos[,1])-b,max(gpspos[,2]-b)),zoom=12,maptype = "toner-lines"); ggmap(thies)
thies <- get_map(location=c(min(gpspos[,1])-b,min(gpspos[,2])-b,max(gpspos[,1])-b,max(gpspos[,2]-b)),zoom=12,maptype = "roadmap"); ggmap(thies)
thies <- get_map(location=c(min(gpspos[,1])-b,min(gpspos[,2])-b,max(gpspos[,1])-b,max(gpspos[,2]-b)),zoom=12,maptype = "roadmap-lines"); ggmap(thies)
thies <- get_map(location=c(min(gpspos[,1])-b,min(gpspos[,2])-b,max(gpspos[,1])-b,max(gpspos[,2]-b)),zoom=12,maptype = "terrain"); ggmap(thies)
ggmap(thies)+
geom_label(data=igf,aes(x = lon, y = lat, label = vertex.names),fontface = "bold") +
geom_edges(data = igf[!is.na(igf$weight),],aes(x = lonend, y = latend, xend = lon, yend = lat),arrow=arrow(length = unit(6, "pt"), type = "closed"),colour="black") +
theme_blank()
thies <- get_map(location=c(min(gpspos[,1])-b,min(gpspos[,2])-b,max(gpspos[,1])-b,max(gpspos[,2]-b)),zoom=12,maptype = "terrain")
ggmap(thies)+
geom_point(data=igf, aes(x = lon, y = lat), size=5) +
geom_text(data=igf,aes(label = name), size=8) +
geom_edges(data = igf[!is.na(igf$weight),],aes(x = lonend, y = latend, xend = lon, yend = lat),arrow=arrow(length = unit(8, "pt"), type = "closed"),colour="black",size=2) +
theme_blank()
knit("seqtrack_geo.Rmd")
thies <- get_map(location=c(min(gpspos[,1])-b,min(gpspos[,2])-b,max(gpspos[,1])-b,max(gpspos[,2]-b)),zoom=12,maptype = "hybrid")
ggmap(thies)
thies <- get_map(location=c(min(gpspos[,1])-b,min(gpspos[,2])-b,max(gpspos[,1])-b,max(gpspos[,2]-b)),zoom=12,maptype = "roadmap")
ggmap(thies)
ggmap(thies)+
geom_point(data=igf, aes(x = lon, y = lat), size=5) +
geom_text(data=igf,aes(label = name), size=8) +
geom_edges(data = igf[!is.na(igf$weight),],aes(x = lonend, y = latend, xend = lon, yend = lat),arrow=arrow(length = unit(8, "pt"), type = "closed"),colour="black",size=2) +
theme_blank()
thies <- get_map(location=c(min(gpspos[,1])-b,min(gpspos[,2])-b,max(gpspos[,1])-b,max(gpspos[,2]-b)),zoom=12,maptype = "terrain")
ggmap(thies)+
geom_point(data=igf, aes(x = lon, y = lat), size=5) +
geom_text(data=igf,aes(label = name), size=8) +
geom_edges(data = igf[!is.na(igf$weight),],aes(x = lonend, y = latend, xend = lon, yend = lat),arrow=arrow(length = unit(8, "pt"), type = "closed"),colour="black",size=2) +
theme_blank()
igf
round(igf$lon,3)
round(igf[,c("lat","lon","latend","lonend")],3)
igf[,c("lat","lon","latend","lonend")] <- round(igf[,c("lat","lon","latend","lonend")],3)
ggmap(thies)+
geom_point(data=igf, aes(x = lon, y = lat), size=5) +
geom_text(data=igf,aes(label = name), size=8) +
geom_edges(data = igf[!is.na(igf$weight),],aes(x = lonend, y = latend, xend = lon, yend = lat),arrow=arrow(length = unit(8, "pt"), type = "closed"),colour="black",size=2) +
theme_blank()
ggmap(thies)+
geom_point(data=igf, aes(x = lon, y = lat), size=1) +
geom_text(data=igf,aes(label = name), size=4) +
geom_edges(data = igf[!is.na(igf$weight),],aes(x = lonend, y = latend, xend = lon, yend = lat),arrow=arrow(length = unit(8, "pt"), type = "closed"),colour="black",size=2) +
theme_blank()
igf[,c("lat","lon","latend","lonend")] <- round(igf[,c("lat","lon","latend","lonend")],2)
ggmap(thies)+
geom_point(data=igf, aes(x = lon, y = lat), size=1) +
geom_text(data=igf,aes(label = name), size=4) +
geom_edges(data = igf[!is.na(igf$weight),],aes(x = lonend, y = latend, xend = lon, yend = lat),arrow=arrow(length = unit(8, "pt"), type = "closed"),colour="black",size=2) +
theme_blank()
ggmap(thies)
#igApure <- igA
igA <- as.igraph(netAllVars)
E(igA)$latend <- gpspos[2:10,2]
E(igA)$lonend <- gpspos[2:10,1]
E(igA)$lat <- gpspos[na.omit(netAllVars$ances),2]
E(igA)$lon <- gpspos[na.omit(netAllVars$ances),1]
igf <- fortify(netAllVars)
igf$vertex.names <- as.character(igf$name)
igf$vertex.names[1:10] <- inds
igf$lat <- gpspos[,2]
igf$lon <- gpspos[,1]
igf$latend[!is.na(igf$weight)] <- gpspos[na.omit(netAllVars$ances),2]
igf$lonend[!is.na(igf$weight)] <- gpspos[na.omit(netAllVars$ances),1]
igf
#ggplot(data = igf,aes(x = lat, y = lon, xend = latend, yend = lonend)) +
library(ggmap)
#thies <- get_map(location = c(lon = meanLon, lat = meanLat), zoom = 12, maptype = 'terrain')
b=0.0
thies <- get_map(location=c(min(gpspos[,1])-b,min(gpspos[,2])-b,max(gpspos[,1])-b,max(gpspos[,2]-b)),zoom=12,maptype = "roadmap")
ggmap(thies)
igf[,c("lat","lon","latend","lonend")] <- round(igf[,c("lat","lon","latend","lonend")],3)
ggmap(thies)+
geom_point(data=igf, aes(x = lon, y = lat), size=5) +
geom_text(data=igf,aes(label = name), size=8) +
geom_edges(data = igf[!is.na(igf$weight),],aes(x = lonend, y = latend, xend = lon, yend = lat),arrow=arrow(length = unit(8, "pt"), type = "closed"),colour="black",size=2) +
theme_blank()
thies <- get_map(location=c(min(gpspos[,1])-b,min(gpspos[,2])-b,max(gpspos[,1])-b,max(gpspos[,2]-b)),zoom=12,maptype = "terrain")
ggmap(thies)+
geom_point(data=igf, aes(x = lon, y = lat), size=1) +
geom_text(data=igf,aes(label = name), size=4) +
geom_edges(data = igf[!is.na(igf$weight),],aes(x = lonend, y = latend, xend = lon, yend = lat),arrow=arrow(length = unit(8, "pt"), type = "closed"),colour="black",size=2) +
theme_blank()
meta$GPS <- as.character(meta$GPS)
meanLat <- mean(as.numeric(t(as.data.frame(strsplit(meta$GPS,", ")[3:10]))[,1]))
meanLon <- mean(as.numeric(t(as.data.frame(strsplit(meta$GPS,", ")[3:10]))[,2]))
maxLat <- max(as.numeric(t(as.data.frame(strsplit(meta$GPS,", ")[3:10]))[,1]))
medianLon <- median(as.numeric(t(as.data.frame(strsplit(meta$GPS,", ")[3:10]))[,2]))
#if this isn't Thies you're in trouble...
meta$GPS[1] <- paste(maxLat+0.03,medianLon,sep=", ")
meta$GPS[2] <- paste(maxLat+0.02,medianLon,sep=", ")
gpspos <- matrix(as.numeric(t(as.data.frame(strsplit(meta$GPS,", ")))),ncol = 2)
#reverse for plotting
gpspos <- gpspos[,c(2,1)]
gpscurves <- rep(0,14)
#gpscurves[c(2,4,5)] <- c(-1,-1,20)
gpscurves[c(2,5)] <- c(+0.2,0)
plot.new()
# plot(ig,layout=gpspos,vertex.size=5,
# edge.curved=gpscurves,edge.width=as.numeric(factor(net$type,levels=c("boot","core"))[2:15]),
# edge.label.cex=1,edge.label.family="Arial",vertex.label.family="Arial",edge.label=NA)
# #get graph with single-weighted edges
igW <- igA
E(igW)$weight <- 1
gdists <- distances(igW)
distdist <- data.frame(from=character(),
to=character(),
graphdist=integer(),
geodist=numeric(),
stringsAsFactors=F)
for (i in c(2:10)) {
for (j in c(i:10)) {
if (i != j) {
di <- dim(distdist)[[1]]+1
dist = sqrt(abs(gpspos[i,1]-gpspos[j,1])**2+abs(gpspos[i,2]-gpspos[j,2])**2)
write(paste(inds[i],inds[j],gdists[i,j],dist),stderr())
distdist[di,c(1:2)] <- c(inds[i],inds[j])
distdist[di,c(3:4)] <- c(gdists[i,j],dist)
}
}
}
```
```{r}
opts_chunk$set(fig.width=16, fig.height=16)
opts_chunk$set(dev=c('png','postscript'))
```
```{r}
ggmap(thies)
#igApure <- igA
igA <- as.igraph(netAllVars)
E(igA)$latend <- gpspos[2:10,2]
E(igA)$lonend <- gpspos[2:10,1]
E(igA)$lat <- gpspos[na.omit(netAllVars$ances),2]
E(igA)$lon <- gpspos[na.omit(netAllVars$ances),1]
igf <- fortify(netAllVars)
igf$vertex.names <- as.character(igf$name)
igf$vertex.names[1:10] <- inds
igf$lat <- gpspos[,2]
igf$lon <- gpspos[,1]
igf$latend[!is.na(igf$weight)] <- gpspos[na.omit(netAllVars$ances),2]
igf$lonend[!is.na(igf$weight)] <- gpspos[na.omit(netAllVars$ances),1]
igf
#ggplot(data = igf,aes(x = lat, y = lon, xend = latend, yend = lonend)) +
library(ggmap)
#thies <- get_map(location = c(lon = meanLon, lat = meanLat), zoom = 12, maptype = 'terrain')
b=0.0
thies <- get_map(location=c(min(gpspos[,1])-b,min(gpspos[,2])-b,max(gpspos[,1])-b,max(gpspos[,2]-b)),zoom=12,maptype = "roadmap")
ggmap(thies)
igf[,c("lat","lon","latend","lonend")] <- round(igf[,c("lat","lon","latend","lonend")],3)
ggmap(thies)+
geom_point(data=igf, aes(x = lon, y = lat), size=5) +
geom_text(data=igf,aes(label = name), size=8) +
geom_edges(data = igf[!is.na(igf$weight),],aes(x = lonend, y = latend, xend = lon, yend = lat),arrow=arrow(length = unit(8, "pt"), type = "closed"),colour="black",size=2) +
theme_blank()
thies <- get_map(location=c(min(gpspos[,1])-b,min(gpspos[,2])-b,max(gpspos[,1])-b,max(gpspos[,2]-b)),zoom=12,maptype = "terrain")
ggmap(thies)+
geom_point(data=igf, aes(x = lon, y = lat), size=1) +
geom_text(data=igf,aes(label = name), size=4) +
geom_edges(data = igf[!is.na(igf$weight),],aes(x = lonend, y = latend, xend = lon, yend = lat),arrow=arrow(length = unit(8, "pt"), type = "closed"),colour="black",size=2) +
theme_blank()
knit("seqtrack_geo.Rmd")
?round
knit("seqtrack_geo.Rmd")
knit("seqtrack_geo.Rmd")
igf[,c("lat","lon","latend","lonend")] <- round((igf[,c("lat","lon","latend","lonend")]*2),3)/2
thies <- get_map(location=c(min(gpspos[,1])-b,min(gpspos[,2])-b,max(gpspos[,1])-b,max(gpspos[,2]-b)),zoom=12,maptype = "terrain")
igf
knit("seqtrack_geo.Rmd")
igf[,c("lat","lon","latend","lonend")] <- round(igf[,c("lat","lon","latend","lonend")],2)
ggmap(thies)+
geom_point(data=igf, aes(x = lon, y = lat), size=5) +
geom_text(data=igf,aes(label = name), size=8) +
geom_edges(data = igf[!is.na(igf$weight),],aes(x = lonend, y = latend, xend = lon, yend = lat),arrow=arrow(length = unit(8, "pt"), type = "closed"),colour="black",size=2) +
theme_blank()
