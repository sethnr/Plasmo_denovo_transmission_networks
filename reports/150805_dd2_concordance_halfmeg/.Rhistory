blocksumI <- merge(callable,blocksumI,by=c("chr","mid"),all.x=T)
blocksumI[is.na(blocksumI)] <- 0
blocksumIM <- melt(blocksumI[,c("mid","PASS","st","concF")],id.vars = c("mid","PASS","st"))
blocksumSM <- melt(blocksumS[,c("mid","PASS","st","concF")],id.vars = c("mid","PASS","st"))
blocksumIM <- melt(blocksumI[,c("mid","PASS","varcount","st","concF")],id.vars = c("mid","PASS","st"))
blocksumSM <- melt(blocksumS[,c("mid","PASS","varcount","st","concF")],id.vars = c("mid","PASS","st"))
blocksumIM <- melt(blocksumI[,c("mid","PASS","varcount","st","concF")],id.vars = c("mid","PASS","st","varcount"))
blocksumSM <- melt(blocksumS[,c("mid","PASS","varcount","st","concF")],id.vars = c("mid","PASS","st","varcount"))
blocksumIM$type="INDEL"
blocksumSM$type="SNP"
blocksumM <- rbind(blocksumIM,blocksumSM)
ggplot(blocksumM,aes(x=mid,y=value,colour=varcount,shape=PASS)) +
ggtitle(paste("dd2concordance ",(blocksize/1000),"kb blocks")) +
geom_point(size=3,alpha=0.7) + facet_grid(PASS ~ TYPE)
head(blocksumM)
ggplot(blocksumM,aes(x=mid,y=value,colour=varcount,shape=PASS)) +
ggtitle(paste("dd2concordance ",(blocksize/1000),"kb blocks")) +
geom_point(size=3,alpha=0.7) + facet_grid(PASS ~ type)
blocksumI <- merge(callable,blocksumI,by=c("chr","mid"),all.x=T)
blocksumI[is.na(blocksumI)] <- 0
head(blocksumI)
blocksumI <- merge(callable,blocksumI,by=c("chr","mid"),all.x=T)
blocksumI <- cbind(poschr,means,varcount,conscount,conccount,allcount)
fs <- blocksumI[,c("conscount","conccount","allcount")]/varcount
colnames(fs) <- c("consF","concF","allF")
blocksumI <- cbind(blocksumI,fs)
rm(fs)
head(blocksumI)
blocksumI <- merge(callable,blocksumI,by=c("chr","mid"),all.x=T)
blocksumI[is.na(blocksumI)] <- 0
head(blocksumI)
blocksumS <- cbind(poschr,means,varcount,conscount,conccount,allcount)
fs <- blocksumS[,c("conscount","conccount","allcount")]/varcount
colnames(fs) <- c("consF","concF","allF")
blocksumS <- cbind(blocksumS,fs)
rm(fs)
head(blocksumS)
blocksumS <- merge(callable,blocksumS,by=c("chr","mid"),all.x=T)
blocksumS[is.na(blocksumS)] <- 0
head(blocksumS)
blocksumIM <- melt(blocksumI[,c("mid","PASS","varcount","st","concF")],id.vars = c("mid","PASS","st","varcount"))
blocksumSM <- melt(blocksumS[,c("mid","PASS","varcount","st","concF")],id.vars = c("mid","PASS","st","varcount"))
blocksumIM$type="INDEL"
blocksumSM$type="SNP"
blocksumM <- rbind(blocksumIM,blocksumSM)
ggplot(blocksumM,aes(x=mid,y=value,colour=varcount,shape=PASS)) +
ggtitle(paste("dd2concordance ",(blocksize/1000),"kb blocks")) +
geom_point(size=3,alpha=0.7) + facet_grid(PASS ~ type)
head(blocksumI)
head(blocksumIM)
head(blocksumI)
ggplot(blocksumM,aes(x=mid,y=value,colour=varcount,shape=PASS)) +
ggtitle(paste("dd2concordance ",(blocksize/1000),"kb blocks")) +
geom_point(size=3,alpha=0.7) + facet_grid(. ~ type)
ggplot(blocksumM,aes(x=mid,y=value,colour=PASS)) +
ggtitle(paste("dd2concordance ",(blocksize/1000),"kb blocks")) +
geom_point(size=3,alpha=0.7) + facet_grid(type ~ .)
ggplot(blocksumM,aes(x=mid,y=value,colour=PASS)) +
ggtitle(paste("dd2concordance ",(blocksize/1000),"kb blocks")) +
geom_point(size=5,alpha=0.7) + facet_grid(type ~ .)
ggplot(blocksumM,aes(x=mid,y=value)) +
ggtitle(paste("dd2concordance ",(blocksize/1000),"kb blocks")) +
geom_hex() + facet_grid(type ~ PASS)
ggplot(blocksumM,aes(x=mid,y=value)) +
ggtitle(paste("dd2concordance ",(blocksize/1000),"kb blocks")) +
geom_hex() + facet_grid(PASS ~ type)
ggplot(blocksumI,aes(x=mid,y=value)) +
ggtitle(paste("dd2concordance ",(blocksize/1000),"kb blocks")) +
geom_hex() + facet_grid(PASS ~ .)
ggplot(blocksumIM,aes(x=mid,y=value)) +
ggtitle(paste("dd2concordance ",(blocksize/1000),"kb blocks")) +
geom_hex() + facet_grid(PASS ~ .)
ggplot(blocksumSM,aes(x=mid,y=value)) +
ggtitle(paste("dd2concordance ",(blocksize/1000),"kb blocks")) +
geom_hex() + facet_grid(PASS ~ .)
ggplot(blocksumIM,aes(x=mid,y=value)) +
ggtitle(paste("dd2concordance INDELs",(blocksize/1000),"kb blocks")) +
geom_hex() + facet_grid(PASS ~ .)
ggplot(blocksumSM,aes(x=mid,y=value)) +
ggtitle(paste("dd2concordance, SNPs ",(blocksize/1000),"kb blocks")) +
geom_hex() + facet_grid(PASS ~ .)
ggplot(blocksumM,aes(x=mid,y=value,colour=PASS)) +
ggtitle(paste("dd2concordance ",(blocksize/1000),"kb blocks")) +
geom_point(size=5,alpha=0.7) + facet_grid(type ~ .)
ggplot(blocksumM,aes(x=mid,y=value,colour=PASS)) +
ggtitle(paste("dd2concordance ",(blocksize/1000),"kb blocks")) +
geom_point(size=5,alpha=0.7) + facet_grid(type ~ .)
head(blocksumI)
blocksumI$type="INDEL"
blocksumS$type="SNP"
blocksum <- rbind(blocksumI,blocksumS)
blocksumI$type="INDEL"
blocksumS$type="SNP"
blocksum <- rbind(blocksumI,blocksumS)
ggplot(blocksum,aes(x=type,y=concF,colour=type)) +
ggtitle(paste("dd2concordance ",(blocksize/1000),"kb blocks")) +
geom_boxplot() + facet_grid(type ~ .)
ggplot(blocksum,aes(x=type,y=concF,colour=type)) +
ggtitle(paste("dd2concordance ",(blocksize/1000),"kb blocks")) +
geom_boxplot() + facet_grid(PASS ~ .)
ggplot(blocksum,aes(x=type,y=concF,colour=type)) +
ggtitle(paste("dd2concordance ",(blocksize/1000),"kb blocks")) +
geom_violin() + facet_grid(PASS ~ .)
ggplot(blocksum,aes(x=type,y=concF,colour=type)) +
ggtitle(paste("dd2concordance ",(blocksize/1000),"kb blocks")) +
geom_violin() + facet_grid(PASS ~ varcount>0)
head(blocksum)
ggplot(blocksum,aes(x=type,y=concF,colour=type)) +
ggtitle(paste("dd2concordance ",(blocksize/1000),"kb blocks")) +
geom_violin() + facet_grid(PASS ~ varcount)
ggplot(blocksum,aes(x=varcount,y=concF,colour=type)) +
ggtitle(paste("dd2concordance ",(blocksize/1000),"kb blocks")) +
geom_bar() + facet_grid(PASS ~ varcount)
ggplot(blocksum,aes(x=varcount,y=concF,colour=type)) +
ggtitle(paste("dd2concordance ",(blocksize/1000),"kb blocks")) +
geom_bar(stat = "identity") + facet_grid(PASS ~ varcount)
ggplot(blocksum,aes(x=varcount,y=concF,colour=type)) +
ggtitle(paste("dd2concordance ",(blocksize/1000),"kb blocks")) +
geom_bar(binwidth=2,stat = "identity") + facet_grid(PASS ~ varcount)
is.numeric(blocksum$varcount)
ggplot(blocksum,aes(x=varcount,y=concF,colour=PASS)) +
ggtitle(paste("dd2concordance ",(blocksize/1000),"kb blocks")) +
geom_point(binwidth=2,stat = "identity") + facet_grid(PASS ~ varcount)
ggplot(blocksum,aes(x=varcount,y=concF,colour=PASS)) +
ggtitle(paste("dd2concordance ",(blocksize/1000),"kb blocks")) +
geom_point() + facet_grid(PASS ~ .)
write.table(aggregate(blocksum$PASS,by=list(blocksumD$chr),function(x) {sum(x>goodlim) / length(x)}))
write.table(aggregate(blocksum$PASS,by=list(blocksum$type),function(x) {sum(x>goodlim) / length(x)}))
write.table(aggregate(blocksum$PASS,by=list(blocksum$type),sum))
write.table(table(blocksum[,c("PASS","type")]))
ggplot(blocksumD,aes(x=goodF)) + geom_density(adjust=0.2)
write.table(table(blocksum[,c("PASS","type")]))
ggplot(blocksum,aes(x=varcount,y=concF,colour=PASS)) +
ggtitle(paste("dd2concordance ",(blocksize/1000),"kb blocks")) +
geom_point() + facet_grid(PASS ~ .)
ggplot(blocksum,aes(x=varcount,y=concF,colour=PASS)) +
ggtitle(paste("dd2concordance ",(blocksize/1000),"kb blocks")) +
geom_violin() + facet_grid(PASS ~ .)
ggplot(PASS,aes(x=varcount,y=concF,colour=PASS)) +
ggtitle(paste("dd2concordance ",(blocksize/1000),"kb blocks")) +
geom_violin() + facet_grid(PASS ~ .)
ggplot(blocksum,aes(x=PASS,y=concF,colour=PASS)) +
ggtitle(paste("dd2concordance ",(blocksize/1000),"kb blocks")) +
geom_violin() + facet_grid(PASS ~ .)
ggplot(blocksum,aes(x=PASS,y=concF,colour=PASS)) +
ggtitle(paste("dd2concordance ",(blocksize/1000),"kb blocks")) +
geom_violin() + facet_grid(type ~ .)
write.table(table(blocksum[,c("PASS","type")]))
blocksum[,c("PASS","type")]
ggplot(blocksumIM,aes(x=mid,y=value)) +
ggtitle(paste("dd2concordance INDELs",(blocksize/1000),"kb blocks")) +
geom_hex() + facet_grid(PASS ~ .)
ggplot(blocksumSM,aes(x=mid,y=value)) +
ggtitle(paste("dd2concordance, SNPs ",(blocksize/1000),"kb blocks")) +
geom_hex() + facet_grid(PASS ~ .)
ggplot(blocksumM,aes(x=mid,y=value,colour=PASS)) +
ggtitle(paste("dd2concordance ",(blocksize/1000),"kb blocks")) +
geom_point(size=5,alpha=0.7) + facet_grid(type ~ .)
ggplot(blocksumIM,aes(x=mid,y=value)) +
ggtitle(paste("dd2concordance INDELs",(blocksize/1000),"kb blocks")) +
geom_hex() + facet_grid(PASS ~ .)
ggplot(blocksumSM,aes(x=mid,y=value)) +
ggtitle(paste("dd2concordance, SNPs ",(blocksize/1000),"kb blocks")) +
geom_hex() + facet_grid(PASS ~ .)
ggplot(blocksumM,aes(x=mid,y=varcount,colour=PASS)) +
ggtitle(paste("dd2concordance ",(blocksize/1000),"kb blocks")) +
geom_point(size=5,alpha=0.7) + facet_grid(type ~ .)
ggplot(blocksumM,aes(x=mid,y=varcount,colour=PASS)) +
ggtitle(paste("dd2concordance ",(blocksize/1000),"kb blocks")) +
geom_point(size=3,alpha=0.7) + facet_grid(type ~ .)
ggplot(blocksumM,aes(x=mid,y=varcount,colour=PASS)) +
ggtitle(paste("dd2 allele count (real data) ",(blocksize/1000),"kb blocks")) +
geom_point(size=3,alpha=0.7) + facet_grid(type ~ .)
head(blocksumM)
head(blocksumI)
head(blocksumS)
blocksize <- 1000
dd2cfI$block <-   paste(dd2cfI$CHR,floor(dd2cfI$POS/blocksize),sep=":")
varcount <- aggregate(dd2cfI$POS,by=list(dd2cfI$block),FUN=length)[,2]
callcount <- aggregate(dd2cfI$CALLABLE!="",by=list(dd2cfI$block),FUN=sum)[,2]
means <- as.data.frame(aggregate(dd2cfI[,c("ALLELES")],by=list(dd2cfI$block),FUN=mean))
conscount <- aggregate(dd2cfI$DD2CONS!="",by=list(dd2cfI$block),FUN=sum)[,2]
conccount <- aggregate(dd2cfI$DD2CONC!="",by=list(dd2cfI$block),FUN=sum)[,2]
allcount <- aggregate(dd2cfI$DD2ALL!="",by=list(dd2cfI$block),FUN=sum)[,2]
colnames(means)[[1]] <- "block"
poschr <- t(as.data.frame(strsplit(means$block,split = ':')))
colnames(poschr) <- c("chr","pos")
poschr <- as.data.frame(poschr)
poschr$pos <- as.numeric(as.character(poschr$pos))
poschr$st = poschr$pos*blocksize
poschr$mid = poschr$st+(blocksize/2)
poschr$en = poschr$st+blocksize
blocksumI <- cbind(poschr,means,varcount,conscount,conccount,allcount)
fs <- blocksumI[,c("conscount","conccount","allcount")]/varcount
colnames(fs) <- c("consF","concF","allF")
blocksumI <- cbind(blocksumI,fs)
rm(fs)
head(blocksumI)
blocksumI <- merge(callable,blocksumI,by=c("chr","mid"),all.x=T)
blocksumI[is.na(blocksumI)] <- 0
dd2cfS$block <-   paste(dd2cfS$CHR,floor(dd2cfS$POS/blocksize),sep=":")
varcount <- aggregate(dd2cfS$POS,by=list(dd2cfS$block),FUN=length)[,2]
callcount <- aggregate(dd2cfS$CALLABLE!="",by=list(dd2cfS$block),FUN=sum)[,2]
means <- as.data.frame(aggregate(dd2cfS[,c("ALLELES")],by=list(dd2cfS$block),FUN=mean))
conscount <- aggregate(dd2cfS$DD2CONS!="",by=list(dd2cfS$block),FUN=sum)[,2]
conccount <- aggregate(dd2cfS$DD2CONC!="",by=list(dd2cfS$block),FUN=sum)[,2]
allcount <- aggregate(dd2cfS$DD2ALL!="",by=list(dd2cfS$block),FUN=sum)[,2]
colnames(means)[[1]] <- "block"
poschr <- t(as.data.frame(strsplit(means$block,split = ':')))
colnames(poschr) <- c("chr","pos")
poschr <- as.data.frame(poschr)
poschr$pos <- as.numeric(as.character(poschr$pos))
poschr$st = poschr$pos*blocksize
poschr$mid = poschr$st+(blocksize/2)
poschr$en = poschr$st+blocksize
blocksumS <- cbind(poschr,means,varcount,conscount,conccount,allcount)
fs <- blocksumS[,c("conscount","conccount","allcount")]/varcount
colnames(fs) <- c("consF","concF","allF")
blocksumS <- cbind(blocksumS,fs)
rm(fs)
blocksumS <- merge(callable,blocksumS,by=c("chr","mid"),all.x=T)
blocksumS[is.na(blocksumS)] <- 0
head(blocksumS)
head(blocksumI)
head(blocksumS)
blocksumIM <- melt(blocksumI[,c("mid","PASS","varcount","st","concF")],id.vars = c("mid","PASS","st","varcount"))
blocksumSM <- melt(blocksumS[,c("mid","PASS","varcount","st","concF")],id.vars = c("mid","PASS","st","varcount"))
blocksumIM$type="INDEL"
blocksumSM$type="SNP"
blocksumM <- rbind(blocksumIM,blocksumSM)
blocksumI$type="INDEL"
blocksumS$type="SNP"
blocksum <- rbind(blocksumI,blocksumS)
ggplot(blocksumM,aes(x=mid,y=value,colour=PASS)) +
ggtitle(paste("dd2concordance ",(blocksize/1000),"kb blocks")) +
geom_point(size=5,alpha=0.7) + facet_grid(type ~ .)
# ggplot(blocksumIM,aes(x=mid,y=value)) +
ggplot(blocksumM,aes(x=mid,y=varcount,colour=PASS)) +
ggtitle(paste("dd2 allele count (real data) ",(blocksize/1000),"kb blocks")) +
geom_point(size=3,alpha=0.7) + facet_grid(type ~ .)
ggplot(blocksumM,aes(x=mid,y=varcount,colour=PASS)) +
ggtitle(paste("dd2 allele count (real data) ",(blocksize/1000),"kb blocks")) +
geom_point(size=3,alpha=0.7) + facet_grid(type ~ .,scales = "free_y")
ggplot(blocksumM,aes(x=mid,y=varcount,colour=PASS)) +
ggtitle(paste("dd2 var count (real data) ",(blocksize/1000),"kb blocks")) +
geom_point(size=3,alpha=0.7) + facet_grid(type ~ .,scales = "free_y")
head(blocksumM)
head(blocksum)
head(means)
blocksize <- 1000
dd2cfI$block <-   paste(dd2cfI$CHR,floor(dd2cfI$POS/blocksize),sep=":")
varcount <- aggregate(dd2cfI$POS,by=list(dd2cfI$block),FUN=length)[,2]
callcount <- aggregate(dd2cfI$CALLABLE!="",by=list(dd2cfI$block),FUN=sum)[,2]
means <- as.data.frame(aggregate(dd2cfI[,c("ALLELES")],by=list(dd2cfI$block),FUN=mean))
conscount <- aggregate(dd2cfI$DD2CONS!="",by=list(dd2cfI$block),FUN=sum)[,2]
conccount <- aggregate(dd2cfI$DD2CONC!="",by=list(dd2cfI$block),FUN=sum)[,2]
allcount <- aggregate(dd2cfI$DD2ALL!="",by=list(dd2cfI$block),FUN=sum)[,2]
colnames(means) <- c("block","mean_alleles")
poschr <- t(as.data.frame(strsplit(means$block,split = ':')))
colnames(poschr) <- c("chr","pos")
poschr <- as.data.frame(poschr)
poschr$pos <- as.numeric(as.character(poschr$pos))
poschr$st = poschr$pos*blocksize
poschr$mid = poschr$st+(blocksize/2)
poschr$en = poschr$st+blocksize
blocksumI <- cbind(poschr,means,varcount,conscount,conccount,allcount)
fs <- blocksumI[,c("conscount","conccount","allcount")]/varcount
colnames(fs) <- c("consF","concF","allF")
blocksumI <- cbind(blocksumI,fs)
rm(fs)
blocksumI <- merge(callable,blocksumI,by=c("chr","mid"),all.x=T)
blocksumI[is.na(blocksumI)] <- 0
dd2cfS$block <-   paste(dd2cfS$CHR,floor(dd2cfS$POS/blocksize),sep=":")
varcount <- aggregate(dd2cfS$POS,by=list(dd2cfS$block),FUN=length)[,2]
callcount <- aggregate(dd2cfS$CALLABLE!="",by=list(dd2cfS$block),FUN=sum)[,2]
means <- as.data.frame(aggregate(dd2cfS[,c("ALLELES")],by=list(dd2cfS$block),FUN=mean))
conscount <- aggregate(dd2cfS$DD2CONS!="",by=list(dd2cfS$block),FUN=sum)[,2]
conccount <- aggregate(dd2cfS$DD2CONC!="",by=list(dd2cfS$block),FUN=sum)[,2]
allcount <- aggregate(dd2cfS$DD2ALL!="",by=list(dd2cfS$block),FUN=sum)[,2]
colnames(means) <- c("block","mean_alleles")
poschr <- t(as.data.frame(strsplit(means$block,split = ':')))
colnames(poschr) <- c("chr","pos")
poschr <- as.data.frame(poschr)
poschr$pos <- as.numeric(as.character(poschr$pos))
poschr$st = poschr$pos*blocksize
poschr$mid = poschr$st+(blocksize/2)
poschr$en = poschr$st+blocksize
blocksumS <- cbind(poschr,means,varcount,conscount,conccount,allcount)
fs <- blocksumS[,c("conscount","conccount","allcount")]/varcount
colnames(fs) <- c("consF","concF","allF")
blocksumS <- cbind(blocksumS,fs)
rm(fs)
blocksumS <- merge(callable,blocksumS,by=c("chr","mid"),all.x=T)
blocksumS[is.na(blocksumS)] <- 0
head(blocksumI)
head(blocksumS)
ggplot(blocksumM,aes(x=mid,y=mean_alleles,colour=PASS)) +
ggtitle(paste("dd2 var count (real data) ",(blocksize/1000),"kb blocks")) +
geom_point(size=3,alpha=0.7) + facet_grid(type ~ .,scales = "free_y")
ggplot(blocksum,aes(x=mid,y=mean_alleles,colour=PASS)) +
ggtitle(paste("dd2 var count (real data) ",(blocksize/1000),"kb blocks")) +
geom_point(size=3,alpha=0.7) + facet_grid(type ~ .,scales = "free_y")
head(blocksumS)
ggplot(blocksum,aes(x=mid,y=mean_alleles,colour=PASS)) +
ggtitle(paste("dd2 var count (real data) ",(blocksize/1000),"kb blocks")) +
geom_point(size=3,alpha=0.7) + facet_grid(type ~ .,scales = "free_y")
blocksumI$type="INDEL"
blocksumS$type="SNP"
blocksum <- rbind(blocksumI,blocksumS)
head(blocksum)
ggplot(blocksum,aes(x=mid,y=mean_alleles,colour=PASS)) +
ggtitle(paste("dd2 var count (real data) ",(blocksize/1000),"kb blocks")) +
geom_point(size=3,alpha=0.7) + facet_grid(type ~ .,scales = "free_y")
ggplot(blocksum,aes(x=varcount,y=mean_alleles,colour=PASS)) +
ggtitle(paste("dd2 var count (real data) ",(blocksize/1000),"kb blocks")) +
geom_point(size=3,alpha=0.7) + facet_grid(type ~ .,scales = "free_y")
ggplot(blocksum,aes(x=mean_alleles,y=concF,colour=PASS)) +
ggtitle(paste("dd2 var count (real data) ",(blocksize/1000),"kb blocks")) +
geom_point(size=3,alpha=0.7) + facet_grid(type ~ .,scales = "free_y")
dd2cf
head(dd2cf)
head(dd2cfI)
ggplot(blocksumM,aes(x=mid,y=value,colour=PASS)) +
ggtitle(paste("dd2concordance ",(blocksize/1000),"kb blocks")) +
geom_point(size=5,alpha=0.7) + facet_grid(type ~ .)
ggplot(blocksumM,aes(x=mid,y=varcount,colour=PASS)) +
ggtitle(paste("dd2 var count (real data) ",(blocksize/1000),"kb blocks")) +
geom_point(size=3,alpha=0.7) + facet_grid(type ~ .,scales = "free_y")
ggplot(blocksum,aes(x=mean_alleles,y=concF,colour=PASS)) +
ggtitle(paste("dd2 var count (real data) ",(blocksize/1000),"kb blocks")) +
geom_point(size=3,alpha=0.7) + facet_grid(type ~ .,scales = "free_y")
ggplot(dd2cfI,aes(x=mean_alleles,y=concF,colour=PASS)) +
ggtitle(paste("dd2 var count (real data) ",(blocksize/1000),"kb blocks")) +
geom_point(size=3,alpha=0.7) + facet_grid(type ~ .,scales = "free_y")
ggplot(dd2cfI,aes(x=mean_alleles,y=concF,colour=PASS)) +
ggtitle(paste("dd2 var count (real data) ",(blocksize/1000),"kb blocks")) +
geom_point(size=3,alpha=0.7) + facet_grid(. ~ .,scales = "free_y")
ggplot(dd2cfI,aes(x=mean_alleles,y=concF,colour=PASS)) +
ggtitle(paste("dd2 var count (real data) ",(blocksize/1000),"kb blocks")) +
geom_point(size=3,alpha=0.7)
head(dd2cfI)
ggplot(dd2cfI,aes(x=DD2CONC,y=alleles,colour=PASS)) +
ggtitle(paste("dd2 var count (real data) ",(blocksize/1000),"kb blocks")) +
geom_point(size=3,alpha=0.7)
ggplot(dd2cfI,aes(x=DD2CONC,y=ALLELES,colour=PASS)) +
ggtitle(paste("dd2 var count (real data) ",(blocksize/1000),"kb blocks")) +
geom_point(size=3,alpha=0.7)
ggplot(dd2cfI,aes(x=DD2CONC,y=ALLELES,colour=CALLABLE)) +
ggtitle(paste("dd2 var count (real data) ",(blocksize/1000),"kb blocks")) +
geom_point(size=3,alpha=0.7)
ggplot(dd2cfI,aes(x=DD2CONC,y=ALLELES,colour=CALLABLE)) +
ggtitle(paste("dd2 var count (real data) ",(blocksize/1000),"kb blocks")) +
geom_box()
ggplot(dd2cfI,aes(x=DD2CONC,y=ALLELES,colour=CALLABLE)) +
ggtitle(paste("dd2 var count (real data) ",(blocksize/1000),"kb blocks")) +
geom_boxplot()
head(dd2cf)
ggplot(dd2cf,aes(x=DD2CONC,y=ALLELES,colour=CALLABLE)) +
ggtitle(paste("dd2 var count (real data) ",(blocksize/1000),"kb blocks")) +
geom_boxplot() + facet_grid(TYPE ~ .)
ggplot(dd2cf,aes(x=DD2CONC,y=ALLELES,colour=CALLABLE)) +
ggtitle(paste("dd2 var count (real data) ",(blocksize/1000),"kb blocks")) +
geom_boxplot() + facet_grid(TYPE ~ CALLABLE)
ggplot(dd2cf,aes(x=DD2CONC,y=ALLELES,colour=CALLABLE)) +
ggtitle(paste("dd2 var count (real data) ",(blocksize/1000),"kb blocks")) +
geom_boxplot() + facet_grid(TYPE ~ CALLABLE) + ylim(0,50)
ggplot(dd2cf,aes(x=DD2CONC,y=ALLELES,colour=CALLABLE)) +
ggtitle(paste("dd2 var count (real data) ",(blocksize/1000),"kb blocks")) +
geom_boxplot() + facet_grid(TYPE ~ CALLABLE,scales="free_y") + ylim(0,50)
ggplot(dd2cf,aes(x=DD2CONC,y=ALLELES,colour=CALLABLE)) +
ggtitle(paste("dd2 var count (real data) ",(blocksize/1000),"kb blocks")) +
geom_boxplot() + facet_grid(TYPE ~ CALLABLE,scales="free_y") + ylim(0,20)
dd2cf$CALLABLE[dd2cf$CALLABLE == ""] = "INACESSABLE"
ggplot(dd2cf,aes(x=DD2CONC,y=ALLELES,colour=CALLABLE)) +
ggtitle(paste("dd2 var count (real data) ",(blocksize/1000),"kb blocks")) +
geom_boxplot() + facet_grid(TYPE ~ CALLABLE,scales="free_y") + ylim(0,20)
dd2cf$CALLABLE[dd2cf$CALLABLE == ""] = "INACESSABLE"
dd2cf$DD2CONC[dd2cf$DD2CONC == ""] = "DISCORDANT"
dd2cf$DD2CONC[dd2cf$DD2CONC == "DD2CONC"] = "CONCORDANT"
ggplot(dd2cf,aes(x=DD2CONC,y=ALLELES,colour=CALLABLE)) +
ggtitle(paste("dd2 var count (real data) ",(blocksize/1000),"kb blocks")) +
geom_boxplot() + facet_grid(TYPE ~ CALLABLE,scales="free_y") + ylim(0,20)
table(dd2cf[,c("DD2CONC","CALLABLE")])
table(dd2cf[,c("CALLABLE","DD2CONC")])
knit("runAnalysis_concordance.Rmd")
setwd("../150730_swscore_blocksums/")
library(ggplot2)
library(knitr)
library(reshape2)
library(hexbin)
SWnucmer <- read.table("NUCMER.qDD2vr3D7.INDELS.SW.txt",stringsAsFactors = F,sep='\t',header=T)
SWnucmer$set="NUCMER"
SWdisco <- read.table("DISCO.qDD2vr3D7.INDELS.SW.txt",stringsAsFactors = F,sep='\t',header=T)
SWdisco$set="DISCO"
SWscores <- rbind(SWnucmer,SWdisco)
#SWscores <- SWdisco
head(SWscores)
colnames(SWscores)[1:2] <- c("i","var")
SWscores <- cbind(t(as.data.frame(strsplit(SWscores$var,split = ':'))),SWscores)
colnames(SWscores)[1:2] <- c("chr","pos")
SWscores$pos <- as.integer(as.character(SWscores$pos))
telos <- readLines("List.subtelomeres.3D7.regions.txt")
telos <- t(as.data.frame(strsplit(telos,split = ':')))
telos <- as.data.frame(cbind(telos[,1],t(as.data.frame(strsplit(telos[,2],split = '-')))))
colnames(telos) <- c("chr","st","en")
telos$st <- as.numeric(as.character(telos$st))
telos$en <- as.numeric(as.character(telos$en))
telos$chr <- as.character(telos$chr)
telos <- merge(subset(telos,st < 1000),subset(telos,st > 1000),by="chr")
colnames(telos) <- c("chr","stL","enL","stR","enR")
SWscores$chr <- as.character(SWscores$chr)
SWscores$telo=F
tmp <- merge(SWscores,telos,by="chr",all.x=T)
tmp[is.na(tmp$stL),c("stL","enL","stR","enR")] <- -1
tmp$telo[tmp$pos < tmp$enL] = T # "L"
tmp$telo[tmp$pos > tmp$stR] = T # "R"
SWscores <- tmp[,colnames(SWscores)]
rm(tmp)
SWscores$error=""
SWscores[SWscores$NM>0,"error"]="LDerror"
SWscores[SWscores$RS>1,"error"]="RSerror"
table(SWscores[,c("error","set")])
SWdisco <- subset(SWscores,set=="DISCO")
SWnucmer <- subset(SWscores,set=="NUCMER")
blocksize <- 1000
SWnucmer$block <- paste(SWnucmer$chr,floor(SWnucmer$pos/blocksize),sep=":")
varcount <- aggregate(SWnucmer$var,by=list(SWnucmer$block),FUN=length)[,2]
means <- as.data.frame(aggregate(SWnucmer[,c("LD","RS","NM")],by=list(SWnucmer$block),FUN=mean))
goodcount <- aggregate(SWnucmer$NM==0,by=list(SWnucmer$block),FUN=sum)[,2]
LDcount <- aggregate(SWnucmer$error=="LDerror",by=list(SWnucmer$block),FUN=sum)[,2]
RScount <- aggregate(SWnucmer$error=="RSerror",by=list(SWnucmer$block),FUN=sum)[,2]
colnames(means)[[1]] <- "block"
poschr <- t(as.data.frame(strsplit(means$block,split = ':')))
colnames(poschr) <- c("chr","pos")
poschr <- as.data.frame(poschr)
poschr$pos <- as.numeric(as.character(poschr$pos))
poschr$st = poschr$pos*blocksize
poschr$mid = poschr$st+(blocksize/2)
poschr$en = poschr$st+blocksize
blocksumN <- cbind(poschr,means,varcount,goodcount,LDcount,RScount)
fs <- blocksumN[,c("goodcount","LDcount","RScount")]/varcount
colnames(fs) <- c("goodF","LDF","RSF")
blocksumN <- cbind(blocksumN,fs)
rm(fs)
SWdisco$block <- paste(SWdisco$chr,floor(SWdisco$pos/blocksize),sep=":")
varcount <- aggregate(SWdisco$var,by=list(SWdisco$block),FUN=length)[,2]
means <- as.data.frame(aggregate(SWdisco[,c("LD","RS","NM")],by=list(SWdisco$block),FUN=mean))
goodcount <- aggregate(SWdisco$NM==0,by=list(SWdisco$block),FUN=sum)[,2]
LDcount <- aggregate(SWdisco$error=="LDerror",by=list(SWdisco$block),FUN=sum)[,2]
RScount <- aggregate(SWdisco$error=="RSerror",by=list(SWdisco$block),FUN=sum)[,2]
colnames(means)[[1]] <- "block"
poschr <- t(as.data.frame(strsplit(means$block,split = ':')))
colnames(poschr) <- c("chr","pos")
poschr <- as.data.frame(poschr)
poschr$pos <- as.numeric(as.character(poschr$pos))
poschr$st = poschr$pos*blocksize
poschr$mid = poschr$st+(blocksize/2)
poschr$en = poschr$st+blocksize
blocksumD <- cbind(poschr,means,varcount,goodcount,LDcount,RScount)
fs <- blocksumD[,c("goodcount","LDcount","RScount")]/varcount
colnames(fs) <- c("goodF","LDF","RSF")
blocksumD <- cbind(blocksumD,fs)
rm(fs)
SWdisco$block <- paste(SWdisco$chr,floor(SWdisco$pos/blocksize),sep=":")
varcount <- aggregate(SWdisco$var,by=list(SWdisco$block),FUN=length)[,2]
means <- as.data.frame(aggregate(SWdisco[,c("LD","RS","NM")],by=list(SWdisco$block),FUN=mean))
goodcount <- aggregate(SWdisco$NM==0,by=list(SWdisco$block),FUN=sum)[,2]
LDcount <- aggregate(SWdisco$error=="LDerror",by=list(SWdisco$block),FUN=sum)[,2]
RScount <- aggregate(SWdisco$error=="RSerror",by=list(SWdisco$block),FUN=sum)[,2]
colnames(means)[[1]] <- "block"
poschr <- t(as.data.frame(strsplit(means$block,split = ':')))
colnames(poschr) <- c("chr","pos")
poschr <- as.data.frame(poschr)
poschr$pos <- as.numeric(as.character(poschr$pos))
poschr$st = poschr$pos*blocksize
poschr$mid = poschr$st+(blocksize/2)
poschr$en = poschr$st+blocksize
blocksumD <- cbind(poschr,means,varcount,goodcount,LDcount,RScount)
fs <- blocksumD[,c("goodcount","LDcount","RScount")]/varcount
colnames(fs) <- c("goodF","LDF","RSF")
blocksumD <- cbind(blocksumD,fs)
rm(fs)
SWdisco$block <- paste(SWdisco$chr,floor(SWdisco$pos/blocksize),sep=":")
varcount <- aggregate(SWdisco$var,by=list(SWdisco$block),FUN=length)[,2]
means <- as.data.frame(aggregate(SWdisco[,c("LD","RS","NM")],by=list(SWdisco$block),FUN=mean))
goodcount <- aggregate(SWdisco$NM==0,by=list(SWdisco$block),FUN=sum)[,2]
LDcount <- aggregate(SWdisco$error=="LDerror",by=list(SWdisco$block),FUN=sum)[,2]
RScount <- aggregate(SWdisco$error=="RSerror",by=list(SWdisco$block),FUN=sum)[,2]
colnames(means)[[1]] <- "block"
poschr <- t(as.data.frame(strsplit(means$block,split = ':')))
colnames(poschr) <- c("chr","pos")
poschr <- as.data.frame(poschr)
poschr$pos <- as.numeric(as.character(poschr$pos))
poschr$st = poschr$pos*blocksize
poschr$mid = poschr$st+(blocksize/2)
poschr$en = poschr$st+blocksize
blocksumD <- cbind(poschr,means,varcount,goodcount,LDcount,RScount)
fs <- blocksumD[,c("goodcount","LDcount","RScount")]/varcount
colnames(fs) <- c("goodF","LDF","RSF")
blocksumD <- cbind(blocksumD,fs)
rm(fs)
setwd("../150805_dd2_concordance_halfmeg/")
ggplot(blocksumM,aes(x=mid,y=value,colour=PASS)) +
ggtitle(paste("dd2concordance ",(blocksize/1000),"kb blocks")) +
geom_point(size=3,alpha=0.7) + facet_grid(type ~ .)
knit("runAnalysis_concordance.Rmd")
ggplot(blocksumM,aes(x=mid,y=value,colour=PASS)) +
ggtitle(paste("dd2concordance ",(blocksize/1000),"kb blocks")) +
geom_point(size=3,alpha=0.7) + facet_grid(type ~ .)
knit("runAnalysis_concordance.Rmd")
knit("runAnalysis_concordance.Rmd")
knit("runAnalysis_concordance.Rmd")
