steadyL.df$names <- c(0:12)
ggplot(as.data.frame(steadyL),aes(x=V1,y=V2,label=names)) + geom_text()
ggplot(steadyL.df,aes(x=V1,y=V2,label=names)) + geom_text()
steadyL[8:13,]
subSteadyL <- steadyL[8:13,]
plot(subgraph(steadyG,v = c(8:13)),subSteadyL)
plot(subgraph(steadyG,v = c(8:13)),layout=subSteadyL)
add_layout_(subgraph(steadyG,v = c(8:13)),layout=subSteadyL)
subSteadyL <- steadyL[8:13,]
plot(subgraph(steadyG,v = c(8:13)),layout=subSteadyL)
plot(subgraph(steadyG,v = c(8:13)),layout=subSteadyL)
add_layout_(subgraph(steadyG,v = c(8:13)),layout=subSteadyL)
subSteadyG <- subgraph(steadyG,v = c(8:13))
subSteadyG <- induced_subgraph(steadyG,v = c(8:13))
plot(subSteadyG,layout=subSteadyL)
plot(subSteadyG,layout=subSteadyL)
add_layout_(subSteadyG,layout=subSteadyL)
add_layout_(subSteadyG,layout=subSteadyL)
add_layout_(subSteadyG,subSteadyL)
fastgreedy.community(subSteadyG)
steadyG <- graph.data.frame(steadystate, directed=F)
E(steadyG)$weight <- steadystate[,3]
superG <- graph.data.frame(superspreader, directed=F)
E(superG)$weight <- superspreader[,3]
steadyL <- layout.fruchterman.reingold(steadyG, params=list(weights=E(steadyG)$weight))
plot(steadyG,layout=steadyL)
superL <- layout.fruchterman.reingold(superG, params=list(weights=E(superG)$weight))
plot(superG,layout=superL)
subSteadyL <- steadyL[8:13,]
subSteadyG <- induced_subgraph(steadyG,v = c(8:13))
plot(subSteadyG)
plot(subSteadyG,layout=subSteadyL)
add_layout_(subSteadyG,subSteadyL)
add_layout_(subSteadyG,subSteadyL,overwrite = T)
add_layout_(subSteadyG,layout=subSteadyL,overwrite = T)
layout_
?layout_
add_layout_(subSteadyG,layout=subSteadyL,overwrite = T)
?graph_structure
?graph.structure
fastgreedy.community(superL)
fastgreedy.community(superG)
dendPlot(fastgreedy.community(superG))
dendPlot(fastgreedy.community(steadyG))
steadyC <- fastgreedy.community(steadyG)
steadyC$names
steadyC$membership
steadyC$merges
steadyC$modularity
dendPlot(fastgreedy.community(steadyG),use.modularity=T)
dendPlot(fastgreedy.community(steadyG),use.modularity=F)
as.phylo(fastgreedy.community(steadyG))
to.phylo(fastgreedy.community(steadyG))
dendPlot(fastgreedy.community(steadyG))
setwd("~/Scratch/gits/pfdisco/reports/160210_reference_panels_adcl/")
library(knitr)
opts_chunk$set(fig.width=13, fig.height=8)
adcls <- read.table("all_iters_35_panel.txt")
head(adcls)
colnames(adcls)<-c("N","cultureAdapted","adcl")
ggplot(adcls,aes(x=cultureAdapted,y=adcl)) + geom_path()
library(ggplot2)
ggplot(adcls,aes(x=cultureAdapted,y=adcl)) + geom_path()
ggplot(adcls,aes(x=cultureAdapted,y=adcl,group=cultureAdapted)) + geom_path()
ggplot(adcls,aes(x=cultureAdapted,y=adcl,group=cultureAdapted)) + geom_ribbon()
ggplot(adcls,aes(x=cultureAdapted,y=adcl,group=cultureAdapted)) + geom_smooth()
ggplot(adcls,aes(x=cultureAdapted,y=adcl,group=cultureAdapted)) + geom_boxplot()
adcls <- read.table("all_iters_35_panel.txt")
colnames(adcls)<-c("N","cultureAdapted","adcl")
ggplot(adcls,aes(x=cultureAdapted,y=adcl,group=cultureAdapted)) + geom_ribbon()
ggplot(adcls,aes(x=cultureAdapted,y=adcl,group=cultureAdapted)) + geom_boxplot()
adcls <- read.table("all_iters_panel.txt")
colnames(adcls)<-c("N","cultureAdapted","adcl")
ggplot(adcls,aes(x=cultureAdapted,y=adcl,group=cultureAdapted,colour=N)) + geom_boxplot()
head(colnames)
head(adcls)
adcls$group=paste(adcls$N,adcls$cultureAdapted)
ggplot(adcls,aes(x=cultureAdapted,y=adcl,group=group,colour=N)) + geom_boxplot()
adcls$cultureAdapted <- factor(adcls$cultureAdapted)
adcls$cultureAdapted[adcls$cultureAdapted==50] <- "Random"
seq(0,50)
adcls$cultureAdapted <- factor(adcls$cultureAdapted,levels=c(seq(0,45),"RAND"))
adcls$cultureAdapted[adcls$cultureAdapted==50] <- "RAND"
adcls <- read.table("all_iters_panel.txt")
colnames(adcls)<-c("N","cultureAdapted","adcl")
adcls$cultureAdapted <- factor(adcls$cultureAdapted,levels=c(seq(0,45),"RAND"))
adcls$cultureAdapted[adcls$cultureAdapted==50] <- "RAND"
adcls$group=paste(adcls$N,adcls$cultureAdapted)
ggplot(adcls,aes(x=cultureAdapted,y=adcl,group=group,colour=N)) + geom_boxplot()
adcls <- read.table("all_iters_panel.txt")
colnames(adcls)<-c("N","cultureAdapted","adcl")
adcls$cultureAdapted <- factor(adcls$cultureAdapted,levels=c(seq(0,45),"RAND"))
adcls$cultureAdapted[adcls$cultureAdapted=="50"] <- "RAND"
adcls$group=paste(adcls$N,adcls$cultureAdapted)
ggplot(adcls,aes(x=cultureAdapted,y=adcl,group=group,colour=N)) + geom_boxplot()
adcls$cultureAdapted[adcls$cultureAdapted=="50"]
adcls$cultureAdapted[adcls$cultureAdapted=="RAND"]
adcls <- read.table("all_iters_panel.txt")
colnames(adcls)<-c("N","cultureAdapted","adcl")
adcls$cultureAdapted <- factor(adcls$cultureAdapted,levels=c(as.character(seq(0,45)),"RAND"))
adcls$cultureAdapted[adcls$cultureAdapted=="50"] <- "RAND"
adcls$group=paste(adcls$N,adcls$cultureAdapted)
ggplot(adcls,aes(x=cultureAdapted,y=adcl,group=group,colour=N)) + geom_boxplot()
c(as.character(seq(0,45)),"RAND")
adcls <- read.table("all_iters_panel.txt")
colnames(adcls)<-c("N","cultureAdapted","adcl")
adcls$cultureAdapted <- factor(adcls$cultureAdapted,labels=c(as.character(seq(0,45)),"RAND"))
adcls$cultureAdapted[adcls$cultureAdapted=="50"] <- "RAND"
adcls$group=paste(adcls$N,adcls$cultureAdapted)
ggplot(adcls,aes(x=cultureAdapted,y=adcl,group=group,colour=N)) + geom_boxplot()
adcls[adcls$cultureAdapted %in% c(43:45)]
adcls[adcls$cultureAdapted %in% c(43:45),]
adcls <- adcls[!adcls$cultureAdapted %in% c(43:45),]
adcls$group=paste(adcls$N,adcls$cultureAdapted)
ggplot(adcls,aes(x=cultureAdapted,y=adcl,group=group,colour=N)) + geom_boxplot()
adcls$N <- factor(adcls$N)
ggplot(adcls,aes(x=cultureAdapted,y=adcl,group=group,colour=N)) + geom_boxplot() + facet_grid(. ~ )
ggplot(adcls,aes(x=cultureAdapted,y=adcl,group=group,colour=N)) + geom_boxplot() + facet_grid(. ~ cultureAdaopted=="RAND")
ggplot(adcls,aes(x=cultureAdapted,y=adcl,group=group,colour=N)) + geom_boxplot() + facet_grid(. ~ cultureAdapted=="RAND")
adcls$RAND <- adcls$cultureAdapted=="RAND"
adcls <- adcls[!adcls$cultureAdapted %in% c(43:45),]
adcls$group=paste(adcls$N,adcls$cultureAdapted)
ggplot(adcls,aes(x=cultureAdapted,y=adcl,group=group,colour=N)) + geom_boxplot() + facet_grid(. ~ )
ggplot(adcls,aes(x=cultureAdapted,y=adcl,group=group,colour=N)) + geom_boxplot() + facet_grid(. ~ RAND)
ggplot(adcls,aes(x=cultureAdapted,y=adcl,group=group,colour=N)) + geom_boxplot() + facet_grid(. ~ RAND,scale="free_x")
ggplot(adcls,aes(x=cultureAdapted,y=adcl,group=group,colour=N)) + geom_boxplot() + facet_grid(. ~ RAND,scale="free_x",space ="free_x")
adcls <- read.table("all_iters_panel.txt")
colnames(adcls)<-c("N","cultureAdapted","adcl")
adcls$cultureAdapted <- factor(adcls$cultureAdapted,labels=c(as.character(seq(0,45)),"RAND","RAND","RAND"))
adcls$cultureAdapted <- factor(adcls$cultureAdapted,labels=c(as.character(seq(0,45)),"RAND_35","RAND_40","RAND_50"))
adcls <- read.table("all_iters_panel.txt")
colnames(adcls)<-c("N","cultureAdapted","adcl")
adcls$cultureAdapted <- factor(adcls$cultureAdapted,labels=c(as.character(seq(0,45)),"RAND_35","RAND_40","RAND_50"))
adcls$N <- factor(adcls$N)
adcls$RAND <- adcls$cultureAdapted>=50
adcls <- read.table("all_iters_panel.txt")
colnames(adcls)<-c("N","cultureAdapted","adcl")
adcls$RAND <- adcls$cultureAdapted>=50
adcls$cultureAdapted <- factor(adcls$cultureAdapted,labels=c(as.character(seq(0,45)),"RAND_35","RAND_40","RAND_50"))
adcls$N <- factor(adcls$N)
adcls <- adcls[!adcls$cultureAdapted %in% c(43:45),]
adcls$group=paste(adcls$N,adcls$cultureAdapted)
ggplot(adcls,aes(x=cultureAdapted,y=adcl,group=group,colour=N)) + geom_boxplot() +
facet_grid(. ~ RAND,scale="free_x",space= "free_x",)
adcls$cultureAdapted <- factor(adcls$cultureAdapted,labels=c(as.character(seq(0,45)),"R_35","R_40","R_50"))
adcls <- read.table("all_iters_panel.txt")
colnames(adcls)<-c("N","cultureAdapted","adcl")
adcls$RAND <- adcls$cultureAdapted>=50
adcls$cultureAdapted <- factor(adcls$cultureAdapted,labels=c(as.character(seq(0,45)),"R_35","R_40","R_50"))
adcls$N <- factor(adcls$N)
adcls <- adcls[!adcls$cultureAdapted %in% c(43:45),]
adcls$group=paste(adcls$N,adcls$cultureAdapted)
ggplot(adcls,aes(x=cultureAdapted,y=adcl,group=group,colour=N)) + geom_boxplot() +
facet_grid(. ~ RAND,scale="free_x",space= "free_x",)
knit("plotADCL_graphs.Rmd")
knit("plotADCL_graphs.Rmd")
adcl_groups <- read.table("daniels.thies.CA.meta")
adcl_groups <- read.table("daniels.thies.CA.meta",sep="\t")
head(adcl_groups)
adcl_groups <- read.table("daniels.thies.CA.meta",sep="\t",headers=T)
adcl_groups <- read.table("daniels.thies.CA.meta",sep="\t",header=T)
head(adcl_groups)
adcl_groups <- read.table("daniels.thies.CA.txt",sep="\t",header=T)
```
head(adcl_groups)
adcl_groups <- read.table("daniels.thies.CA.txt",sep="\t",header=T)
head(adcl_groups)
subset(adcl_groups,sum(ADCL_35,ADCL_40,ADCL_45)==3)
apply(adcl_groups[,6:8],1,FUN=sum)
adcl_groups$sum=apply(adcl_groups[,6:8],1,FUN=sum)
subset(adcl_groups,sum==3)
subset(adcl_groups,ADCL_35==1)
subset(adcl_groups,ADCL_35==1,c("name","year")
)
subset(adcl_groups,ADCL_35==1,c("name","year","THIS"))
setAll <- adcl_groups[,c("name","year","")]
setAll <- adcl_groups[,c("name","year")]
setAll <- adcl_groups[,c("name","year")]
setALL$set=0
setAll <- adcl_groups[,c("name","year")]
setAll$set=0
sets <- rbind(set35,set40,set45,setAll)
set35 <- subset(adcl_groups,ADCL_35==1,c("name","year"))
set35$set=35
set40 <- subset(adcl_groups,ADCL_40==1,c("name","year"))
set40$set=40
set45 <- subset(adcl_groups,ADCL_45==1,c("name","year"))
set45$set=45
setAll <- adcl_groups[,c("name","year")]
setAll$set=0
sets <- rbind(set35,set40,set45,setAll)
rm(set35,set40,set45,setAll)
ggplot2(sets,x=year,group=set) + geom_density()
library(knitr)
library(ggplot2)
ggplot2(sets,x=year,group=set) + geom_density()
ggplot(sets,x=year,group=set) + geom_density()
ggplot(sets,aes(x=year,group=set)) + geom_density()
ggplot(sets,aes(x=year,group=set,colour=set)) + geom_density()
set35 <- subset(adcl_groups,ADCL_35==1,c("name","year"))
set35$set="35"
set40 <- subset(adcl_groups,ADCL_40==1,c("name","year"))
set40$set="40"
set45 <- subset(adcl_groups,ADCL_45==1,c("name","year"))
set45$set="45"
setAll <- adcl_groups[,c("name","year")]
setAll$set="0"
sets <- rbind(set35,set40,set45,setAll)
rm(set35,set40,set45,setAll)
ggplot(sets,aes(x=year,group=set,colour=set)) + geom_density()
rm(set35,set40,set45,setAll)
cols<-c("black","#000044","#0000AA","#0000DD")
names(cols)<-c("0","35","40","45")
ggplot(sets,aes(x=year,group=set,colour=set)) + geom_density() + scale_color_discrete(values=cols)
ggplot(sets,aes(x=year,group=set,colour=set)) + geom_density() + scale_color_manual(values=cols)
cols<-c("black","#000088","#4444AA","#9999FF")
names(cols)<-c("0","35","40","45")
ggplot(sets,aes(x=year,group=set,colour=set)) + geom_density() + scale_color_manual(values=cols)
subset(adcl_groups,sum==3)
ggplot(sets,aes(x=year,group=set,colour=set)) + geom_histogram() + scale_color_manual(values=cols)
ggplot(sets,aes(x=year,group=set,colour=set)) + geom_density(position="dodge") + scale_color_manual(values=cols)
ggplot(sets,aes(x=year,group=set,fill=set)) + geom_histogram(position="dodge") + scale_color_manual(values=cols)
ggplot(sets,aes(x=year,group=set,fill=set)) + geom_histogram(position="dodge") + scale_fill_manual(values=cols)
ggplot(sets,aes(x=year,group=set,fill=set)) + geom_histogram(position="dodge") + scale_fill_manual(values=cols) + scale_y_log10
ggplot(sets,aes(x=year,group=set,fill=set)) + geom_histogram(position="dodge") + scale_fill_manual(values=cols) + scale_y_log10()
ggplot(sets,aes(x=year,group=set,fill=set)) + geom_histogram(position="dodge") + scale_fill_manual(values=cols)
setDisco <- subset(adcl_groups,DISCO==1,c("name","year"))
setDisco$set="Disco"
set35 <- subset(adcl_groups,ADCL_35==1,c("name","year"))
set35$set="35"
set35 <- subset(adcl_groups,ADCL_35==1,c("name","year"))
set35$set="35"
set40 <- subset(adcl_groups,ADCL_40==1,c("name","year"))
set40$set="40"
set45 <- subset(adcl_groups,ADCL_45==1,c("name","year"))
set45$set="45"
setAll <- adcl_groups[,c("name","year")]
setAll$set="All"
setDisco <- subset(adcl_groups,DISCO==1,c("name","year"))
setDisco$set="Disco"
sets <- rbind(set35,set40,set45,setAll,setDisco)
rm(set35,set40,set45,setAll)
cols<-c("black","#000088","#4444AA","#9999FF","white")
names(cols)<-c("All","35","40","45","Disco")
ggplot(sets,aes(x=year,group=set,colour=set)) + geom_density() + scale_color_manual(values=cols)
cols<-c("black","#000088","#4444AA","#9999FF","grey")
names(cols)<-c("All","35","40","45","Disco")
ggplot(sets,aes(x=year,group=set,colour=set)) + geom_density() + scale_color_manual(values=cols)
ggplot(sets,aes(x=year,group=set,fill=set)) + geom_histogram(position="dodge") + scale_fill_manual(values=cols)
table(adcl_groups[,c("year","haplotype")])
table(adcl_groups[,c("year","Haplotype")])
head(adcl_groups)
table(adcl_groups[,c("year","haplotype.number")])
melt(table(adcl_groups[,c("year","haplotype.number")]))
library(reshape2)
melt(table(adcl_groups[,c("year","haplotype.number")]))
haplo_dist <- melt(table(adcl_groups[,c("year","haplotype.number")]))
ggplot(haplo_dist,aes(x=year,y=value)) + geom_violin()
ggplot(haplo_dist,aes(x=year,y=value,group=year)) + geom_violin()
ggplot(haplo_dist,aes(x=year,y=value,group=year,colour=year)) + geom_violin()
ggplot(sets,aes(x=year,group=set,colour=set)) + geom_density() + scale_color_manual(values=cols)
haplo_dist <- subset(haplo_dist,value>0)
ggplot(subset(haplo_dist,aes(x=year,y=value,group=year,colour=year)) + geom_violin()
ggplot(haplo_dist,aes(x=year,y=value,group=year,colour=year)) + geom_violin()\c
haplo_dist <- subset(haplo_dist,value>0)
ggplot(subset(haplo_dist,aes(x=year,y=value,group=year,colour=year)) + geom_violin()
ggplot(haplo_dist,aes(x=year,y=value,group=year,colour=year)) + geom_violin()
```
ggplot(haplo_dist,aes(x=year,y=value,group=year,colour=year)) + geom_violin()
ggplot(haplo_dist,aes(x=year,y=value,group=year,colour=year)) + geom_jitter()
haplo_dist <- melt(table(adcl_groups[,c("year","haplotype.number")]))
ggplot(haplo_dist,aes(x=year,y=value,group=year,colour=year)) + geom_jitter()
haplo_dist <- subset(haplo_dist,value>0)
ggplot(haplo_dist,aes(x=year,y=value,group=year,colour=year)) + geom_jitter()
ggplot(subset(haplo_dist,value>1),aes(x=year,y=value,group=year,colour=year)) + geom_jitter()
table(adcl_groups[,c("year","haplotype.number")])
haplos <- table(adcl_groups[,c("year","haplotype.number")])
apply(haplos[,1:dim(haplos)[[2]]])
apply(haplos[,1:dim(haplos)[[2]]],2,FUN=sum)
apply(haplos[,1:dim(haplos)[[2]]]>1,2,FUN=sum)
haplos[,1:dim(haplos)[[2]]]>1
apply(haplos[,1:dim(haplos)[[2]]]>1,2,FUN=sum)
apply(haplos[,1:dim(haplos)[[2]]]>1,1,FUN=sum)
cbind(haplos$year,apply(haplos[,1:dim(haplos)[[2]]]>1,1,FUN=sum),apply(haplos[,1:dim(haplos)[[2]]]>0,1,FUN=sum))
cbind(haplos[,1],apply(haplos[,1:dim(haplos)[[2]]]>1,1,FUN=sum),apply(haplos[,1:dim(haplos)[[2]]]>0,1,FUN=sum))
cbind(apply(haplos[,1:dim(haplos)[[2]]]>1,1,FUN=sum),apply(haplos[,1:dim(haplos)[[2]]]>0,1,FUN=sum))
data.frame(year=rownames(haplos),"multi"=apply(haplos[,1:dim(haplos)[[2]]]>1,1,FUN=sum),"ston"=apply(haplos[,1:dim(haplos)[[2]]]>0,1,FUN=sum))
haplos <- data.frame(year=rownames(haplos),"multi"=apply(haplos[,1:dim(haplos)[[2]]]>1,1,FUN=sum),"ston"=apply(haplos[,1:dim(haplos)[[2]]]>0,1,FUN=sum))
haplos <- data.frame(year=rownames(haplos),"multi"=apply(haplos[,1:dim(haplos)[[2]]]>1,1,FUN=sum),"all"=apply(haplos[,1:dim(haplos)[[2]]]>0,1,FUN=sum))
haplos <- table(adcl_groups[,c("year","haplotype.number")])
haplos <- data.frame(year=rownames(haplos),"multi"=apply(haplos[,1:dim(haplos)[[2]]]>1,1,FUN=sum),"all"=apply(haplos[,1:dim(haplos)[[2]]]>0,1,FUN=sum))
haplos$prop <- haplos$multi/haplos$all
haplos
haplos <- table(adcl_groups[,c("year","haplotype.number")])
haplos <- data.frame(year=rownames(haplos),"multi"=apply(haplos[,1:dim(haplos)[[2]]]>1,1,FUN=sum),"all"=apply(haplos[,1:dim(haplos)[[2]]]>0,1,FUN=sum))
haplos$prop <- haplos$multi/haplos$all'
haplos
haplos <- table(adcl_groups[,c("year","haplotype.number")])
haplos <- data.frame(year=rownames(haplos),"multi"=apply(haplos[,1:dim(haplos)[[2]]]>1,1,FUN=sum),"all"=apply(haplos[,1:dim(haplos)[[2]]]>0,1,FUN=sum))
haplos$prop <- haplos$multi/haplos$all
haplos
''
haplos <- table(adcl_groups[,c("year","haplotype.number")])
haplos <- data.frame(year=rownames(haplos),"multi"=apply(haplos[,1:dim(haplos)[[2]]]>1,1,FUN=sum),"all"=apply(haplos[,1:dim(haplos)[[2]]]>0,1,FUN=sum))
haplos$prop <- haplos$multi/haplos$all
haplos
haplo_dist <- melt(table(adcl_groups[,c("year","haplotype.number")]))
haplo_dist <- subset(haplo_dist,value>0)
ggplot(haplo_dist,aes(x=year,y=value,group=year,colour=year)) + geom_violin()
ggplot(haplo_dist,aes(x=year,y=value,group=year,colour=year)) + geom_jitter()
ggplot(subset(haplo_dist,value>1),aes(x=year,y=value,group=year,colour=year)) + geom_jitter()
ggplot(haplo_dist,aes(x=year,y=value,group=year,colour=year)) + geom_violin()
knit("plotADCL_graphs.md")
knit("plotADCL_graphs.md")
knit("plotADCL_graphs.Rmd")
knit("plotADCL_graphs.Rmd")
knit("plotADCL_graphs.Rmd")
knit("plotADCL_graphs.Rmd")
knit("plotADCL_graphs.Rmd")
knit("plotADCL_graphs.Rmd")
setwd("../160211_pf3k_indel_rations_v1/")
adcls <- read.table("SNP_INDEL_Pf3D7_v3.1K.100Inds.in-del.tab.txt")
snpindel <- read.table("SNP_INDEL_Pf3D7_v3.1K.100Inds.in-del.tab.txt")
head(snpindel)
melt(snpindel)
snpindel$from = rownames(snpindel)
melt(snpindel)
unique(melt(snpindel))
snpindel$from >= snpindel$variable
snpindel$from >= snpindel$variable
snpindel <- melt(snpindel)
snpindel$from >= snpindel$variable
snpindel$from <- factor(snpindel$from)
snpindel$variable <- factor(snpindel$variable,levels=order(snpindel$variable)
)
snpindel$from <- factor(snpindel$from,levels=order(snpindel$from))
snpindel$variable <- factor(snpindel$variable,levels=order(snpindel$variable))
as.numerical(snpindel$from) >= snpindel$variable
as.numeric(snpindel$from) >= snpindel$variable
as.numeric(snpindel$from) >= as.numeric(snpindel$variable)
as.numeric(snpindel$from)
snpindel$from
snpindel <- read.table("SNP_INDEL_Pf3D7_v3.1K.100Inds.in-del.tab.txt")
snpindel$from = rownames(snpindel)
snpindel <- melt(snpindel)
snpindel$from <- factor(snpindel$from,levels=order(snpindel$from))
snpindel$variable <- factor(snpindel$variable,levels=order(snpindel$variable))
as.numeric(snpindel$from) >= as.numeric(snpindel$variable)
head(snpindel)
snpindel <- read.table("SNP_INDEL_Pf3D7_v3.1K.100Inds.in-del.tab.txt")
snpindel$from = rownames(snpindel)
snpindel <- melt(snpindel)
head(snpindel)
snpindel$from <- factor(snpindel$from ,levels=sort(snpindel$from))
snpindel$from <- factor(snpindel$from ,levels=unique(sort(snpindel$from)))
snpindel$variable <- factor(snpindel$variable,levels=unique(sort(snpindel$variable)))
snpindel <- melt(snpindel)
snpindel$from <- factor(snpindel$from ,levels=unique(sort(snpindel$from)))
snpindel$variable <- factor(snpindel$variable,levels=unique(sort(snpindel$variable)))
as.numeric(snpindel$from) >= as.numeric(snpindel$variable)
snpIndel <- snpIndel[as.numeric(snpindel$from) < as.numeric(snpindel$variable),]
snpindel <- snpindel[as.numeric(snpindel$from) < as.numeric(snpindel$variable),]
snpindel <- read.table("SNP_INDEL_Pf3D7_v3.1K.100Inds.indel-snp.tab.txt")
snpindel$from = rownames(snpindel)
snpindel <- melt(snpindel)
snpindel$from <- factor(snpindel$from ,levels=unique(sort(snpindel$from)))
snpindel$variable <- factor(snpindel$variable,levels=unique(sort(snpindel$variable)))
snpindel <- snpindel[as.numeric(snpindel$from) < as.numeric(snpindel$variable),]
dist <- read.table("SNP_INDEL_Pf3D7_v3.1K.100Inds.dist.tab.txt")
dist$from = rownames(dist)
dist <- melt(dist)
dist$from <- factor(dist$from ,levels=unique(sort(dist$from)))
dist$variable <- factor(dist$variable,levels=unique(sort(dist$variable)))
dist <- dist[as.numeric(dist$from) < as.numeric(dist$variable),]
dist <- read.table("SNP_INDEL_Pf3D7_v3.1K.100Inds.dist.tab.txt")
dist <- read.table("SNP_INDEL_Pf3D7_v3.1K.100Inds.dist.tab.txt",sep="\t")
dist$from = rownames(dist)
dist <- melt(dist)
dist$from <- factor(dist$from ,levels=unique(sort(dist$from)))
dist$variable <- factor(dist$variable,levels=unique(sort(dist$variable)))
dist <- dist[as.numeric(dist$from) < as.numeric(dist$variable),]
head(dist)
snpindel <- read.table("SNP_INDEL_Pf3D7_v3.1K.100Inds.indel-snp.tab.txt")
snpindel$from = rownames(snpindel)
snpindel <- melt(snpindel)
colnames(snpindel)[[3]]<-"snpindel"
snpindel$from <- factor(snpindel$from ,levels=unique(sort(snpindel$from)))
snpindel$variable <- factor(snpindel$variable,levels=unique(sort(snpindel$variable)))
snpindel <- snpindel[as.numeric(snpindel$from) < as.numeric(snpindel$variable),]
dist <- read.table("SNP_INDEL_Pf3D7_v3.1K.100Inds.dist.tab.txt",sep="\t")
dist$from = rownames(dist)
dist <- melt(dist)
colnames(dist)[[3]]<-"dist"
dist$from <- factor(dist$from ,levels=unique(sort(dist$from)))
dist$variable <- factor(dist$variable,levels=unique(sort(dist$variable)))
dist <- dist[as.numeric(dist$from) < as.numeric(dist$variable),]
merge(dist,snpindel)
cf <- merge(dist,snpindel)
ggplot(cf,aes(x=dist,y=snpindel)) + geom_point()
head(cf)
ggplot(cf,aes(x=dist,y=snpindel,colour=from)) + geom_point()
ggplot(cf,aes(x=dist,y=snpindel,colour=to)) + geom_point()
ggplot(cf,aes(x=dist,y=snpindel,colour=variable)) + geom_point()
ggplot(cf,aes(x=dist,y=snpindel,colour=variable)) + geom_point() + scale_y_log10()
ggplot(cf,aes(x=dist,y=snpindel,colour=variable)) + geom_point()
subset(cf,from %in% s & variable %in% s)
s<-unique(sort(snpindel$variable))[1:20]
subset(cf,from %in% s & variable %in% s)
subset(cf,from %in% s && variable %in% s)
subset(cf,from %in% s)
s
cf
colnames(cf)<-c("from","to","dist","ratio")
cf <- merge(dist,snpindel)
colnames(cf)<-c("from","to","dist","ratio")
cf$from <- as.character(cf$from)
cf$to <- as.character(cf$to)
s<-unique(sort(cf$to))[1:20]
subset(cf,from %in% s && variable %in% s)
subset(cf,from %in% s && to %in% s)
subset(cf,from %in% s)
s
cf
subset(cf,to %in% s)
dim(subset(cf,to %in% s))
dim(cf)
dist <- read.table("SNP_INDEL_Pf3D7_v3.1K.100Inds.dist.tab.txt",sep="\t")
dist$from = rownames(dist)
dist <- melt(dist)
colnames(dist)[[3]]<-"dist"
dist$from <- factor(dist$from ,levels=unique(sort(dist$from)))
dist$variable <- factor(dist$variable,levels=unique(sort(dist$variable)))
View(dist)
dist <- read.table("SNP_INDEL_Pf3D7_v3.1K.100Inds.dist.tab.txt",sep="\t")
dist
lowertri(snpindel)
lower.tri(snpindel)
snpindel[lower.tri(snpindel)]
snpindel <- read.table("SNP_INDEL_Pf3D7_v3.1K.100Inds.indel-snp.tab.txt")
snpindel[lower.tri(snpindel)]
snpindel <- read.table("SNP_INDEL_Pf3D7_v3.1K.100Inds.indel-snp.tab.txt")
snpindel[lower.tri(snpindel)]<-NA
snpindel$from = rownames(snpindel)
snpindel <- melt(snpindel)
colnames(snpindel)[[3]]<-"snpindel"
snpindel$from <- factor(snpindel$from ,levels=unique(sort(snpindel$from)))
snpindel$variable <- factor(snpindel$variable,levels=unique(sort(snpindel$variable)))
snpindel <- snpindel[as.numeric(snpindel$from) < as.numeric(snpindel$variable),]
dist <- read.table("SNP_INDEL_Pf3D7_v3.1K.100Inds.dist.tab.txt",sep="\t")
dist$from = rownames(dist)
dist <- melt(dist)
colnames(dist)[[3]]<-"dist"
dist$from <- factor(dist$from ,levels=unique(sort(dist$from)))
dist$variable <- factor(dist$variable,levels=unique(sort(dist$variable)))
#dist <- dist[as.numeric(dist$from) < as.numeric(dist$variable),]
snpindel
snpindel <- snpindel[!is.na(snpindel$snpindel)]
snpindel <- snpindel[!is.na(snpindel$snpindel),]
dist <- dist[!is.na(dist$dist),]
cf <- merge(dist,snpindel)
colnames(cf)<-c("from","to","dist","ratio")
cf$from <- as.character(cf$from)
cf$to <- as.character(cf$to)
s<-unique(sort(cf$to))[1:20]
subset(cf,from %in% s)
cf
s
head(cf)
s
subset(cf,from %in% s)
subset(cf,to %in% s)
cf$from <- as.character(cf$from)
cf$to <- as.character(cf$to)
s<-unique(sort(cf$to))[1:20]
subset(cf,from %in% s)
subset(cf,to %in% s)
cf$to <- gsub("-",".",as.character(cf$to))
s<-unique(sort(cf$to))[1:20]
subset(cf,to %in% s)
subset(cf,to %in% s & from %in% s)
subset(cf,to %in% s)
head(cf)
subset(cf,to %in% s)
cf$from <- gsub("-",".",as.character(cf$from))
cf$to <- gsub("-",".",as.character(cf$to))
s<-unique(sort(cf$to))[1:20]
subset(cf,to %in% s & from %in% s)
ggplot(subset(cf,to %in% s & from %in% s),aes(x=dist,y=snpindel,colour=variable)) + geom_point()
ggplot(cf,aes(x=dist,y=snpindel,colour=to)) + geom_point()
ggplot(cf,aes(x=dist,y=snpindel,colour=variable)) + geom_point()head(cf)
ehad(cf)
head(cf)
ggplot(cf,aes(x=dist,y=ratio,colour=to)) + geom_point()
s<-unique(sort(cf$to))[1:20]
ggplot(subset(cf,to %in% s & from %in% s),aes(x=dist,y=ratio,colour=to)) + geom_point()
ggplot(subset(cf,to %in% s & from %in% s),aes(x=dist,y=ratio,colour=from)) + geom_point()
s<-unique(sort(cf$to))[21:40]
ggplot(subset(cf,to %in% s & from %in% s),aes(x=dist,y=ratio,colour=from)) + geom_point()
ggplot(subset(cf,to %in% s & from %in% s),aes(x=dist,y=ratio,colour=from)) + geom_point()
s<-unique(sort(cf$to))[41:60]
ggplot(subset(cf,to %in% s & from %in% s),aes(x=dist,y=ratio,colour=from)) + geom_point()
ggplot(cf,aes(x=dist,y=ratio,colour=to)) + geom_point() + scale_y_log10()
ggplot(subset(cf,to %in% s & from %in% s),aes(x=dist,y=ratio,colour=from)) + geom_point() + scale_y_log10()
ggplot(subset(cf,to %in% s & from %in% s),aes(x=dist,y=ratio,colour=from)) + geom_point() + scale_y_log10() + geom_hline(yintersect=1)
ggplot(cf,aes(x=dist,y=ratio,colour=to)) + geom_point() + scale_y_log10() + geom_hline(yintersect=1)
ggplot(cf,aes(x=dist,y=ratio,colour=to)) + geom_point() + scale_y_log10() + geom_hline(yintersect=2)
ggplot(cf,aes(x=dist,y=ratio,colour=to)) + geom_point() + scale_y_log10() + geom_hline(yintersect=2)
ggplot(subset(cf,to %in% s & from %in% s),aes(x=dist,y=ratio,colour=from)) + geom_point() + scale_y_log10() + geom_hline(yintersect=2)
ggplot(subset(cf,to %in% s & from %in% s),aes(x=dist,y=ratio,colour=from)) + geom_point() + scale_y_log10() + geom_hline(xintersect=2)
ggplot(subset(cf,to %in% s & from %in% s),aes(x=dist,y=ratio,colour=from)) + geom_point() + scale_y_log10() + geom_hline(aes(xintersect=2))
ggplot(subset(cf,to %in% s & from %in% s),aes(x=dist,y=ratio,colour=from)) + geom_point() + scale_y_log10() + geom_hline(yintercept=2)
ggplot(cf,aes(x=dist,y=ratio,colour=to)) + geom_point() + scale_y_log10() + geom_hline(yintercept=2)
