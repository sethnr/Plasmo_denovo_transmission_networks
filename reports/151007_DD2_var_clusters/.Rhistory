load("~/Google Drive/misc/macports_150504/pkglist.Rdata")
install.packages(save.pkg.list)
source("http://bioconductor.org/biocLite.R")
biocLite()
?write.table
setwd("~/Scratch//gits//pfdisco/analyses/wetlab_validation/")
library(ggplot2)
library(reshape2)
fileroot <- "DD2FDKDiscords.PFXDD2"
read.table(paste(fileroot,"012",sep="."))
genos <- read.table(paste(fileroot,"012",sep="."))
pos <- read.table(paste(fileroot,"012","pos",sep="."))
ind <- read.table(paste(fileroot,"012","ind",sep="."))
indv <- read.table(paste(fileroot,"012","indv",sep="."))
indv
indv <- read(paste(fileroot,"012","indv",sep="."))
pos <- read.table(paste(fileroot,"012","pos",sep="."))[,1]
indv <- read.table(paste(fileroot,"012","indv",sep="."))[,1]
pos
pos <- read.table(paste(fileroot,"012","pos",sep="."))
pos
pos <- read.table(paste(fileroot,"012","pos",sep="."))
indv <- read.table(paste(fileroot,"012","indv",sep="."))[,1]
genos <- read.table(paste(fileroot,"012",sep="."))
genos
genos <- t(read.table(paste(fileroot,"012",sep=".")))
genos <- cbind(pos,genos)
genos
genos[,2:]
genos[,2:dim(genos)[[2]]]
genos[,2:dim(genos)[[2]]]
genos[,2:dim(genos)[[1]]]
genos[,2:dim(genos)[[2]]]
genos[2:dim(genos)[[1]],]
genotab <- cbind(pos,genos[2:dim(genos)[[1]],])
colnames(genotab)<-c("chr","pos",indv)
genotab
melt(genotab,id.vars =c("chr","pos"))
indv
colnames(genotab)<-c("chr","pos",as.character(indv))
melt(genotab,id.vars =c("chr","pos"))
genos[genos==-1] <- NA
pos <- read.table(paste(fileroot,"012","pos",sep="."))
indv <- read.table(paste(fileroot,"012","indv",sep="."))[,1]
genos <- t(read.table(paste(fileroot,"012",sep=".")))
genos[genos==-1] <- NA
genotab <- cbind(pos,genos[2:dim(genos)[[1]],])
colnames(genotab)<-c("chr","pos",as.character(indv))
genotab.m <- melt(genotab,id.vars =c("chr","pos"))
ggplot(genotab.m,aes(x=pos,ymin=variable,ymax=variable+1,colour=value)) + geom_ribbon()
genotab.m$indi <- as.numeric(genotab.m$indv)
genotab <- cbind(pos,genos[2:dim(genos)[[1]],])
colnames(genotab)<-c("chr","pos",indv)
genotab.m <- melt(genotab,id.vars =c("chr","pos"))
genotab.m$indv <- indv[genotab.m$indv]
indv
indv[1,2,3]
indv[c(1,2,3)]
indv[c(1,2,3,3,3,3,3)]
genotab.m$indv <- indv[c(genotab.m$indv)]
genotab.m$indv
genotab.m$variable
genotab.m$indv <- indv[c(genotab.m$variable)]
ggplot(genotab.m,aes(x=pos,ymin=variable,ymax=variable+1,colour=value)) + geom_ribbon()
as.character(genotab.m$variable)
as.numeric(as.character(genotab.m$variable))
genotab.m$variable <- as.numeric(as.character(genotab.m$variable))
genotab.m$indv <- indv[c(genotab.m$variable)]
ggplot(genotab.m,aes(x=pos,ymin=variable,ymax=variable+1,colour=value)) + geom_ribbon()
ggplot(genotab.m,aes(x=pos,ymin=variable,ymax=variable+1,colour=value)) + geom_rect()
ggplot(genotab.m,aes(x=pos,ymin=variable,ymax=variable+1,colour=value)) + geom_ribbon()
ggplot(genotab.m,aes(x=pos,y=variable,colour=value)) + geom_line()
ggplot(genotab.m,aes(x=pos,y=variable,colour=value)) + geom_line() + facet_grid(~ x .)
.)
ggplot(genotab.m,aes(x=pos,y=variable,colour=value)) + geom_line() + facet_grid(. ~ chr)
ggplot(genotab.m,aes(x=pos,y=variable,colour=value)) + geom_line() + facet_grid(chr ~ .)
ggplot(genotab.m,aes(x=pos,y=variable,colour=value,group=indv)) + geom_line() + facet_grid(chr ~ .)
ggplot(genotab.m,aes(x=pos,y=indv,colour=value,group=indv)) + geom_line() + facet_grid(chr ~ .)
ggplot(genotab.m,aes(x=pos,y=indv,colour=value,group=indv)) + geom_point() + facet_grid(chr ~ .)
genotab.m$value <- as.factor(genotab.m$value)
ggplot(genotab.m,aes(x=pos,y=indv,colour=value,group=indv)) + geom_point() + facet_grid(chr ~ .)
pos
indv
genos
colnames(genos)<-indv
genos
genotab <- cbind(pos,genos[2:dim(genos)[[1]],])
colnames(genotab)[1:2]<-c("chr","pos")
head(genotab)
genotab.m <- melt(genotab,id.vars =c("chr","pos"))
genotab.m$variable <- as.numeric(as.character(genotab.m$variable))
genotab.m$indv <- indv[c(genotab.m$variable)]
genotab.m <- melt(genotab,id.vars =c("chr","pos"))
genotab.m$variable <- as.numeric(as.character(genotab.m$variable))
genotab.m <- melt(genotab,id.vars =c("chr","pos"))
genotab.m$value <- as.factor(genotab.m$value)
ggplot(genotab.m,aes(x=pos,y=indv,colour=value,group=indv)) + geom_point() + facet_grid(chr ~ .)
genotab.m <- melt(genotab,id.vars =c("chr","pos"),variable.name ="indv")
genotab.m$value <- as.factor(genotab.m$value)
ggplot(genotab.m,aes(x=pos,y=indv,colour=value,group=indv)) + geom_point() + facet_grid(chr ~ .)
levels(genotab.m$indv)
sorted(levels(genotab.m$indv))
sort(levels(genotab.m$indv))
factor(genotab.m$indv,levels=sort(levels(genotab.m$indv)))
genotab.m$indv
factor(genotab.m$indv,levels=sort(levels(genotab.m$indv)))
genotab.m$indv <- factor(genotab.m$indv,levels=sort(levels(genotab.m$indv)))
ggplot(genotab.m,aes(x=pos,y=indv,colour=value,group=indv)) + geom_point() + facet_grid(chr ~ .)
varClustPlot <- ggplot(genotab.m,aes(x=pos,y=indv,colour=value,group=indv)) + geom_point() + facet_grid(chr ~ .)
ggsave(varClustPlot,filename="DD2_mutation_clusters.eps",width=1200,height=800,units="mm")
ggsave(varClustPlot,filename="DD2_mutation_clusters.eps",width=800,height=500,units="mm")
ggsave(varClustPlot,filename="DD2_mutation_clusters.eps",width=300,height=210,units="mm")
if (!sys.interactive)
\c
setwd("../../reports/151007_DD2_var_clusters/")
library(ggplot2)
library(reshape2)
if (interactive()) {
fileroot <- "DD2FDKDiscords.PFXDD2"
} else{
fileroot <- commandArgs(TRUE)[1]
}
pos <- read.table(paste(fileroot,"012","pos",sep="."))
indv <- read.table(paste(fileroot,"012","indv",sep="."))[,1]
genos <- t(read.table(paste(fileroot,"012",sep=".")))
genos[genos==-1] <- NA
colnames(genos)<-indv
genotab <- cbind(pos,genos[2:dim(genos)[[1]],])
colnames(genotab)[1:2]<-c("chr","pos")
genotab.m <- melt(genotab,id.vars =c("chr","pos"),variable.name ="indv")
genotab.m$value <- as.factor(genotab.m$value)
#sort levels
genotab.m$indv <- factor(genotab.m$indv,levels=sort(levels(genotab.m$indv)))
varClustPlot <- ggplot(genotab.m,aes(x=pos,y=indv,colour=value,group=indv)) + geom_point() + facet_grid(chr ~ .)
varClustPlot
ggsave(varClustPlot,filename="DD2_mutation_clusters.eps",width=300,height=210,units="mm")
