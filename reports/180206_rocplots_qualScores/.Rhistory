inherit.aes=F,colour="blue",linetype="dashed",alpha=0.5) +
geom_segment(data=subset(bcrossrate,chrom==C & crossrate > 0.2 & pass==T),aes(x=mid+1e4,xend=mid+1e4,y=from/3,yend=to/3),
inherit.aes=F,colour="red",linetype="dashed",alpha=0.5) +
geom_point(size=0.5) +
facet_grid(sample ~ .) + ggtitle(paste(C,"cross rates by base"))+
theme(legend.position="bottom") + xlim(0,3.3e6) + ylim(0,0.34)
print(propplot)
head(bcrossrate)
propplot <- ggplot(subset(bcrossrate,chrom==C & pass==TRUE),aes(x=mid,y=crossrate)) +
geom_segment(data=subset(recombs,chrom==C),aes(x=co_pos_min-1e4,xend=co_pos_max+1e4,y=from/3,yend=to/3),
inherit.aes=F,colour="blue",linetype="dashed",alpha=0.5) +
geom_segment(data=subset(bcrossrate,chrom==C & crossrate > 0.2 & pass==T),aes(x=mid+1e4,xend=mid+1e4,y=0,yend=0.33),
inherit.aes=F,colour="red",linetype="dashed",alpha=0.5) +
geom_point(size=0.5) +
facet_grid(sample ~ .) + ggtitle(paste(C,"cross rates by base"))+
theme(legend.position="bottom") + xlim(0,3.3e6) + ylim(0,0.34)
print(propplot)
propplot <- ggplot(subset(bcrossrate,chrom==C & pass==TRUE),aes(x=mid,y=crossrate)) +
geom_segment(data=subset(recombs,chrom==C),aes(x=co_pos_min-1e4,xend=co_pos_max+1e4,y=from/3,yend=to/3),
inherit.aes=F,colour="blue",linetype="dashed",alpha=0.5) +
geom_segment(data=subset(bcrossrate,chrom==C & crossrate > 0.2 & pass==T),aes(x=mid,xend=mid,y=0,yend=0.33),
inherit.aes=F,colour="red",linetype="dashed",alpha=0.5) +
geom_point(size=0.5) +
facet_grid(sample ~ .) + ggtitle(paste(C,"cross rates by base"))+
theme(legend.position="bottom") + xlim(0,3.3e6) + ylim(0,0.34)
print(propplot)
propplot <- ggplot(subset(bcrossrate,chrom==C & pass==TRUE),aes(x=mid,y=crossrate)) +
geom_segment(data=subset(recombs,chrom==C),aes(x=co_pos_min-1e4,xend=co_pos_max+1e4,y=from/3,yend=to/3),
inherit.aes=F,colour="blue",linetype="dashed",alpha=0.5) +
geom_segment(data=subset(bcrossrate,chrom==C & crossrate > 0.2 & pass==T),aes(x=mid,xend=mid,y=0,yend=0.33),
inherit.aes=F,colour="red",linetype="dashed",alpha=1) +
geom_point(size=0.5) +
facet_grid(sample ~ .) + ggtitle(paste(C,"cross rates by base"))+
theme(legend.position="bottom") + xlim(0,3.3e6) + ylim(0,0.34)
print(propplot)
propplot <- ggplot(subset(bcrossrate,chrom==C & pass==TRUE),aes(x=mid,y=crossrate)) +
geom_segment(data=subset(recombs,chrom==C),aes(x=co_pos_min-1e4,xend=co_pos_max+1e4,y=from/3,yend=to/3),
inherit.aes=F,colour="blue",linetype="dashed",alpha=0.5) +
geom_segment(data=subset(bcrossrate,chrom==C & crossrate > 0.2 & pass==T),aes(x=mid,xend=mid,y=0,yend=0.33),
inherit.aes=F,colour="red",linetype="dashed",alpha=1,size=2) +
geom_point(size=0.5) +
facet_grid(sample ~ .) + ggtitle(paste(C,"cross rates by base"))+
theme(legend.position="bottom") + xlim(0,3.3e6) + ylim(0,0.34)
print(propplot)
propplot <- ggplot(subset(bcrossrate,chrom==C & pass==TRUE),aes(x=mid,y=crossrate)) +
geom_segment(data=subset(recombs,chrom==C),aes(x=co_pos_min-1e4,xend=co_pos_max+1e4,y=from/3,yend=to/3),
inherit.aes=F,colour="blue",linetype="dashed",alpha=0.5) +
geom_segment(data=subset(bcrossrate,chrom==C & crossrate > 0.2 & pass==T),aes(x=mid,xend=mid,y=0,yend=0.33),
inherit.aes=F,colour="red",linetype="dashed",alpha=1,size=0.5) +
geom_point(size=0.5) +
facet_grid(sample ~ .) + ggtitle(paste(C,"cross rates by base"))+
theme(legend.position="bottom") + xlim(0,3.3e6) + ylim(0,0.34)
print(propplot)
propplot <- ggplot(subset(bcrossrate,chrom==C & pass==TRUE),aes(x=mid,y=crossrate)) +
geom_segment(data=subset(recombs,chrom==C),aes(x=co_pos_min-1e4,xend=co_pos_max+1e4,y=from/3,yend=to/3),
inherit.aes=F,colour="blue",linetype="dashed",alpha=0.5) +
geom_segment(data=subset(bcrossrate,chrom==C & crossrate > 0.2 & pass==T),aes(x=mid,xend=mid,y=0,yend=0.33),
inherit.aes=F,colour="red",linetype="dashed",alpha=1,size=1) +
geom_point(size=0.5) +
facet_grid(sample ~ .) + ggtitle(paste(C,"cross rates by base"))+
theme(legend.position="bottom") + xlim(0,3.3e6) + ylim(0,0.34)
print(propplot)
propplot <- ggplot(subset(bcrossrate,chrom==C & pass==TRUE),aes(x=mid,y=crossrate)) +
geom_segment(data=subset(recombs,chrom==C),aes(x=co_pos_min-1e4,xend=co_pos_max+1e4,y=from/3,yend=to/3),
inherit.aes=F,colour="blue",linetype="dashed",alpha=0.5) +
geom_segment(data=subset(bcrossrate,chrom==C & crossrate > 0.2 & pass==T),aes(x=mid,xend=mid,y=0,yend=0.33),
inherit.aes=F,colour="red",linetype="dotted",alpha=1,size=1) +
geom_point(size=0.5) +
facet_grid(sample ~ .) + ggtitle(paste(C,"cross rates by base"))+
theme(legend.position="bottom") + xlim(0,3.3e6) + ylim(0,0.34)
print(propplot)
propplot <- ggplot(subset(bcrossrate,chrom==C & pass==TRUE),aes(x=mid,y=crossrate)) +
geom_segment(data=subset(recombs,chrom==C),aes(x=co_pos_min-1e4,xend=co_pos_max+1e4,y=from/3,yend=to/3),
inherit.aes=F,colour="blue",linetype="dashed",alpha=0.5) +
geom_point(data=subset(bcrossrate,chrom==C & crossrate > 0.2 & pass==T),aes(x=mid,0.3),
inherit.aes=F,colour="red",size=3) +
geom_point(size=0.5) +
facet_grid(sample ~ .) + ggtitle(paste(C,"cross rates by base"))+
theme(legend.position="bottom") + xlim(0,3.3e6) + ylim(0,0.34)
print(propplot)
for(C in levels(haplinks$chrom)) {
propplot <- ggplot(subset(bcrossrate,chrom==C & pass==TRUE),aes(x=mid,y=crossrate)) +
geom_segment(data=subset(recombs,chrom==C),aes(x=co_pos_min-1e4,xend=co_pos_max+1e4,y=from/3,yend=to/3),
inherit.aes=F,colour="blue",linetype="dashed",alpha=0.5) +
geom_point(data=subset(bcrossrate,chrom==C & crossrate > 0.2 & pass==T),aes(x=mid,0.3),
inherit.aes=F,colour="red",size=3) +
geom_point(size=0.5) +
facet_grid(sample ~ .) + ggtitle(paste(C,"cross rates by base"))+
theme(legend.position="bottom") + xlim(0,3.3e6) + ylim(0,0.34)
print(propplot)
}
propplot <- ggplot(subset(bcrossrate,sample==S & pass==TRUE),aes(x=mid,y=crossrate)) +
geom_segment(data=subset(recombs,sample==S),aes(x=co_pos_min-1e4,xend=co_pos_max+1e4,y=from/3,yend=to/3),
inherit.aes=F,colour="blue",linetype="dashed",alpha=0.5) +
geom_point(data=subset(bcrossrate,sample==S & crossrate > 0.2 & pass==T),aes(x=mid,0.3),
inherit.aes=F,colour="red",size=3) +
geom_point(size=0.5) +
facet_grid(chrom ~ .) + ggtitle(paste(S,"cross rates by base"))+
theme(legend.position="bottom") + xlim(0,3.3e6) + ylim(0,0.34)
for(S in levels(haplinks$sample)[c(1,2,7,8)]) {
propplot <- ggplot(subset(bcrossrate,sample==S & pass==TRUE),aes(x=mid,y=crossrate)) +
geom_segment(data=subset(recombs,sample==S),aes(x=co_pos_min-1e4,xend=co_pos_max+1e4,y=from/3,yend=to/3),
inherit.aes=F,colour="blue",linetype="dashed",alpha=0.5) +
geom_point(data=subset(bcrossrate,sample==S & crossrate > 0.2 & pass==T),aes(x=mid,0.3),
inherit.aes=F,colour="red",size=3) +
geom_point(size=0.5) +
facet_grid(chrom ~ .) + ggtitle(paste(S,"cross rates by base"))+
theme(legend.position="bottom") + xlim(0,3.3e6) + ylim(0,0.34)
print(propplot)
}
S
propplot <- ggplot(subset(bcrossrate,sample==S & pass==TRUE),aes(x=mid,y=crossrate)) +
geom_segment(data=subset(recombs,sample==S),aes(x=co_pos_min-1e4,xend=co_pos_max+1e4,y=from/3,yend=to/3),
inherit.aes=F,colour="blue",linetype="dashed",alpha=0.5) +
geom_point(data=subset(bcrossrate,sample==S & crossrate > 0.2 & pass==T),aes(x=mid,0.3),
inherit.aes=F,colour="red",size=3) +
geom_point(size=0.5) +
facet_grid(chrom ~ .) + ggtitle(paste(S,"cross rates by base"))+
theme(legend.position="bottom") + xlim(0,3.3e6) + ylim(0,0.34)
print(propplot)
subset(bcrossrate,sample==S & crossrate > 0.2 & pass==T)
propplot <- ggplot(subset(bcrossrate,pass==TRUE),aes(x=mid,y=crossrate)) +
geom_segment(data=recombs,aes(x=co_pos_min-1e4,xend=co_pos_max+1e4,y=from/3,yend=to/3),
inherit.aes=F,colour="blue",linetype="dashed",alpha=0.5) +
geom_point(data=subset(bcrossrate,crossrate > 0.2 & pass==T),aes(x=mid,0.3),
inherit.aes=F,colour="red",size=3) +
geom_point(size=0.5) +
facet_grid(chrom ~ .) + ggtitle(paste(S,"cross rates by base"))+
theme(legend.position="bottom") + xlim(0,3.3e6) + ylim(0,0.34)
propplot <- ggplot(subset(bcrossrate,pass==TRUE),aes(x=mid,y=crossrate)) +
geom_segment(data=recombs,aes(x=co_pos_min-1e4,xend=co_pos_max+1e4,y=from/3,yend=to/3),
inherit.aes=F,colour="blue",linetype="dashed",alpha=0.5) +
geom_point(data=subset(bcrossrate,crossrate > 0.2 & pass==T),aes(x=mid,0.3),
inherit.aes=F,colour="red",size=3) +
geom_point(size=0.5) +
facet_grid(chrom ~ sample) + ggtitle(paste(S,"cross rates by base"))+
theme(legend.position="bottom") + xlim(0,3.3e6) + ylim(0,0.34)
print(propplot)
goodsamps <- levels(haplinks$sample)[c(1,2,7,8)]
propplot <- ggplot(subset(bcrossrate,sample %in% goodsamps & pass==TRUE),aes(x=mid,y=crossrate)) +
geom_segment(data=subset(recombs,sample %in% goodsamps),aes(x=co_pos_min-1e4,xend=co_pos_max+1e4,y=from/3,yend=to/3),
inherit.aes=F,colour="blue",linetype="dashed",alpha=0.5) +
geom_point(data=subset(bcrossrate,sample %in% goodsamps & crossrate > 0.2 & pass==T),aes(x=mid,0.3),
inherit.aes=F,colour="red",size=3) +
geom_point(size=0.5) +
facet_grid(chrom ~ .) + ggtitle(paste(S,"cross rates by base"))+
theme(legend.position="bottom") + xlim(0,3.3e6) + ylim(0,0.34)
print(propplot)
propplot <- ggplot(subset(bcrossrate,sample %in% goodsamps & pass==TRUE),aes(x=mid,y=crossrate)) +
geom_segment(data=subset(recombs,sample %in% goodsamps),aes(x=co_pos_min-1e4,xend=co_pos_max+1e4,y=from/3,yend=to/3),
inherit.aes=F,colour="blue",linetype="dashed",alpha=0.5) +
geom_point(data=subset(bcrossrate,sample %in% goodsamps & crossrate > 0.2 & pass==T),aes(x=mid,0.3),
inherit.aes=F,colour="red",size=3) +
geom_point(size=0.5) +
facet_grid(chrom ~ sample) + ggtitle(paste(S,"cross rates by base"))+
theme(legend.position="bottom") + xlim(0,3.3e6) + ylim(0,0.34)
print(propplot)
propplot <- ggplot(subset(bcrossrate,sample %in% goodsamps & pass==TRUE),aes(x=mid,y=crossrate)) +
geom_segment(data=subset(recombs,sample %in% goodsamps),aes(x=co_pos_min-1e4,xend=co_pos_max+1e4,y=from/3,yend=to/3),
inherit.aes=F,colour="blue",linetype="dashed",alpha=0.5) +
geom_point(data=subset(bcrossrate,sample %in% goodsamps & crossrate > 0.2 & pass==T),aes(x=mid,0.3),
inherit.aes=F,colour="red",size=3) +
geom_point(size=0.5) +
facet_grid(chrom ~ sample) + ggtitle(paste(S,"cross rates by base"))+
theme(legend.position="bottom") + xlim(0,3.3e6) + ylim(0,0.5)
print(propplot)
propplot <- ggplot(subset(bcrossrate,sample %in% goodsamps & pass==TRUE),aes(x=mid,y=crossrate)) +
geom_segment(data=subset(recombs,sample %in% goodsamps),aes(x=co_pos_min-1e4,xend=co_pos_max+1e4,y=from/3,yend=to/3),
inherit.aes=F,colour="blue",linetype="dashed",alpha=0.5) +
geom_point(data=subset(bcrossrate,sample %in% goodsamps & crossrate > 0.2 & pass==T),aes(x=mid,0.3),
inherit.aes=F,colour="red",size=3) +
geom_point(size=0.5) +
facet_grid(chrom ~ sample) + ggtitle(paste(S,"cross rates by base"))+
theme(legend.position="bottom") + xlim(0,3.3e6)
print(propplot)
goodsamps <- levels(haplinks$sample)[c(3:6)]
propplot <- ggplot(subset(bcrossrate,sample %in% goodsamps & pass==TRUE),aes(x=mid,y=crossrate)) +
geom_segment(data=subset(recombs,sample %in% goodsamps),aes(x=co_pos_min-1e4,xend=co_pos_max+1e4,y=from/3,yend=to/3),
inherit.aes=F,colour="blue",linetype="dashed",alpha=0.5) +
geom_point(data=subset(bcrossrate,sample %in% goodsamps & crossrate > 0.2 & pass==T),aes(x=mid,0.3),
inherit.aes=F,colour="red",size=3) +
geom_point(size=0.5) +
facet_grid(chrom ~ sample) + ggtitle(paste(S,"cross rates by base"))+
theme(legend.position="bottom") + xlim(0,3.3e6)
print(propplot)
goodsamps <- levels(haplinks$sample)[c(1,2,7,8)]
propplot <- ggplot(subset(bcrossrate,sample %in% goodsamps & pass==TRUE),aes(x=mid,y=crossrate)) +
geom_segment(data=subset(recombs,sample %in% goodsamps),aes(x=co_pos_min-1e4,xend=co_pos_max+1e4,y=from/3,yend=to/3),
inherit.aes=F,colour="blue",linetype="dashed",alpha=0.5) +
geom_point(data=subset(bcrossrate,sample %in% goodsamps & crossrate > 0.2 & pass==T),aes(x=mid,0.3),
inherit.aes=F,colour="red",size=3) +
geom_point(size=0.5) +
facet_grid(chrom ~ sample) + ggtitle(paste(S,"cross rates by base"))+
theme(legend.position="bottom") + xlim(0,3.3e6)
print(propplot)
propplot <- ggplot(subset(bcrossrate,sample %in% goodsamps & pass==TRUE),aes(x=mid,y=crossrate)) +
geom_segment(data=subset(recombs,sample %in% goodsamps),aes(x=co_pos_min-1e4,xend=co_pos_max+1e4,y=from/2,yend=to/2),
inherit.aes=F,colour="blue",linetype="dashed",alpha=0.5) +
geom_point(data=subset(bcrossrate,sample %in% goodsamps & crossrate > 0.2 & pass==T),aes(x=mid,0.45),
inherit.aes=F,colour="red",size=3) +
geom_point(size=0.5) +
facet_grid(chrom ~ sample) + ggtitle(paste(S,"cross rates by base"))+
theme(legend.position="bottom") + xlim(0,3.3e6) + ylim(0,0.5)
print(propplot)
propplot <- ggplot(subset(bcrossrate,sample %in% goodsamps & pass==TRUE),aes(x=mid,y=crossrate)) +
geom_segment(data=subset(recombs,sample %in% goodsamps),aes(x=co_pos_min-1e4,xend=co_pos_max+1e4,y=from/2,yend=to/2),
inherit.aes=F,colour="blue",linetype="dashed",alpha=0.5) +
geom_point(data=subset(bcrossrate,sample %in% goodsamps & crossrate > 0.2 & pass==T),aes(x=mid,0.45),
inherit.aes=F,colour="red",size=3) +
geom_point(size=0.5) +
facet_grid(chrom ~ sample) + ggtitle(paste(S,"cross rates by base"))+
theme(legend.position="bottom") + xlim(0,3.3e6)
print(propplot)
setwd("~/Gits/pfdisco/reports/180206_rocplots_qualScores/")
opts_chunk$set(fig.width=12, fig.height=8,dev=c('png','postscript'),warning=F)
discoFilt <- read.table("disco_3D7DD2.FILT.DD2-2D4_callable_all_EVAL/weighted_roc.tsv.gz",header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names=c("score","true_positives","false_positives","false_negatives","precision","sensitivity","f_measure"))
discoFilt$region="GENOME"
discoFiltSNPs <- read.table("disco_3D7DD2.FILT.DD2-2D4_callable_all_EVAL//snp_roc.tsv.gz",header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names = c("score","true_positives","false_positives"))
discoFiltINDELs <- read.table("disco_3D7DD2.FILT.DD2-2D4_callable_all_EVAL//non_snp_roc.tsv.gz",header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names = c("score","true_positives","false_positives"))
discoFiltSNPs$type="SNP"
discoFiltSNPs$type="SNP"
discoFiltINDELs$type="INDEL"
discoFiltType <- rbind(discoFiltSNPs,discoFiltINDELs)
discoFiltType$caller="disco"
discoFiltType$region="GENOME"
posns <- intersect(discoFiltSNPs$score,discoFiltINDELs$score)
discoFiltType <- subset(discoFiltType,score %in% posns)
gatk100 <- read.table("gatkHaplo_3D7DD2_100.VQSR.DD2-2D4_callable_haplo100_EVAL/weighted_roc.tsv.gz",header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names=c("score","true_positives","false_positives","false_negatives","precision","sensitivity","f_measure"))
gatk100$caller="gatk"
gatk100$region="GENOME"
gatk100SNPs <- read.table("gatkHaplo_3D7DD2_100.VQSR.DD2-2D4_callable_haplo100_EVAL/snp_roc.tsv.gz",header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names = c("score","true_positives","false_positives"))
gatk100INDELs <- read.table("gatkHaplo_3D7DD2_100.VQSR.DD2-2D4_callable_haplo100_EVAL/non_snp_roc.tsv.gz",header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names = c("score","true_positives","false_positives"))
gatk100SNPs$type="SNP"
gatk100INDELs$type="INDEL"
gatk100Type <- rbind(gatk100SNPs,gatk100INDELs)
gatk100Type$caller="gatk"
gatk100Type$region="GENOME"
posns <- intersect(gatk100SNPs$score,gatk100INDELs$score)
gatk100Type <- subset(gatk100Type,score %in% posns)
gatkCALL100 <- read.table("gatkHaplo_3D7DD2_100.VQSR.DD2-2D4_callable_all_EVAL/weighted_roc.tsv.gz",header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names=c("score","true_positives","false_positives","false_negatives","precision","sensitivity","f_measure"))
gatkCALL100 <- read.table("gatkHaplo_3D7DD2_100.VQSR.DD2-2D4_callable_all_EVAL/weighted_roc.tsv.gz",header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names=c("score","true_positives","false_positives","false_negatives","precision","sensitivity","f_measure"))
gatkCALL100$caller="gatk"
gatkCALL100$caller="gatk"
gatkCALL100$region="CALLABLE"
gatkCALL100INDELs <- read.table("gatkHaplo_3D7DD2_100.VQSR.DD2-2D4_callable_all_EVAL/non_snp_roc.tsv.gz",header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names = c("score","true_positives","false_positives"))
gatkCALL100SNPs$type="SNP"
gatkCALL100INDELs$type="INDEL"
gatkCALL100Type <- rbind(gatkCALL100SNPs,gatkCALL100INDELs)
gatkCALL100SNPs <- read.table("gatkHaplo_3D7DD2_100.VQSR.DD2-2D4_callable_all_EVAL/snp_roc.tsv.gz",header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names = c("score","true_positives","false_positives"))
gatkCALL100 <- read.table("gatkHaplo_3D7DD2_100.VQSR.DD2-2D4_callable_all_EVAL/weighted_roc.tsv.gz",header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names=c("score","true_positives","false_positives","false_negatives","precision","sensitivity","f_measure"))
gatkCALL100$caller="gatk"
gatkCALL100$region="CALLABLE"
gatkCALL100SNPs <- read.table("gatkHaplo_3D7DD2_100.VQSR.DD2-2D4_callable_all_EVAL/snp_roc.tsv.gz",header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names = c("score","true_positives","false_positives"))
gatkCALL100INDELs <- read.table("gatkHaplo_3D7DD2_100.VQSR.DD2-2D4_callable_all_EVAL/non_snp_roc.tsv.gz",header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names = c("score","true_positives","false_positives"))
gatkCALL100SNPs$type="SNP"
gatkCALL100INDELs$type="INDEL"
gatkCALL100Type <- rbind(gatkCALL100SNPs,gatkCALL100INDELs)
gatkCALL100Type$caller="gatk"
gatkCALL100Type$region="CALLABLE"
posns <- intersect(gatkCALL100SNPs$score,gatkCALL100INDELs$score)
gatkCALL100Type <- subset(gatkCALL100Type,score %in% posns)
gatk250 <- read.table("gatkHaplo_3D7DD2_250.VQSR.DD2-2D4_callable_haplo250_EVAL/weighted_roc.tsv.gz",header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names=c("score","true_positives","false_positives","false_negatives","precision","sensitivity","f_measure"))
gatk250 <- read.table("gatkHaplo_3D7DD2_250.VQSR.DD2-2D4_callable_haplo250_EVAL/weighted_roc.tsv.gz",header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names=c("score","true_positives","false_positives","false_negatives","precision","sensitivity","f_measure"))
gatk250$caller="gatk"
gatk250$region="GENOME"
gatk250SNPs <- read.table("gatkHaplo_3D7DD2_250.VQSR.DD2-2D4_callable_haplo250_EVAL/snp_roc.tsv.gz",header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names = c("score","true_positives","false_positives"))
gatk250INDELs <- read.table("gatkHaplo_3D7DD2_250.VQSR.DD2-2D4_callable_haplo250_EVAL/non_snp_roc.tsv.gz",header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names = c("score","true_positives","false_positives"))
gatk250SNPs$type="SNP"
gatk250INDELs$type="INDEL"
gatk250Type <- rbind(gatk250SNPs,gatk250INDELs)
gatk250Type$caller="gatk"
gatk250Type$region="GENOME"
posns <- intersect(gatk250SNPs$score,gatk250INDELs$score)
gatk250Type <- subset(gatk250Type,score %in% posns)
gatkCALL250 <- read.table("gatkHaplo_3D7DD2_250.VQSR.DD2-2D4_callable_all_EVAL/weighted_roc.tsv.gz",header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names=c("score","true_positives","false_positives","false_negatives","precision","sensitivity","f_measure"))
gatkCALL250$caller="gatk"
gatkCALL250$region="CALLABLE"
gatkCALL250SNPs <- read.table("gatkHaplo_3D7DD2_250.VQSR.DD2-2D4_callable_all_EVAL/snp_roc.tsv.gz",header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names = c("score","true_positives","false_positives"))
gatkCALL250INDELs <- read.table("gatkHaplo_3D7DD2_250.VQSR.DD2-2D4_callable_all_EVAL/non_snp_roc.tsv.gz",header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names = c("score","true_positives","false_positives"))
gatkCALL250SNPs$type="SNP"
gatkCALL250INDELs$type="INDEL"
gatkCALL250Type <- rbind(gatkCALL250SNPs,gatkCALL250INDELs)
gatkCALL250Type$caller="gatk"
gatkCALL250Type$region="CALLABLE"
posns <- intersect(gatkCALL250SNPs$score,gatkCALL250INDELs$score)
gatkCALL250Type <- subset(gatkCALL250Type,score %in% posns)
rocCf <- rbind(discoCALL250Type,disco250Type,gatkCALL100Type,gatk100Type,gatkCALL250Type,gatk250Type)
rocCf <- rbind(discoCALLType,discoType,gatkCALL100Type,gatk100Type,gatkCALL250Type,gatk250Type)
disco <- read.table("disco_3D7DD2.FILT.DD2-2D4_callable_disco_EVAL/weighted_roc.tsv.gz",header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names=c("score","true_positives","false_positives","false_negatives","precision","sensitivity","f_measure"))
disco$caller="disco"
disco$region="GENOME"
discoSNPs <- read.table("disco_3D7DD2.FILT.DD2-2D4_callable_disco_EVAL/snp_roc.tsv.gz",header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names = c("score","true_positives","false_positives"))
discoINDELs <- read.table("disco_3D7DD2.FILT.DD2-2D4_callable_disco_EVAL/non_snp_roc.tsv.gz",header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names = c("score","true_positives","false_positives"))
discoSNPs$type="SNP"
discoINDELs$type="INDEL"
discoType <- rbind(discoSNPs,discoINDELs)
discoType$caller="disco"
discoType$region="GENOME"
posns <- intersect(discoSNPs$score,discoINDELs$score)
discoType <- subset(discoType,score %in% posns)
discoCALL <- read.table("disco_3D7DD2.FILT.DD2-2D4_callable_all_EVAL/weighted_roc.tsv.gz",header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names=c("score","true_positives","false_positives","false_negatives","precision","sensitivity","f_measure"))
discoCALL$caller="disco"
discoCALL$region="CALLABLE"
discoCALLSNPs <- read.table("disco_3D7DD2.FILT.DD2-2D4_callable_all_EVAL/snp_roc.tsv.gz",header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names = c("score","true_positives","false_positives"))
discoCALLINDELs <- read.table("disco_3D7DD2.FILT.DD2-2D4_callable_all_EVAL/non_snp_roc.tsv.gz",header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names = c("score","true_positives","false_positives"))
discoCALLSNPs$type="SNP"
discoCALLINDELs$type="INDEL"
discoCALLType <- rbind(discoCALLSNPs,discoCALLINDELs)
discoCALLType$caller="disco"
discoCALLType$region="CALLABLE"
posns <- intersect(discoCALLSNPs$score,discoCALLINDELs$score)
discoCALLType <- subset(discoCALLType,score %in% posns)
head(disco); head(discoCALL)
head(discoType); head(discoCALLType)
#
rocCf <- rbind(discoCALLType,discoType,gatkCALL100Type,gatk100Type,gatkCALL250Type,gatk250Type)
g_legend<-function(a.gplot){
tmp <- ggplot_gtable(ggplot_build(a.gplot))
leg <- which(sapply(tmp$grobs, function(x) x$name) == "guide-box")
legend <- tmp$grobs[[leg]]
return(legend)}
ggplot(discoCALLFiltType,aes(x=false_positives,y=true_positives,colour=type)) +
geom_line() + facet_grid(. ~ caller) + theme(legend.position="bottom")
ggplot(discoCALLType,aes(x=false_positives,y=true_positives,colour=type)) +
geom_line() + facet_grid(. ~ caller) + theme(legend.position="bottom")
ggplot(discoCALLType,aes(x=false_positives,y=true_positives,colour=type)) +
geom_line() + facet_grid(. ~ caller) + theme(legend.position="bottom")
ggplot(discoType,aes(x=false_positives,y=true_positives,colour=type)) +
geom_point() + facet_grid(. ~ caller) + theme(legend.position="bottom")
ggplot(discoType,aes(x=false_positives,y=true_positives,colour=type)) +
geom_line() + facet_grid(. ~ caller) + theme(legend.position="bottom")
ggplot(rocCf,aes(x=false_positives,y=true_positives,colour=type,linetype=region)) +
geom_line() + facet_grid(. ~ caller) + theme(legend.position="bottom")
library(ggplot2)
library(hexbin)
library(reshape2)
library(knitr)
library(gridExtra)
library(grid)
library(ggplot2)
library(lattice)
```{r setup}
opts_chunk$set(fig.width=12, fig.height=8,dev=c('png','postscript'),warning=F)
```
```{r}
disco <- read.table("disco_3D7DD2.FILT.DD2-2D4_callable_disco_EVAL/weighted_roc.tsv.gz",header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names=c("score","true_positives","false_positives","false_negatives","precision","sensitivity","f_measure"))
disco$caller="disco"
disco$region="GENOME"
discoSNPs <- read.table("disco_3D7DD2.FILT.DD2-2D4_callable_disco_EVAL/snp_roc.tsv.gz",header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names = c("score","true_positives","false_positives"))
discoINDELs <- read.table("disco_3D7DD2.FILT.DD2-2D4_callable_disco_EVAL/non_snp_roc.tsv.gz",header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names = c("score","true_positives","false_positives"))
discoSNPs$type="SNP"
discoINDELs$type="INDEL"
discoType <- rbind(discoSNPs,discoINDELs)
discoType$caller="disco"
discoType$region="GENOME"
posns <- intersect(discoSNPs$score,discoINDELs$score)
discoType <- subset(discoType,score %in% posns)
discoCALL <- read.table("disco_3D7DD2.FILT.DD2-2D4_callable_all_EVAL/weighted_roc.tsv.gz",header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names=c("score","true_positives","false_positives","false_negatives","precision","sensitivity","f_measure"))
discoCALL$caller="disco"
discoCALL$region="CALLABLE"
discoCALLSNPs <- read.table("disco_3D7DD2.FILT.DD2-2D4_callable_all_EVAL/snp_roc.tsv.gz",header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names = c("score","true_positives","false_positives"))
discoCALLINDELs <- read.table("disco_3D7DD2.FILT.DD2-2D4_callable_all_EVAL/non_snp_roc.tsv.gz",header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names = c("score","true_positives","false_positives"))
discoCALLSNPs$type="SNP"
discoCALLINDELs$type="INDEL"
discoCALLType <- rbind(discoCALLSNPs,discoCALLINDELs)
discoCALLType$caller="disco"
discoCALLType$region="CALLABLE"
posns <- intersect(discoCALLSNPs$score,discoCALLINDELs$score)
discoCALLType <- subset(discoCALLType,score %in% posns)
head(disco); head(discoCALL)
head(discoType); head(discoCALLType)
# disco <- read.table("disco_3D7_0901_weighted_roc.tsv.gz",header=F,skip = 3,stringsAsFactors =F,sep="\t")
# colnames(disco) <-c("score","true_positives","false_positives","false_negatives","precision","sensitivity","f_measure")
# disco$sample="0901"
# disco$caller="disco"
# disco$filter=T
```
```{r}
gatk100 <- read.table("gatkHaplo_3D7DD2_100.VQSR.DD2-2D4_callable_haplo100_EVAL/weighted_roc.tsv.gz",header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names=c("score","true_positives","false_positives","false_negatives","precision","sensitivity","f_measure"))
gatk100$caller="gatk100"
gatk100$region="GENOME"
gatk100SNPs <- read.table("gatkHaplo_3D7DD2_100.VQSR.DD2-2D4_callable_haplo100_EVAL/snp_roc.tsv.gz",header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names = c("score","true_positives","false_positives"))
gatk100INDELs <- read.table("gatkHaplo_3D7DD2_100.VQSR.DD2-2D4_callable_haplo100_EVAL/non_snp_roc.tsv.gz",header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names = c("score","true_positives","false_positives"))
gatk100SNPs$type="SNP"
gatk100INDELs$type="INDEL"
gatk100Type <- rbind(gatk100SNPs,gatk100INDELs)
gatk100Type$caller="gatk100"
gatk100Type$region="GENOME"
posns <- intersect(gatk100SNPs$score,gatk100INDELs$score)
gatk100Type <- subset(gatk100Type,score %in% posns)
gatkCALL100 <- read.table("gatkHaplo_3D7DD2_100.VQSR.DD2-2D4_callable_all_EVAL/weighted_roc.tsv.gz",header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names=c("score","true_positives","false_positives","false_negatives","precision","sensitivity","f_measure"))
gatkCALL100$caller="gatk100"
gatkCALL100$region="CALLABLE"
gatkCALL100SNPs <- read.table("gatkHaplo_3D7DD2_100.VQSR.DD2-2D4_callable_all_EVAL/snp_roc.tsv.gz",header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names = c("score","true_positives","false_positives"))
gatkCALL100INDELs <- read.table("gatkHaplo_3D7DD2_100.VQSR.DD2-2D4_callable_all_EVAL/non_snp_roc.tsv.gz",header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names = c("score","true_positives","false_positives"))
gatkCALL100SNPs$type="SNP"
gatkCALL100INDELs$type="INDEL"
gatkCALL100Type <- rbind(gatkCALL100SNPs,gatkCALL100INDELs)
gatkCALL100Type$caller="gatk100"
gatkCALL100Type$region="CALLABLE"
posns <- intersect(gatkCALL100SNPs$score,gatkCALL100INDELs$score)
gatkCALL100Type <- subset(gatkCALL100Type,score %in% posns)
```
```{r}
gatk250 <- read.table("gatkHaplo_3D7DD2_250.VQSR.DD2-2D4_callable_haplo250_EVAL/weighted_roc.tsv.gz",header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names=c("score","true_positives","false_positives","false_negatives","precision","sensitivity","f_measure"))
gatk250$caller="gatk250"
gatk250$region="GENOME"
gatk250SNPs <- read.table("gatkHaplo_3D7DD2_250.VQSR.DD2-2D4_callable_haplo250_EVAL/snp_roc.tsv.gz",header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names = c("score","true_positives","false_positives"))
gatk250INDELs <- read.table("gatkHaplo_3D7DD2_250.VQSR.DD2-2D4_callable_haplo250_EVAL/non_snp_roc.tsv.gz",header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names = c("score","true_positives","false_positives"))
gatk250SNPs$type="SNP"
gatk250INDELs$type="INDEL"
gatk250Type <- rbind(gatk250SNPs,gatk250INDELs)
gatk250Type$caller="gatk250"
gatk250Type$region="GENOME"
posns <- intersect(gatk250SNPs$score,gatk250INDELs$score)
gatk250Type <- subset(gatk250Type,score %in% posns)
gatkCALL250 <- read.table("gatkHaplo_3D7DD2_250.VQSR.DD2-2D4_callable_all_EVAL/weighted_roc.tsv.gz",header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names=c("score","true_positives","false_positives","false_negatives","precision","sensitivity","f_measure"))
gatkCALL250$caller="gatk250"
gatkCALL250$region="CALLABLE"
gatkCALL250SNPs <- read.table("gatkHaplo_3D7DD2_250.VQSR.DD2-2D4_callable_all_EVAL/snp_roc.tsv.gz",header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names = c("score","true_positives","false_positives"))
gatkCALL250INDELs <- read.table("gatkHaplo_3D7DD2_250.VQSR.DD2-2D4_callable_all_EVAL/non_snp_roc.tsv.gz",header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names = c("score","true_positives","false_positives"))
gatkCALL250SNPs$type="SNP"
gatkCALL250INDELs$type="INDEL"
gatkCALL250Type <- rbind(gatkCALL250SNPs,gatkCALL250INDELs)
gatkCALL250Type$caller="gatk250"
gatkCALL250Type$region="CALLABLE"
posns <- intersect(gatkCALL250SNPs$score,gatkCALL250INDELs$score)
gatkCALL250Type <- subset(gatkCALL250Type,score %in% posns)
```
```{r}
rocCf <- rbind(discoCALLType,discoType,gatkCALL100Type,gatk100Type,gatkCALL250Type,gatk250Type)
```
```{r}
g_legend<-function(a.gplot){
tmp <- ggplot_gtable(ggplot_build(a.gplot))
leg <- which(sapply(tmp$grobs, function(x) x$name) == "guide-box")
legend <- tmp$grobs[[leg]]
return(legend)}
```
ggplot(discoCALLType,aes(x=false_positives,y=true_positives,colour=type)) +
geom_line() + facet_grid(. ~ caller) + theme(legend.position="bottom")
ggplot(discoType,aes(x=false_positives,y=true_positives,colour=type)) +
geom_point() + facet_grid(. ~ caller) + theme(legend.position="bottom")
ggplot(discoType,aes(x=false_positives,y=true_positives,colour=type)) +
geom_line() + facet_grid(. ~ caller) + theme(legend.position="bottom")
ggplot(discoCALLType,aes(x=false_positives,y=true_positives,colour=type)) +
geom_line() + facet_grid(. ~ caller) + theme(legend.position="bottom")
ggplot(discoType,aes(x=false_positives,y=true_positives,colour=type)) +
geom_line() + facet_grid(. ~ caller) + theme(legend.position="bottom")
ggplot(rocCf,aes(x=false_positives,y=true_positives,colour=type,linetype=region)) +
geom_line() + facet_grid(. ~ caller) + theme(legend.position="bottom")
ggplot(rocCf,aes(x=false_positives,y=true_positives,colour=type,linetype=region)) +
geom_line() + facet_grid(. ~ caller,scales = "free_x") + theme(legend.position="bottom")
ggplot(rocCf,aes(x=false_positives,y=true_positives,colour=type,linetype=region)) +
geom_line() + scale_x_log10() + facet_grid(. ~ caller) + theme(legend.position="bottom")
ggplot(rocCf,aes(x=false_positives,y=true_positives,colour=type,linetype=region)) +
geom_line() + facet_grid(. ~ caller) + theme(legend.position="bottom")
ggplot(rocCf,aes(x=false_positives,y=true_positives,colour=type,linetype=region)) +
geom_line() + facet_grid(. ~ caller,scales = "free_x") + theme(legend.position="bottom")
ggplot(rocCf,aes(x=false_positives,y=true_positives,colour=type,linetype=region)) +
geom_line() + facet_grid(. ~ caller) + theme(legend.position="bottom")
read.table("disco_3D7DD2.FILT.DD2-2D4_callable_all_EVAL/summary.txt")
read.table("disco_3D7DD2.FILT.DD2-2D4_callable_all_EVAL/summary.txt",sep="\t")
read.table("disco_3D7DD2.FILT.DD2-2D4_callable_all_EVAL/summary.txt",sep="\t",header=T)
read.table("disco_3D7DD2.FILT.DD2-2D4_callable_all_EVAL/summary.txt",sep="\t",skip=2)
read.table("disco_3D7DD2.FILT.DD2-2D4_callable_all_EVAL/summary.txt",skip=2)
sumcols <- c("threshold","truepos","falsepos","falseneg","precision","sensitivity","F-measure")
discosum <- read.table("disco_3D7DD2.FILT.DD2-2D4_callable_disco_EVAL/summary.txt",skip=2,col.names = sumcols)
gatk100sum <- read.table("gatkHaplo_3D7DD2_100.VQSR.DD2-2D4_callable_haplo100_EVAL/summary.txt",skip=2,col.names = sumcols)
gatk250sum <- read.table("gatkHaplo_3D7DD2_250.VQSR.DD2-2D4_callable_haplo250_EVAL/summary.txt",skip=2,col.names = sumcols)
discosum$caller<-"disco"
gatk100$caller<-"gatk100"
gatk250$caller<-"gatk250"
rbind(discosum,gatk250,gatk100)
sumcols <- c("threshold","truepos","falsepos","falseneg","precision","sensitivity","F-measure")
discosum <- read.table("disco_3D7DD2.FILT.DD2-2D4_callable_disco_EVAL/summary.txt",skip=2,col.names = sumcols)
gatk100sum <- read.table("gatkHaplo_3D7DD2_100.VQSR.DD2-2D4_callable_haplo100_EVAL/summary.txt",skip=2,col.names = sumcols)
gatk250sum <- read.table("gatkHaplo_3D7DD2_250.VQSR.DD2-2D4_callable_haplo250_EVAL/summary.txt",skip=2,col.names = sumcols)
discosum$caller<-"disco"
gatk100$caller<-"gatk100"
gatk250$caller<-"gatk250"
rbind(discosum,gatk250,gatk100)
sumcols <- c("threshold","truepos","falsepos","falseneg","precision","sensitivity","F-measure")
discosum <- read.table("disco_3D7DD2.FILT.DD2-2D4_callable_disco_EVAL/summary.txt",skip=2,col.names = sumcols)
gatk100sum <- read.table("gatkHaplo_3D7DD2_100.VQSR.DD2-2D4_callable_haplo100_EVAL/summary.txt",skip=2,col.names = sumcols)
gatk250sum <- read.table("gatkHaplo_3D7DD2_250.VQSR.DD2-2D4_callable_haplo250_EVAL/summary.txt",skip=2,col.names = sumcols)
discosum$caller<-"disco"
gatk100sum$caller<-"gatk100"
gatk250sum$caller<-"gatk250"
rbind(discosum,gatk250sum,gatk100sum)
callsums <- rbind(discosum,gatk250sum,gatk100sum)
write.table(subset(callsums,threshold=="None"),sep="\t",quote=F)
write.table(subset(callsums,threshold=="None"),sep="\t",quote=F,row.names = F)
subset(callsums,threshold=="None")
subset(callsums,threshold!="None")
sumcols <- c("threshold","truepos","falsepos","falseneg","precision","sensitivity","F-measure")
discosum <- read.table("disco_3D7DD2.FILT.DD2-2D4_callable_disco_EVAL/summary.txt",skip=2,col.names = sumcols)
gatk100sum <- read.table("gatkHaplo_3D7DD2_100.VQSR.DD2-2D4_callable_haplo100_EVAL/summary.txt",skip=2,col.names = sumcols)
gatk250sum <- read.table("gatkHaplo_3D7DD2_250.VQSR.DD2-2D4_callable_haplo250_EVAL/summary.txt",skip=2,col.names = sumcols)
discosum$caller<-"disco"
gatk100sum$caller<-"gatk100"
gatk250sum$caller<-"gatk250"
callsums <- rbind(discosum,gatk250sum,gatk100sum)
subset(callsums,threshold=="None")
subset(callsums,threshold!="None")
knit("validation.Rmd")
ggplot(discoCALLType,aes(x=false_positives,y=true_positives,colour=type)) +
geom_line() + facet_grid(. ~ caller) + theme(legend.position="bottom")
ggplot(rocCf,aes(x=false_positives,y=true_positives,colour=type,linetype=region)) +
geom_line() + facet_grid(. ~ caller) + theme(legend.position="bottom")
ggplot(rocCf,aes(x=false_positives,y=true_positives,colour=type,linetype=region)) +
geom_line() + facet_grid(. ~ caller,scales = "free_x") + theme(legend.position="bottom")
