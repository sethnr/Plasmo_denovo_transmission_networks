facet_grid(variable ~ .)
blockplot
blockplot <- ggplot(subset(blockmelt,pcfilled >= 0.7 & (depthfilled >= 10 & depthfilled <= 100)),aes(x=block,y=value,colour=variable)) +
geom_line() + ylim(0,0.2) + ggtitle(outroot) +
facet_grid(variable ~ .)
blockplot
library(ggplot2)
library(reshape2)
library(splines)
#plot depth graphs windows
if(!interactive()) {
cmd_args = commandArgs(trailingOnly = T);
flagdepthsfile = cmd_args[1]
winsize = as.numeric(cmd_args[2])
} else {
flagdepthsfile <- "~/Work_Sanger/anopheles_analyses/unmapPairs/data/AB0090_C.2R.flagdepths.w1000.txt"
winsize <- 1000
}
#cnames <- c("chr","pos",
#            "mappairs","notpaired","mateunmap","faceaway","mapnotpair")
# flagdepths <- read.table(flagdepthsfile)
# colnames(flagdepths) <- cnames
# flagdepths$block <- ceiling(flagdepths$pos/winsize) * winsize
# blocksums_a <- aggregate(. ~ block,
#                        data=flagdepths[,c("block","mappairs","notpaired","mateunmap","faceaway","mapnotpair")],
#                        FUN=sum)
# blocksums <- blocksums_a
#read blocksums from pre-calc'd file
cnames <- c("chr","block","pcfilled",
"mappairs","notpaired","mateunmap","faceaway","mapnotpair")
blocksums <- read.table(flagdepthsfile)
colnames(blocksums) <- cnames
blocksums <- cbind(blocksums[,c("block","pcfilled","mappairs")],
blocksums[,c("notpaired","mateunmap","faceaway","mapnotpair")]/blocksums$mappairs)
blocksums$depthfilled <- round(blocksums$mappairs / (blocksums$pcfilled * winsize))
#blocksums <- blocksums_raw
blocksums_raw <- blocksums
blocksums <- as.data.frame(rollmean(blocksums,100))
blockmelt <- melt(blocksums,id.vars=c("block","pcfilled","depthfilled","mappairs"))
outroot <- gsub(".txt","",gsub(".gz","",flagdepthsfile))
#blockplot <- ggplot(subset(blockmelt,mappairs >= (20 * winsize)),aes(x=block,y=value,colour=variable)) +
blockplot <- ggplot(subset(blockmelt,pcfilled >= 0.7 & (depthfilled >= 10 & depthfilled <= 100)),aes(x=block,y=value,colour=variable)) +
geom_line() + ylim(0,0.2) + ggtitle(outroot) +
facet_grid(variable ~ .)
blockplot
head(blocksums)
head(blocksums_raw)
dim(blocksums_raw)
?rollmean
dim(blocksums)
dim(blocksums_raw)
dim(blocksums)
blocksums <- as.data.frame(rollmean(blocksums,100))
dim(blocksums)
head(blocksums_raw)
blocksums <- blocksums_raw
blocksums <- as.data.frame(rollmean(blocksums,100))
head(blocksums)
tail(blocksums)
blockmelt <- melt(blocksums,id.vars=c("block","pcfilled","depthfilled","mappairs"))
outroot <- gsub(".txt","",gsub(".gz","",flagdepthsfile))
#blockplot <- ggplot(subset(blockmelt,mappairs >= (20 * winsize)),aes(x=block,y=value,colour=variable)) +
blockplot <- ggplot(subset(blockmelt,pcfilled >= 0.7 & (depthfilled >= 10 & depthfilled <= 100)),aes(x=block,y=value,colour=variable)) +
geom_line() + ylim(0,0.2) + ggtitle(outroot) +
facet_grid(variable ~ .)
blocksums <- as.data.frame(rollmean(blocksums,100,partial=T))
tail(blocksums)
blocksums <- blocksums_raw
rollmean(blocksums,100,partial=T)
tail(rollmean(blocksums,100,partial=T))
tail(rollmean(blocksums,100,partial=T),100)
?rollapply
?mean
blocksums <- blocksums_raw
blocksums <- as.data.frame(rollapply(blocksums,100,FUN=mean,partial=T,na.rm=T))
tail(blocksums)
blockmelt <- melt(blocksums,id.vars=c("block","pcfilled","depthfilled","mappairs"))
outroot <- gsub(".txt","",gsub(".gz","",flagdepthsfile))
#blockplot <- ggplot(subset(blockmelt,mappairs >= (20 * winsize)),aes(x=block,y=value,colour=variable)) +
blockplot <- ggplot(subset(blockmelt,pcfilled >= 0.7 & (depthfilled >= 10 & depthfilled <= 100)),aes(x=block,y=value,colour=variable)) +
geom_line() + ylim(0,0.2) + ggtitle(outroot) +
facet_grid(variable ~ .)
blockplot
blockplot <- ggplot(subset(blockmelt,pcfilled >= 0.7 & (depthfilled >= 10 & depthfilled <= 100)),aes(x=block,y=value,colour=variable)) +
geom_line() + ylim(0,0.5) + ggtitle(outroot) +
facet_grid(variable ~ .)
blockplot
ggplot(subset(blockmelt,pcfilled >= 0.7 & (depthfilled >= 10 & depthfilled <= 100)),aes(x=block,y=value,colour=variable)) +
geom_line() + ggtitle(outroot) +
facet_grid(variable ~ .)
head(blocksums)
blocksums <- blocksums_raw
blocksums$pcfilled < 0.8
sum(blocksums$pcfilled < 0.8)
head(blocksums[blocksums$pcfilled < 0.8,])
head(blocksums[blocksums$pcfilled < 0.8,3:6])
head(blocksums[blocksums$pcfilled < 0.8,4:7])
blocksums[blocksums$pcfilled < 0.8,4:7] <- NA
blocksums <- as.data.frame(rollapply(blocksums,100,FUN=mean,partial=T,na.rm=T))
blockmelt <- melt(blocksums,id.vars=c("block","pcfilled","depthfilled","mappairs"))
outroot <- gsub(".txt","",gsub(".gz","",flagdepthsfile))
#blockplot <- ggplot(subset(blockmelt,mappairs >= (20 * winsize)),aes(x=block,y=value,colour=variable)) +
blockplot <- ggplot(subset(blockmelt,pcfilled >= 0.7 & (depthfilled >= 10 & depthfilled <= 100)),aes(x=block,y=value,colour=variable)) +
geom_line() + ggtitle(outroot) +
facet_grid(variable ~ .)
blockplot
library(zoo)
blockplot <- ggplot(subset(blockmelt,pcfilled >= 0.7 & (depthfilled >= 10 & depthfilled <= 100)),aes(x=block,y=value,colour=variable)) +
geom_line() + ggtitle(outroot) +
facet_grid(variable ~ .,scales="free_y")
blockplot
blockplot <- ggplot(blockmelt),aes(x=block,y=value,colour=variable)) +
geom_line() + ggtitle(outroot) +
facet_grid(variable ~ .,scales="free_y")
blockplot <- ggplot(blockmelt,aes(x=block,y=value,colour=variable)) +
geom_line() + ggtitle(outroot) +
facet_grid(variable ~ .,scales="free_y")
blockplot
blocksums <- blocksums_raw
blocksums[blocksums$pcfilled < 0.8,4:7] <- NA
blocksums <- as.data.frame(rollapply(blocksums,1000,FUN=mean,partial=T,na.rm=T))
blockmelt <- melt(blocksums,id.vars=c("block","pcfilled","depthfilled","mappairs"))
outroot <- gsub(".txt","",gsub(".gz","",flagdepthsfile))
#blockplot <- ggplot(subset(blockmelt,mappairs >= (20 * winsize)),aes(x=block,y=value,colour=variable)) +
#blockplot <- ggplot(subset(blockmelt,pcfilled >= 0.7 & (depthfilled >= 10 & depthfilled <= 100)),aes(x=block,y=value,colour=variable)) +
blockplot <- ggplot(blockmelt,aes(x=block,y=value,colour=variable)) +
geom_line() + ggtitle(outroot) +
facet_grid(variable ~ .,scales="free_y")
blockplot
blocksums <- blocksums_raw
blocksums[blocksums$pcfilled < 0.8,4:7] <- NA
blocksums_loc <- as.data.frame(rollapply(blocksums,100,FUN=mean,partial=T,na.rm=T))
blocksums_region <- as.data.frame(rollapply(blocksums,1000,FUN=mean,partial=T,na.rm=T))
head(blocksums(loc))
head(blocksums_loc)
head(blocksums_region)
head(blocksums_region[4:7])
head(blocksums_loc[,4:7]/blocksums_region[,4:7])
blocksums <- blocksums_raw
blocksums[blocksums$pcfilled < 0.8,4:7] <- NA
blocksums_loc <- as.data.frame(rollapply(blocksums,100,FUN=mean,partial=T,na.rm=T))
blocksums_region <- as.data.frame(rollapply(blocksums,1000,FUN=mean,partial=T,na.rm=T))
dim(blocksums_loc)
dim(blocksums_region)
dim(blocksums)
dim(as.data.frame(rollapply(blocksums,100,FUN=mean,partial=T,na.rm=T)))
View(blocksums)
View(blocksums)
dim(as.data.frame(rollapply(blocksums,100,FUN=mean,partial=F,na.rm=T)))
blocksums[,4:7] <- blocksums_loc[,4:7]/blocksums_region[,4:7]
head(blocksums)
blockmelt <- melt(blocksums,id.vars=c("block","pcfilled","depthfilled","mappairs"))
outroot <- gsub(".txt","",gsub(".gz","",flagdepthsfile))
#blockplot <- ggplot(subset(blockmelt,mappairs >= (20 * winsize)),aes(x=block,y=value,colour=variable)) +
#blockplot <- ggplot(subset(blockmelt,pcfilled >= 0.7 & (depthfilled >= 10 & depthfilled <= 100)),aes(x=block,y=value,colour=variable)) +
blockplot <- ggplot(blockmelt,aes(x=block,y=value,colour=variable)) +
geom_line() + ggtitle(outroot) +
facet_grid(variable ~ .,scales="free_y")
blockplot
blocksums <- blocksums_raw
blocksums[blocksums$pcfilled < 0.8,4:7] <- NA
blocksums_loc <- as.data.frame(rollapply(blocksums,1000,FUN=mean,partial=T,na.rm=T))
blocksums_region <- as.data.frame(rollapply(blocksums,10000,FUN=mean,partial=T,na.rm=T))
blocksums[,4:7] <- blocksums_loc[,4:7]/blocksums_region[,4:7]
blockmelt <- melt(blocksums,id.vars=c("block","pcfilled","depthfilled","mappairs"))
outroot <- gsub(".txt","",gsub(".gz","",flagdepthsfile))
#blockplot <- ggplot(subset(blockmelt,mappairs >= (20 * winsize)),aes(x=block,y=value,colour=variable)) +
#blockplot <- ggplot(subset(blockmelt,pcfilled >= 0.7 & (depthfilled >= 10 & depthfilled <= 100)),aes(x=block,y=value,colour=variable)) +
blockplot <- ggplot(blockmelt,aes(x=block,y=value,colour=variable)) +
geom_line() + ggtitle(outroot) +
facet_grid(variable ~ .,scales="free_y")
blockplot
blocksums <- blocksums_raw
blocksums[blocksums$pcfilled < 0.8,4:7] <- NA
blocksums_loc <- as.data.frame(rollapply(blocksums,100,FUN=mean,partial=T,na.rm=T))
blocksums_region <- as.data.frame(rollapply(blocksums,10000,FUN=mean,partial=T,na.rm=T))
blocksums_rel[,4:7] <- blocksums_loc[,4:7]/blocksums_region[,4:7]
blockmelt <- melt(blocksums_rel,id.vars=c("block","pcfilled","depthfilled","mappairs"))
outroot <- gsub(".txt","",gsub(".gz","",flagdepthsfile))
#blockplot <- ggplot(subset(blockmelt,mappairs >= (20 * winsize)),aes(x=block,y=value,colour=variable)) +
#blockplot <- ggplot(subset(blockmelt,pcfilled >= 0.7 & (depthfilled >= 10 & depthfilled <= 100)),aes(x=block,y=value,colour=variable)) +
blockplot <- ggplot(blockmelt,aes(x=block,y=value,colour=variable)) +
geom_line() + ggtitle(outroot) +
facet_grid(variable ~ .,scales="free_y")
blockplot
blocksums_rel <- blocksums
blocksums_rel[,4:7] <- blocksums_loc[,4:7]/blocksums_region[,4:7]
blockmelt <- melt(blocksums_rel,id.vars=c("block","pcfilled","depthfilled","mappairs"))
outroot <- gsub(".txt","",gsub(".gz","",flagdepthsfile))
#blockplot <- ggplot(subset(blockmelt,mappairs >= (20 * winsize)),aes(x=block,y=value,colour=variable)) +
#blockplot <- ggplot(subset(blockmelt,pcfilled >= 0.7 & (depthfilled >= 10 & depthfilled <= 100)),aes(x=block,y=value,colour=variable)) +
blockplot <- ggplot(blockmelt,aes(x=block,y=value,colour=variable)) +
geom_line() + ggtitle(outroot) +
facet_grid(variable ~ .,scales="free_y")
blockplot
blockplot <- ggplot(blockmelt,aes(x=block,y=value,colour=variable)) +
geom_line() + ggtitle(paste(outroot," [",locsize,"/",winsize,"]",sep="") +
facet_grid(variable ~ .,scales="free_y")
blockplot
blockplot <- ggplot(blockmelt,aes(x=block,y=value,colour=variable)) +
geom_line() + ggtitle(paste(outroot," [",locsize,"/",winsize,"]",sep="")) +
facet_grid(variable ~ .,scales="free_y")
blockplot
locsize <-  10000
regsize <- 100000
blockplot <- ggplot(blockmelt,aes(x=block,y=value,colour=variable)) +
geom_line() + ggtitle(paste(outroot," [",locsize,"/",winsize,"]",sep="")) +
facet_grid(variable ~ .,scales="free_y")
blockplot
blockplot <- ggplot(blockmelt,aes(x=block,y=value,colour=variable)) +
geom_line() + ggtitle(paste(outroot," [",(locsize/1000),"/",(regsize/1000),"]",sep="")) +
facet_grid(variable ~ .,scales="free_y")
blockplot
?mean
save.pkg.list <- installed.packages()[is.na(installed.packages()[,"priority"]), 1]
is.na(installed.packages()[,"priority"])
installed.packages()
installed.packages()[,"priority"]
installed.packages()[,"Priority"]
save.pkg.list <- installed.packages()[is.na(installed.packages()[,"Priority"]), 1]
save.pkg.list
save(save.pkg.list,file="~/Google Drive/misc/macports_150504/pkglist.Rdata")
library(raster)
library(maptools)
library(rgdal)
library(RColorBrewer)
library (ggplot2)
library(rgeos)
#library(animation)
library(rgeos)
library(myGeoFuncs)
codesTab <- as.data.frame(ccodes())
codesTab
africa.c <- as.vector(subset(codesTab,NAME %in% african.countries))
codesTab <- as.data.frame(ccodes())
codes <- as.character(unlist(subset(codesTab,NAME %in% african.countries,ISO3)))
africa.c <- as.vector(subset(codesTab,NAME %in% african.countries))
calt <- list()
cshapes <- list()
for (code in codes) {
#  write(code,stderr())
#country region data:
cshape<-getData("GADM", country=code, level=1)
#get midpoint of climate data
coords <- coordinates(cshape)
max <- apply(coords,2,FUN=max)
min <- apply(coords,2,FUN=min)
mid <- min + ((max-min)/2)
mid
altdata<-getData("worldclim", var="alt", res=0.5, lon=mid[1], lat=mid[2])
extract(altdata,cshape,fun=mean, na.rm=T)
calt[code] <- altdata
cshapes[code] <- cshape
}
codes
codesTab
subset(codesTab,NAME %in% african.countries,ISO3)
subset(codesTab,NAME %in% african.countries)
african.countries
malpe<-extract(malp,malb,fun=mean, na.rm=T)
malp<-getData("worldclim", var="prec", res=0.5, lon=35, lat=-14)
malpe<-extract(malp,malb,fun=mean, na.rm=T)
?getData
?extract
malp
g <- graph.de.bruijn(2,1)
graph.de.bruijn(2,2)
line.graph(g)
install.packages("igraph")
install.packages("stringr")
install.packages("stringr")
install.packages("igraph")
g <- graph.de.bruijn(2,1)
graph.de.bruijn(2,2)
line.graph(g)
library(igraph)
g <- graph.de.bruijn(2,1)
graph.de.bruijn(2,2)
line.graph(g)
g <- graph.de.bruijn(2,1)
g
g <- graph.de.bruijn(55)
g <- graph.de.bruijn(5,5)
g
line.graph(g)
anyNA
V(g)
E(g)
version()
session.info()
sessioninfo()
sessionInfo()
sessioninfo()
sessionInfo()
anyNA
library(igraph)
g <- graph.de.bruijn(5,5)
E(g)
line.graph(g)
plot(g)
g <- graph.de.bruijn(2,5)
plot(g)
g <- graph.de.bruijn(5,2)
plot(g)
g <- graph.de.bruijn(10,2)
plot(g)
g <- graph.de.bruijn(10,1)
plot(g)
g <- graph.de.bruijn(20,5,)
g <- graph.de.bruijn(20,5)
plot(g)
g <- graph.de.bruijn(20,2)
plot(g)
g <- graph.de.bruijn(10,2)
plot(g)
g <- graph.de.bruijn(6,2)
g <- graph.de.bruijn(6,2)
g <- graph.de.bruijn(5,2)
plot(g)
plot(g,mark.shape=0)
plot(g,mark.shape=1)
plot(g,mark.shape=0.1)
plot(g,shape="none")
plot(g,Shape="none")
plot(g,vertex.shape="none")
plot(g,edge.shape="none")
plot(g,arrow.size=0.2)
g <- graph.de.bruijn(5,10)
g <- graph.de.bruijn(5,3)
plot(g, layout=layout_with_fr)
plot(g, layout='layout_with_fr')
plot(g)
plot(g, layout=layout_with_fr, vertex.size=4,
vertex.label.dist=0.5, vertex.color="red", edge.arrow.size=0.5)
g<-barabasi.game(10)
plot(g, layout=layout_with_fr, vertex.size=4,
vertex.label.dist=0.5, vertex.color="red", edge.arrow.size=0.5)
g <- graph.de.bruijn(5,2)
plot(g)
plot(g,cex.main=0.2)
plot(g,cex.main=0.1)
plot.igraph(g,mark.shape=0)
plot.igraph(g,mark.shape=0,arrow.size=0.3)
g<-barabasi.game(10)
plot(g)
g<-barabasi.game(30)
plot(g)
?igraph
g<-erdos.renyi.game(30)
g<-erdos.renyi.game(n=20,p.or.m=p)
g<-erdos.renyi.game(n=20,p.or.m="p")
g<-erdos.renyi.game(n=20,p.or.m=T)
plot(g)
g<-erdos.renyi.game(n=20,p.or.m=F)
plot(g)
g <- graph.de.bruijn(5,2)
plot(g)
plot(g,xlim(0,10))
plot.igraph(g,mark.expand=20)
plot.igraph(g,mark.expand=30)
plot.igraph(g,mark.expand=10)
g <- graph.kautz(5,2)
plot(g,xlim(0,10))
plot(g\)
plot(g)
g <- graph.kautz(5,1)
plot(g)
read.table("Scratch/gits/pfdisco/analyses/modelling_intraspec/")
read.table("Scratch/gits/pfdisco/analyses/modelling_intraspec/qstages.C1.5m.L0.01mb.G36.mtp.AFs.txt")
afs <- read.table("Scratch/gits/pfdisco/analyses/modelling_intraspec/qstages.C1.5m.L0.01mb.G36.mtp.AFs.txt",sep="\t")
afs <- read.table("Scratch/gits/pfdisco/analyses/modelling_intraspec/qstages.C1.5m.L0.01mb.G36.mtp.AFs.txt",sep="\t")
afs <- read.table("Scratch/gits/pfdisco/analyses/modelling_intraspec/qstages.C1.5m.L0.01mb.G36.mtp.AFs.txt",sep="\t",row.names=1)
library(ggplot2)
ggplot(afs[1,]) + geom_dist()
ggplot(afs[1,]) + geom_density()
ggplot(t(afs),aes(x="14") + geom_density()
\c
ggplot(t(afs),aes(x="14")) + geom_density()
afs <- as.data.frame(t(afs))
ggplot(afs,aes(x="14")) + geom_density()
head(afs)
ggplot(afs,aes(x=14)) + geom_density()
colnames(afs) <- c("month","half_yr","yr")
ggplot(afs,aes(x=month)) + geom_density()
afs_small <- as.data.frame(t(read.table("Scratch/gits/pfdisco/analyses/modelling_intraspec/qstages.C1.5m.L0.01mb.G36.mtp.AFs.txt",sep="\t",row.names=1)),col.names=c("month","halfyr","yr"))
head(afs_small)
afs_small <- data.frame(t(read.table("Scratch/gits/pfdisco/analyses/modelling_intraspec/qstages.C1.5m.L0.01mb.G36.mtp.AFs.txt",sep="\t",row.names=1)),col.names=c("month","halfyr","yr"))
afs_small <- data.frame(t(read.table("Scratch/gits/pfdisco/analyses/modelling_intraspec/qstages.C1.5m.L0.01mb.G36.mtp.AFs.txt",sep="\t",row.names=1)))
colnames(afs_small)<-c("mth","halfyr","yr")
afs_large <- data.frame(t(read.table("Scratch/gits/pfdisco/analyses/modelling_intraspec/qstages.C100.0m.L0.01mb.G36.mtp.AFs.txt",sep="\t",row.names=1)))
colnames(afs_large)<-c("mth","halfyr","yr")
ggplot(afs_small,aes(x="yr")) + geom_density(colour="blue") + geom_density(data=afs_large,aes(x="mth"),colour="red")
ggplot(afs_small,aes(x=yr)) + geom_density(colour="blue") + geom_density(data=afs_large,aes(x=mth),colour="red")
ggplot(afs_small,aes(x=yr)) + geom_density()
ggplot(afs_large,aes(x=mth)) + geom_density()
density(afs_large$mth)
plot(density(afs_large$mth))
plot(density(afs_large$mth),colour="red") + lines(density(afs_small$yr),colour="blue")
plot(density(afs_large$mth),col="red") + lines(density(afs_small$yr),col="blue")
plot(density(afs_small$yr),colour="blue") + lines(density(afs_large$mth),colour="red")
plot(density(afs_small$yr),col="blue") + lines(density(afs_large$mth),col="red")
plot(density(subset(afs_small,yr>0.01,yr),col="blue") + lines(density(afs_large$mth),col="red")
\c
plot(density(subset(afs_small,yr>0.01,yr)),col="blue") + lines(density(afs_large$mth),col="red")
subset(afs_small,yr>0.01,yr)
plot(density(subset(afs_small,yr>0.01,yr)),col="blue") + lines(density(afs_large$mth),col="red")
plot(density(subset(afs_small,yr>0.01,yr)),col="blue")
plot(density(subset(afs_small,yr>0.01)$yr),col="blue")
plot(density(subset(afs_small,yr>0.01)$yr),col="blue") + lines(density(subset(afs_large,mth>0.01)$mth),col="red")
plot(density(subset(afs_small,yr>=0.01)$yr),col="blue") + lines(density(subset(afs_large,mth>=0.01)$mth),col="red")
setwd("~/Scratch/gits/pfdisco/reports/160308_allele_loss_pfx_data/")
loss3H <- read.table("3d7_hb3.gatk.final.F1pc.txt",header=T,row.names=1,sep="\t")
loss3H <- read.table("3d7_hb3.gatk.final.F1pc.txt",header=T,sep="\t")
head(loss3H)
loss3H[loss3H$P1=="None"]
loss3H[loss3H$P1=="None",]
loss3H[loss3H$P1!="None",]
loss3H <- subset(loss3H, P1!="None" & P2!="None")
head(loss3H)
subset(loss3H, P1_F1_pc=="." | P2_F1_pc==".")
loss3H$P1_F1_pc[loss3H$P1_F1_pc=='.']
loss3H$P1_F1_pc[loss3H$P1_F1_pc=='.']<-0
loss3H <- read.table("3d7_hb3.gatk.final.F1pc.txt",header=T,sep="\t")
loss3H <- subset(loss3H, P1!="None" & P2!="None")
loss3H$P1_F1_pc<-as.numeric(loss3H$P1_F1_pc)
loss3H$P1_F1_pc[loss3H$P1_F1_pc=='.']<-0
loss3H$P1_F1_pc[loss3H$P1_F1_pc=='.']
loss3H <- read.table("3d7_hb3.gatk.final.F1pc.txt",header=T,sep="\t")
loss3H <- subset(loss3H, P1!="None" & P2!="None")
loss3H$P1_F1_pc<-as.numeric(loss3H$P1_F1_pc)
loss3H$P1_F1_pc[loss3H$P1_F1_pc=='.']<-0
View(loss3H)
loss3H <- read.table("3d7_hb3.gatk.final.F1pc.txt",header=T,sep="\t")
loss3H <- subset(loss3H, P1!="None" & P2!="None")
loss3H$P1_F1_pc<-as.numeric(as.character(loss3H$P1_F1_pc))
loss3H$P1_F1_pc[is.na(loss3H$P1_F1_pc)]<-0
loss3H$P2_F1_pc<-as.numeric(as.character(loss3H$P2_F1_pc))
loss3H$P2_F1_pc[is.na(loss3H$P2_F1_pc)]<-0
loss3H <- read.table("3d7_hb3.gatk.final.F1pc.txt",header=T,sep="\t")
loss3H <- subset(loss3H, P1!="None" & P2!="None")
loss3H$P1_F1_pc<-as.numeric(as.character(loss3H$P1_F1_pc))
loss3H$P1_F1_pc[is.na(loss3H$P1_F1_pc)]<-0
loss3H$P2_F1_pc<-as.numeric(as.character(loss3H$P2_F1_pc))
loss3H$P2_F1_pc[is.na(loss3H$P2_F1_pc)]<-0
loss7G <- read.table("7g8_gb4.gatk.final.F1pc.txt",header=T,sep="\t")
loss7G <- subset(loss7G, P1!="None" & P2!="None")
loss7G$P1_F1_pc<-as.numeric(as.character(loss7G$P1_F1_pc))
loss7G$P1_F1_pc[is.na(loss7G$P1_F1_pc)]<-0
loss7G$P2_F1_pc<-as.numeric(as.character(loss7G$P2_F1_pc))
loss7G$P2_F1_pc[is.na(loss7G$P2_F1_pc)]<-0
lossHD <- read.table("hb3_dd2.gatk.final.F1pc.txt",header=T,sep="\t")
lossHD <- subset(lossHD, P1!="None" & P2!="None")
lossHD$P1_F1_pc<-as.numeric(as.character(lossHD$P1_F1_pc))
lossHD$P1_F1_pc[is.na(lossHD$P1_F1_pc)]<-0
lossHD$P2_F1_pc<-as.numeric(as.character(lossHD$P2_F1_pc))
lossHD$P2_F1_pc[is.na(lossHD$P2_F1_pc)]<-0
ggplot(lossHD,aes(x=P1_F1_pc,group=type)) + geom_density()
library(ggplot2)
library(reshape2)
library(knitr)
install.packages("ggplot2")
library(ggplot2)
install.packages("knitr")
ggplot(lossHD,aes(x=P1_F1_pc,group=type)) + geom_density()
ggplot(lossHD,aes(x=P1_F1_pc,group=type,colour=type)) + geom_density()
ggplot(loss7H,aes(x=P1_F1_pc,group=type,colour=type)) + geom_density()
ggplot(loss7G,aes(x=P1_F1_pc,group=type,colour=type)) + geom_density()
ggplot(loss37,aes(x=P1_F1_pc,group=type,colour=type)) + geom_density()
ggplot(loss3H,aes(x=P1_F1_pc,group=type,colour=type)) + geom_density()
ggplot(loss3H,aes(x=P2_F1_pc,group=type,colour=type)) + geom_density()
ggplot(lossHD,aes(x=P1_F1_pc,group=type,colour=type)) + geom_density()
ggplot(loss7G,aes(x=P1_F1_pc,group=type,colour=type)) + geom_density()
ggplot(loss3H,aes(x=P2_F1_pc,group=type,colour=type)) + geom_density()
knit("pfx_indel_loss.Rmd")
library("knitr")
knit("pfx_indel_loss.Rmd")
sum(loss3H$P1_F1_pc==0)
sum(loss3H$P1_F1_pc==1)
sum(loss3H$P1_F1_pc==0) + sum(loss3H$P1_F1_pc==1)
sum(loss3H$P1_F1_pc==0 | loss3H$P1_F1_pc==1)
sum(loss3H$P1_F1_pc==0 | loss3H$P1_F1_pc==1) / dim(loss3H)[[2]]
sum(loss3H$P1_F1_pc==0 | loss3H$P1_F1_pc==1) / dim(loss3H)[[1]]
dim(loss3H)[[1]]
sum(loss3H$P1_F1_pc==0 | loss3H$P1_F1_pc==1) / dim(loss3H)[[1]]
sum(loss7G$P1_F1_pc==0 | loss7G$P1_F1_pc==1) / dim(loss7G)[[1]]
loss3H$lost <- loss3H$P1_F1_pc==0 | loss3H$P1_F1_pc==1
loss3H$lost <- loss3H$P1_F1_pc==0 | loss3H$P1_F1_pc==1
loss7G$lost <- loss7G$P1_F1_pc==0 | loss7G$P1_F1_pc==1
lossHD$lost <- lossHD$P1_F1_pc==0 | lossHD$P1_F1_pc==1
ggplot(lossHD,aes(x=type,colour=type,y=lost)) + geom_bar()
ggplot(lossHD,aes(x=type,colour=type,group=lost)) + geom_bar()
ggplot(lossHD,aes(x=type,colour=type,group=lost,colour=lost)) + geom_bar()
ggplot(lossHD,aes(x=type,group=lost,colour=lost)) + geom_bar()
ggplot(lossHD,aes(x=type,group=lost,fill=lost)) + geom_bar()
ggplot(loss7G,aes(x=type,group=lost,fill=lost)) + geom_bar()
loss3H$set <- "3D7xHB3"
loss7G$set <- "7G8xGB4"
lossHD$set <- "HB3xDD2"
loss <- rbind(loss3H,loss7G,lossHD)
ggplot(loss,aes(x=type,group=lost,fill=lost)) + geom_bar() + geom_facet(set ~ .)
ggplot(loss,aes(x=type,group=lost,fill=lost)) + geom_bar() + facet_grid(set ~ .)
ggplot(loss,aes(x=type,group=lost,fill=lost)) + geom_bar() + facet_grid(set ~ .)
ggplot(loss,aes(x=type,group=lost,fill=lost)) + geom_bar() + scale_y_continuous(formatter = 'percent')
ggplot(loss,aes(x=type,group=lost,fill=lost)) + scale_y_continuous(formatter = 'percent')  + geom_bar()
ggplot(loss,aes(x=type,group=lost,fill=lost)) + geom_bar() + facet_grid(set ~ .)
ggplot(loss,aes(x=type,group=lost,fill=lost)) + geom_bar() + facet_grid(. ~ set)
dist <- read.table("SNP_INDEL_Pf3kGhana_1K.DIST.tab.txt")
head(dist)
dist <- read.table("SNP_INDEL_Pf3kGhana_1K.DIST.tab.txt")
ggplot(loss,aes(x=type,group=lost,fill=lost)) + geom_bar() + facet_grid(. ~ set)
ggplot(loss,aes(x=type,group=lost,fill=lost)) + geom_bar(position="fill") + facet_grid(. ~ set)
knit("pfx_indel_loss.Rmd")
