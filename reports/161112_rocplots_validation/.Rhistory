colnames(starts)<-c("contig","start")
colnames(ends)  <-c("contig","end")
colnames(chroms)<-c("contig","chrom")
daisyContigs <- merge(chroms,merge(starts,ends))
daisyContigs$chrom <- as.numeric(gsub("daisy_","",daisyContigs$chrom))
daisyContigs <- daisyContigs[order(daisyContigs$chrom,daisyContigs$start),]
joins <- read.table("all_0_3125ng_AaPB.RG.n20.noBC.bam_40000_fragScaff.f.nucmer.coords.joins",col.names=c("to","from","scaff","count","program"),stringsAsFactors = F)
dim(joins)
joins <- subset(joins,to %in% daisyContigs$contig & from %in% daisyContigs$contig)
dim(joins)
joins$to <- factor(joins$to,levels=daisyContigs$contig,ordered=T)
joins$from <- factor(joins$from,levels=daisyContigs$contig,ordered=T)
#ggplot(joins,aes(y=to,x=from,fill=scaff)) + geom_tile(aes(size=size/10000)) + theme(legend.position="none",axis.text=element_blank() )
ggplot(joins,aes(y=to,x=from,fill=scaff)) + geom_tile() + theme(legend.position="none",axis.text=element_blank() )
```
```{r}
joins <- read.table("fragscaff_AaegPB_0_156_n10_40k.nucmer.coords.joins",col.names=c("to","from","scaff","size","program"),stringsAsFactors = F)
dim(joins)
joins <- subset(joins,to %in% daisyContigs$contig & from %in% daisyContigs$contig)
joins$to <- factor(joins$to,levels=daisyContigs$contig,ordered=T)
joins$from <- factor(joins$from,levels=daisyContigs$contig,ordered=T)
dim(joins)
ggplot(joins,aes(y=to,x=from,fill=scaff)) + geom_tile() + theme(legend.position="none",axis.text=element_blank() )
```
```{r}
joins <- read.table("AaegL_daisy_hiC.rename.nucmer.coords.joins",col.names=c("to","from","scaff","size","program"),stringsAsFactors = F)
dim(joins)
joins <- subset(joins,to %in% daisyContigs$contig & from %in% daisyContigs$contig)
joins$to <- factor(joins$to,levels=daisyContigs$contig,ordered=T)
joins$from <- factor(joins$from,levels=daisyContigs$contig,ordered=T)
ggplot(joins,aes(y=to,x=from,fill=scaff)) + geom_tile() + theme(legend.position="none",axis.text=element_blank() )
joins <- read.table("Aaeg_dovetail_pacbio_22Aug2016.nucmer.coords.joins",col.names=c("to","from","scaff","size","program"),stringsAsFactors = F)
dim(joins)
joins <- subset(joins,to %in% daisyContigs$contig & from %in% daisyContigs$contig)
joins$to <- factor(joins$to,levels=daisyContigs$contig,ordered=T)
joins$from <- factor(joins$from,levels=daisyContigs$contig,ordered=T)
#ggplot(joins,aes(y=to,x=from,fill=scaff)) + geom_tile() + geom_vline(aes(xintercept=x),data=chroms) +
#  theme(legend.position="none",axis.text=element_blank() )
ggplot(joins,aes(y=to,x=from,fill=scaff)) + geom_tile() +
theme(legend.position="none",axis.text=element_blank() )
joins <- read.table("Aaeg_dovetail_bionano_02Sep2016_ALIGN.RG.n10.noBC.bam_40000_fragScaff.nucmer.coords.joins",col.names=c("to","from","scaff","size","program"),stringsAsFactors = F)
dim(joins)
joins <- subset(joins,to %in% daisyContigs$contig & from %in% daisyContigs$contig)
joins$to <- factor(joins$to,levels=daisyContigs$contig,ordered=T)
joins$from <- factor(joins$from,levels=daisyContigs$contig,ordered=T)
ggplot(joins,aes(y=to,x=from,fill=scaff)) + geom_tile() + theme(legend.position="none",axis.text=element_blank() )
daisyContigs <- read.table("AaegL_daisy_hiC.rename.nucmer.10.tiling",col.names=c("start","end","qstart","qend","mle","len","cov","chrsize","contigsize","chrpc","contpc","chrom","contig"),stringsAsFactors = F)
unique(daisyContigs$contig)
starts <- as.data.frame(aggregate(daisyContigs$start,by=list(daisyContigs$contig),FUN=min))
ends <- as.data.frame(aggregate(daisyContigs$end,by=list(daisyContigs$contig),FUN=max))
chroms <- as.data.frame(aggregate(daisyContigs$chrom,by=list(daisyContigs$contig),FUN=function(x){x[1]}))
aligns <- as.data.frame(aggregate(daisyContigs$chrom,by=list(daisyContigs$contig),FUN=function(x){length(unique(x))}))
daisyContigs[aligns$x>1,]
colnames(starts)<-c("contig","start")
colnames(ends)  <-c("contig","end")
colnames(chroms)<-c("contig","chrom")
daisyContigs <- merge(chroms,merge(starts,ends))
daisyContigs$chrom <- as.numeric(gsub("daisy_","",daisyContigs$chrom))
daisyContigs <- daisyContigs[order(daisyContigs$chrom,daisyContigs$start),]
ggplot(joins,aes(y=to,x=from,fill=scaff)) + geom_tile() + theme(legend.position="none",axis.text=element_blank() )
joins <- read.table("Aaeg_dovetail_bionano_02Sep2016_ALIGN.RG.n10.noBC.bam_40000_fragScaff.nucmer.coords.joins",col.names=c("to","from","scaff","size","program"),stringsAsFactors = F)
dim(joins)
joins <- subset(joins,to %in% daisyContigs$contig & from %in% daisyContigs$contig)
joins$to <- factor(joins$to,levels=daisyContigs$contig,ordered=T)
joins$from <- factor(joins$from,levels=daisyContigs$contig,ordered=T)
ggplot(joins,aes(y=to,x=from,fill=scaff)) + geom_tile() + theme(legend.position="none",axis.text=element_blank() )
daisyContigs <- read.table("daisy_order_scaffs.txt",col.names=c("contig","chr","pos","cov","size","hits"),stringsAsFactors = F)
joins <- read.table("Aaeg_dovetail_bionano_02Sep2016_ALIGN.RG.n10.noBC.bam_40000_fragScaff.nucmer.coords.joins",col.names=c("to","from","scaff","size","program"),stringsAsFactors = F)
dim(joins)
joins <- subset(joins,to %in% daisyContigs$contig & from %in% daisyContigs$contig)
joins$to <- factor(joins$to,levels=daisyContigs$contig,ordered=T)
joins$from <- factor(joins$from,levels=daisyContigs$contig,ordered=T)
ggplot(joins,aes(y=to,x=from,fill=scaff)) + geom_tile() + theme(legend.position="none",axis.text=element_blank() )
daisyContigs <- read.table("Aaeg_dovetail_bionano_02Sep2016_ALIGN.RG.n10.noBC.bam_40000_fragScaff.nucmer.5.tiling",col.names=c("start","end","qstart","qend","mle","len","cov","chrsize","contigsize","chrpc","contpc","chrom","contig"),stringsAsFactors = F)
unique(daisyContigs$contig)
starts <- as.data.frame(aggregate(daisyContigs$start,by=list(daisyContigs$contig),FUN=min))
ends <- as.data.frame(aggregate(daisyContigs$end,by=list(daisyContigs$contig),FUN=max))
chroms <- as.data.frame(aggregate(daisyContigs$chrom,by=list(daisyContigs$contig),FUN=function(x){x[1]}))
aligns <- as.data.frame(aggregate(daisyContigs$chrom,by=list(daisyContigs$contig),FUN=function(x){length(unique(x))}))
daisyContigs[aligns$x>1,]
colnames(starts)<-c("contig","start")
colnames(ends)  <-c("contig","end")
colnames(chroms)<-c("contig","chrom")
daisyContigs <- merge(chroms,merge(starts,ends))
daisyContigs$chrom <- as.numeric(gsub("daisy_","",daisyContigs$chrom))
daisyContigs <- daisyContigs[order(daisyContigs$chrom,daisyContigs$start),]
head(daisyContigs)
daisyContigs <- read.table("Aaeg_dovetail_bionano_02Sep2016_ALIGN.RG.n10.noBC.bam_40000_fragScaff.nucmer.5.tiling",col.names=c("start","end","qstart","qend","mle","len","cov","chrsize","contigsize","chrpc","contpc","chrom","contig"),stringsAsFactors = F)
unique(daisyContigs$contig)
starts <- as.data.frame(aggregate(daisyContigs$start,by=list(daisyContigs$contig),FUN=min))
ends <- as.data.frame(aggregate(daisyContigs$end,by=list(daisyContigs$contig),FUN=max))
chroms <- as.data.frame(aggregate(daisyContigs$chrom,by=list(daisyContigs$contig),FUN=function(x){x[1]}))
aligns <- as.data.frame(aggregate(daisyContigs$chrom,by=list(daisyContigs$contig),FUN=function(x){length(unique(x))}))
daisyContigs[aligns$x>1,]
colnames(starts)<-c("contig","start")
colnames(ends)  <-c("contig","end")
colnames(chroms)<-c("contig","chrom")
daisyContigs <- merge(chroms,merge(starts,ends))
daisyContigs$chrom <- as.numeric(gsub("daisy_","",daisyContigs$chrom))
daisyContigs <- daisyContigs[order(daisyContigs$chrom,daisyContigs$start),]
daisyContigs <- read.table("Aaeg_dovetail_bionano_02Sep2016_ALIGN.RG.n10.noBC.bam_40000_fragScaff.nucmer.5.tiling",col.names=c("start","end","qstart","qend","mle","len","cov","chrsize","contigsize","chrpc","contpc","chrom","contig"),stringsAsFactors = F)
unique(daisyContigs$contig)
starts <- as.data.frame(aggregate(daisyContigs$start,by=list(daisyContigs$contig),FUN=min))
ends <- as.data.frame(aggregate(daisyContigs$end,by=list(daisyContigs$contig),FUN=max))
chroms <- as.data.frame(aggregate(daisyContigs$chrom,by=list(daisyContigs$contig),FUN=function(x){x[1]}))
aligns <- as.data.frame(aggregate(daisyContigs$chrom,by=list(daisyContigs$contig),FUN=function(x){length(unique(x))}))
daisyContigs[aligns$x>1,]
colnames(starts)<-c("contig","start")
colnames(ends)  <-c("contig","end")
colnames(chroms)<-c("contig","chrom")
daisyContigs <- merge(chroms,merge(starts,ends))
#daisyContigs$chrom <- as.numeric(gsub("daisy_","",daisyContigs$chrom))
daisyContigs <- daisyContigs[order(daisyContigs$chrom,daisyContigs$start),]
daisyContigs <- read.table("Aaeg_dovetail_bionano_02Sep2016_ALIGN.RG.n10.noBC.bam_40000_fragScaff.nucmer.5.tiling",col.names=c("start","end","qstart","qend","mle","len","cov","chrsize","contigsize","chrpc","contpc","chrom","contig"),stringsAsFactors = F)
unique(daisyContigs$contig)
starts <- as.data.frame(aggregate(daisyContigs$start,by=list(daisyContigs$contig),FUN=min))
ends <- as.data.frame(aggregate(daisyContigs$end,by=list(daisyContigs$contig),FUN=max))
daisyContigs <- read.table("AaegL_daisy_hiC.rename.nucmer.10.tiling",col.names=c("start","end","qstart","qend","mle","len","cov","chrsize","contigsize","chrpc","contpc","chrom","contig"),stringsAsFactors = F)
unique(daisyContigs$contig)
starts <- as.data.frame(aggregate(daisyContigs$start,by=list(daisyContigs$contig),FUN=min))
ends <- as.data.frame(aggregate(daisyContigs$end,by=list(daisyContigs$contig),FUN=max))
chroms <- as.data.frame(aggregate(daisyContigs$chrom,by=list(daisyContigs$contig),FUN=function(x){x[1]}))
aligns <- as.data.frame(aggregate(daisyContigs$chrom,by=list(daisyContigs$contig),FUN=function(x){length(unique(x))}))
daisyContigs[aligns$x>1,]
colnames(starts)<-c("contig","start")
colnames(ends)  <-c("contig","end")
colnames(chroms)<-c("contig","chrom")
daisyContigs <- merge(chroms,merge(starts,ends))
daisyContigs$chrom <- as.numeric(gsub("daisy_","",daisyContigs$chrom))
daisyContigs <- daisyContigs[order(daisyContigs$chrom,daisyContigs$start),]
fragContigs <- read.table("Aaeg_dovetail_bionano_02Sep2016_ALIGN.RG.n10.noBC.bam_40000_fragScaff.nucmer.5.tiling",col.names=c("start","end","qstart","qend","mle","len","cov","chrsize","contigsize","chrpc","contpc","chrom","contig"),stringsAsFactors = F)
unique(fragContigs$contig)
starts <- as.data.frame(aggregate(fragContigs$start,by=list(fragContigs$contig),FUN=min))
ends <- as.data.frame(aggregate(fragContigs$end,by=list(fragContigs$contig),FUN=max))
chroms <- as.data.frame(aggregate(fragContigs$chrom,by=list(fragContigs$contig),FUN=function(x){x[1]}))
aligns <- as.data.frame(aggregate(fragContigs$chrom,by=list(fragContigs$contig),FUN=function(x){length(unique(x))}))
fragContigs[aligns$x>1,]
colnames(starts)<-c("contig","start")
colnames(ends)  <-c("contig","end")
colnames(chroms)<-c("contig","chrom")
fragContigs <- merge(chroms,merge(starts,ends))
fragContigs <- fragContigs[order(fragContigs$chrom,fragContigs$start),]
joins <- read.table("all_0_3125ng_AaPB.RG.n20.noBC.bam_40000_fragScaff.f.nucmer.coords.joins",col.names=c("to","from","scaff","count","program"),stringsAsFactors = F)
dim(joins)
joins <- subset(joins,to %in% daisyContigs$contig & from %in% daisyContigs$contig)
dim(joins)
joins$to <- factor(joins$to,levels=daisyContigs$contig,ordered=T)
joins$from <- factor(joins$from,levels=daisyContigs$contig,ordered=T)
#ggplot(joins,aes(y=to,x=from,fill=scaff)) + geom_tile(aes(size=size/10000)) + theme(legend.position="none",axis.text=element_blank() )
ggplot(joins,aes(y=to,x=from,fill=scaff)) + geom_tile() + theme(legend.position="none",axis.text=element_blank() )
daisyContigs<-fragContigs
joins <- read.table("all_0_3125ng_AaPB.RG.n20.noBC.bam_40000_fragScaff.f.nucmer.coords.joins",col.names=c("to","from","scaff","count","program"),stringsAsFactors = F)
dim(joins)
joins <- subset(joins,to %in% daisyContigs$contig & from %in% daisyContigs$contig)
dim(joins)
joins$to <- factor(joins$to,levels=daisyContigs$contig,ordered=T)
joins$from <- factor(joins$from,levels=daisyContigs$contig,ordered=T)
#ggplot(joins,aes(y=to,x=from,fill=scaff)) + geom_tile(aes(size=size/10000)) + theme(legend.position="none",axis.text=element_blank() )
ggplot(joins,aes(y=to,x=from,fill=scaff)) + geom_tile() + theme(legend.position="none",axis.text=element_blank() )
library(hexbin)
library(reshape2)
library(knitr)
library(ggplot2)
```{r setup, include=F}
opts_chunk$set(fig.width=10, fig.height=10,dev=c('png','postscript'),warning=F)
#setwd("/Volumes//gsap_garage-protistvector/sredmond/Aedes_AGWG/reports/161019_assembly_comp_matrix/")
```
```{r}
#orderContigs <- read.table("daisy_order_scaffs.txt",col.names=c("contig","chr","pos","cov","size","hits"),stringsAsFactors = F)
daisyContigs <- read.table("AaegL_daisy_hiC.rename.nucmer.10.tiling",col.names=c("start","end","qstart","qend","mle","len","cov","chrsize","contigsize","chrpc","contpc","chrom","contig"),stringsAsFactors = F)
unique(daisyContigs$contig)
starts <- as.data.frame(aggregate(daisyContigs$start,by=list(daisyContigs$contig),FUN=min))
ends <- as.data.frame(aggregate(daisyContigs$end,by=list(daisyContigs$contig),FUN=max))
chroms <- as.data.frame(aggregate(daisyContigs$chrom,by=list(daisyContigs$contig),FUN=function(x){x[1]}))
aligns <- as.data.frame(aggregate(daisyContigs$chrom,by=list(daisyContigs$contig),FUN=function(x){length(unique(x))}))
daisyContigs[aligns$x>1,]
colnames(starts)<-c("contig","start")
colnames(ends)  <-c("contig","end")
colnames(chroms)<-c("contig","chrom")
daisyContigs <- merge(chroms,merge(starts,ends))
daisyContigs$chrom <- as.numeric(gsub("daisy_","",daisyContigs$chrom))
daisyContigs <- daisyContigs[order(daisyContigs$chrom,daisyContigs$start),]
```
```{r}
fragContigs <- read.table("Aaeg_dovetail_bionano_02Sep2016_ALIGN.RG.n10.noBC.bam_40000_fragScaff.nucmer.5.tiling",col.names=c("start","end","qstart","qend","mle","len","cov","chrsize","contigsize","chrpc","contpc","chrom","contig"),stringsAsFactors = F)
unique(fragContigs$contig)
starts <- as.data.frame(aggregate(fragContigs$start,by=list(fragContigs$contig),FUN=min))
ends <- as.data.frame(aggregate(fragContigs$end,by=list(fragContigs$contig),FUN=max))
chroms <- as.data.frame(aggregate(fragContigs$chrom,by=list(fragContigs$contig),FUN=function(x){x[1]}))
aligns <- as.data.frame(aggregate(fragContigs$chrom,by=list(fragContigs$contig),FUN=function(x){length(unique(x))}))
fragContigs[aligns$x>1,]
colnames(starts)<-c("contig","start")
colnames(ends)  <-c("contig","end")
colnames(chroms)<-c("contig","chrom")
fragContigs <- merge(chroms,merge(starts,ends))
#fragContigs$chrom <- as.numeric(gsub("daisy_","",fragContigs$chrom))
fragContigs <- fragContigs[order(fragContigs$chrom,fragContigs$start),]
```
```{r}
orderContigs<-fragContigs
```
```{r}
#orderContigs <- subset(orderContigs,hits==1)
joins <- read.table("all_0_3125ng_AaPB.RG.n20.noBC.bam_40000_fragScaff.f.nucmer.coords.joins",col.names=c("to","from","scaff","count","program"),stringsAsFactors = F)
dim(joins)
joins <- subset(joins,to %in% orderContigs$contig & from %in% orderContigs$contig)
dim(joins)
joins$to <- factor(joins$to,levels=orderContigs$contig,ordered=T)
joins$from <- factor(joins$from,levels=orderContigs$contig,ordered=T)
#ggplot(joins,aes(y=to,x=from,fill=scaff)) + geom_tile(aes(size=size/10000)) + theme(legend.position="none",axis.text=element_blank() )
ggplot(joins,aes(y=to,x=from,fill=scaff)) + geom_tile() + theme(legend.position="none",axis.text=element_blank() )
```
```{r}
joins <- read.table("fragscaff_AaegPB_0_156_n10_40k.nucmer.coords.joins",col.names=c("to","from","scaff","size","program"),stringsAsFactors = F)
dim(joins)
joins <- subset(joins,to %in% orderContigs$contig & from %in% orderContigs$contig)
joins$to <- factor(joins$to,levels=orderContigs$contig,ordered=T)
joins$from <- factor(joins$from,levels=orderContigs$contig,ordered=T)
dim(joins)
ggplot(joins,aes(y=to,x=from,fill=scaff)) + geom_tile() + theme(legend.position="none",axis.text=element_blank() )
```
```{r}
joins <- read.table("AaegL_daisy_hiC.rename.nucmer.coords.joins",col.names=c("to","from","scaff","size","program"),stringsAsFactors = F)
dim(joins)
joins <- subset(joins,to %in% orderContigs$contig & from %in% orderContigs$contig)
joins$to <- factor(joins$to,levels=orderContigs$contig,ordered=T)
joins$from <- factor(joins$from,levels=orderContigs$contig,ordered=T)
ggplot(joins,aes(y=to,x=from,fill=scaff)) + geom_tile() + theme(legend.position="none",axis.text=element_blank() )
```
```{r}
joins <- read.table("Aaeg_dovetail_pacbio_22Aug2016.nucmer.coords.joins",col.names=c("to","from","scaff","size","program"),stringsAsFactors = F)
dim(joins)
joins <- subset(joins,to %in% orderContigs$contig & from %in% orderContigs$contig)
joins$to <- factor(joins$to,levels=orderContigs$contig,ordered=T)
joins$from <- factor(joins$from,levels=orderContigs$contig,ordered=T)
#ggplot(joins,aes(y=to,x=from,fill=scaff)) + geom_tile() + geom_vline(aes(xintercept=x),data=chroms) +
#  theme(legend.position="none",axis.text=element_blank() )
ggplot(joins,aes(y=to,x=from,fill=scaff)) + geom_tile() +
theme(legend.position="none",axis.text=element_blank() )
```
```{r}
joins <- read.table("Aaeg_dovetail_bionano_02Sep2016_ALIGN.RG.n10.noBC.bam_40000_fragScaff.nucmer.coords.joins",col.names=c("to","from","scaff","size","program"),stringsAsFactors = F)
dim(joins)
joins <- subset(joins,to %in% orderContigs$contig & from %in% orderContigs$contig)
joins$to <- factor(joins$to,levels=orderContigs$contig,ordered=T)
joins$from <- factor(joins$from,levels=orderContigs$contig,ordered=T)
ggplot(joins,aes(y=to,x=from,fill=scaff)) + geom_tile() + theme(legend.position="none",axis.text=element_blank() )
```
```{r}
joins <- merge(joins,orderContigs,by.x="from",by.y="contig")
joins <- merge(joins,orderContigs,by.x="to",by.y="contig",suffixes = c(".from",".to"))
ggplot(subset(joins,chrom.from %in% c(1) & chrom.to == chrom.from),aes(ymin=start.from,ymax=end.from, xmin=start.to,xmax=end.to)) + geom_rect() + theme(legend.position="none") + facet_grid(. ~ chrom.to)
```
knit("assembliesMatrix.Rmd")
knit("assembliesMatrix.Rmd")
knit("assembliesMatrix.Rmd")
knit("assembliesMatrix.Rmd")
orderContigs<-daisyContigs
joins <- read.table("all_0_3125ng_AaPB.RG.n20.noBC.bam_40000_fragScaff.f.nucmer.coords.joins",col.names=c("to","from","scaff","count","program"),stringsAsFactors = F)
dim(joins)
joins <- subset(joins,to %in% orderContigs$contig & from %in% orderContigs$contig)
dim(joins)
joins$to <- factor(joins$to,levels=orderContigs$contig,ordered=T)
joins$from <- factor(joins$from,levels=orderContigs$contig,ordered=T)
#ggplot(joins,aes(y=to,x=from,fill=scaff)) + geom_tile(aes(size=size/10000)) + theme(legend.position="none",axis.text=element_blank() )
ggplot(joins,aes(y=to,x=from,fill=scaff)) + geom_tile() + theme(legend.position="none",axis.text=element_blank() )
ggplot(joins,aes(y=to,x=from,fill=scaff)) + geom_tile(aes(size=size/10000)) + theme(legend.position="none",axis.text=element_blank() )
pwd
setwd("~/Scratch/gits/pfdisco/reports/161112_rocplots_validation/")
gatkFilt <- read.table("3D7DD2.REFCALL.PASS.DD2CONC.PFX.LMRG.HAP.CALLBOTH.Dd2-2D4_FILT_EVAL/weighted_roc.tsv.gz",header=F,skip = 3,stringsAsFactors =F,sep="\t")
head(gatkFilt)
colnames(gatkFilt) <-c("score","true_positives","false_positives","false_negatives","precision","sensitivity","f_measure")
gatkFilt <- read.table("3D7DD2.REFCALL.PASS.DD2CONC.PFX.LMRG.HAP.CALLBOTH.Dd2-2D4_FILT_EVAL/snp_roc.tsv.gz",header=F,skip = 3,stringsAsFactors =F,sep="\t")
colnames(gatkFilt) <-c("score","true_positives","false_positives","false_negatives","precision","sensitivity","f_measure")
head(gatkFilt)
gatkFilt <- read.table("3D7DD2.REFCALL.PASS.DD2CONC.PFX.LMRG.HAP.CALLBOTH.Dd2-2D4_FILT_EVAL/weighted_roc.tsv.gz",header=F,skip = 3,stringsAsFactors =F,sep="\t")
colnames(gatkFilt) <-c("score","true_positives","false_positives","false_negatives","precision","sensitivity","f_measure")
head(gatkFilt)
gatkFilt <- read.table("3D7DD2.REFCALL.PASS.DD2CONC.PFX.LMRG.HAP.CALLBOTH.Dd2-2D4_FILT_EVAL/weighted_roc.tsv.gz",header=F,skip = 3,stringsAsFactors =F,sep="\t")
colnames(gatkFilt) <-c("score","true_positives","false_positives","false_negatives","precision","sensitivity","f_measure")
gatkFilt <- read.table("3D7DD2.REFCALL.PASS.DD2CONC.PFX.LMRG.HAP.CALLBOTH.Dd2-2D4_FILT_EVAL/weighted_roc.tsv.gz",header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names=c("score","true_positives","false_positives","false_negatives","precision","sensitivity","f_measure"))
gatkFiltSNPs <- read.table("3D7DD2.REFCALL.PASS.DD2CONC.PFX.LMRG.HAP.CALLBOTH.Dd2-2D4_FILT_EVAL/snp_roc.tsv.gz",header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names = c("score","snp_tp","snp_fp"))
gatkFiltINDELs <- read.table("3D7DD2.REFCALL.PASS.DD2CONC.PFX.LMRG.HAP.CALLBOTH.Dd2-2D4_FILT_EVAL/snp_roc.tsv.gz",header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names = c("score","ind_tp","ind_fp"))
gatkfilt <- merge(gatkFilt,gatkFiltSNPs,all.x=T)
gatkfilt <- merge(gatkFilt,gatkFiltINDELs,all.x=T)
gatkFilt$caller="GATK"
gatkFilt <- read.table("3D7DD2.REFCALL.PASS.DD2CONC.PFX.LMRG.HAP.CALLBOTH.Dd2-2D4_FILT_EVAL/weighted_roc.tsv.gz",header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names=c("score","true_positives","false_positives","false_negatives","precision","sensitivity","f_measure"))
gatkFiltSNPs <- read.table("3D7DD2.REFCALL.PASS.DD2CONC.PFX.LMRG.HAP.CALLBOTH.Dd2-2D4_FILT_EVAL/snp_roc.tsv.gz",header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names = c("score","snp_tp","snp_fp"))
gatkFiltINDELs <- read.table("3D7DD2.REFCALL.PASS.DD2CONC.PFX.LMRG.HAP.CALLBOTH.Dd2-2D4_FILT_EVAL/snp_roc.tsv.gz",header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names = c("score","ind_tp","ind_fp"))
gatkfilt <- merge(gatkFilt,gatkFiltSNPs,all.x=T)
gatkfilt <- merge(gatkFilt,gatkFiltINDELs,all.x=T)
gatkFilt$caller="GATK"
gatkCALLFilt <- read.table("3D7DD2.REFCALL.PASS.DD2CONC.PFX.LMRG.HAP.CALLBOTH.Dd2-2D4_FILT_EVAL/weighted_roc.tsv.gz",header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names=c("score","true_positives","false_positives","false_negatives","precision","sensitivity","f_measure"))
gatkCALLFiltSNPs <- read.table("3D7DD2.REFCALL.PASS.DD2CONC.PFX.LMRG.HAP.CALLBOTH.Dd2-2D4_FILT_EVAL/snp_roc.tsv.gz",header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names = c("score","snp_tp","snp_fp"))
gatkCALLFiltINDELs <- read.table("3D7DD2.REFCALL.PASS.DD2CONC.PFX.LMRG.HAP.CALLBOTH.Dd2-2D4_FILT_EVAL/snp_roc.tsv.gz",header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names = c("score","ind_tp","ind_fp"))
gatkCALLfilt <- merge(gatkCALLFilt,gatkCALLFiltSNPs,all.x=T)
gatkCALLfilt <- merge(gatkCALLFilt,gatkCALLFiltINDELs,all.x=T)
gatkCALLFilt$caller="GATK"
roctab <- rbind(gatkFilt,gatkCALLfilt)
vq$sample <- factor(roctab$sample)
vq$caller <- factor(roctab$caller)
head(gatkFilt)
head(gatkCALLFilt)
gatkFilt <- read.table("3D7DD2.REFCALL.PASS.DD2CONC.PFX.LMRG.HAP.CALLBOTH.Dd2-2D4_FILT_EVAL/weighted_roc.tsv.gz",header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names=c("score","true_positives","false_positives","false_negatives","precision","sensitivity","f_measure"))
gatkFiltSNPs <- read.table("3D7DD2.REFCALL.PASS.DD2CONC.PFX.LMRG.HAP.CALLBOTH.Dd2-2D4_FILT_EVAL/snp_roc.tsv.gz",header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names = c("score","snp_tp","snp_fp"))
gatkFiltINDELs <- read.table("3D7DD2.REFCALL.PASS.DD2CONC.PFX.LMRG.HAP.CALLBOTH.Dd2-2D4_FILT_EVAL/snp_roc.tsv.gz",header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names = c("score","ind_tp","ind_fp"))
gatkfilt <- merge(gatkFilt,gatkFiltSNPs,all.x=T)
gatkfilt <- merge(gatkFilt,gatkFiltINDELs,all.x=T)
gatkFilt$caller="GATK"
gatkCALLFilt <- read.table("3D7DD2.REFCALL.PASS.DD2CONC.PFX.LMRG.HAP.CALLBOTH.Dd2-2D4_FILT_EVAL/weighted_roc.tsv.gz",header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names=c("score","true_positives","false_positives","false_negatives","precision","sensitivity","f_measure"))
gatkCALLFiltSNPs <- read.table("3D7DD2.REFCALL.PASS.DD2CONC.PFX.LMRG.HAP.CALLBOTH.Dd2-2D4_FILT_EVAL/snp_roc.tsv.gz",header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names = c("score","snp_tp","snp_fp"))
gatkCALLFiltINDELs <- read.table("3D7DD2.REFCALL.PASS.DD2CONC.PFX.LMRG.HAP.CALLBOTH.Dd2-2D4_FILT_EVAL/snp_roc.tsv.gz",header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names = c("score","ind_tp","ind_fp"))
gatkCALLfilt <- merge(gatkCALLFilt,gatkCALLFiltSNPs,all.x=T)
gatkCALLfilt <- merge(gatkCALLFilt,gatkCALLFiltINDELs,all.x=T)
gatkCALLFilt$caller="GATK"
discoFilt <- read.table("GATK_3D7_0901_weighted_roc.tsv.gz",header=F,skip = 3,stringsAsFactors =F,sep="\t")
roctab <- rbind(gatkFilt,gatkCALLfilt)
head(roctab)
head(gatkFilt,gatkCALLfilt)
head(gatkFilt); head(gatkCALLfilt)
gatkCALLFilt <- read.table("3D7DD2.REFCALL.PASS.DD2CONC.PFX.LMRG.HAP.CALLBOTH.Dd2-2D4_FILT_EVAL/weighted_roc.tsv.gz",header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names=c("score","true_positives","false_positives","false_negatives","precision","sensitivity","f_measure"))
gatkCALLFiltSNPs <- read.table("3D7DD2.REFCALL.PASS.DD2CONC.PFX.LMRG.HAP.CALLBOTH.Dd2-2D4_FILT_EVAL/snp_roc.tsv.gz",header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names = c("score","snp_tp","snp_fp"))
gatkCALLFiltINDELs <- read.table("3D7DD2.REFCALL.PASS.DD2CONC.PFX.LMRG.HAP.CALLBOTH.Dd2-2D4_FILT_EVAL/snp_roc.tsv.gz",header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names = c("score","ind_tp","ind_fp"))
gatkCALLFilt <- merge(gatkCALLFilt,gatkCALLFiltSNPs,all.x=T)
gatkCALLFilt <- merge(gatkCALLFilt,gatkCALLFiltINDELs,all.x=T)
gatkCALLFilt$caller="GATK"
head(gatkFilt); head(gatkCALLfilt)
gatkCALLFilt <- merge(gatkCALLFilt,gatkCALLFiltSNPs,all.x=T)
gatkCALLFilt <- merge(gatkCALLFilt,gatkCALLFiltINDELs,all.x=T)
head(gatkFilt); head(gatkCALLFilt)
gatkFilt <- read.table("3D7DD2.REFCALL.PASS.DD2CONC.PFX.LMRG.HAP.CALLBOTH.Dd2-2D4_FILT_EVAL/weighted_roc.tsv.gz",header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names=c("score","true_positives","false_positives","false_negatives","precision","sensitivity","f_measure"))
gatkFiltSNPs <- read.table("3D7DD2.REFCALL.PASS.DD2CONC.PFX.LMRG.HAP.CALLBOTH.Dd2-2D4_FILT_EVAL/snp_roc.tsv.gz",header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names = c("score","snp_tp","snp_fp"))
gatkFiltINDELs <- read.table("3D7DD2.REFCALL.PASS.DD2CONC.PFX.LMRG.HAP.CALLBOTH.Dd2-2D4_FILT_EVAL/snp_roc.tsv.gz",header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names = c("score","ind_tp","ind_fp"))
gatkFilt <- merge(gatkFilt,gatkFiltSNPs,all.x=T)
gatkFilt <- merge(gatkFilt,gatkFiltINDELs,all.x=T)
gatkFilt$caller="GATK"
gatkCALLFilt <- read.table("3D7DD2.REFCALL.PASS.DD2CONC.PFX.LMRG.HAP.CALLBOTH.Dd2-2D4_FILT_EVAL/weighted_roc.tsv.gz",header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names=c("score","true_positives","false_positives","false_negatives","precision","sensitivity","f_measure"))
gatkCALLFiltSNPs <- read.table("3D7DD2.REFCALL.PASS.DD2CONC.PFX.LMRG.HAP.CALLBOTH.Dd2-2D4_FILT_EVAL/snp_roc.tsv.gz",header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names = c("score","snp_tp","snp_fp"))
gatkCALLFiltINDELs <- read.table("3D7DD2.REFCALL.PASS.DD2CONC.PFX.LMRG.HAP.CALLBOTH.Dd2-2D4_FILT_EVAL/snp_roc.tsv.gz",header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names = c("score","ind_tp","ind_fp"))
gatkCALLFilt <- merge(gatkCALLFilt,gatkCALLFiltSNPs,all.x=T)
gatkCALLFilt <- merge(gatkCALLFilt,gatkCALLFiltINDELs,all.x=T)
gatkCALLFilt$caller="GATK"
head(gatkFilt); head(gatkCALLFilt)
gatkFilt <- read.table("3D7DD2.REFCALL.PASS.DD2CONC.PFX.LMRG.HAP.CALLBOTH.Dd2-2D4_FILT_EVAL/weighted_roc.tsv.gz",header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names=c("score","true_positives","false_positives","false_negatives","precision","sensitivity","f_measure"))
gatkFilt$caller="GATK"
gatkFiltSNPs <- read.table("3D7DD2.REFCALL.PASS.DD2CONC.PFX.LMRG.HAP.CALLBOTH.Dd2-2D4_FILT_EVAL/snp_roc.tsv.gz",header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names = c("score","snp_tp","snp_fp"))
gatkFiltINDELs <- read.table("3D7DD2.REFCALL.PASS.DD2CONC.PFX.LMRG.HAP.CALLBOTH.Dd2-2D4_FILT_EVAL/non_snp_roc.tsv.gz",header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names = c("score","ind_tp","ind_fp"))
gatkFiltType <- merge(gatkFiltSNPs,gatkFiltINDELs,all.x=T)
gatkFiltType$caller="GATK"
gatkCALLFilt <- read.table("3D7DD2.REFCALL.PASS.DD2CONC.PFX.LMRG.HAP.CALLBOTH.Dd2-2D4_FILT_EVAL/weighted_roc.tsv.gz",header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names=c("score","true_positives","false_positives","false_negatives","precision","sensitivity","f_measure"))
gatkCALLFilt$caller="GATK"
gatkCALLFiltSNPs <- read.table("3D7DD2.REFCALL.PASS.DD2CONC.PFX.LMRG.HAP.CALLBOTH.Dd2-2D4_FILT_EVAL/snp_roc.tsv.gz",header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names = c("score","snp_tp","snp_fp"))
gatkCALLFiltINDELs <- read.table("3D7DD2.REFCALL.PASS.DD2CONC.PFX.LMRG.HAP.CALLBOTH.Dd2-2D4_FILT_EVAL/non_snp_roc.tsv.gz",header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names = c("score","ind_tp","ind_fp"))
gatkCALLFiltType <- merge(gatkCALLFiltSNPs,gatkCALLFiltINDELs,all.x=T)
gatkCALLFiltType$caller="GATK"
head(gatkFilt); head(gatkCALLFilt)
head(gatkFiltType); head(gatkCALLFiltType)
View(gatkCALLFiltType)
gatkCALLFiltType <- rbind(gatkCALLFiltSNPs,gatkCALLFiltINDELs)
gatkCALLFilt <- read.table("3D7DD2.REFCALL.PASS.DD2CONC.PFX.LMRG.HAP.CALLBOTH.Dd2-2D4_FILT_EVAL/weighted_roc.tsv.gz",header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names=c("score","true_positives","false_positives","false_negatives","precision","sensitivity","f_measure"))
gatkCALLFilt$caller="GATK"
gatkCALLFiltSNPs <- read.table("3D7DD2.REFCALL.PASS.DD2CONC.PFX.LMRG.HAP.CALLBOTH.Dd2-2D4_FILT_EVAL/snp_roc.tsv.gz",header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names = c("score","snp_tp","snp_fp"))
gatkCALLFiltINDELs <- read.table("3D7DD2.REFCALL.PASS.DD2CONC.PFX.LMRG.HAP.CALLBOTH.Dd2-2D4_FILT_EVAL/non_snp_roc.tsv.gz",header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names = c("score","ind_tp","ind_fp"))
gatkCALLFiltSNPs$type="SNP"
gatkCALLFiltINDELs$type="INDEL"
gatkCALLFiltType <- rbind(gatkCALLFiltSNPs,gatkCALLFiltINDELs)
gatkCALLFiltType$caller="GATK"
gatkCALLFiltSNPs <- read.table("3D7DD2.REFCALL.PASS.DD2CONC.PFX.LMRG.HAP.CALLBOTH.Dd2-2D4_FILT_EVAL/snp_roc.tsv.gz",header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names = c("score","true_positives","false_positives"))
gatkCALLFiltINDELs <- read.table("3D7DD2.REFCALL.PASS.DD2CONC.PFX.LMRG.HAP.CALLBOTH.Dd2-2D4_FILT_EVAL/non_snp_roc.tsv.gz",header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names = c("score","true_positives","false_positives"))
gatkCALLFiltSNPs$type="SNP"
gatkCALLFiltINDELs$type="INDEL"
gatkCALLFiltType <- rbind(gatkCALLFiltSNPs,gatkCALLFiltINDELs)
gatkCALLFiltType$caller="GATK"
head(gatkFilt); head(gatkCALLFilt)
head(gatkFiltType); head(gatkCALLFiltType)
gatkCALLFilt <- read.table("3D7DD2.REFCALL.PASS.DD2CONC.PFX.LMRG.HAP.CALLBOTH.Dd2-2D4_FILT_EVAL/weighted_roc.tsv.gz",header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names=c("score","true_positives","false_positives","false_negatives","precision","sensitivity","f_measure"))
gatkCALLFilt$caller="GATK"
gatkCALLFiltSNPs <- read.table("3D7DD2.REFCALL.PASS.DD2CONC.PFX.LMRG.HAP.CALLBOTH.Dd2-2D4_FILT_EVAL/snp_roc.tsv.gz",header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names = c("score","true_positives","false_positives"))
gatkCALLFiltINDELs <- read.table("3D7DD2.REFCALL.PASS.DD2CONC.PFX.LMRG.HAP.CALLBOTH.Dd2-2D4_FILT_EVAL/non_snp_roc.tsv.gz",header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names = c("score","true_positives","false_positives"))
gatkCALLFiltSNPs$type="SNP"
gatkCALLFiltINDELs$type="INDEL"
gatkCALLFiltType <- rbind(gatkCALLFiltSNPs,gatkCALLFiltINDELs)
gatkCALLFiltType$caller="GATK"
head(gatkFilt); head(gatkCALLFilt)
head(gatkFiltType); head(gatkCALLFiltType)
g_legend<-function(a.gplot){
tmp <- ggplot_gtable(ggplot_build(a.gplot))
leg <- which(sapply(tmp$grobs, function(x) x$name) == "guide-box")
legend <- tmp$grobs[[leg]]
return(legend)}
ggplot(gatkCALLFiltType,aes(x=false_positives,y=true_positives,colour=type)) +
geom_line() + facet_grid(. ~ caller) + theme(legend.position="bottom") + ylim(0,20e3)
library(ggplot2)
ggplot(gatkCALLFiltType,aes(x=false_positives,y=true_positives,colour=type)) +
geom_line() + facet_grid(. ~ caller) + theme(legend.position="bottom") + ylim(0,20e3)
ggplot(gatkCALLFiltType,aes(x=false_positives,y=true_positives,colour=type)) +
geom_line() + facet_grid(. ~ caller) + theme(legend.position="bottom")
ggplot(gatkCALLType,aes(x=false_positives,y=true_positives,colour=type)) +
geom_line() + facet_grid(. ~ caller) + theme(legend.position="bottom")
ggplot(gatkCALLFiltType,aes(x=false_positives,y=true_positives,colour=type)) +
geom_line() + facet_grid(. ~ caller) + theme(legend.position="bottom")
ggplot(gatkCALLType,aes(x=false_positives,y=true_positives,colour=type)) +
geom_line() + facet_grid(. ~ caller) + theme(legend.position="bottom")
ggplot(gatkFiltType,aes(x=false_positives,y=true_positives,colour=type)) +
geom_line() + facet_grid(. ~ caller) + theme(legend.position="bottom")
gatkFilt <- read.table("3D7DD2.REFCALL.PASS.DD2CONC.PFX.LMRG.HAP.CALLBOTH.Dd2-2D4_FILT_EVAL/weighted_roc.tsv.gz",header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names=c("score","true_positives","false_positives","false_negatives","precision","sensitivity","f_measure"))
gatkFilt$caller="GATK"
gatkFiltSNPs <- read.table("3D7DD2.REFCALL.PASS.DD2CONC.PFX.LMRG.HAP.CALLBOTH.Dd2-2D4_FILT_EVAL/snp_roc.tsv.gz",header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names = c("score","snp_tp","snp_fp"))
gatkFiltINDELs <- read.table("3D7DD2.REFCALL.PASS.DD2CONC.PFX.LMRG.HAP.CALLBOTH.Dd2-2D4_FILT_EVAL/non_snp_roc.tsv.gz",header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names = c("score","ind_tp","ind_fp"))
gatkFiltSNPs <- read.table("3D7DD2.REFCALL.PASS.DD2CONC.PFX.LMRG.HAP.CALLBOTH.Dd2-2D4_FILT_EVAL/snp_roc.tsv.gz",header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names = c("score","true_positives","false_positives"))
gatkFiltINDELs <- read.table("3D7DD2.REFCALL.PASS.DD2CONC.PFX.LMRG.HAP.CALLBOTH.Dd2-2D4_FILT_EVAL/non_snp_roc.tsv.gz",header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names = c("score","true_positives","false_positives"))
gatkFiltSNPs$type="SNP"
gatkFiltINDELs$type="INDEL"
gatkFiltType <- rbind(gatkFiltSNPs,gatkFiltINDELs)
gatkFiltType$caller="GATK"
gatkCALLFilt <- read.table("3D7DD2.REFCALL.PASS.DD2CONC.PFX.LMRG.HAP.CALLBOTH.Dd2-2D4_FILT_EVAL/weighted_roc.tsv.gz",header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names=c("score","true_positives","false_positives","false_negatives","precision","sensitivity","f_measure"))
gatkCALLFilt$caller="GATK"
gatkCALLFiltSNPs <- read.table("3D7DD2.REFCALL.PASS.DD2CONC.PFX.LMRG.HAP.CALLBOTH.Dd2-2D4_FILT_EVAL/snp_roc.tsv.gz",header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names = c("score","true_positives","false_positives"))
gatkCALLFiltINDELs <- read.table("3D7DD2.REFCALL.PASS.DD2CONC.PFX.LMRG.HAP.CALLBOTH.Dd2-2D4_FILT_EVAL/non_snp_roc.tsv.gz",header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names = c("score","true_positives","false_positives"))
gatkCALLFiltSNPs$type="SNP"
gatkCALLFiltINDELs$type="INDEL"
gatkCALLFiltType <- rbind(gatkCALLFiltSNPs,gatkCALLFiltINDELs)
gatkCALLFiltType$caller="GATK"
head(gatkFilt); head(gatkCALLFilt)
head(gatkFiltType); head(gatkCALLFiltType)
View(gatkCALLFiltType)
ggplot(gatkCALLFiltType,aes(x=false_positives,y=true_positives,colour=type)) +
geom_line() + facet_grid(. ~ caller) + theme(legend.position="bottom")
ggplot(gatkCALLFiltType,aes(x=false_positives,y=true_positives,colour=type)) +
geom_point() + facet_grid(. ~ caller) + theme(legend.position="bottom")
ggplot(gatkFiltType,aes(x=false_positives,y=true_positives,colour=type)) +
geom_point() + facet_grid(. ~ caller) + theme(legend.position="bottom")
gatkFilt <- read.table("3D7DD2.REFCALL.PASS.DD2CONC.PFX.LMRG.HAP.Dd2-2D4_FILT_EVAL/weighted_roc.tsv.gz",header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names=c("score","true_positives","false_positives","false_negatives","precision","sensitivity","f_measure"))
gatkFilt$caller="GATK"
gatkFiltSNPs <- read.table("3D7DD2.REFCALL.PASS.DD2CONC.PFX.LMRG.HAP.Dd2-2D4_FILT_EVAL/snp_roc.tsv.gz",header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names = c("score","true_positives","false_positives"))
gatkFiltINDELs <- read.table("3D7DD2.REFCALL.PASS.DD2CONC.PFX.LMRG.HAP.Dd2-2D4_FILT_EVAL/non_snp_roc.tsv.gz",header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names = c("score","true_positives","false_positives"))
gatkFiltSNPs$type="SNP"
gatkFiltINDELs$type="INDEL"
gatkFiltType <- rbind(gatkFiltSNPs,gatkFiltINDELs)
gatkFiltType$caller="GATK"
ggplot(gatkCALLFiltType,aes(x=false_positives,y=true_positives,colour=type)) +
geom_line() + facet_grid(. ~ caller) + theme(legend.position="bottom")
ggplot(gatkFiltType,aes(x=false_positives,y=true_positives,colour=type)) +
geom_point() + facet_grid(. ~ caller) + theme(legend.position="bottom")
posns <- intersect(gatkCALLFiltSNPs$score,gatkCALLFiltINDELs)
posns
posns <- intersect(gatkCALLFiltSNPs$score,gatkCALLFiltINDELs$score)
posns
gatkCALLFiltType <- subset(gatkCALLFiltType,score in posns)
gatkCALLFiltType <- subset(gatkCALLFiltType,score %in% posns)
gatkCALLFiltType
posns <- intersect(gatkFiltSNPs$score,gatkFiltINDELs$score)
gatkFiltType <- subset(gatkFiltType,score %in% posns)
ggplot(gatkCALLFiltType,aes(x=false_positives,y=true_positives,colour=type)) +
geom_line() + facet_grid(. ~ caller) + theme(legend.position="bottom")
ggplot(gatkFiltType,aes(x=false_positives,y=true_positives,colour=type)) +
geom_point() + facet_grid(. ~ caller) + theme(legend.position="bottom")
ggplot(gatkFiltType,aes(x=false_positives,y=true_positives,colour=type)) +
geom_line() + facet_grid(. ~ caller) + theme(legend.position="bottom")
length(gatkFiltSNPs$score)
length(posns)
dim(gatkFiltType)
gatkFilt$region="GENOME"
gatkCALLFilt$region="GENOME"
rbind(gatkCALLFilt,gatkFilt)
rocCf <- rbind(gatkCALLFilt,gatkFilt)
ggplot(rocCf,aes(x=false_positives,y=true_positives,colour=type,linetype=region)) +
geom_line() + facet_grid(. ~ caller) + theme(legend.position="bottom")
ggplot(rocCf,aes(x=false_positives,y=true_positives,colour=caller,linetype=region)) +
geom_line() + facet_grid(. ~ caller) + theme(legend.position="bottom")
gatkCALLFilt$region="CALLABLE"
rocCf <- rbind(gatkCALLFilt,gatkFilt)
ggplot(rocCf,aes(x=false_positives,y=true_positives,colour=caller,linetype=region)) +
geom_line() + facet_grid(. ~ caller) + theme(legend.position="bottom")
rocCf <- rbind(gatkCALLFiltType,gatkFiltType)
ggplot(rocCf,aes(x=false_positives,y=true_positives,colour=type,linetype=region)) +
geom_line() + facet_grid(. ~ caller) + theme(legend.position="bottom")
gatkFiltSNPs <- read.table("3D7DD2.REFCALL.PASS.DD2CONC.PFX.LMRG.HAP.Dd2-2D4_FILT_EVAL/snp_roc.tsv.gz",header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names = c("score","true_positives","false_positives"))
gatkFiltINDELs <- read.table("3D7DD2.REFCALL.PASS.DD2CONC.PFX.LMRG.HAP.Dd2-2D4_FILT_EVAL/non_snp_roc.tsv.gz",header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names = c("score","true_positives","false_positives"))
gatkFiltSNPs$type="SNP"
gatkFiltINDELs$type="INDEL"
gatkFiltType <- rbind(gatkFiltSNPs,gatkFiltINDELs)
gatkFiltType$caller="GATK"
gatkFiltType$region="GENOME"
posns <- intersect(gatkFiltSNPs$score,gatkFiltINDELs$score)
gatkFiltType <- subset(gatkFiltType,score %in% posns)
gatkCALLFilt <- read.table("3D7DD2.REFCALL.PASS.DD2CONC.PFX.LMRG.HAP.CALLBOTH.Dd2-2D4_FILT_EVAL/weighted_roc.tsv.gz",header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names=c("score","true_positives","false_positives","false_negatives","precision","sensitivity","f_measure"))
gatkCALLFilt$caller="GATK"
gatkCALLFilt$region="CALLABLE"
gatkCALLFiltSNPs <- read.table("3D7DD2.REFCALL.PASS.DD2CONC.PFX.LMRG.HAP.CALLBOTH.Dd2-2D4_FILT_EVAL/snp_roc.tsv.gz",header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names = c("score","true_positives","false_positives"))
gatkCALLFiltINDELs <- read.table("3D7DD2.REFCALL.PASS.DD2CONC.PFX.LMRG.HAP.CALLBOTH.Dd2-2D4_FILT_EVAL/non_snp_roc.tsv.gz",header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names = c("score","true_positives","false_positives"))
gatkCALLFiltSNPs$type="SNP"
gatkCALLFiltINDELs$type="INDEL"
gatkCALLFiltType <- rbind(gatkCALLFiltSNPs,gatkCALLFiltINDELs)
gatkCALLFiltType$caller="GATK"
gatkCALLFiltType$region="CALLABLE"
posns <- intersect(gatkCALLFiltSNPs$score,gatkCALLFiltINDELs$score)
gatkCALLFiltType <- subset(gatkCALLFiltType,score %in% posns)
head(gatkFilt); head(gatkCALLFilt)
head(gatkFiltType); head(gatkCALLFiltType)
discoFilt <- read.table("GATK_3D7_0901_weighted_roc.tsv.gz",header=F,skip = 3,stringsAsFactors =F,sep="\t")
colnames(discoFilt) <-c("score","true_positives","false_positives","false_negatives","precision","sensitivity","f_measure")
discoFilt$sample="0901"
discoFilt$caller="GATK"
discoFilt$filter=T
rocCf <- rbind(gatkCALLFiltType,gatkFiltType)
ggplot(roctab,aes(x=false_positives,y=true_positives,colour=sample,linetype=filter)) +
geom_line() + facet_grid(filter ~ caller) + theme(legend.position="bottom") + ylim(0,20e3)
ggplot(rocCf,aes(x=false_positives,y=true_positives,colour=typ,linetype=region)) +
geom_line() + facet_grid(. ~ caller) + theme(legend.position="bottom")
ggplot(rocCf,aes(x=false_positives,y=true_positives,colour=type,linetype=region)) +
geom_line() + facet_grid(. ~ caller) + theme(legend.position="bottom")
