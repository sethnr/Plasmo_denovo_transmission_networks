ratesM
ratesM <- rbind(ratesM,floors)
ratesM$variable <- factor(ratesM$variable,levels=c("weeks","months","years"),ordered=T)
fcol <- c("#AAAAAA","#CCCCCC","#EEEEEE")
names(fcol) = c("years","months","weeks")
dotsubs <- c("H. pylori", "M. tuberculosis", "S. aureus (MRSA)", "S. pneumoniae",
"V. cholerae", "HCV (Hep C)", "EBOV (Ebola)", "HIV-M", # "HFLUV (H1N1 2009)",
"HFLUV (H1N1)", "RABV", "FMDV",    "P.falciparum (snp)", # "P.falciparum (ind)",
"P.falciparum (all)", "P.falciparum (core)")
ggplot(subset(sppsubs, Label %in% dotsubs),aes(x=gsize,y=subrate),) +
geom_polygon(data=ratesM,aes(group=variable,fill=variable)) +
scale_fill_manual(values = fcol) +
geom_label(aes(label=Label,colour=Group),nudge_x = 0.2) +
geom_point(aes(label=Pathogen,colour=Group,shape=vartype),size=5) +
scale_y_log10() + scale_x_log10(limits=c(1e3,1e8),breaks=c(1e4,1e5,1e6,1e7,1e8)) +
xlab("Genome Size (bp)")+ylab("mutation rate (muts / site / year)")+
theme(panel.background = element_rect(fill = F))
gsizes <- c(0e-6,1,1e1,1e2,1e3,1e4,1e5,1e6,1e7,1e8)
rates <- data.frame("gsize"=gsizes,"years"=1/gsizes,"months"=12/gsizes,"weeks"=52/gsizes)
ratesM <- melt(rates,id.vars = "gsize",value.name ="subrate")
ratesM <- ratesM[ratesM$gsize>0,]
floors <- data.frame("gsize"=c(rep(max(ratesM$gsize),3),rep(min(ratesM$gsize),3)),
"variable"=unique(as.character(ratesM$variable)),
"subrate"=rep(0,6))
ratesM <- rbind(ratesM,floors)
ratesM$variable <- factor(ratesM$variable,levels=c("weeks","months","years"),ordered=T)
fcol <- c("#AAAAAA","#CCCCCC","#EEEEEE")
names(fcol) = c("years","months","weeks")
dotsubs <- c("H. pylori", "M. tuberculosis", "S. aureus (MRSA)", "S. pneumoniae",
"V. cholerae", "HCV (Hep C)", "EBOV (Ebola)", "HIV-M", # "HFLUV (H1N1 2009)",
"HFLUV (H1N1)", "RABV", "FMDV",    "P.falciparum (snp)", # "P.falciparum (ind)",
"P.falciparum (all)", "P.falciparum (core)")
ggplot(subset(sppsubs, Label %in% dotsubs),aes(x=gsize,y=subrate),) +
geom_polygon(data=ratesM,aes(group=variable,fill=variable)) +
scale_fill_manual(values = fcol) +
geom_label(aes(label=Label,colour=Group),nudge_x = 0.2) +
geom_point(aes(label=Pathogen,colour=Group,shape=vartype),size=5) +
scale_y_log10() + scale_x_log10(limits=c(1e3,1e8),breaks=c(1e4,1e5,1e6,1e7,1e8)) +
xlab("Genome Size (bp)")+ylab("mutation rate (muts / site / year)")+
theme(panel.background = element_rect(fill = F))
gsizes <- c(0e-6,1,1e1,1e2,1e3,1e4,1e5,1e6,1e7,1e8)
rates <- data.frame("gsize"=gsizes,"years"=1/gsizes,"months"=12/gsizes,"weeks"=52/gsizes)
ratesM <- melt(rates,id.vars = "gsize",value.name ="subrate")
floors <- data.frame("gsize"=c(rep(max(ratesM$gsize),3),rep(min(ratesM$gsize),3)),
"variable"=unique(as.character(ratesM$variable)),
"subrate"=rep(0,6))
ratesM <- rbind(ratesM,floors)
ratesM$variable <- factor(ratesM$variable,levels=c("weeks","months","years"),ordered=T)
fcol <- c("#AAAAAA","#CCCCCC","#EEEEEE")
names(fcol) = c("years","months","weeks")
dotsubs <- c("H. pylori", "M. tuberculosis", "S. aureus (MRSA)", "S. pneumoniae",
"V. cholerae", "HCV (Hep C)", "EBOV (Ebola)", "HIV-M", # "HFLUV (H1N1 2009)",
"HFLUV (H1N1)", "RABV", "FMDV",    "P.falciparum (snp)", # "P.falciparum (ind)",
"P.falciparum (all)", "P.falciparum (core)")
ggplot(subset(sppsubs, Label %in% dotsubs),aes(x=gsize,y=subrate),) +
geom_polygon(data=ratesM,aes(group=variable,fill=variable)) +
scale_fill_manual(values = fcol) +
geom_label(aes(label=Label,colour=Group),nudge_x = 0.2) +
geom_point(aes(label=Pathogen,colour=Group,shape=vartype),size=5) +
scale_y_log10() + scale_x_log10(limits=c(1e3,1e8),breaks=c(1e4,1e5,1e6,1e7,1e8)) +
xlab("Genome Size (bp)")+ylab("mutation rate (muts / site / year)")+
theme(panel.background = element_rect(fill = F))
yearRate <- 1/(sppsubs$subrate*sppsubs$gsize)
monthRate <- 1/(sppsubs$subrate*sppsubs$gsize/12)
gsizes
rates
ratesM
gsizes <- c(1e-6,1,1e1,1e2,1e3,1e4,1e5,1e6,1e7,1e8)
rates <- data.frame("gsize"=gsizes,"years"=1/gsizes,"months"=12/gsizes,"weeks"=52/gsizes)
ratesM <- melt(rates,id.vars = "gsize",value.name ="subrate")
floors <- data.frame("gsize"=c(rep(max(ratesM$gsize),3),rep(min(ratesM$gsize),3)),
"variable"=unique(as.character(ratesM$variable)),
"subrate"=rep(0,6))
ratesM <- rbind(ratesM,floors)
ratesM$variable <- factor(ratesM$variable,levels=c("weeks","months","years"),ordered=T)
fcol <- c("#AAAAAA","#CCCCCC","#EEEEEE")
names(fcol) = c("years","months","weeks")
dotsubs <- c("H. pylori", "M. tuberculosis", "S. aureus (MRSA)", "S. pneumoniae",
"V. cholerae", "HCV (Hep C)", "EBOV (Ebola)", "HIV-M", # "HFLUV (H1N1 2009)",
"HFLUV (H1N1)", "RABV", "FMDV",    "P.falciparum (snp)", # "P.falciparum (ind)",
"P.falciparum (all)", "P.falciparum (core)")
ggplot(subset(sppsubs, Label %in% dotsubs),aes(x=gsize,y=subrate),) +
geom_polygon(data=ratesM,aes(group=variable,fill=variable)) +
scale_fill_manual(values = fcol) +
geom_label(aes(label=Label,colour=Group),nudge_x = 0.2) +
geom_point(aes(label=Pathogen,colour=Group,shape=vartype),size=5) +
scale_y_log10() + scale_x_log10(limits=c(1e3,1e8),breaks=c(1e4,1e5,1e6,1e7,1e8)) +
xlab("Genome Size (bp)")+ylab("mutation rate (muts / site / year)")+
theme(panel.background = element_rect(fill = F))
gsizes <- c(1e-6,1,1e1,1e2,1e3,1e4,1e5,1e6,1e7,1e8)
rates <- data.frame("gsize"=gsizes,"years"=1/gsizes,"months"=12/gsizes,"weeks"=52/gsizes)
ratesM <- melt(rates,id.vars = "gsize",value.name ="subrate")
ratesM <- ratesM[ratesM$gsize>0,]
floors <- data.frame("gsize"=c(rep(max(ratesM$gsize),3),rep(min(ratesM$gsize),3)),
"variable"=unique(as.character(ratesM$variable)),
"subrate"=rep(0,6))
ratesM <- rbind(ratesM,floors)
ratesM$variable <- factor(ratesM$variable,levels=c("weeks","months","years"),ordered=T)
fcol <- c("#AAAAAA","#CCCCCC","#EEEEEE")
names(fcol) = c("years","months","weeks")
dotsubs <- c("H. pylori", "M. tuberculosis", "S. aureus (MRSA)", "S. pneumoniae",
"V. cholerae", "HCV (Hep C)", "EBOV (Ebola)", "HIV-M", # "HFLUV (H1N1 2009)",
"HFLUV (H1N1)", "RABV", "FMDV",    "P.falciparum (snp)", # "P.falciparum (ind)",
"P.falciparum (all)", "P.falciparum (core)")
ggplot(subset(sppsubs, Label %in% dotsubs),aes(x=gsize,y=subrate),) +
geom_polygon(data=ratesM,aes(group=variable,fill=variable)) +
scale_fill_manual(values = fcol) +
geom_label(aes(label=Label,colour=Group),nudge_x = 0.2) +
geom_point(aes(label=Pathogen,colour=Group,shape=vartype),size=5) +
scale_y_log10() + scale_x_log10(limits=c(1e3,1e8),breaks=c(1e4,1e5,1e6,1e7,1e8)) +
xlab("Genome Size (bp)")+ylab("mutation rate (muts / site / year)")+
theme(panel.background = element_rect(fill = F))
gsizes <- c(1e-1,1,1e1,1e2,1e3,1e4,1e5,1e6,1e7,1e8)
rates <- data.frame("gsize"=gsizes,"years"=1/gsizes,"months"=12/gsizes,"weeks"=52/gsizes)
ratesM <- melt(rates,id.vars = "gsize",value.name ="subrate")
ratesM <- ratesM[ratesM$gsize>0,]
floors <- data.frame("gsize"=c(rep(max(ratesM$gsize),3),rep(min(ratesM$gsize),3)),
"variable"=unique(as.character(ratesM$variable)),
"subrate"=rep(0,6))
ratesM <- rbind(ratesM,floors)
ratesM$variable <- factor(ratesM$variable,levels=c("weeks","months","years"),ordered=T)
fcol <- c("#AAAAAA","#CCCCCC","#EEEEEE")
names(fcol) = c("years","months","weeks")
dotsubs <- c("H. pylori", "M. tuberculosis", "S. aureus (MRSA)", "S. pneumoniae",
"V. cholerae", "HCV (Hep C)", "EBOV (Ebola)", "HIV-M", # "HFLUV (H1N1 2009)",
"HFLUV (H1N1)", "RABV", "FMDV",    "P.falciparum (snp)", # "P.falciparum (ind)",
"P.falciparum (all)", "P.falciparum (core)")
ggplot(subset(sppsubs, Label %in% dotsubs),aes(x=gsize,y=subrate),) +
geom_polygon(data=ratesM,aes(group=variable,fill=variable)) +
scale_fill_manual(values = fcol) +
geom_label(aes(label=Label,colour=Group),nudge_x = 0.2) +
geom_point(aes(label=Pathogen,colour=Group,shape=vartype),size=5) +
scale_y_log10() + scale_x_log10(limits=c(1e3,1e8),breaks=c(1e4,1e5,1e6,1e7,1e8)) +
xlab("Genome Size (bp)")+ylab("mutation rate (muts / site / year)")+
theme(panel.background = element_rect(fill = F))
gsizes <- c(1,1e1,1e2,1e3,1e4,1e5,1e6,1e7,1e8)
rates <- data.frame("gsize"=gsizes,"years"=1/gsizes,"months"=12/gsizes,"weeks"=52/gsizes)
ratesM <- melt(rates,id.vars = "gsize",value.name ="subrate")
ratesM <- ratesM[ratesM$gsize>0,]
floors <- data.frame("gsize"=c(rep(max(ratesM$gsize),3),rep(min(ratesM$gsize),3)),
"variable"=unique(as.character(ratesM$variable)),
"subrate"=rep(0,6))
ratesM <- rbind(ratesM,floors)
ratesM$variable <- factor(ratesM$variable,levels=c("weeks","months","years"),ordered=T)
fcol <- c("#AAAAAA","#CCCCCC","#EEEEEE")
names(fcol) = c("years","months","weeks")
dotsubs <- c("H. pylori", "M. tuberculosis", "S. aureus (MRSA)", "S. pneumoniae",
"V. cholerae", "HCV (Hep C)", "EBOV (Ebola)", "HIV-M", # "HFLUV (H1N1 2009)",
"HFLUV (H1N1)", "RABV", "FMDV",    "P.falciparum (snp)", # "P.falciparum (ind)",
"P.falciparum (all)", "P.falciparum (core)")
ggplot(subset(sppsubs, Label %in% dotsubs),aes(x=gsize,y=subrate),) +
geom_polygon(data=ratesM,aes(group=variable,fill=variable)) +
scale_fill_manual(values = fcol) +
geom_label(aes(label=Label,colour=Group),nudge_x = 0.2) +
geom_point(aes(label=Pathogen,colour=Group,shape=vartype),size=5) +
scale_y_log10() + scale_x_log10(limits=c(1e3,1e8),breaks=c(1e4,1e5,1e6,1e7,1e8)) +
xlab("Genome Size (bp)")+ylab("mutation rate (muts / site / year)")+
theme(panel.background = element_rect(fill = F))
gsizes <- c(1,12,52,1e1,1e2,1e3,1e4,1e5,1e6,1e7,1e8)
rates <- data.frame("gsize"=gsizes,"years"=1/gsizes,"months"=12/gsizes,"weeks"=52/gsizes)
ratesM <- melt(rates,id.vars = "gsize",value.name ="subrate")
ratesM <- ratesM[ratesM$gsize>0,]
floors <- data.frame("gsize"=c(rep(max(ratesM$gsize),3),rep(min(ratesM$gsize),3)),
"variable"=unique(as.character(ratesM$variable)),
"subrate"=rep(0,6))
ratesM <- rbind(ratesM,floors)
ratesM$variable <- factor(ratesM$variable,levels=c("weeks","months","years"),ordered=T)
fcol <- c("#AAAAAA","#CCCCCC","#EEEEEE")
names(fcol) = c("years","months","weeks")
dotsubs <- c("H. pylori", "M. tuberculosis", "S. aureus (MRSA)", "S. pneumoniae",
"V. cholerae", "HCV (Hep C)", "EBOV (Ebola)", "HIV-M", # "HFLUV (H1N1 2009)",
"HFLUV (H1N1)", "RABV", "FMDV",    "P.falciparum (snp)", # "P.falciparum (ind)",
"P.falciparum (all)", "P.falciparum (core)")
ggplot(subset(sppsubs, Label %in% dotsubs),aes(x=gsize,y=subrate),) +
geom_polygon(data=ratesM,aes(group=variable,fill=variable)) +
scale_fill_manual(values = fcol) +
geom_label(aes(label=Label,colour=Group),nudge_x = 0.2) +
geom_point(aes(label=Pathogen,colour=Group,shape=vartype),size=5) +
scale_y_log10() + scale_x_log10(limits=c(1e3,1e8),breaks=c(1e4,1e5,1e6,1e7,1e8)) +
xlab("Genome Size (bp)")+ylab("mutation rate (muts / site / year)")+
theme(panel.background = element_rect(fill = F))
ggplot(subset(sppsubs, Label %in% dotsubs),aes(x=gsize,y=subrate),) +
geom_polygon(data=ratesM,aes(group=variable,fill=variable)) +
scale_fill_manual(values = fcol) +
geom_label(aes(label=Label,colour=Group),nudge_x = 0.2) +
geom_point(aes(label=Pathogen,colour=Group,shape=vartype),size=5) +
scale_y_log10() + scale_x_log10(limits=c(1,1e8),breaks=c(1e4,1e5,1e6,1e7,1e8)) +
xlab("Genome Size (bp)")+ylab("mutation rate (muts / site / year)")+
theme(panel.background = element_rect(fill = F))
knit("gsize_v_rate.Rmd")
knit("gsize_v_rate.Rmd")
knit("gsize_v_rate.Rmd")
knit("gsize_v_rate.Rmd")
knit("gsize_v_rate.Rmd")
gsizes <- c(1e3,12e3,52e3,1e1,1e2,1e3,1e4,1e5,1e6,1e7,1e8)
rates <- data.frame("gsize"=gsizes,"years"=1/gsizes,"months"=12/gsizes,"weeks"=52/gsizes)
ratesM <- melt(rates,id.vars = "gsize",value.name ="subrate")
ratesM <- ratesM[ratesM$gsize>0,]
floors <- data.frame("gsize"=c(rep(max(ratesM$gsize),3),rep(min(ratesM$gsize),3)),
"variable"=unique(as.character(ratesM$variable)),
"subrate"=rep(0,6))
ratesM <- rbind(ratesM,floors)
ratesM$variable <- factor(ratesM$variable,levels=c("weeks","months","years"),ordered=T)
fcol <- c("#AAAAAA","#CCCCCC","#EEEEEE")
names(fcol) = c("years","months","weeks")
dotsubs <- c("H. pylori", "M. tuberculosis", "S. aureus (MRSA)", "S. pneumoniae",
"V. cholerae", "HCV (Hep C)", "EBOV (Ebola)", "HIV-M", # "HFLUV (H1N1 2009)",
"HFLUV (H1N1)", "RABV", "FMDV",    "P.falciparum (snp)", # "P.falciparum (ind)",
"P.falciparum (all)", "P.falciparum (core)")
ggplot(subset(sppsubs, Label %in% dotsubs),aes(x=gsize,y=subrate),) +
geom_polygon(data=ratesM,aes(group=variable,fill=variable)) +
scale_fill_manual(values = fcol) +
geom_label(aes(label=Label,colour=Group),nudge_x = 0.2) +
geom_point(aes(label=Pathogen,colour=Group,shape=vartype),size=5) +
scale_y_log10() + scale_x_log10(limits=c(1e3,1e8),breaks=c(1e4,1e5,1e6,1e7,1e8)) +
xlab("Genome Size (bp)")+ylab("mutation rate (muts / site / year)")+
theme(panel.background = element_rect(fill = F))
ggplot(subset(sppsubs, Label %in% dotsubs),aes(x=gsize,y=subrate),) +
geom_polygon(data=ratesM,aes(group=variable,fill=variable)) +
scale_fill_manual(values = fcol) +
geom_label(aes(label=Label,colour=Group),nudge_x = 0.2) +
geom_point(aes(label=Pathogen,colour=Group,shape=vartype),size=5) +
scale_y_log10() + scale_x_log10(limits=c(1e3-1,1e8),breaks=c(1e4,1e5,1e6,1e7,1e8)) +
xlab("Genome Size (bp)")+ylab("mutation rate (muts / site / year)")+
theme(panel.background = element_rect(fill = F))
ggplot(subset(sppsubs, Label %in% dotsubs),aes(x=gsize,y=subrate),) +
geom_polygon(data=ratesM,aes(group=variable,fill=variable)) +
scale_fill_manual(values = fcol) +
geom_label(aes(label=Label,colour=Group),nudge_x = 0.2) +
geom_point(aes(label=Pathogen,colour=Group,shape=vartype),size=5) +
scale_y_log10() + scale_x_log10(limits=c(1e2,1e8),breaks=c(1e4,1e5,1e6,1e7,1e8)) +
xlab("Genome Size (bp)")+ylab("mutation rate (muts / site / year)")+
theme(panel.background = element_rect(fill = F))
ggplot(subset(sppsubs, Label %in% dotsubs),aes(x=gsize,y=subrate),) +
geom_polygon(data=ratesM,aes(group=variable,fill=variable)) +
scale_fill_manual(values = fcol) +
geom_label(aes(label=Label,colour=Group),nudge_x = 0.2) +
geom_point(aes(label=Pathogen,colour=Group,shape=vartype),size=5) +
scale_y_log10() + scale_x_log10(limits=c(1e2,1e8),breaks=c(1e3,1e4,1e5,1e6,1e7,1e8)) +
xlab("Genome Size (bp)")+ylab("mutation rate (muts / site / year)")+
theme(panel.background = element_rect(fill = F))
12e3
gsizes <- c(1e2,12e3,52e3,1e1,1e2,1e3,1e4,1e5,1e6,1e7,1e8)
rates <- data.frame("gsize"=gsizes,"years"=1/gsizes,"months"=12/gsizes,"weeks"=52/gsizes)
ratesM <- melt(rates,id.vars = "gsize",value.name ="subrate")
ratesM <- ratesM[ratesM$gsize>0,]
floors <- data.frame("gsize"=c(rep(max(ratesM$gsize),3),rep(min(ratesM$gsize),3)),
"variable"=unique(as.character(ratesM$variable)),
"subrate"=rep(0,6))
ratesM <- rbind(ratesM,floors)
ratesM$variable <- factor(ratesM$variable,levels=c("weeks","months","years"),ordered=T)
fcol <- c("#AAAAAA","#CCCCCC","#EEEEEE")
names(fcol) = c("years","months","weeks")
dotsubs <- c("H. pylori", "M. tuberculosis", "S. aureus (MRSA)", "S. pneumoniae",
"V. cholerae", "HCV (Hep C)", "EBOV (Ebola)", "HIV-M", # "HFLUV (H1N1 2009)",
"HFLUV (H1N1)", "RABV", "FMDV",    "P.falciparum (snp)", # "P.falciparum (ind)",
"P.falciparum (all)", "P.falciparum (core)")
ggplot(subset(sppsubs, Label %in% dotsubs),aes(x=gsize,y=subrate),) +
geom_polygon(data=ratesM,aes(group=variable,fill=variable)) +
scale_fill_manual(values = fcol) +
geom_label(aes(label=Label,colour=Group),nudge_x = 0.2) +
geom_point(aes(label=Pathogen,colour=Group,shape=vartype),size=5) +
scale_y_log10() + scale_x_log10(limits=c(1e2,1e8),breaks=c(1e3,1e4,1e5,1e6,1e7,1e8)) +
xlab("Genome Size (bp)")+ylab("mutation rate (muts / site / year)")+
theme(panel.background = element_rect(fill = F))
yearRate <- 1/(sppsubs$subrate*sppsubs$gsize)
ratesM
ratesM <- ratesM[ratesM$subrate<=0.005,]
ratesM <- ratesM[ratesM$gsize>0,]
floors <- data.frame("gsize"=c(rep(max(ratesM$gsize),3),rep(min(ratesM$gsize),3)),
"variable"=unique(as.character(ratesM$variable)),
"subrate"=rep(0,6))
ratesM <- rbind(ratesM,floors)
ratesM$variable <- factor(ratesM$variable,levels=c("weeks","months","years"),ordered=T)
fcol <- c("#AAAAAA","#CCCCCC","#EEEEEE")
names(fcol) = c("years","months","weeks")
dotsubs <- c("H. pylori", "M. tuberculosis", "S. aureus (MRSA)", "S. pneumoniae",
"V. cholerae", "HCV (Hep C)", "EBOV (Ebola)", "HIV-M", # "HFLUV (H1N1 2009)",
"HFLUV (H1N1)", "RABV", "FMDV",    "P.falciparum (snp)", # "P.falciparum (ind)",
"P.falciparum (all)", "P.falciparum (core)")
ggplot(subset(sppsubs, Label %in% dotsubs),aes(x=gsize,y=subrate),) +
geom_polygon(data=ratesM,aes(group=variable,fill=variable)) +
scale_fill_manual(values = fcol) +
geom_label(aes(label=Label,colour=Group),nudge_x = 0.2) +
geom_point(aes(label=Pathogen,colour=Group,shape=vartype),size=5) +
scale_y_log10() + scale_x_log10(limits=c(1e3,1e8),breaks=c(1e3,1e4,1e5,1e6,1e7,1e8)) +
xlab("Genome Size (bp)")+ylab("mutation rate (muts / site / year)")+
theme(panel.background = element_rect(fill = F))
gsizes <- c(1,12,52,1e2,1e1,1e2,1e3,1e4,1e5,1e6,1e7,1e8)
rates <- data.frame("gsize"=gsizes,"years"=1/gsizes,"months"=12/gsizes,"weeks"=52/gsizes)
ratesM <- melt(rates,id.vars = "gsize",value.name ="subrate")
ratesM <- ratesM[ratesM$subrate<=0.005,]
ratesM <- ratesM[ratesM$gsize>0,]
floors <- data.frame("gsize"=c(rep(max(ratesM$gsize),3),rep(min(ratesM$gsize),3)),
"variable"=unique(as.character(ratesM$variable)),
"subrate"=rep(0,6))
ratesM <- rbind(ratesM,floors)
ratesM$variable <- factor(ratesM$variable,levels=c("weeks","months","years"),ordered=T)
fcol <- c("#AAAAAA","#CCCCCC","#EEEEEE")
names(fcol) = c("years","months","weeks")
dotsubs <- c("H. pylori", "M. tuberculosis", "S. aureus (MRSA)", "S. pneumoniae",
"V. cholerae", "HCV (Hep C)", "EBOV (Ebola)", "HIV-M", # "HFLUV (H1N1 2009)",
"HFLUV (H1N1)", "RABV", "FMDV",    "P.falciparum (snp)", # "P.falciparum (ind)",
"P.falciparum (all)", "P.falciparum (core)")
ggplot(subset(sppsubs, Label %in% dotsubs),aes(x=gsize,y=subrate),) +
geom_polygon(data=ratesM,aes(group=variable,fill=variable)) +
scale_fill_manual(values = fcol) +
geom_label(aes(label=Label,colour=Group),nudge_x = 0.2) +
geom_point(aes(label=Pathogen,colour=Group,shape=vartype),size=5) +
scale_y_log10() + scale_x_log10(limits=c(1e3,1e8),breaks=c(1e3,1e4,1e5,1e6,1e7,1e8)) +
xlab("Genome Size (bp)")+ylab("mutation rate (muts / site / year)")+
theme(panel.background = element_rect(fill = F))
gsizes <- c(1,12,52,1e2,1e1,1e2,1e3,1e4,1e5,1e6,1e7,1e8)
rates <- data.frame("gsize"=gsizes,"years"=1/gsizes,"months"=12/gsizes,"weeks"=52/gsizes)
ratesM <- melt(rates,id.vars = "gsize",value.name ="subrate")
ratesM <- ratesM[ratesM$gsize>0,]
floors <- data.frame("gsize"=c(rep(max(ratesM$gsize),3),rep(min(ratesM$gsize),3)),
"variable"=unique(as.character(ratesM$variable)),
"subrate"=rep(0,6))
ratesM <- rbind(ratesM,floors)
ratesM$variable <- factor(ratesM$variable,levels=c("weeks","months","years"),ordered=T)
fcol <- c("#AAAAAA","#CCCCCC","#EEEEEE")
names(fcol) = c("years","months","weeks")
dotsubs <- c("H. pylori", "M. tuberculosis", "S. aureus (MRSA)", "S. pneumoniae",
"V. cholerae", "HCV (Hep C)", "EBOV (Ebola)", "HIV-M", # "HFLUV (H1N1 2009)",
"HFLUV (H1N1)", "RABV", "FMDV",    "P.falciparum (snp)", # "P.falciparum (ind)",
"P.falciparum (all)", "P.falciparum (core)")
ggplot(subset(sppsubs, Label %in% dotsubs),aes(x=gsize,y=subrate),) +
geom_polygon(data=ratesM,aes(group=variable,fill=variable)) +
scale_fill_manual(values = fcol) +
geom_label(aes(label=Label,colour=Group),nudge_x = 0.2) +
geom_point(aes(label=Pathogen,colour=Group,shape=vartype),size=5) +
scale_y_log10() + scale_x_log10(limits=c(1e3,1e8),breaks=c(1e3,1e4,1e5,1e6,1e7,1e8)) +
xlab("Genome Size (bp)")+ylab("mutation rate (muts / site / year)")+
theme(panel.background = element_rect(fill = F))
ggplot(subset(sppsubs, Label %in% dotsubs),aes(x=gsize,y=subrate),) +
geom_polygon(data=ratesM,aes(group=variable,fill=variable)) +
scale_fill_manual(values = fcol) +
geom_label(aes(label=Label,colour=Group),nudge_x = 0.2) +
geom_point(aes(label=Pathogen,colour=Group,shape=vartype),size=5) +
scale_y_log10() + scale_x_log10(limits=c(0,1e8),breaks=c(1e3,1e4,1e5,1e6,1e7,1e8)) +
xlab("Genome Size (bp)")+ylab("mutation rate (muts / site / year)")+
theme(panel.background = element_rect(fill = F))
ggplot(subset(sppsubs, Label %in% dotsubs),aes(x=gsize,y=subrate),) +
geom_polygon(data=ratesM,aes(group=variable,fill=variable)) +
scale_fill_manual(values = fcol) +
geom_label(aes(label=Label,colour=Group),nudge_x = 0.2) +
geom_point(aes(label=Pathogen,colour=Group,shape=vartype),size=5) +
scale_y_log10() + scale_x_log10(limits=c(1,1e8),breaks=c(1e3,1e4,1e5,1e6,1e7,1e8)) +
xlab("Genome Size (bp)")+ylab("mutation rate (muts / site / year)")+
theme(panel.background = element_rect(fill = F))
ratesM
ggplot(subset(sppsubs, Label %in% dotsubs),aes(x=gsize,y=subrate),) +
geom_polygon(data=ratesM,aes(group=variable,fill=variable)) +
scale_fill_manual(values = fcol) +
geom_label(aes(label=Label,colour=Group),nudge_x = 0.2) +
geom_point(aes(label=Pathogen,colour=Group,shape=vartype),size=5) +
scale_y_log10(c(1,1e-1)) + scale_x_log10(limits=c(1e3,1e8),breaks=c(1e3,1e4,1e5,1e6,1e7,1e8)) +
xlab("Genome Size (bp)")+ylab("mutation rate (muts / site / year)")+
theme(panel.background = element_rect(fill = F))
ggplot(subset(sppsubs, Label %in% dotsubs),aes(x=gsize,y=subrate),) +
geom_polygon(data=ratesM,aes(group=variable,fill=variable)) +
scale_fill_manual(values = fcol) +
geom_label(aes(label=Label,colour=Group),nudge_x = 0.2) +
geom_point(aes(label=Pathogen,colour=Group,shape=vartype),size=5) +
scale_y_log10(c(1e-8,1e-1)) + scale_x_log10(limits=c(1e3,1e8),breaks=c(1e3,1e4,1e5,1e6,1e7,1e8)) +
xlab("Genome Size (bp)")+ylab("mutation rate (muts / site / year)")+
theme(panel.background = element_rect(fill = F))
ggplot(subset(sppsubs, Label %in% dotsubs),aes(x=gsize,y=subrate),) +
geom_polygon(data=ratesM,aes(group=variable,fill=variable)) +
scale_fill_manual(values = fcol) +
geom_label(aes(label=Label,colour=Group),nudge_x = 0.2) +
geom_point(aes(label=Pathogen,colour=Group,shape=vartype),size=5) +
scale_y_log10() + scale_x_log10(limits=c(1e3,1e8),breaks=c(1e3,1e4,1e5,1e6,1e7,1e8)) +
xlab("Genome Size (bp)")+ylab("mutation rate (muts / site / year)")+
theme(panel.background = element_rect(fill = F))
ggplot(subset(sppsubs, Label %in% dotsubs),aes(x=gsize,y=subrate),) +
geom_polygon(data=ratesM,aes(group=variable,fill=variable)) +
scale_fill_manual(values = fcol) +
geom_label(aes(label=Label,colour=Group),nudge_x = 0.2) +
geom_point(aes(label=Pathogen,colour=Group,shape=vartype),size=5) +
scale_y_log10() + scale_x_log10(limits=c(1e2,1e8),breaks=c(1e3,1e4,1e5,1e6,1e7,1e8)) +
xlab("Genome Size (bp)")+ylab("mutation rate (muts / site / year)")+
theme(panel.background = element_rect(fill = F))
ggplot(subset(sppsubs, Label %in% dotsubs),aes(x=gsize,y=subrate),) +
geom_polygon(data=ratesM,aes(group=variable,fill=variable)) +
scale_fill_manual(values = fcol) +
geom_label(aes(label=Label,colour=Group),nudge_x = 0.2) +
geom_point(aes(label=Pathogen,colour=Group,shape=vartype),size=5) +
scale_y_log10() + scale_x_log10(limits=c(1,1e8),breaks=c(1e3,1e4,1e5,1e6,1e7,1e8)) +
xlab("Genome Size (bp)")+ylab("mutation rate (muts / site / year)")+
theme(panel.background = element_rect(fill = F))
gsizes <- c(12e3,52e3,1e3,1e4,1e5,1e6,1e7,1e8)
rates <- data.frame("gsize"=gsizes,"years"=1/gsizes,"months"=12/gsizes,"weeks"=52/gsizes)
ratesM <- melt(rates,id.vars = "gsize",value.name ="subrate")
ratesM <- ratesM[ratesM$gsize>0,]
floors <- data.frame("gsize"=c(rep(max(ratesM$gsize),3),rep(min(ratesM$gsize),3)),
"variable"=unique(as.character(ratesM$variable)),
"subrate"=rep(0,6))
ratesM <- rbind(ratesM,floors)
ratesM$variable <- factor(ratesM$variable,levels=c("weeks","months","years"),ordered=T)
fcol <- c("#AAAAAA","#CCCCCC","#EEEEEE")
names(fcol) = c("years","months","weeks")
dotsubs <- c("H. pylori", "M. tuberculosis", "S. aureus (MRSA)", "S. pneumoniae",
"V. cholerae", "HCV (Hep C)", "EBOV (Ebola)", "HIV-M", # "HFLUV (H1N1 2009)",
"HFLUV (H1N1)", "RABV", "FMDV",    "P.falciparum (snp)", # "P.falciparum (ind)",
"P.falciparum (all)", "P.falciparum (core)")
ggplot(subset(sppsubs, Label %in% dotsubs),aes(x=gsize,y=subrate),) +
geom_polygon(data=ratesM,aes(group=variable,fill=variable)) +
scale_fill_manual(values = fcol) +
geom_label(aes(label=Label,colour=Group),nudge_x = 0.2) +
geom_point(aes(label=Pathogen,colour=Group,shape=vartype),size=5) +
scale_y_log10() + scale_x_log10(limits=c(1,1e8),breaks=c(1e3,1e4,1e5,1e6,1e7,1e8)) +
xlab("Genome Size (bp)")+ylab("mutation rate (muts / site / year)")+
theme(panel.background = element_rect(fill = F))
yearRate <- 1/(sppsubs$subrate*sppsubs$gsize)
ggplot(subset(sppsubs, Label %in% dotsubs),aes(x=gsize,y=subrate),) +
geom_polygon(data=ratesM,aes(group=variable,fill=variable)) +
scale_fill_manual(values = fcol) +
geom_label(aes(label=Label,colour=Group),nudge_x = 0.2) +
geom_point(aes(label=Pathogen,colour=Group,shape=vartype),size=5) +
scale_y_log10() + scale_x_log10(limits=c(1e3,1e8),breaks=c(1e3,1e4,1e5,1e6,1e7,1e8)) +
xlab("Genome Size (bp)")+ylab("mutation rate (muts / site / year)")+
theme(panel.background = element_rect(fill = F))
gsizes <- c(12e3,52e3,1e3,1e4,1e5,1e6,1e7,1e8)
rates <- data.frame("gsize"=gsizes,"years"=1/gsizes,"months"=12/gsizes,"weeks"=52/gsizes)
ratesM <- melt(rates,id.vars = "gsize",value.name ="subrate")
floors <- data.frame("gsize"=c(rep(max(ratesM$gsize),3),rep(min(ratesM$gsize),3)),
"variable"=unique(as.character(ratesM$variable)),
"subrate"=rep(0,6))
ratesM <- rbind(ratesM,floors)
ratesM$variable <- factor(ratesM$variable,levels=c("weeks","months","years"),ordered=T)
fcol <- c("#AAAAAA","#CCCCCC","#EEEEEE")
names(fcol) = c("years","months","weeks")
dotsubs <- c("H. pylori", "M. tuberculosis", "S. aureus (MRSA)", "S. pneumoniae",
"V. cholerae", "HCV (Hep C)", "EBOV (Ebola)", "HIV-M", # "HFLUV (H1N1 2009)",
"HFLUV (H1N1)", "RABV", "FMDV",    "P.falciparum (snp)", # "P.falciparum (ind)",
"P.falciparum (all)", "P.falciparum (core)")
ggplot(subset(sppsubs, Label %in% dotsubs),aes(x=gsize,y=subrate),) +
geom_polygon(data=ratesM,aes(group=variable,fill=variable)) +
scale_fill_manual(values = fcol) +
geom_label(aes(label=Label,colour=Group),nudge_x = 0.2) +
geom_point(aes(label=Pathogen,colour=Group,shape=vartype),size=5) +
scale_y_log10() + scale_x_log10(limits=c(1e3,1e8),breaks=c(1e3,1e4,1e5,1e6,1e7,1e8)) +
xlab("Genome Size (bp)")+ylab("mutation rate (muts / site / year)")+
theme(panel.background = element_rect(fill = F))
floors
gsizes <- c(1e3,1e4,1e5,1e6,1e7,1e8)
rates <- data.frame("gsize"=gsizes,"years"=1/gsizes,"months"=12/gsizes,"weeks"=52/gsizes)
ratesM <- melt(rates,id.vars = "gsize",value.name ="subrate")
floors <- data.frame("gsize"=c(rep(max(ratesM$gsize),3),rep(min(ratesM$gsize),3)),
"variable"=unique(as.character(ratesM$variable)),
"subrate"=rep(0,6))
ratesM <- rbind(ratesM,floors)
ratesM$variable <- factor(ratesM$variable,levels=c("weeks","months","years"),ordered=T)
fcol <- c("#AAAAAA","#CCCCCC","#EEEEEE")
names(fcol) = c("years","months","weeks")
dotsubs <- c("H. pylori", "M. tuberculosis", "S. aureus (MRSA)", "S. pneumoniae",
"V. cholerae", "HCV (Hep C)", "EBOV (Ebola)", "HIV-M", # "HFLUV (H1N1 2009)",
"HFLUV (H1N1)", "RABV", "FMDV",    "P.falciparum (snp)", # "P.falciparum (ind)",
"P.falciparum (all)", "P.falciparum (core)")
ggplot(subset(sppsubs, Label %in% dotsubs),aes(x=gsize,y=subrate),) +
geom_polygon(data=ratesM,aes(group=variable,fill=variable)) +
scale_fill_manual(values = fcol) +
geom_label(aes(label=Label,colour=Group),nudge_x = 0.2) +
geom_point(aes(label=Pathogen,colour=Group,shape=vartype),size=5) +
scale_y_log10() + scale_x_log10(limits=c(1e3,1e8),breaks=c(1e3,1e4,1e5,1e6,1e7,1e8)) +
xlab("Genome Size (bp)")+ylab("mutation rate (muts / site / year)")+
theme(panel.background = element_rect(fill = F))
knit("gsize_v_rate.Rmd")
ggplot(subset(sppsubs, Label %in% dotsubs),aes(x=gsize,y=subrate),) +
geom_polygon(data=ratesM,aes(group=variable,fill=variable)) +
scale_fill_manual(values = fcol) +
geom_label(aes(label=Label,colour=Group),nudge_x = 1) +
geom_point(aes(label=Pathogen,colour=Group,shape=vartype),size=5) +
scale_y_log10() + scale_x_log10(limits=c(1e3,1e8),breaks=c(1e3,1e4,1e5,1e6,1e7,1e8)) +
xlab("Genome Size (bp)")+ylab("mutation rate (muts / site / year)")+
theme(panel.background = element_rect(fill = F))
knit("gsize_v_rate.Rmd")
ggplot(subset(sppsubs, Label %in% dotsubs),aes(x=gsize,y=subrate),) +
geom_polygon(data=ratesM,aes(group=variable,fill=variable)) +
scale_fill_manual(values = fcol) +
geom_label(aes(label=Label,colour=Group)) +
geom_point(aes(label=Pathogen,colour=Group,shape=vartype),size=5) +
scale_y_log10() + scale_x_log10(limits=c(1e3,1e8),breaks=c(1e3,1e4,1e5,1e6,1e7,1e8)) +
xlab("Genome Size (bp)")+ylab("mutation rate (muts / site / year)")+
theme(panel.background = element_rect(fill = F))
ggplot(subset(sppsubs, Label %in% dotsubs),aes(x=gsize,y=subrate),) +
geom_polygon(data=ratesM,aes(group=variable,fill=variable)) +
scale_fill_manual(values = fcol) +
geom_label(aes(label=Label,colour=Group),nudge_x = 1,hjust=1) +
geom_point(aes(label=Pathogen,colour=Group,shape=vartype),size=5) +
scale_y_log10() + scale_x_log10(limits=c(1e3,1e8),breaks=c(1e3,1e4,1e5,1e6,1e7,1e8)) +
xlab("Genome Size (bp)")+ylab("mutation rate (muts / site / year)")+
theme(panel.background = element_rect(fill = F))
ggplot(subset(sppsubs, Label %in% dotsubs),aes(x=gsize,y=subrate),) +
geom_polygon(data=ratesM,aes(group=variable,fill=variable)) +
scale_fill_manual(values = fcol) +
geom_label(aes(label=Label,colour=Group),hjust=1) +
geom_point(aes(label=Pathogen,colour=Group,shape=vartype),size=5) +
scale_y_log10() + scale_x_log10(limits=c(1e3,1e8),breaks=c(1e3,1e4,1e5,1e6,1e7,1e8)) +
xlab("Genome Size (bp)")+ylab("mutation rate (muts / site / year)")+
theme(panel.background = element_rect(fill = F))
ggplot(subset(sppsubs, Label %in% dotsubs),aes(x=gsize,y=subrate),) +
geom_polygon(data=ratesM,aes(group=variable,fill=variable)) +
scale_fill_manual(values = fcol) +
geom_label(aes(label=Label,colour=Group),nudge_x = -0.2,hjust=1) +
geom_point(aes(label=Pathogen,colour=Group,shape=vartype),size=5) +
scale_y_log10() + scale_x_log10(limits=c(1e3,1e8),breaks=c(1e3,1e4,1e5,1e6,1e7,1e8)) +
xlab("Genome Size (bp)")+ylab("mutation rate (muts / site / year)")+
theme(panel.background = element_rect(fill = F))
knit("gsize_v_rate.Rmd")
