#cheat sheet
ggplot(sppsubs,aes(x=gsize,y=subrate,colour=Group)) + geom_label(aes(label=Pathogen)) + geom_line(data=ratesM,aes(group=variable),colour="grey") + scale_y_log10() + scale_x_log10()
sppsubs <- read.table("subrate_relaxed_otherspp2.txt",sep="\t",header=T)
colnames(sppsubs)[3:4] <- c("gsize","subrate")
sppsubs$Group <- factor(sppsubs$Group,levels=c("eukaryote","Bacteria","dsDNA virus","ssDNA virus","RNA virus"),ordered = T)
gsizes <- seq(0,25e6,1e3)
rates <- data.frame("gsize"=gsizes,"years"=1/gsizes,"months"=12/gsizes,"weeks"=52/gsizes)
ratesM <- melt(rates,id.vars = "gsize",value.name ="subrate")
ratesM <- ratesM[ratesM$subrate<=0.005,]
ggplot(sppsubs,aes(x=gsize,y=subrate,colour=Group)) + geom_point(size=4) + geom_line(data=ratesM,aes(group=variable),colour="grey") + scale_y_log10() + scale_x_log10()
sppsubs <- read.table("subrate_relaxed_otherspp2.txt",sep="\t",header=T)
colnames(sppsubs)[3:4] <- c("gsize","subrate")
sppsubs$Group <- factor(sppsubs$Group,levels=c("eukaryote","Bacteria","dsDNA virus","ssDNA virus","RNA virus"),ordered = T)
gsizes <- seq(0,25e6,1e3)
rates <- data.frame("gsize"=gsizes,"years"=1/gsizes,"months"=12/gsizes,"weeks"=52/gsizes)
ratesM <- melt(rates,id.vars = "gsize",value.name ="subrate")
ratesM <- ratesM[ratesM$subrate<=0.005,]
ggplot(sppsubs,aes(x=gsize,y=subrate,colour=Group)) + geom_point(size=4) + geom_line(data=ratesM,aes(group=variable),colour="grey") + scale_y_log10() + scale_x_log10()
ggplot(sppsubs,aes(x=gsize,y=subrate,colour=Group)) + geom_label(aes(label=Pathogen)) + geom_line(data=ratesM,aes(group=variable),colour="grey") + scale_y_log10() + scale_x_log10()
sppsubs <- read.table("subrate_relaxed_otherspp2.txt",sep="\t",header=T)
colnames(sppsubs)[3:4] <- c("gsize","subrate")
sppsubs$Group <- factor(sppsubs$Group,levels=c("eukaryote","Bacteria","dsDNA virus","ssDNA virus","RNA virus"),ordered = T)
gsizes <- seq(0,25e6,1e3)
rates <- data.frame("gsize"=gsizes,"years"=1/gsizes,"months"=12/gsizes,"weeks"=52/gsizes)
ratesM <- melt(rates,id.vars = "gsize",value.name ="subrate")
ratesM <- ratesM[ratesM$subrate<=0.005,]
ggplot(sppsubs,aes(x=gsize,y=subrate,colour=Group)) + geom_point(size=4) + geom_line(data=ratesM,aes(group=variable),colour="grey") + scale_y_log10() + scale_x_log10()
#cheat sheet
ggplot(sppsubs,aes(x=gsize,y=subrate,colour=Group)) + geom_label(aes(label=Pathogen)) + geom_line(data=ratesM,aes(group=variable),colour="grey") + scale_y_log10() + scale_x_log10()
ratesM
gsizes
head(ratesM)
min(gsize)
min(ratesM$gsize)
c(min(ratesM$gsize),years,0)
c(min(ratesM$gsize),"years",0)
c(min(ratesM$gsize),unique(ratesM$variable),0)
c(min(ratesM$gsize),unique(as.character(ratesM$variable)),0)
rep(c(min(ratesM$gsize),3),unique(as.character(ratesM$variable)),rep(0,3))
rbind(rep(c(min(ratesM$gsize),3),unique(as.character(ratesM$variable)),rep(0,3)))
rbind(rep(min(ratesM$gsize),3),unique(as.character(ratesM$variable)),rep(0,3)))
rbind(rep(min(ratesM$gsize),3),unique(as.character(ratesM$variable)),rep(0,3))
cbind(rep(min(ratesM$gsize),3),unique(as.character(ratesM$variable)),rep(0,3))
cbind(c(rep(min(ratesM$gsize),3),rep(max(ratesM$gsize),3)),
unique(as.character(ratesM$variable)),
rep(0,6))
floors <- cbind(c(rep(min(ratesM$gsize),3),rep(max(ratesM$gsize),3)),
unique(as.character(ratesM$variable)),
rep(0,6))
floors
cbind(floors,ratesM)
rbind(floors,ratesM)
head(ratesM)
floors <- data.frame("gsize"=c(rep(min(ratesM$gsize),3),rep(max(ratesM$gsize),3)),
"variable"=unique(as.character(ratesM$variable)),
"subrate"=rep(0,6))
floors
ratesM <- rbind(ratesM,floors)
ggplot(sppsubs,aes(x=gsize,y=subrate,colour=Group)) + geom_label(aes(label=Pathogen)) + geom_poly(data=ratesM,aes(group=variable),colour="grey") + scale_y_log10() + scale_x_log10()
ggplot(sppsubs,aes(x=gsize,y=subrate,colour=Group)) + geom_label(aes(label=Pathogen)) + geom_polygon(data=ratesM,aes(group=variable),colour="grey") + scale_y_log10() + scale_x_log10()
ratesM <- melt(rates,id.vars = "gsize",value.name ="subrate")
ratesM <- ratesM[ratesM$subrate<=0.005,]
floors <- data.frame("gsize"=c(rep(max(ratesM$gsize),3),rep(min(ratesM$gsize),3)),
"variable"=unique(as.character(ratesM$variable)),
"subrate"=rep(0,6))
ratesM <- rbind(ratesM,floors)
ggplot(sppsubs,aes(x=gsize,y=subrate,colour=Group)) + geom_label(aes(label=Pathogen)) + geom_polygon(data=ratesM,aes(group=variable),colour="grey") + scale_y_log10() + scale_x_log10()
rates <- data.frame("gsize"=gsizes,"years"=1/gsizes,"months"=12/gsizes,"weeks"=52/gsizes)
ratesM <- melt(rates,id.vars = "gsize",value.name ="subrate")
#ratesM <- ratesM[ratesM$subrate<=0.005,]
floors <- data.frame("gsize"=c(rep(max(ratesM$gsize),3),rep(min(ratesM$gsize),3)),
"variable"=unique(as.character(ratesM$variable)),
"subrate"=rep(0,6))
ratesM <- rbind(ratesM,floors)
ggplot(sppsubs,aes(x=gsize,y=subrate,colour=Group)) + geom_point(size=4) + geom_line(data=ratesM,aes(group=variable),colour="grey") + scale_y_log10() + scale_x_log10()
ggplot(sppsubs,aes(x=gsize,y=subrate,colour=Group)) + geom_label(aes(label=Pathogen)) + geom_polygon(data=ratesM,aes(group=variable),colour="grey") + scale_y_log10() + scale_x_log10()
ggplot(sppsubs,aes(x=gsize,y=subrate,colour=Group)) + geom_label(aes(label=Pathogen)) + geom_polygon(data=ratesM,aes(group=variable)) + scale_y_log10() + scale_x_log10()
ggplot(sppsubs,aes(x=gsize,y=subrate,colour=Group)) + geom_label(aes(label=Pathogen)) + geom_polygon(data=ratesM,aes(group=variable,colour=variable)) + scale_y_log10() + scale_x_log10()
ggplot(sppsubs,aes(x=gsize,y=subrate,colour=Group)) + geom_label(aes(label=Pathogen)) + geom_polygon(data=ratesM,aes(group=variable,fill=variable)) + scale_y_log10() + scale_x_log10()
ggplot(sppsubs,aes(x=gsize,y=subrate,colour=Group)) + geom_label(aes(label=Pathogen)) + geom_polygon(data=ratesM,aes(group=variable,fill=variable,colour=variable)) + scale_y_log10() + scale_x_log10()
ggplot(sppsubs,aes(x=gsize,y=subrate,colour=Group)) + geom_label(aes(label=Pathogen)) + geom_polygon(data=ratesM,aes(group=variable,fill=variable,colour=variable),alpha=0) + scale_y_log10() + scale_x_log10()
ggplot(sppsubs,aes(x=gsize,y=subrate,colour=Group)) + geom_label(aes(label=Pathogen)) + geom_polygon(data=ratesM,aes(group=variable,fill=variable,colour=variable),alpha=10) + scale_y_log10() + scale_x_log10()
ggplot(sppsubs,aes(x=gsize,y=subrate,colour=Group)) + geom_label(aes(label=Pathogen)) + geom_polygon(data=ratesM,aes(group=variable,fill=variable,colour=variable),alpha=0.5) + scale_y_log10() + scale_x_log10()
ggplot(sppsubs,aes(x=gsize,y=subrate,colour=Group)) +
geom_polygon(data=ratesM,aes(group=variable,fill=variable,colour=variable),alpha=0.5) +
geom_label(aes(label=Pathogen)) + scale_y_log10() + scale_x_log10()
head(ratesM)
View(rates)
ratesM <- melt(rates,id.vars = "gsize",value.name ="subrate")
#ratesM <- ratesM[ratesM$subrate<=0.005,]
ratesM <- ratesM[ratesM$gsize<=0,]
floors <- data.frame("gsize"=c(rep(max(ratesM$gsize),3),rep(min(ratesM$gsize),3)),
"variable"=unique(as.character(ratesM$variable)),
"subrate"=rep(0,6))
ratesM <- rbind(ratesM,floors)
ggplot(sppsubs,aes(x=gsize,y=subrate,colour=Group)) + geom_point(size=4) + geom_line(data=ratesM,aes(group=variable),colour="grey") + scale_y_log10() + scale_x_log10()
#cheat sheet
ggplot(sppsubs,aes(x=gsize,y=subrate,colour=Group)) + geom_label(aes(label=Pathogen)) + geom_line(data=ratesM,aes(group=variable),colour="grey") + scale_y_log10() + scale_x_log10()
ggplot(sppsubs,aes(x=gsize,y=subrate,colour=Group)) +
geom_polygon(data=ratesM,aes(group=variable,fill=variable,colour=variable),alpha=0.5) +
geom_label(aes(label=Pathogen)) + scale_y_log10() + scale_x_log10()
ratesM <- melt(rates,id.vars = "gsize",value.name ="subrate")
#ratesM <- ratesM[ratesM$subrate<=0.005,]
ratesM <- ratesM[ratesM$gsize>=0,]
floors <- data.frame("gsize"=c(rep(max(ratesM$gsize),3),rep(min(ratesM$gsize),3)),
"variable"=unique(as.character(ratesM$variable)),
"subrate"=rep(0,6))
ratesM <- rbind(ratesM,floors)
ggplot(sppsubs,aes(x=gsize,y=subrate,colour=Group)) + geom_point(size=4) + geom_line(data=ratesM,aes(group=variable),colour="grey") + scale_y_log10() + scale_x_log10()
#cheat sheet
ggplot(sppsubs,aes(x=gsize,y=subrate,colour=Group)) + geom_label(aes(label=Pathogen)) + geom_line(data=ratesM,aes(group=variable),colour="grey") + scale_y_log10() + scale_x_log10()
ggplot(sppsubs,aes(x=gsize,y=subrate,colour=Group)) +
geom_polygon(data=ratesM,aes(group=variable,fill=variable,colour=variable),alpha=0.5) +
geom_label(aes(label=Pathogen)) + scale_y_log10() + scale_x_log10() + xlim(1e3,1e8)
ggplot(sppsubs,aes(x=gsize,y=subrate,colour=Group)) +
geom_polygon(data=ratesM,aes(group=variable,fill=variable,colour=variable),alpha=0.5) +
geom_label(aes(label=Pathogen)) + scale_y_log10() + scale_x_log10(limits=c(1e3,1e8))
ratesM <- ratesM[ratesM$gsize>=0,]
floors <- data.frame("gsize"=c(rep(max(ratesM$gsize),3),rep(min(ratesM$gsize),3)),
"variable"=unique(as.character(ratesM$variable)),
"subrate"=rep(0,6))
ratesM <- rbind(ratesM,floors)
rates
View(rates)
View(ratesM)
ratesM <- ratesM[ratesM$gsize>0,]
ratesM <- melt(rates,id.vars = "gsize",value.name ="subrate")
#ratesM <- ratesM[ratesM$subrate<=0.005,]
ratesM <- ratesM[ratesM$gsize>0,]
floors <- data.frame("gsize"=c(rep(max(ratesM$gsize),3),rep(min(ratesM$gsize),3)),
"variable"=unique(as.character(ratesM$variable)),
"subrate"=rep(0,6))
ratesM <- rbind(ratesM,floors)
ggplot(sppsubs,aes(x=gsize,y=subrate,colour=Group)) + geom_point(size=4) + geom_line(data=ratesM,aes(group=variable),colour="grey") + scale_y_log10() + scale_x_log10()
#cheat sheet
ggplot(sppsubs,aes(x=gsize,y=subrate,colour=Group)) + geom_label(aes(label=Pathogen)) + geom_line(data=ratesM,aes(group=variable),colour="grey") + scale_y_log10() + scale_x_log10()
ggplot(sppsubs,aes(x=gsize,y=subrate,colour=Group)) +
geom_polygon(data=ratesM,aes(group=variable,fill=variable,colour=variable),alpha=0.5) +
geom_label(aes(label=Pathogen)) + scale_y_log10() + scale_x_log10(limits=c(1e3,1e8))
ggplot(sppsubs,aes(x=gsize,y=subrate,colour=Group)) +
geom_polygon(data=ratesM,aes(group=variable,fill=variable,colour="grey"),alpha=0.5) +
geom_label(aes(label=Pathogen)) + scale_y_log10() + scale_x_log10(limits=c(1e3,1e8))
ggplot(sppsubs,aes(x=gsize,y=subrate,colour=Group)) +
geom_polygon(data=ratesM,aes(group=variable,fill="grey",colour=variable),alpha=0.5) +
geom_label(aes(label=Pathogen)) + scale_y_log10() + scale_x_log10(limits=c(1e3,1e8))
ggplot(sppsubs,aes(x=gsize,y=subrate,colour=Group)) +
geom_polygon(data=ratesM,aes(group=variable,colour=variable),alpha=0.5,fill="grey") +
geom_label(aes(label=Pathogen)) + scale_y_log10() + scale_x_log10(limits=c(1e3,1e8))
ggplot(sppsubs,aes(x=gsize,y=subrate,colour=Group)) +
geom_polygon(data=ratesM,aes(group=variable),alpha=0.7,fill="grey") +
geom_label(aes(label=Pathogen)) + scale_y_log10() + scale_x_log10(limits=c(1e3,1e8))
ggplot(sppsubs,aes(x=gsize,y=subrate)) + geom_label(aes(label=Pathogen,colour=Group)) + geom_line(data=ratesM,aes(group=variable),colour="grey") + scale_y_log10() + scale_x_log10()
ggplot(sppsubs,aes(x=gsize,y=subrate,colour=Group)) +
geom_polygon(data=ratesM,aes(group=variable),alpha=0.7,fill="grey") +
geom_label(aes(label=Pathogen)) + scale_y_log10() + scale_x_log10(limits=c(1e3,1e8))
ggplot(sppsubs,aes(x=gsize,y=subrate)) +
geom_polygon(data=ratesM,aes(group=variable),alpha=0.7,fill="grey") +
geom_label(aes(label=Pathogen,colour=Group)) + scale_y_log10() + scale_x_log10(limits=c(1e3,1e8))
gsizes <- seq(0,1e8,1e3)
rates <- data.frame("gsize"=gsizes,"years"=1/gsizes,"months"=12/gsizes,"weeks"=52/gsizes)
ratesM <- melt(rates,id.vars = "gsize",value.name ="subrate")
#ratesM <- ratesM[ratesM$subrate<=0.005,]
ratesM <- ratesM[ratesM$gsize>0,]
floors <- data.frame("gsize"=c(rep(max(ratesM$gsize),3),rep(min(ratesM$gsize),3)),
"variable"=unique(as.character(ratesM$variable)),
"subrate"=rep(0,6))
ratesM <- rbind(ratesM,floors)
ggplot(sppsubs,aes(x=gsize,y=subrate,colour=Group)) + geom_point(size=4) + geom_line(data=ratesM,aes(group=variable),colour="grey") + scale_y_log10() + scale_x_log10()
#cheat sheet
ggplot(sppsubs,aes(x=gsize,y=subrate,colour=Group)) + geom_label(aes(label=Pathogen)) + geom_line(data=ratesM,aes(group=variable),colour="grey") + scale_y_log10() + scale_x_log10()
gsizes <- seq(0,1e8,1e2)
rates <- data.frame("gsize"=gsizes,"years"=1/gsizes,"months"=12/gsizes,"weeks"=52/gsizes)
ratesM <- melt(rates,id.vars = "gsize",value.name ="subrate")
#ratesM <- ratesM[ratesM$subrate<=0.005,]
ratesM <- ratesM[ratesM$gsize>0,]
floors <- data.frame("gsize"=c(rep(max(ratesM$gsize),3),rep(min(ratesM$gsize),3)),
"variable"=unique(as.character(ratesM$variable)),
"subrate"=rep(0,6))
ratesM <- rbind(ratesM,floors)
ggplot(sppsubs,aes(x=gsize,y=subrate,colour=Group)) + geom_point(size=4) + geom_line(data=ratesM,aes(group=variable),colour="grey") + scale_y_log10() + scale_x_log10()
#cheat sheet
gsizes <- seq(0,1e8,1e3)
rates <- data.frame("gsize"=gsizes,"years"=1/gsizes,"months"=12/gsizes,"weeks"=52/gsizes)
ratesM <- melt(rates,id.vars = "gsize",value.name ="subrate")
#ratesM <- ratesM[ratesM$subrate<=0.005,]
ratesM <- ratesM[ratesM$gsize>0,]
floors <- data.frame("gsize"=c(rep(max(ratesM$gsize),3),rep(min(ratesM$gsize),3)),
"variable"=unique(as.character(ratesM$variable)),
"subrate"=rep(0,6))
ratesM <- rbind(ratesM,floors)
ggplot(sppsubs,aes(x=gsize,y=subrate,colour=Group)) + geom_point(size=4) + geom_line(data=ratesM,aes(group=variable),colour="grey") + scale_y_log10() + scale_x_log10(limits=c(1e3,1e8))
gsizes <- seq(1e3,1e8,1e3)
rates <- data.frame("gsize"=gsizes,"years"=1/gsizes,"months"=12/gsizes,"weeks"=52/gsizes)
ratesM <- melt(rates,id.vars = "gsize",value.name ="subrate")
#ratesM <- ratesM[ratesM$subrate<=0.005,]
ratesM <- ratesM[ratesM$gsize>0,]
floors <- data.frame("gsize"=c(rep(max(ratesM$gsize),3),rep(min(ratesM$gsize),3)),
"variable"=unique(as.character(ratesM$variable)),
"subrate"=rep(0,6))
ratesM <- rbind(ratesM,floors)
ggplot(sppsubs,aes(x=gsize,y=subrate,colour=Group)) + geom_point(size=4) + geom_line(data=ratesM,aes(group=variable),colour="grey") + scale_y_log10() + scale_x_log10(limits=c(1e3,1e8))
gsizes <- seq(0,1e8,1e3)
rates <- data.frame("gsize"=gsizes,"years"=1/gsizes,"months"=12/gsizes,"weeks"=52/gsizes)
ratesM <- melt(rates,id.vars = "gsize",value.name ="subrate")
#ratesM <- ratesM[ratesM$subrate<=0.005,]
ratesM <- ratesM[ratesM$gsize>0,]
floors <- data.frame("gsize"=c(rep(max(ratesM$gsize),3),rep(min(ratesM$gsize),3)),
"variable"=unique(as.character(ratesM$variable)),
"subrate"=rep(0,6))
ratesM <- rbind(ratesM,floors)
ggplot(sppsubs,aes(x=gsize,y=subrate,colour=Group)) + geom_point(size=4) + geom_line(data=ratesM,aes(group=variable),colour="grey") + scale_y_log10() + scale_x_log10(limits=c(1e3,1e8))
sppsubs <- read.table("subrate_relaxed_otherspp2.txt",sep="\t",header=T)
colnames(sppsubs)[3:4] <- c("gsize","subrate")
sppsubs$Group <- factor(sppsubs$Group,levels=c("eukaryote","Bacteria","dsDNA virus","ssDNA virus","RNA virus"),ordered = T)
gsizes <- seq(0,1e8,1e3)
rates <- data.frame("gsize"=gsizes,"years"=1/gsizes,"months"=12/gsizes,"weeks"=52/gsizes)
ratesM <- melt(rates,id.vars = "gsize",value.name ="subrate")
#ratesM <- ratesM[ratesM$subrate<=0.005,]
ratesM <- ratesM[ratesM$gsize>0,]
floors <- data.frame("gsize"=c(rep(max(ratesM$gsize),3),rep(min(ratesM$gsize),3)),
"variable"=unique(as.character(ratesM$variable)),
"subrate"=rep(0,6))
ggplot(sppsubs,aes(x=gsize,y=subrate,colour=Group)) + geom_point(size=4) + geom_line(data=ratesM,aes(group=variable),colour="grey") + scale_y_log10() + scale_x_log10(limits=c(1e3,1e8))
ggplot(sppsubs,aes(x=gsize,y=subrate,colour=Group)) + geom_label(aes(label=Pathogen)) + geom_line(data=ratesM,aes(group=variable),colour="grey") + scale_y_log10() + scale_x_log10(limits=c(1e3,1e8))
ratesM <- rbind(ratesM,floors)
ggplot(sppsubs,aes(x=gsize,y=subrate)) +
geom_polygon(data=ratesM,aes(group=variable),alpha=0.7,fill="grey") +
geom_label(aes(label=Pathogen,colour=Group)) + scale_y_log10() + scale_x_log10(limits=c(1e3,1e8))
ggplot(sppsubs,aes(x=gsize,y=subrate)) +
geom_polygon(data=ratesM,aes(group=variable),alpha=0.7,fill="grey") +
geom_label(aes(label=Pathogen,colour=Group),position="jitter") + scale_y_log10() + scale_x_log10(limits=c(1e3,1e8))
geom_label(aes(label=Pathogen,colour=Group),position="jitter") + scale_y_log10() + scale_x_log10(limits=c(1e3,1e8))
ggplot(sppsubs,aes(x=gsize,y=subrate)) +
geom_polygon(data=ratesM,aes(group=variable),alpha=0.7,fill="grey") +
geom_label(aes(label=Pathogen,colour=Group),position="jitter") + scale_y_log10() + scale_x_log10(limits=c(1e3,1e8))
ggplot(sppsubs,aes(x=gsize,y=subrate)) +
geom_polygon(data=ratesM,aes(group=variable),alpha=0.7,fill="grey") +
geom_label(aes(label=Pathogen,colour=Group),position="jitter") +
geom_point(aes(label=Pathogen,colour=Group),position="jitter") +
scale_y_log10() + scale_x_log10(limits=c(1e3,1e8))
ggplot(sppsubs,aes(x=gsize,y=subrate)) +
geom_polygon(data=ratesM,aes(group=variable),alpha=0.7,fill="grey") +
geom_label(aes(label=Pathogen,colour=Group),position = jitter) +
geom_point(aes(label=Pathogen,colour=Group)) +
scale_y_log10() + scale_x_log10(limits=c(1e3,1e8))
ggplot(sppsubs,aes(x=gsize,y=subrate)) +
geom_polygon(data=ratesM,aes(group=variable),alpha=0.7,fill="grey") +
geom_label(aes(label=Pathogen,colour=Group),position = jitter()) +
geom_point(aes(label=Pathogen,colour=Group)) +
scale_y_log10() + scale_x_log10(limits=c(1e3,1e8))
ggplot(sppsubs,aes(x=gsize,y=subrate)) +
geom_polygon(data=ratesM,aes(group=variable),alpha=0.7,fill="grey") +
geom_label(aes(label=Pathogen,colour=Group),position = "whatever" +
geom_point(aes(label=Pathogen,colour=Group)) +
scale_y_log10() + scale_x_log10(limits=c(1e3,1e8))
)
ggplot(sppsubs,aes(x=gsize,y=subrate)) +
geom_polygon(data=ratesM,aes(group=variable),alpha=0.7,fill="grey") +
geom_label(aes(label=Pathogen,colour=Group),position = "whatever") +
geom_point(aes(label=Pathogen,colour=Group)) +
scale_y_log10() + scale_x_log10(limits=c(1e3,1e8))
ggplot(sppsubs,aes(x=gsize,y=subrate)) +
geom_polygon(data=ratesM,aes(group=variable),alpha=0.7,fill="grey") +
geom_label(aes(label=Pathogen,colour=Group),position = "jitter") +
geom_point(aes(label=Pathogen,colour=Group)) +
scale_y_log10() + scale_x_log10(limits=c(1e3,1e8))
ggplot(sppsubs,aes(x=gsize,y=subrate)) +
geom_polygon(data=ratesM,aes(group=variable),alpha=0.7,fill="grey") +
geom_label(aes(label=Pathogen,colour=Group),position = "jitter") +
geom_point(aes(label=Pathogen,colour=Group)) +
scale_y_log10() + scale_x_log10(limits=c(1e3,1e8),breaks=c(1e4,1e5,1e6,1e7,1e8))
1e4
ggplot(sppsubs,aes(x=gsize,y=subrate)) +
geom_polygon(data=ratesM,aes(group=variable),alpha=0.7,fill="grey") +
geom_label(aes(label=Pathogen,colour=Group),position = "jitter") +
geom_point(aes(label=Pathogen,colour=Group),size=3) +
scale_y_log10() + scale_x_log10(limits=c(1e3,1e8),breaks=c(1e4,1e5,1e6,1e7,1e8))
?geom_label
ggplot(sppsubs,aes(x=gsize,y=subrate)) +
geom_polygon(data=ratesM,aes(group=variable),alpha=0.7,fill="grey") +
geom_label(aes(label=Pathogen,colour=Group),check_overlap=T) +
geom_point(aes(label=Pathogen,colour=Group),size=3) +
scale_y_log10() + scale_x_log10(limits=c(1e3,1e8),breaks=c(1e4,1e5,1e6,1e7,1e8))
ggplot(sppsubs,aes(x=gsize,y=subrate)) +
geom_polygon(data=ratesM,aes(group=variable),alpha=0.7,fill="grey") +
geom_text(aes(label=Pathogen,colour=Group),check_overlap=T) +
geom_point(aes(label=Pathogen,colour=Group),size=3) +
scale_y_log10() + scale_x_log10(limits=c(1e3,1e8),breaks=c(1e4,1e5,1e6,1e7,1e8))
ggplot(sppsubs,aes(x=gsize,y=subrate)) +
geom_polygon(data=ratesM,aes(group=variable),alpha=0.7,fill="grey") +
geom_text(aes(label=Pathogen,colour=Group),position="jitter") +
geom_point(aes(label=Pathogen,colour=Group),size=3) +
scale_y_log10() + scale_x_log10(limits=c(1e3,1e8),breaks=c(1e4,1e5,1e6,1e7,1e8))
ggplot(sppsubs,aes(x=gsize,y=subrate)) +
geom_polygon(data=ratesM,aes(group=variable),alpha=0.7,fill="grey") +
geom_label(aes(label=Pathogen,colour=Group),check_overlap=T) +
geom_point(aes(label=Pathogen,colour=Group),size=3) +
scale_y_log10() + scale_x_log10(limits=c(1e3,1e8),breaks=c(1e4,1e5,1e6,1e7,1e8))
ggplot(sppsubs,aes(x=gsize,y=subrate)) +
geom_polygon(data=ratesM,aes(group=variable),alpha=0.7,fill="grey") +
geom_label(aes(label=Pathogen,colour=Group)) +
geom_point(aes(label=Pathogen,colour=Group),size=3) +
scale_y_log10() + scale_x_log10(limits=c(1e3,1e8),breaks=c(1e4,1e5,1e6,1e7,1e8))
sppsubs <- read.table("subrate_relaxed_otherspp2.txt",sep="\t",header=T)
colnames(sppsubs)[3:4] <- c("gsize","subrate")
sppsubs$Group <- factor(sppsubs$Group,levels=c("eukaryote","Bacteria","dsDNA virus","ssDNA virus","RNA virus"),ordered = T)
gsizes <- seq(0,1e8,1e3)
rates <- data.frame("gsize"=gsizes,"years"=1/gsizes,"months"=12/gsizes,"weeks"=52/gsizes)
ratesM <- melt(rates,id.vars = "gsize",value.name ="subrate")
#ratesM <- ratesM[ratesM$subrate<=0.005,]
ratesM <- ratesM[ratesM$gsize>0,]
floors <- data.frame("gsize"=c(rep(max(ratesM$gsize),3),rep(min(ratesM$gsize),3)),
"variable"=unique(as.character(ratesM$variable)),
"subrate"=rep(0,6))
ratesM <- rbind(ratesM,floors)
ggplot(sppsubs,aes(x=gsize,y=subrate)) +
geom_polygon(data=ratesM,aes(group=variable),alpha=0.7,fill="grey") +
geom_label(aes(label=Pathogen,colour=Group)) +
geom_point(aes(label=Pathogen,colour=Group),size=3) +
scale_y_log10() + scale_x_log10(limits=c(1e3,1e8),breaks=c(1e4,1e5,1e6,1e7,1e8))
sppsubs <- read.table("subrate_relaxed_otherspp2.txt",sep="\t",header=T)
colnames(sppsubs)[3:4] <- c("gsize","subrate")
sppsubs$Group <- factor(sppsubs$Group,levels=c("eukaryote","Bacteria","dsDNA virus","ssDNA virus","RNA virus"),ordered = T)
gsizes <- seq(0,1e8,1e3)
rates <- data.frame("gsize"=gsizes,"years"=1/gsizes,"months"=12/gsizes,"weeks"=52/gsizes)
ratesM <- melt(rates,id.vars = "gsize",value.name ="subrate")
#ratesM <- ratesM[ratesM$subrate<=0.005,]
ratesM <- ratesM[ratesM$gsize>0,]
floors <- data.frame("gsize"=c(rep(max(ratesM$gsize),3),rep(min(ratesM$gsize),3)),
"variable"=unique(as.character(ratesM$variable)),
"subrate"=rep(0,6))
ratesM <- rbind(ratesM,floors)
ggplot(sppsubs,aes(x=gsize,y=subrate)) +
geom_polygon(data=ratesM,aes(group=variable),alpha=0.7,fill="grey") +
geom_label(aes(label=Pathogen,colour=Group)) +
geom_point(aes(label=Pathogen,colour=Group),size=3) +
scale_y_log10() + scale_x_log10(limits=c(1e3,1e8),breaks=c(1e4,1e5,1e6,1e7,1e8))
sppsubs <- read.table("subrate_relaxed_otherspp2.txt",sep="\t",header=T)
colnames(sppsubs)[3:4] <- c("gsize","subrate")
sppsubs$Group <- factor(sppsubs$Group,levels=c("eukaryote","Bacteria","dsDNA virus","ssDNA virus","RNA virus"),ordered = T)
gsizes <- seq(0,1e8,1e3)
rates <- data.frame("gsize"=gsizes,"years"=1/gsizes,"months"=12/gsizes,"weeks"=52/gsizes)
ratesM <- melt(rates,id.vars = "gsize",value.name ="subrate")
#ratesM <- ratesM[ratesM$subrate<=0.005,]
ratesM <- ratesM[ratesM$gsize>0,]
floors <- data.frame("gsize"=c(rep(max(ratesM$gsize),3),rep(min(ratesM$gsize),3)),
"variable"=unique(as.character(ratesM$variable)),
"subrate"=rep(0,6))
ratesM <- rbind(ratesM,floors)
ggplot(sppsubs,aes(x=gsize,y=subrate)) +
geom_polygon(data=ratesM,aes(group=variable),alpha=0.7,fill="grey") +
geom_label(aes(label=Pathogen,colour=Group)) +
geom_point(aes(label=Pathogen,colour=Group),size=3) +
scale_y_log10() + scale_x_log10(limits=c(1e3,1e8),breaks=c(1e4,1e5,1e6,1e7,1e8))
sppsubs <- read.table("subrate_relaxed_otherspp2.txt",sep="\t",header=T)
colnames(sppsubs)[3:4] <- c("gsize","subrate")
sppsubs$Group <- factor(sppsubs$Group,levels=c("eukaryote","Bacteria","dsDNA virus","ssDNA virus","RNA virus"),ordered = T)
gsizes <- seq(0,1e8,1e3)
rates <- data.frame("gsize"=gsizes,"years"=1/gsizes,"months"=12/gsizes,"weeks"=52/gsizes)
ratesM <- melt(rates,id.vars = "gsize",value.name ="subrate")
#ratesM <- ratesM[ratesM$subrate<=0.005,]
ratesM <- ratesM[ratesM$gsize>0,]
floors <- data.frame("gsize"=c(rep(max(ratesM$gsize),3),rep(min(ratesM$gsize),3)),
"variable"=unique(as.character(ratesM$variable)),
"subrate"=rep(0,6))
ratesM <- rbind(ratesM,floors)
ggplot(sppsubs,aes(x=gsize,y=subrate)) +
geom_polygon(data=ratesM,aes(group=variable),alpha=0.7,fill="grey") +
geom_label(aes(label=Pathogen,colour=Group)) +
geom_point(aes(label=Pathogen,colour=Group),size=3) +
scale_y_log10() + scale_x_log10(limits=c(1e3,1e8),breaks=c(1e4,1e5,1e6,1e7,1e8))
knit("subrates.Rmd")
ggplot(sppsubs,aes(x=gsize,y=subrate)) +
geom_polygon(data=ratesM,aes(group=variable),alpha=0.7,fill="grey") +
geom_label(aes(label=Pathogen,colour=Group)) +
geom_point(aes(label=Pathogen,colour=Group),size=3) +
scale_y_log10() + scale_x_log10(limits=c(1e3,1e8),breaks=c(1e4,1e5,1e6,1e7,1e8),label="Genome Size (bp)")
ggplot(sppsubs,aes(x=gsize,y=subrate)) +
geom_polygon(data=ratesM,aes(group=variable),alpha=0.7,fill="grey") +
geom_label(aes(label=Pathogen,colour=Group)) +
geom_point(aes(label=Pathogen,colour=Group),size=3) +
scale_y_log10() + scale_x_log10(limits=c(1e3,1e8),breaks=c(1e4,1e5,1e6,1e7,1e8)) +xlab("Genome Size (bp)")
ggplot(sppsubs,aes(x=gsize,y=subrate)) +
geom_polygon(data=ratesM,aes(group=variable),alpha=0.7,fill="grey") +
geom_label(aes(label=Pathogen,colour=Group)) +
geom_point(aes(label=Pathogen,colour=Group),size=3) +
scale_y_log10() + scale_x_log10(limits=c(1e3,1e8),breaks=c(1e4,1e5,1e6,1e7,1e8)) +
xlab("Genome Size (bp)")+ylab("mutation rate (subs / site / year)")
ggplot(sppsubs,aes(x=gsize,y=subrate)) +
geom_polygon(data=ratesM,aes(group=variable,fill=variable)) +
geom_label(aes(label=Pathogen,colour=Group)) +
geom_point(aes(label=Pathogen,colour=Group),size=3) +
scale_y_log10() + scale_x_log10(limits=c(1e3,1e8),breaks=c(1e4,1e5,1e6,1e7,1e8)) +
xlab("Genome Size (bp)")+ylab("mutation rate (subs / site / year)")
ratesM <- rbind(ratesM,floors)
ratesM$variable <- factor(ratesM$variable,levels=c("years","months","weeks"))
ggplot(sppsubs,aes(x=gsize,y=subrate)) +
geom_polygon(data=ratesM,aes(group=variable,fill=variable)) +
geom_label(aes(label=Pathogen,colour=Group)) +
geom_point(aes(label=Pathogen,colour=Group),size=3) +
scale_y_log10() + scale_x_log10(limits=c(1e3,1e8),breaks=c(1e4,1e5,1e6,1e7,1e8)) +
xlab("Genome Size (bp)")+ylab("mutation rate (subs / site / year)")
ratesM$variable <- factor(ratesM$variable,levels=c("years","months","weeks"),ordered=T)
ggplot(sppsubs,aes(x=gsize,y=subrate)) +
geom_polygon(data=ratesM,aes(group=variable,fill=variable)) +
geom_label(aes(label=Pathogen,colour=Group)) +
geom_point(aes(label=Pathogen,colour=Group),size=3) +
scale_y_log10() + scale_x_log10(limits=c(1e3,1e8),breaks=c(1e4,1e5,1e6,1e7,1e8)) +
xlab("Genome Size (bp)")+ylab("mutation rate (subs / site / year)")
ratesM <- rbind(ratesM,floors)
ratesM$variable <- factor(ratesM$variable,levels=c("weeks","months","years"),ordered=T)
ggplot(sppsubs,aes(x=gsize,y=subrate)) +
geom_polygon(data=ratesM,aes(group=variable,fill=variable)) +
geom_label(aes(label=Pathogen,colour=Group)) +
geom_point(aes(label=Pathogen,colour=Group),size=3) +
scale_y_log10() + scale_x_log10(limits=c(1e3,1e8),breaks=c(1e4,1e5,1e6,1e7,1e8)) +
xlab("Genome Size (bp)")+ylab("mutation rate (subs / site / year)")
ggplot(sppsubs,aes(x=gsize,y=subrate)) +
geom_polygon(data=ratesM,aes(group=variable,fill=variable)) +
scale_fill_manual(values = fcol) +
geom_label(aes(label=Pathogen,colour=Group)) +
geom_point(aes(label=Pathogen,colour=Group),size=3) +
scale_y_log10() + scale_x_log10(limits=c(1e3,1e8),breaks=c(1e4,1e5,1e6,1e7,1e8)) +
xlab("Genome Size (bp)")+ylab("mutation rate (subs / site / year)")
fcol <- c("#AAAAAA","#CCCCCC","#EEEEEE")
names(fcol) = c("years","months","weeks")
ggplot(sppsubs,aes(x=gsize,y=subrate)) +
geom_polygon(data=ratesM,aes(group=variable,fill=variable)) +
scale_fill_manual(values = fcol) +
geom_label(aes(label=Pathogen,colour=Group)) +
geom_point(aes(label=Pathogen,colour=Group),size=3) +
scale_y_log10() + scale_x_log10(limits=c(1e3,1e8),breaks=c(1e4,1e5,1e6,1e7,1e8)) +
xlab("Genome Size (bp)")+ylab("mutation rate (subs / site / year)")
ggplot(sppsubs,aes(x=gsize,y=subrate)) +
geom_polygon(data=ratesM,aes(group=variable,fill=variable)) +
scale_fill_manual(values = fcol) +
geom_label(aes(label=Pathogen,colour=Group),position="right") +
geom_point(aes(label=Pathogen,colour=Group),size=3) +
scale_y_log10() + scale_x_log10(limits=c(1e3,1e8),breaks=c(1e4,1e5,1e6,1e7,1e8)) +
xlab("Genome Size (bp)")+ylab("mutation rate (subs / site / year)")
ggplot(sppsubs,aes(x=gsize,y=subrate)) +
geom_polygon(data=ratesM,aes(group=variable,fill=variable)) +
scale_fill_manual(values = fcol) +
geom_label(aes(label=Pathogen,colour=Group),nudge_x = T) +
geom_point(aes(label=Pathogen,colour=Group),size=3) +
scale_y_log10() + scale_x_log10(limits=c(1e3,1e8),breaks=c(1e4,1e5,1e6,1e7,1e8)) +
xlab("Genome Size (bp)")+ylab("mutation rate (subs / site / year)")
ggplot(sppsubs,aes(x=gsize,y=subrate)) +
geom_polygon(data=ratesM,aes(group=variable,fill=variable)) +
scale_fill_manual(values = fcol) +
geom_label(aes(label=Pathogen,colour=Group),nudge_x = 10) +
geom_point(aes(label=Pathogen,colour=Group),size=3) +
scale_y_log10() + scale_x_log10(limits=c(1e3,1e8),breaks=c(1e4,1e5,1e6,1e7,1e8)) +
xlab("Genome Size (bp)")+ylab("mutation rate (subs / site / year)")
ggplot(sppsubs,aes(x=gsize,y=subrate)) +
geom_polygon(data=ratesM,aes(group=variable,fill=variable)) +
scale_fill_manual(values = fcol) +
geom_label(aes(label=Pathogen,colour=Group),nudge_x = 0.5) +
geom_point(aes(label=Pathogen,colour=Group),size=3) +
scale_y_log10() + scale_x_log10(limits=c(1e3,1e8),breaks=c(1e4,1e5,1e6,1e7,1e8)) +
xlab("Genome Size (bp)")+ylab("mutation rate (subs / site / year)")
ggplot(sppsubs,aes(x=gsize,y=subrate)) +
geom_polygon(data=ratesM,aes(group=variable,fill=variable)) +
scale_fill_manual(values = fcol) +
geom_label(aes(label=Pathogen,colour=Group),nudge_x = 0.1) +
geom_point(aes(label=Pathogen,colour=Group),size=3) +
scale_y_log10() + scale_x_log10(limits=c(1e3,1e8),breaks=c(1e4,1e5,1e6,1e7,1e8)) +
xlab("Genome Size (bp)")+ylab("mutation rate (subs / site / year)")
ggplot(sppsubs,aes(x=gsize,y=subrate)) +
geom_polygon(data=ratesM,aes(group=variable,fill=variable)) +
scale_fill_manual(values = fcol) +
geom_label(aes(label=Pathogen,colour=Group),nudge_x = 0.2) +
geom_point(aes(label=Pathogen,colour=Group),size=3) +
scale_y_log10() + scale_x_log10(limits=c(1e3,1e8),breaks=c(1e4,1e5,1e6,1e7,1e8)) +
xlab("Genome Size (bp)")+ylab("mutation rate (subs / site / year)")
ggplot(sppsubs,aes(x=gsize,y=subrate),) +
geom_polygon(data=ratesM,aes(group=variable,fill=variable)) +
scale_fill_manual(values = fcol) +
geom_label(aes(label=Pathogen,colour=Group),nudge_x = 0.2) +
geom_point(aes(label=Pathogen,colour=Group),size=3) +
scale_y_log10() + scale_x_log10(limits=c(1e3,1e8),breaks=c(1e4,1e5,1e6,1e7,1e8)) +
xlab("Genome Size (bp)")+ylab("mutation rate (subs / site / year)")+
theme(plot.background = element_rect(fill = 'white'))
ggplot(sppsubs,aes(x=gsize,y=subrate),) +
geom_polygon(data=ratesM,aes(group=variable,fill=variable)) +
scale_fill_manual(values = fcol) +
geom_label(aes(label=Pathogen,colour=Group),nudge_x = 0.2) +
geom_point(aes(label=Pathogen,colour=Group),size=3) +
scale_y_log10() + scale_x_log10(limits=c(1e3,1e8),breaks=c(1e4,1e5,1e6,1e7,1e8)) +
xlab("Genome Size (bp)")+ylab("mutation rate (subs / site / year)")+
theme(panel.background = element_rect(fill = 'white'))
ggplot(sppsubs,aes(x=gsize,y=subrate),) +
geom_polygon(data=ratesM,aes(group=variable,fill=variable)) +
scale_fill_manual(values = fcol) +
geom_label(aes(label=Pathogen,colour=Group),nudge_x = 0.2) +
geom_point(aes(label=Pathogen,colour=Group),size=3) +
scale_y_log10() + scale_x_log10(limits=c(1e3,1e8),breaks=c(1e4,1e5,1e6,1e7,1e8)) +
xlab("Genome Size (bp)")+ylab("mutation rate (subs / site / year)")+
theme(panel.background = element_rect(fill = None))
ggplot(sppsubs,aes(x=gsize,y=subrate),) +
geom_polygon(data=ratesM,aes(group=variable,fill=variable)) +
scale_fill_manual(values = fcol) +
geom_label(aes(label=Pathogen,colour=Group),nudge_x = 0.2) +
geom_point(aes(label=Pathogen,colour=Group),size=3) +
scale_y_log10() + scale_x_log10(limits=c(1e3,1e8),breaks=c(1e4,1e5,1e6,1e7,1e8)) +
xlab("Genome Size (bp)")+ylab("mutation rate (subs / site / year)")+
theme(panel.background = element_rect(fill = F))
knit("subrates.Rmd")
knit("subrates.Rmd")
knit("subrates.Rmd")
knit("subrates.Rmd")
knit("subrates.Rmd")
