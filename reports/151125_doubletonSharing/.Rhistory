alleles <- subset(tstvs,MODEL %in% c("AC","AG","AT","CG","CT","GT"))
tstvs <- subset(tstvs,MODEL %in% c("Ts","Tv","Tv-ta","AT"))
tstvs <- merge(
merge(
read.table("Thies_all_manual.PASS.Cls.miss0.5.LMRG.HAP.MKSNGL.CONCORD.TsTv.summary",header=T),
read.table("Thies_all_manual.PASS.Cls.miss0.5.LMRG.HAP.MKSNGL.DISCORD.TsTv.summary",header=T),
by="MODEL"
),
#  merge(
read.table("Thies_all_manual.PASS.Cls.miss0.5.LMRG.HAP.MKSNGL.TsTv.summary",header=T),
#    read.table("Thies_all_manual.PASS.Cls.miss0.5.LMRG.HAP.TsTv.summary",header=T),
by="MODEL"
#  ),
#  by="MODEL"
)
#colnames(tstvs)<-c("MODEL","CONCORD","DISCORD","MKSNGL","ALL")
colnames(tstvs)<-c("MODEL","CONCORD","DISCORD","ALL")
rownames(tstvs)<-tstvs$MODEL
tstvs$MODEL <- factor(tstvs$MODEL,levels=c("AT","AG","CT","AC","GT","CG","Ts","Tv","total","Tv-ta"))
tstvs["Tv-ta",1] <- "Tv-ta"
tstvs["Tv-ta",2:4] <- tstvs["Tv",2:4] - tstvs["AT",2:4]
tstvs["total",1] <- "total"
tstvs["total",2:4] <- tstvs["Tv",2:4] + tstvs["Ts",2:4]
tstvs["Tv",2:4] / tstvs["Ts",2:4]
tstvs["Tv-ta",2:4] / tstvs["Ts",2:4]
alleles <- subset(tstvs,MODEL %in% c("AC","AG","AT","CG","CT","GT"))
tstvs <- subset(tstvs,MODEL %in% c("Ts","Tv","Tv-ta","AT"))
tstvs <- melt(tstvs)
tstvs$variable <- factor(tstvs$variable,levels=c("ALL","CONCORD","DISCORD"))
tstvs$MODEL <- factor(tstvs$MODEL,levels =c("AT","Tv-ta","Tv","Ts"))
alleles <- melt(alleles)
alleles$variable <- factor(alleles$variable,levels=c("ALL","CONCORD","DISCORD"))
cols <- c("dark blue","blue","red","light blue")
names(cols) <- c("AT","Tv","Ts","Tv-ta")
ggplot(subset(tstvs,MODEL %in% c("Ts","Tv")),aes(x=variable,y=value,group=MODEL,fill=MODEL)) + geom_bar(stat="identity",position = "stack") + scale_fill_manual(values = cols)
ggplot(subset(tstvs,MODEL %in% c("Ts","Tv-ta","AT")),aes(x=variable,y=value,group=MODEL,fill=MODEL)) + geom_bar(stat="identity",position = "stack") + scale_fill_manual(values = cols)
cols <- c("blue","red","light blue","dark blue")
names(cols) <- c("Tv","Ts","Tv-ta","AT")
ggplot(subset(tstvs,MODEL %in% c("Ts","Tv")),aes(x=variable,y=value,group=MODEL,fill=MODEL)) + geom_bar(stat="identity",position = "stack") + scale_fill_manual(values = cols)
ggplot(subset(tstvs,MODEL %in% c("Ts","Tv-ta","AT")),aes(x=variable,y=value,group=MODEL,fill=MODEL)) + geom_bar(stat="identity",position = "stack") + scale_fill_manual(values = cols)
tstvs$MODEL
ggplot(subset(tstvs,MODEL %in% c("Ts","Tv")),aes(x=variable,y=value,group=MODEL,fill=MODEL)) + geom_bar(stat="identity",position = "dodge") + scale_fill_manual(values = cols)
ggplot(subset(tstvs,MODEL %in% c("Ts","Tv")),aes(x=variable,y=value,group=MODEL,fill=MODEL)) + geom_bar(stat="identity",position = "dodge") + scale_fill_manual(values = cols)
ggplot(subset(tstvs,MODEL %in% c("Ts","Tv")),aes(x=variable,y=value,group=MODEL,fill=MODEL)) + geom_bar(stat="identity",position = "stack") + scale_fill_manual(values = cols)
ggplot(subset(tstvs,MODEL %in% c("Ts","Tv")),aes(x=variable,y=value,group=MODEL,fill=MODEL)) + geom_bar(stat="identity",position = "stack") + scale_fill_manual(values = cols)
ggplot(subset(tstvs,MODEL %in% c("Ts","Tv-ta","AT")),aes(x=variable,y=value,group=MODEL,fill=MODEL)) + geom_bar(stat="identity",position = "stack") + scale_fill_manual(values = cols)
ggplot(subset(tstvs,MODEL %in% c("Ts","Tv-ta","AT")),aes(x=variable,y=value,group=MODEL,fill=MODEL)) + geom_bar(stat="identity",position = "dodge") + scale_fill_manual(values = cols)
stack
ggplot(subset(tstvs,MODEL %in% c("Ts","Tv-ta","AT")),aes(x=variable,y=value,group=MODEL,fill=MODEL)) + geom_bar(stat="identity",position = "stack") + scale_fill_manual(values = cols)
tscol <- scale_fill_manual(values = cols)
ggplot(subset(tstvs,MODEL %in% c("Ts","Tv")),aes(x=variable,y=value,group=MODEL,fill=MODEL)) + geom_bar(stat="identity",position = "stack") + tscol
ggplot(subset(tstvs,MODEL %in% c("Ts","Tv")),aes(x=variable,y=value,group=MODEL,fill=MODEL)) + geom_bar(stat="identity",position = "stack") + tscol
ggplot(subset(tstvs,MODEL %in% c("Ts","Tv")),aes(x=variable,y=value,group=MODEL,fill=MODEL)) + geom_bar(stat="identity",position = "stack") + tscol
ggplot(subset(tstvs,MODEL %in% c("Ts","Tv-ta","AT")),aes(x=variable,y=value,group=MODEL,fill=MODEL)) + geom_bar(stat="identity",position = "stack") + tscol
ggplot(subset(tstvs,MODEL %in% c("Ts","Tv")),aes(x=variable,y=value,group=MODEL,fill=MODEL)) + geom_bar(stat="identity",position = "fill") + tscol
ggplot(subset(tstvs,MODEL %in% c("Ts","Tv-ta","AT")),aes(x=variable,y=value,group=MODEL,fill=MODEL)) + geom_bar(stat="identity",position = "fill") + tscol
ggplot(subset(tstvs,MODEL %in% c("Ts","Tv-ta")),aes(x=variable,y=value,group=MODEL,fill=MODEL)) + geom_bar(stat="identity",position = "fill") + tscol
ggplot(subset(tstvs,MODEL %in% c("Ts","Tv-ta","AT")),aes(x=variable,y=value,group=MODEL,fill=MODEL)) + geom_bar(stat="identity",position = "fill") + tscol
ordered(tstvs$MODEL,levels =c("AT","Tv-ta","Tv","Ts"))
tstvs$MODEL <- ordered(tstvs$MODEL,levels =c("AT","Tv-ta","Tv","Ts"))
ggplot(subset(tstvs,MODEL %in% c("Ts","Tv")),aes(x=variable,y=value,group=MODEL,fill=MODEL)) + geom_bar(stat="identity",position = "stack") + tscol
ggplot(subset(tstvs,MODEL %in% c("Ts","Tv-ta","AT")),aes(x=variable,y=value,group=MODEL,fill=MODEL)) + geom_bar(stat="identity",position = "stack") + tscol
tstvs$MODEL
ggplot(tstvs,aes(x=variable,y=value,group=MODEL,fill=MODEL)) + geom_bar(stat="identity",position = "stack") + tscol
ggplot(subset(tstvs,MODEL %in% c("Ts","Tv")),aes(x=variable,y=value,group=MODEL,fill=MODEL)) + geom_bar(stat="identity",position = "stack") + tscol
ggplot(subset(tstvs,MODEL %in% c("Ts","Tv-ta","AT")),aes(x=variable,y=value,group=MODEL,fill=MODEL)) + geom_bar(stat="identity",position = "stack") + tscol
tstvs$MODEL <- ordered(tstvs$MODEL,levels =c("AT","Tv-ta","Tv","Ts"))
ggplot(subset(tstvs,MODEL %in% c("Ts","Tv")),aes(x=variable,y=value,group=MODEL,fill=MODEL)) + geom_bar(stat="identity",position = "stack") + tscol
ggplot(subset(tstvs,MODEL %in% c("Ts","Tv-ta","AT")),aes(x=variable,y=value,group=MODEL,fill=MODEL)) + geom_bar(stat="identity",position = "stack") + tscol
ggplot(subset(tstvs,MODEL %in% c("Ts","Tv")),aes(x=variable,y=value,group=MODEL,fill=MODEL)) + geom_bar(stat="identity",position = "fill") + tscol
ggplot(subset(tstvs,MODEL %in% c("Ts","Tv-ta","AT")),aes(x=variable,y=value,group=MODEL,fill=MODEL)) + geom_bar(stat="identity",position = "fill") + tscol
tstvs
order(tstvs,tstvs$MODEL)
order(tstvs$MODEL)
tstvs[order(tstvs$MODEL),]
tstvs <- tstvs[order(tstvs$MODEL),]
ggplot(subset(tstvs,MODEL %in% c("Ts","Tv")),aes(x=variable,y=value,group=MODEL,fill=MODEL)) + geom_bar(stat="identity",position = "stack") + tscol
ggplot(subset(tstvs,MODEL %in% c("Ts","Tv-ta","AT")),aes(x=variable,y=value,group=MODEL,fill=MODEL)) + geom_bar(stat="identity",position = "stack") + tscol
ggplot(subset(tstvs,MODEL %in% c("Ts","Tv")),aes(x=variable,y=value,group=MODEL,fill=MODEL)) + geom_bar(stat="identity",position = "fill") + tscol
ggplot(subset(tstvs,MODEL %in% c("Ts","Tv-ta","AT")),aes(x=variable,y=value,group=MODEL,fill=MODEL)) + geom_bar(stat="identity",position = "fill") + tscol
tstvs$MODEL <- ordered(tstvs$MODEL,levels =c("Tv","Tv-ta","AT","Ts"))
tstvs <- tstvs[order(tstvs$MODEL),]
alleles <- melt(alleles)
alleles$variable <- factor(alleles$variable,levels=c("ALL","CONCORD","DISCORD"))
cols <- c("blue","red","light blue","dark blue")
names(cols) <- c("Tv","Ts","Tv-ta","AT")
tscol <- scale_fill_manual(values = cols)
ggplot(subset(tstvs,MODEL %in% c("Ts","Tv")),aes(x=variable,y=value,group=MODEL,fill=MODEL)) + geom_bar(stat="identity",position = "stack") + tscol
ggplot(subset(tstvs,MODEL %in% c("Ts","Tv-ta","AT")),aes(x=variable,y=value,group=MODEL,fill=MODEL)) + geom_bar(stat="identity",position = "stack") + tscol
tstvs$MODEL <- ordered(tstvs$MODEL,levels =c("Ts","Tv","Tv-ta","AT"))
tstvs <- tstvs[order(tstvs$MODEL),]
ggplot(subset(tstvs,MODEL %in% c("Ts","Tv")),aes(x=variable,y=value,group=MODEL,fill=MODEL)) + geom_bar(stat="identity",position = "stack") + tscol
ggplot(subset(tstvs,MODEL %in% c("Ts","Tv-ta","AT")),aes(x=variable,y=value,group=MODEL,fill=MODEL)) + geom_bar(stat="identity",position = "stack") + tscol
ggplot(subset(tstvs,MODEL %in% c("Ts","Tv")),aes(x=variable,y=value,group=MODEL,fill=MODEL)) + geom_bar(stat="identity",position = "fill") + tscol
ggplot(subset(tstvs,MODEL %in% c("Ts","Tv-ta","AT")),aes(x=variable,y=value,group=MODEL,fill=MODEL)) + geom_bar(stat="identity",position = "fill") + tscol
ggplot(subset(tstvs,MODEL %in% c("Ts","Tv-ta")),aes(x=variable,y=value,group=MODEL,fill=MODEL)) + geom_bar(stat="identity",position = "fill") + tscol
cols <- c("dark blue","dark red","light blue","dark blue")
names(cols) <- c("Tv","Ts","Tv-ta","AT")
tscol <- scale_fill_manual(values = cols)
ggplot(subset(tstvs,MODEL %in% c("Ts","Tv")),aes(x=variable,y=value,group=MODEL,fill=MODEL)) + geom_bar(stat="identity",position = "stack") + tscol
ggplot(subset(tstvs,MODEL %in% c("Ts","Tv")),aes(x=variable,y=value,group=MODEL,fill=MODEL)) + geom_bar(stat="identity",position = "stack") + tscol
ggplot(subset(tstvs,MODEL %in% c("Ts","Tv-ta","AT")),aes(x=variable,y=value,group=MODEL,fill=MODEL)) + geom_bar(stat="identity",position = "stack") + tscol
ggplot(subset(tstvs,MODEL %in% c("Ts","Tv")),aes(x=variable,y=value,group=MODEL,fill=MODEL)) + geom_bar(stat="identity",position = "fill") + tscol
cols <- c("dark blue","#990000","light blue","dark blue")
names(cols) <- c("Tv","Ts","Tv-ta","AT")
tscol <- scale_fill_manual(values = cols)
ggplot(subset(tstvs,MODEL %in% c("Ts","Tv")),aes(x=variable,y=value,group=MODEL,fill=MODEL)) + geom_bar(stat="identity",position = "stack") + tscol
cols <- c("dark blue","#CC0000","light blue","dark blue")
names(cols) <- c("Tv","Ts","Tv-ta","AT")
tscol <- scale_fill_manual(values = cols)
ggplot(subset(tstvs,MODEL %in% c("Ts","Tv")),aes(x=variable,y=value,group=MODEL,fill=MODEL)) + geom_bar(stat="identity",position = "stack") + tscol
cols <- c("dark blue","#DD0000","light blue","dark blue")
names(cols) <- c("Tv","Ts","Tv-ta","AT")
tscol <- scale_fill_manual(values = cols)
ggplot(subset(tstvs,MODEL %in% c("Ts","Tv")),aes(x=variable,y=value,group=MODEL,fill=MODEL)) + geom_bar(stat="identity",position = "stack") + tscol
cols <- c("#0000DD","#DD0000","light blue","dark blue")
names(cols) <- c("Tv","Ts","Tv-ta","AT")
tscol <- scale_fill_manual(values = cols)
ggplot(subset(tstvs,MODEL %in% c("Ts","Tv")),aes(x=variable,y=value,group=MODEL,fill=MODEL)) + geom_bar(stat="identity",position = "stack") + tscol
cols <- c("#0000DD","#EE0000","light blue","dark blue")
names(cols) <- c("Tv","Ts","Tv-ta","AT")
tscol <- scale_fill_manual(values = cols)
ggplot(subset(tstvs,MODEL %in% c("Ts","Tv")),aes(x=variable,y=value,group=MODEL,fill=MODEL)) + geom_bar(stat="identity",position = "stack") + tscol
cols <- c("#0000DD","#EE0000","#8888FF","#0000DD")
names(cols) <- c("Tv","Ts","Tv-ta","AT")
tscol <- scale_fill_manual(values = cols)
ggplot(subset(tstvs,MODEL %in% c("Ts","Tv")),aes(x=variable,y=value,group=MODEL,fill=MODEL)) + geom_bar(stat="identity",position = "stack") + tscol
ggplot(subset(tstvs,MODEL %in% c("Ts","Tv-ta","AT")),aes(x=variable,y=value,group=MODEL,fill=MODEL)) + geom_bar(stat="identity",position = "stack") + tscol
cols <- c("#0000DD","#EE0000","#9999FF","#0000DD")
names(cols) <- c("Tv","Ts","Tv-ta","AT")
tscol <- scale_fill_manual(values = cols)
ggplot(subset(tstvs,MODEL %in% c("Ts","Tv")),aes(x=variable,y=value,group=MODEL,fill=MODEL)) + geom_bar(stat="identity",position = "stack") + tscol
ggplot(subset(tstvs,MODEL %in% c("Ts","Tv-ta","AT")),aes(x=variable,y=value,group=MODEL,fill=MODEL)) + geom_bar(stat="identity",position = "stack") + tscol
ggplot(subset(tstvs,MODEL %in% c("Ts","Tv")),aes(x=variable,y=value,group=MODEL,fill=MODEL)) + geom_bar(stat="identity",position = "fill") + tscol
ggplot(subset(tstvs,MODEL %in% c("Ts","Tv-ta","AT")),aes(x=variable,y=value,group=MODEL,fill=MODEL)) + geom_bar(stat="identity",position = "fill") + tscol
ggplot(subset(tstvs,MODEL %in% c("Ts","Tv-ta")),aes(x=variable,y=value,group=MODEL,fill=MODEL)) + geom_bar(stat="identity",position = "fill") + tscol
ggplot(subset(tstvs,!MODEL %in% c("Ts","Tv","total","Tv-ta")),aes(x=variable,y=value,group=MODEL,fill=MODEL)) + geom_bar(stat="identity",position = "dodge")
ggplot(alleles,aes(x=variable,y=value,group=MODEL,fill=MODEL)) + geom_bar(stat="identity",position = "dodge")
ggplot(alleles,aes(x=variable,y=value,group=MODEL,fill=MODEL)) + geom_bar(stat="identity",position = "stack")
ggplot(alleles,aes(x=variable,y=value,group=MODEL,fill=MODEL)) + geom_bar(stat="identity",position = "fill")
ggplot(alleles,aes(x=variable,y=value,group=MODEL,fill=MODEL)) + geom_bar(stat="identity",position = "fill")
alleles[order(alleles$MODEL),]
alleles <- alleles[order(alleles$MODEL),]
ggplot(alleles,aes(x=variable,y=value,group=MODEL,fill=MODEL)) + geom_bar(stat="identity",position = "dodge")
ggplot(alleles,aes(x=variable,y=value,group=MODEL,fill=MODEL)) + geom_bar(stat="identity",position = "stack")
ggplot(alleles,aes(x=variable,y=value,group=MODEL,fill=MODEL)) + geom_bar(stat="identity",position = "fill")
ggplot(alleles,aes(x=variable,y=value,group=MODEL,fill=MODEL)) + geom_bar(stat="identity",position = "fill")
ggplot(alleles,aes(x=variable,y=value,group=MODEL,fill=MODEL)) + geom_bar(stat="identity",position = "fill")
ggplot(subset(alleles,MODEL != "AT"),aes(x=variable,y=value,group=MODEL,fill=MODEL)) + geom_bar(stat="identity",position = "fill")
ggplot(alleles,aes(x=variable,y=value,group=MODEL,fill=MODEL)) + geom_bar(stat="identity",position = "dodge")
ggplot(alleles,aes(x=variable,y=value,group=MODEL,fill=MODEL)) + geom_bar(stat="identity",position = "stack")
ggplot(alleles,aes(x=variable,y=value,group=MODEL,fill=MODEL)) + geom_bar(stat="identity",position = "fill")
ggplot(subset(alleles,MODEL != "AT"),aes(x=variable,y=value,group=MODEL,fill=MODEL)) + geom_bar(stat="identity",position = "fill")
alleles <- alleles[order(alleles$MODEL),]
ggplot(alleles,aes(x=variable,y=value,group=MODEL,fill=MODEL)) + geom_bar(stat="identity",position = "dodge")
ggplot(alleles,aes(x=variable,y=value,group=MODEL,fill=MODEL)) + geom_bar(stat="identity",position = "stack")
ggplot(alleles,aes(x=variable,y=value,group=MODEL,fill=MODEL)) + geom_bar(stat="identity",position = "fill")
ggplot(subset(alleles,MODEL != "AT"),aes(x=variable,y=value,group=MODEL,fill=MODEL)) + geom_bar(stat="identity",position = "fill")
alleles$MODEL
alleles$MODEL <- factor(alleles$MODEL,levels=c("AT","AG","CT","AC","GT","CG"))
alleles$MODEL <- ordered(alleles$MODEL,levels=c("AT","AG","CT","AC","GT","CG"))
alleles <- alleles[order(alleles$MODEL),]
rainbow(6)
cols<-rainbow(6)
names(cols)<-levels(alleles$MODEL)
cols<-rainbow(6)
names(cols)<-levels(alleles$MODEL)
alcol <- scale_fill_manual(values = cols)
ggplot(alleles,aes(x=variable,y=value,group=MODEL,fill=MODEL)) + geom_bar(stat="identity",position = "dodge") + alcol
ggplot(alleles,aes(x=variable,y=value,group=MODEL,fill=MODEL)) + geom_bar(stat="identity",position = "dodge") + alcol
ggplot(alleles,aes(x=variable,y=value,group=MODEL,fill=MODEL)) + geom_bar(stat="identity",position = "stack") + alcol
ggplot(alleles,aes(x=variable,y=value,group=MODEL,fill=MODEL)) + geom_bar(stat="identity",position = "fill") + alcol
ggplot(subset(alleles,MODEL != "AT"),aes(x=variable,y=value,group=MODEL,fill=MODEL)) + geom_bar(stat="identity",position = "fill") + alcol
cols<-ggcolour(6)
names(cols)<-levels(alleles$MODEL)
alcol <- scale_fill_manual(values = cols)
alleles <- alleles[order(alleles$MODEL),]
ggplot(alleles,aes(x=variable,y=value,group=MODEL,fill=MODEL)) + geom_bar(stat="identity",position = "dodge") + alcol
ggplot(alleles,aes(x=variable,y=value,group=MODEL,fill=MODEL)) + geom_bar(stat="identity",position = "stack") + alcol
ggplot(alleles,aes(x=variable,y=value,group=MODEL,fill=MODEL)) + geom_bar(stat="identity",position = "dodge") + alcol
ggplot(alleles,aes(x=variable,y=value,group=MODEL,fill=MODEL)) + geom_bar(stat="identity",position = "stack") + alcol
ggplot(alleles,aes(x=variable,y=value,group=MODEL,fill=MODEL)) + geom_bar(stat="identity",position = "fill") + alcol
ggplot(subset(alleles,MODEL != "AT"),aes(x=variable,y=value,group=MODEL,fill=MODEL)) + geom_bar(stat="identity",position = "fill") + alcol
knit("tstv_taat_proportions.Rmd")
setwd("../151201_tstv_indel_ratios/")
system("ls")
library(ggplot2)
library(reshape2)
library(knitr)
```{r setup}
opts_chunk$set(fig.width=10, fig.height=9)
```
```{r}
reorder <- function(M,new_order) {
M[lower.tri(M)] = t(M)[lower.tri(M)]
M <- M[new_order,new_order]
#  M[lower.tri(M)] <- NA
M
}
sym <- function(M) {
M[lower.tri(M)] = t(M)[lower.tri(M)]
M
}
ggcolour <- function(n) {
hues = seq(15, 375, length=n+1)
hcl(h=hues, l=65, c=100)[1:n]
}
tree_order <- c(
"Th166.12", "Th246.13", "Th245.13", "Th211.13" ,"Th092.13" ,
"Th086.07", "Th106.09",  "Th230.12","Th074.13", "Th132.11","Th162.12","Th196.12", "Th106.11", "Th117.11", "Th134.11",
"Th068.12", "Th061.13", "Th095.13"
)
clades <- c(
rep(2,5),
rep(3,10),
rep(1,3))
names(clades)<-tree_order
clades
```
```{r}
tstv <- read.table("Thies_all_manual.PASS.Cls.miss0.5.LMRG.HAP.MKSNGL.DISCORD.tstv.tab.txt",header=T,row.names=1,sep="\t")
tstv <- reorder(tstv,tree_order)
tstv[lower.tri(tstv)] <- NA
diag(tstv)<-0
tstv
indel <- read.table("Thies_all_manual.PASS.Cls.miss0.5.LMRG.HAP.MKSNGL.DISCORD.in-del.tab.txt",header=T,row.names=1,sep="\t")
indel <- reorder(indel,tree_order)
diag(indel) <- 0
indel
indelsnp <- read.table("Thies_all_manual.PASS.Cls.miss0.5.LMRG.HAP.MKSNGL.DISCORD.indel-snp.tab.txt",header=T,row.names=1,sep="\t")
indelsnp <- reorder(indelsnp,tree_order)
indelsnp[lower.tri(indelsnp)] <- NA
indelsnp
taat <- read.table("Thies_all_manual.PASS.Cls.miss0.5.LMRG.HAP.MKSNGL.DISCORD.taat.tab.txt",header=T,row.names=1,sep="\t")
taat <- reorder(taat,tree_order)
taat[lower.tri(taat)] <- NA
taat
total_dist <- read.table("Thies_all_manual.PASS.Cls.miss0.5.LMRG.HAP.MKSNGL.DISCORD.dist.tab.txt",header=T,row.names=1,sep="\t")
total_dist <- reorder(total_dist,tree_order)
total_dist[lower.tri(total_dist)] <- NA
total_dist
```
```{r}
vartypes <- merge(
merge(
merge(
melt(as.matrix(taat),value.name ="taat",factorsAsStrings = T),
melt(as.matrix(tstv),value.name ="tstv",factorsAsStrings = T),
by=c("Var1","Var2")
),
merge(
melt(as.matrix(indel),value.name ="indel",factorsAsStrings = T),
melt(as.matrix(indelsnp),value.name ="indelsnp",factorsAsStrings = T),
by=c("Var1","Var2")
),
by=c("Var1","Var2")
),
melt(as.matrix(total_dist),value.name ="total",factorsAsStrings = T),
by=c("Var1","Var2")
)
head(vartypes)
#vartypes <- vartypes[vartypes$Var1!=vartypes$Var2,]
#vartypes <- vartypes[!is.na(vartypes$total),]
vartypes$clade1 <- clades[vartypes$Var1]
vartypes$clade2 <- clades[vartypes$Var2]
vartypes$clades <- paste(clades[vartypes$Var1],clades[vartypes$Var2])
vartypes$interval_yrs <- abs(as.numeric(substr(as.character(vartypes$Var1),7,8)) - as.numeric(substr(as.character(vartypes$Var2),7,8)))
vartypes$related[vartypes$clade1 != vartypes$clade2] <- "UNRELATED"
vartypes$related[vartypes$clade1 == vartypes$clade2] <- "RELATED"
#vartypes$IBD <- vartypes$total < 2100
vartypes$Var1 <- factor(vartypes$Var1,levels=rev(tree_order))
vartypes$Var2 <- factor(vartypes$Var2,levels=rev(tree_order))
head(vartypes)
relcol <- scale_color_manual(values=c("white","black"))
vxlab <- theme(axis.text.x = element_text(angle = 90, hjust = 1))
#total pairwise distance
ggplot(subset(vartypes,!is.na(total)),aes(x=Var1,y=Var2,fill=total,label=total,colour=related)) + geom_tile() + scale_fill_gradient(trans="log") + geom_text(size=4) + relcol + vxlab
ggplot(subset(vartypes,!is.na(total)),aes(x=Var1,y=Var2,fill=total,label=total,colour=related)) + geom_tile() + scale_fill_gradient(trans="log") + geom_text(size=4) + relcol + vxlab
#Ts:Tv ratio
ggplot(subset(vartypes,!is.na(tstv)),aes(x=Var1,y=Var2,fill=tstv,label=tstv)) + geom_tile() + scale_fill_gradient(trans="log") + geom_text(size=4,colour="white") + relcol + vxlab
ggplot(subset(vartypes,tstv > 0),aes(x=total,y=tstv,colour=related)) + geom_point() + vxlab + ylim(0,5)
ggplot(subset(vartypes,tstv > 0),aes(x=total,y=indel,colour=related)) + geom_point() + vxlab + scale_y_log10(limits=c(0.5,2))
ggplot(subset(vartypes,tstv > 0),aes(x=indel,y=tstv,colour=related,size=1/total)) + geom_point() + vxlab + scale_x_log10(limits=c(0.5,2))
ggplot(subset(vartypes,tstv > 0),aes(x=indel,y=tstv,colour=related,size=1/total)) + geom_point() + vxlab + scale_x_log10(limits=c(0.5,2))
knit("tstv_indel_ratios.DISCORD.Rmd")
knit("tstv_indel_ratios.DISCORD.Rmd")
knit("tstv_indel_ratios.DISCORD.Rmd")
knit("tstv_indel_ratios.ALL.Rmd")
knit("tstv_indel_ratios.DISCORD.Rmd","tstv_indel_ratios.DISCORD.md")
knit("tstv_indel_ratios.ALL.Rmd")
knit("tstv_indel_ratios.ALL.Rmd")
knit("tstv_indel_ratios.DISCORD.Rmd")
knit("tstv_indel_ratios.DISCORD.Rmd")
knit("tstv_indel_ratios.ALL.Rmd")
ggplot(subset(vartypes,!is.na(total)),aes(x=Var1,y=Var2,fill=total,label=total,colour=related)) + geom_tile() + scale_fill_gradient(trans="log") + geom_text(size=4) + relcol + vxlab
#ggplot(subset(vartypes,!is.na(total)),aes(x=Var1,y=Var2,fill=total,label=total,colour=related)) + geom_tile() + scale_fill_gradient(trans="log") + geom_text(size=4) + relcol + vxlab
ggplot(subset(vartypes,!is.na(total) & related=="RELATED"),aes(x=Var1,y=Var2,fill=total,label=total,colour=related)) + geom_tile() + scale_fill_gradient(trans="log") + geom_text(size=4) + relcol + vxlab
ggplot(subset(vartypes,!is.na(total) & related=="RELATED"),aes(x=Var1,y=Var2,fill=total,label=total,colour=related)) + geom_tile() + scale_fill_gradient(trans="log") + geom_text(size=4) + relcol + vxlab + theme(axis.text=element_text(size=12))
ggplot(subset(vartypes,!is.na(total) & related=="RELATED"),aes(x=Var1,y=Var2,fill=total,label=total,colour=related)) + geom_tile() + scale_fill_gradient(trans="log") + geom_text(size=4) + relcol + vxlab + theme(axis.text=element_text(size=12, face="bold"))
ggplot(subset(vartypes,!is.na(total) & related=="RELATED"),aes(x=Var1,y=Var2,fill=total,label=total,colour=related)) + geom_tile() + scale_fill_gradient(trans="log") + geom_text(size=4) + relcol + vxlab + theme(axis.text=element_text(size=14, face="bold"))
ggplot(subset(vartypes,!is.na(total) & related=="RELATED"),aes(x=Var1,y=Var2,fill=total,label=total,colour=related)) + geom_tile() + scale_fill_gradient(trans="log") + geom_text(size=4) + relcol + vxlab + theme(axis.text=element_text(size=20, face="bold"))
distances <- ggplot(subset(vartypes,!is.na(total) & related=="RELATED"),aes(x=Var1,y=Var2,fill=total,label=total,colour=related)) + geom_tile() + scale_fill_gradient(trans="log") + geom_text(size=4) + relcol + vxlab + theme(axis.text=element_text(size=14, face="bold"))
ggsave("~/Desktop/allDistancesThiesRelated.png",height=500,width=600,units="px")
ggsave("~/Desktop/allDistancesThiesRelated.png",height=500,width=600,units="mm")
ggsave("~/Desktop/allDistancesThiesRelated.png",height=300,width=330,units="mm")
ggsave("~/Desktop/allDistancesThiesRelated.png",distances,height=300,width=330,units="mm")
ggplot(subset(vartypes,!is.na(total) & clades=="1 1"),aes(x=Var1,y=Var2,fill=total,label=total,colour=related)) + geom_tile() + scale_fill_gradient(trans="log") + geom_text(size=4) + relcol + vxlab + theme(axis.text=element_text(size=14, face="bold"))
ggplot(subset(vartypes,!is.na(total) & related=="RELATED"),aes(x=Var1,y=Var2,fill=total,label=total,colour=related)) + geom_tile() + scale_fill_gradient(trans="log") + geom_text(size=4) + relcol + vxlab + theme(axis.text=element_text(size=14, face="bold")) + facet_grid(. ~ clades)
ggplot(subset(vartypes,!is.na(total) & related=="RELATED"),aes(x=Var1,y=Var2,fill=total,label=total,colour=related)) + geom_tile() + scale_fill_gradient(trans="log") + geom_text(size=4) + relcol + vxlab + theme(axis.text=element_text(size=14, face="bold")) + facet_grid(. ~ clades, scales="free")
ggplot(subset(vartypes,!is.na(total) & related=="RELATED"),aes(x=Var1,y=Var2,fill=total,label=total,colour=related)) + geom_tile() + scale_fill_gradient(trans="log") + geom_text(size=4) + relcol + vxlab + theme(axis.text=element_text(size=14, face="bold")) + facet_grid(clade1 ~ clade2, scales="free")
c1 <- ggplot(subset(vartypes,!is.na(total) & clades=="1 1"),aes(x=Var1,y=Var2,fill=total,label=total,colour=related)) + geom_tile() + scale_fill_gradient(trans="log") + geom_text(size=4) + relcol + vxlab + theme(axis.text=element_text(size=14, face="bold"))
c2 <- ggplot(subset(vartypes,!is.na(total) & clades=="2 2"),aes(x=Var1,y=Var2,fill=total,label=total,colour=related)) + geom_tile() + scale_fill_gradient(trans="log") + geom_text(size=4) + relcol + vxlab + theme(axis.text=element_text(size=14, face="bold"))
c3 <- ggplot(subset(vartypes,!is.na(total) & clades=="3 3"),aes(x=Var1,y=Var2,fill=total,label=total,colour=related)) + geom_tile() + scale_fill_gradient(trans="log") + geom_text(size=4) + relcol + vxlab + theme(axis.text=element_text(size=14, face="bold"))
ggsave("~/Desktop/allDistancesThiesRelated.c1.png",c1,height=100,width=110,units="mm")
ggsave("~/Desktop/allDistancesThiesRelated.c2.png",c2,height=100,width=110,units="mm")
setwd("../151125_doubletonSharing/")
library(ggplot2)
library(reshape2)
library(knitr)
```{r setup}
opts_chunk$set(fig.width=10, fig.height=9)
```
```{r}
reorder <- function(M,new_order) {
M[lower.tri(M)] = t(M)[lower.tri(M)]
M <- M[new_order,new_order]
M[lower.tri(M)] <- NA
M
}
sym <- function(M) {
M[lower.tri(M)] = t(M)[lower.tri(M)]
M
}
ggcolour <- function(n) {
hues = seq(15, 375, length=n+1)
hcl(h=hues, l=65, c=100)[1:n]
}
tree_order <- c(
"Th166.12", "Th246.13", "Th245.13", "Th211.13" ,"Th092.13" ,
"Th086.07", "Th106.09",  "Th230.12","Th074.13", "Th132.11","Th162.12","Th196.12", "Th106.11", "Th117.11", "Th134.11",
"Th068.12", "Th061.13", "Th095.13"
)
clades <- c(
rep(2,5),
rep(3,10),
rep(1,3))
names(clades)<-tree_order
clades
```
```{r}
doubletons <- read.table("sharedDoubles_thies.txt",header=T,row.names=1,sep="\t")
total_dist <- read.table("Thies_manual.nj.dist.tab.txt",header=T,row.names=1,sep="\t")
doubletons <- reorder(doubletons,tree_order)
total_dist <- reorder(total_dist,tree_order)
distances <- merge(
melt(as.matrix(total_dist),value.name ="total",factorsAsStrings = T),
melt(as.matrix(doubletons),value.name ="doubletons",factorsAsStrings = T),
by=c("Var1","Var2")
)
distances
#distances <- distances[distances$Var1!=distances$Var2,]
distances <- distances[!is.na(distances$total),]
distances$clade1 <- clades[distances$Var1]
distances$clade2 <- clades[distances$Var2]
distances$clades <- paste(clades[distances$Var1],clades[distances$Var2])
distances$interval_yrs <- abs(as.numeric(substr(as.character(distances$Var1),7,8)) - as.numeric(substr(as.character(distances$Var2),7,8)))
#distances$related <- distances$total < 10000
distances$related[distances$total >= 10000] <- "UNRELATED"
distances$related[distances$total < 10000] <- "RELATED"
distances$IBD <- distances$total < 2100
distances$Var1 <- factor(distances$Var1,levels=rev(tree_order))
distances$Var2 <- factor(distances$Var2,levels=rev(tree_order))
relcol <- scale_color_manual(values=c("white","black"))
vxlab <- theme(axis.text.x = element_text(angle = 90, hjust = 1))
ggplot(distances,aes(x=Var1,y=Var2,fill=total,label=total,colour=related)) + geom_tile() + scale_fill_gradient(trans="log") + geom_text(size=3) + relcol + vxlab
total_dist <- read.table("Thies_all_manual.PASS.Cls.miss0.5.LMRG.HAP.MKSNGL.dist.tab.txt",header=T,row.names=1,sep="\t")
doubletons <- reorder(doubletons,tree_order)
total_dist <- reorder(total_dist,tree_order)
distances <- merge(
melt(as.matrix(total_dist),value.name ="total",factorsAsStrings = T),
melt(as.matrix(doubletons),value.name ="doubletons",factorsAsStrings = T),
by=c("Var1","Var2")
)
distances
#distances <- distances[distances$Var1!=distances$Var2,]
distances <- distances[!is.na(distances$total),]
distances$clade1 <- clades[distances$Var1]
distances$clade2 <- clades[distances$Var2]
distances$clades <- paste(clades[distances$Var1],clades[distances$Var2])
distances$interval_yrs <- abs(as.numeric(substr(as.character(distances$Var1),7,8)) - as.numeric(substr(as.character(distances$Var2),7,8)))
#distances$related <- distances$total < 10000
distances$related[distances$total >= 10000] <- "UNRELATED"
distances$related[distances$total < 10000] <- "RELATED"
distances$IBD <- distances$total < 2100
distances$Var1 <- factor(distances$Var1,levels=rev(tree_order))
distances$Var2 <- factor(distances$Var2,levels=rev(tree_order))
```
relcol <- scale_color_manual(values=c("white","black"))
vxlab <- theme(axis.text.x = element_text(angle = 90, hjust = 1))
ggplot(distances,aes(x=Var1,y=Var2,fill=total,label=total,colour=related)) + geom_tile() + scale_fill_gradient(trans="log") + geom_text(size=3) + relcol + vxlab
ggplot(distances,aes(x=Var1,y=Var2,fill=doubletons,label=doubletons,colour=doubletons)) + geom_tile() + scale_fill_gradient(trans="log") + geom_text(size=5) +  vxlab + scale_colour_gradient(low="white",high="red")
ggplot(subset(distances,related=="RELATED"),aes(x=Var1,y=Var2,fill=doubletons,label=doubletons,colour=doubletons)) + geom_tile() + scale_fill_gradient(trans="log") + geom_text(size=5) +  vxlab + scale_colour_gradient(low="white",high="red")
singletons <- read.table("Thies_all_manual.PASS.Cls.miss0.5.LMRG.HAP.DISCORDS.singletonCounts",header=F,row.names=1,sep=":")
singletons
singletons[tree_order]
tree_order
singletons[tree_order,]
names(singletons[tree_order,])
singletons <- singletons[tree_order,]
singletons
names(singletons) <- tree_order
singletons
ggplot(singletons) + geom_bar()
singletons <- read.table("Thies_all_manual.PASS.Cls.miss0.5.LMRG.HAP.DISCORDS.singletonCounts",header=F,sep=":")
singletons <- singletons[tree_order,]
names(singletons) <- tree_order
rownames(singletons) <- tree_order
singletons
singletons <- read.table("Thies_all_manual.PASS.Cls.miss0.5.LMRG.HAP.DISCORDS.singletonCounts",header=F,sep=":")
singletons
singletons[tree_order,]
rownames(singletons) <- singletons$V1
singletons <- singletons[tree_order,]
singletons
singletons <- read.table("Thies_all_manual.PASS.Cls.miss0.5.LMRG.HAP.DISCORDS.singletonCounts",header=F,sep=":")
singletons
rownames(singletons) <- singletons$V1
singletons <- singletons[tree_order,]
ggplot(singletons,aes(x=V1,y=V2) + geom_bar()
)
ggplot(singletons,aes(x=V1,y=V2)) + geom_bar(stat="identity")
ggplot(singletons,aes(y=V1,x=V2)) + geom_bar(stat="identity")
colnames(singletons) <- c("sample","singletons")
colnames(singletons) <- c("sample","count")
colnames(singletons) <- c("sample","sing_count")
singletons <- cbind(singletons,clades)
ggplot(singletons,aes(x=V1,y=V2,fill=clades)) + geom_bar(stat="identity")
ggplot(singletons,aes(x=sample,y=count,fill=clades)) + geom_bar(stat="identity")
ggplot(singletons,aes(x=sample,y=singcount,fill=clades)) + geom_bar(stat="identity")
singletons
ggplot(singletons,aes(x=sample,y=sing_count,fill=clades)) + geom_bar(stat="identity")
ggplot(singletons,aes(x=sample,y=sing_count,fill=as.factor(clades))) + geom_bar(stat="identity")
singletons <- read.table("Thies_all_manual.PASS.Cls.miss0.5.LMRG.HAP.DISCORDS.singletonCounts",header=F,sep=":")
rownames(singletons) <- singletons$V1
colnames(singletons) <- c("sample","sing_count")
singletons <- singletons[tree_order,]
clades
singletons
clades
cbind(singletons,clades)
singletons <- cbind(singletons,clades)
singletons$sample <- ordered(singletons$factor,levels=singletons$factor)
ordered(singletons$factor,levels=singletons$factor)
singletons <- read.table("Thies_all_manual.PASS.Cls.miss0.5.LMRG.HAP.DISCORDS.singletonCounts",header=F,sep=":")
rownames(singletons) <- singletons$V1
colnames(singletons) <- c("sample","sing_count")
singletons <- singletons[tree_order,]
ordered(singletons$factor,levels=singletons$factor)
singletons$sample <- ordered(singletons$factor)
singletons <- read.table("Thies_all_manual.PASS.Cls.miss0.5.LMRG.HAP.DISCORDS.singletonCounts",header=F,sep=":")
rownames(singletons) <- singletons$V1
colnames(singletons) <- c("sample","sing_count")
singletons <- singletons[tree_order,]
ordered(singletons$factor)
singletons$factor
ordered(singletons$sample)
ordered(singletons$sample,levels=tree_order)
singletons <- read.table("Thies_all_manual.PASS.Cls.miss0.5.LMRG.HAP.DISCORDS.singletonCounts",header=F,sep=":")
rownames(singletons) <- singletons$V1
colnames(singletons) <- c("sample","sing_count")
singletons <- singletons[tree_order,]
singletons$sample <- ordered(singletons$sample,levels=tree_order)
singletons <- cbind(singletons,clades)
ggplot(singletons,aes(x=sample,y=sing_count,fill=as.factor(clades))) + geom_bar(stat="identity")
ggplot(singletons,aes(x=sample,y=sing_count,fill=as.factor(clades))) + geom_bar(stat="identity") + vxlab
ggplot(singletons,aes(x=sample,y=sing_count,fill=as.factor(clades))) + geom_bar(stat="identity") + vxlab + coord_flip()
colnames(singletons) <- c("sample","singletons")
singletons <- read.table("Thies_all_manual.PASS.Cls.miss0.5.LMRG.HAP.DISCORDS.singletonCounts",header=F,sep=":")
rownames(singletons) <- singletons$V1
colnames(singletons) <- c("sample","singletons")
singletons <- singletons[tree_order,]
singletons$sample <- ordered(singletons$sample,levels=tree_order)
singletons <- cbind(singletons,clades)
ggplot(singletons,aes(x=sample,y=singletons,fill=as.factor(clades))) + geom_bar(stat="identity") + vxlab + coord_flip()
ggplot(singletons,aes(x=sample,y=singletons,fill=as.factor(clades))) + geom_bar(stat="identity") + vxlab + coord_flip() + scale_fill_manual(values = c("red","green","blue"))
ggplot(singletons,aes(x=sample,y=singletons,fill=as.factor(clades))) + geom_bar(stat="identity") + vxlab + coord_flip() + scale_fill_manual(values = c("red","blue","green"))
singletons <- read.table("Thies_all_manual.PASS.Cls.miss0.5.LMRG.HAP.DISCORDS.singletonCounts",header=F,sep=":")
rownames(singletons) <- singletons$V1
colnames(singletons) <- c("sample","singletons")
singletons <- singletons[tree_order,]
singletons$sample <- ordered(singletons$sample,levels=reverse(tree_order))
rev(tree_order)
singletons$sample <- ordered(singletons$sample,levels=rev(tree_order))
singletons <- cbind(singletons,clades)
source('~/.active-rstudio-document', echo=TRUE)
ggplot(singletons,aes(x=sample,y=singletons,fill=as.factor(clades))) + geom_bar(stat="identity") + vxlab + coord_flip() + scale_fill_manual(values = c("red","blue","green"))
ggplot(subset(vartypes,!is.na(total) & related=="RELATED"),aes(x=Var1,y=Var2,fill=total,label=total,colour=related)) + geom_tile() + scale_fill_gradient(trans="log") + geom_text(size=4) + relcol + vxlab +
\c
ggplot(singletons,aes(x=sample,y=singletons,fill=as.factor(clades))) + geom_bar(stat="identity") + vxlab + coord_flip() + scale_fill_manual(values = c("red","blue","green")) + theme(axis.text=element_text(size=20, face="bold"))
ggplot(singletons,aes(x=sample,y=singletons,fill=as.factor(clades))) + geom_bar(stat="identity") + vxlab + coord_flip() + scale_fill_manual(values = c("red","blue","green")) + theme(axis.text=element_text(size=14, face="bold"))
ggplot(singletons,aes(x=sample,y=singletons,fill=as.factor(clades))) + geom_bar(stat="identity") + vxlab + coord_flip() + scale_fill_manual(values = c("red","blue","green")) +  theme(axis.text=element_text(size=14, face="bold"))
ggplot(singletons,aes(x=sample,y=singletons,fill=as.factor(clades))) + geom_bar(stat="identity") + vxlab + coord_flip() + scale_fill_manual(values = c("red","blue","green")) +  theme(axis.text=element_text(size=14, face="bold"),axis.line=element_blank())
ggplot(singletons,aes(x=sample,y=singletons,fill=as.factor(clades))) + geom_bar(stat="identity") + vxlab + coord_flip() + scale_fill_manual(values = c("red","blue","green")) +  theme(axis.text=element_text(size=14, face="bold"),axis.label=element_blank())
ggplot(singletons,aes(x=sample,y=singletons,fill=as.factor(clades))) + geom_bar(stat="identity") + vxlab + coord_flip() + scale_fill_manual(values = c("red","blue","green")) +  theme(axis.text=element_text(size=14, face="bold"),axis.title=element_blank())
knit("doubletonSharing.Rmd")
ggplot(distances,aes(x=interval_yrs,y=ratio,colour=related,label=clades)) + geom_text(size=4) +
geom_smooth(aes(group=related,colour=related), method="lm",se=F) + facet_grid(. ~ related,scale="free_x") + ylim(0,1.5)
ggplot(distances,aes(x=total,y=doubletons,colour=related)) + geom_point() + scale_x_log10() + facet_grid(. ~ related)
ggplot(subset(distances,related=="RELATED"),aes(x=total,y=doubletons,colour=related)) + geom_point() + scale_x_log10() + facet_grid(. ~ related)
ggplot(subset(distances,related=="UNRELATED"),aes(x=total,y=doubletons,colour=related)) + geom_point() + scale_x_log10() + facet_grid(. ~ related)
ggplot(distances,aes(x=Var1,y=Var2,fill=doubletons,label=doubletons,colour=doubletons)) + geom_tile() + scale_fill_gradient(trans="log") + geom_text(size=5) +  vxlab + scale_colour_gradient(low="white",high="red")
ggplot(subset(distances,related=="RELATED"),aes(x=Var1,y=Var2,fill=doubletons,label=doubletons,colour=doubletons)) + geom_tile() + scale_fill_gradient(trans="log") + geom_text(size=5) +  vxlab + scale_colour_gradient(low="white",high="red")
