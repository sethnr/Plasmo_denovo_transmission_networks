cxcol <- scale_fill_gradientn(colors = c("black","black","red","grey","dark green","black","black"),
values =colscale,na.value = NA,
breaks =c(-1000,-500,0,500,1000),
labels=c(500,250,0,500,1000),
limits=c(-1000,1000))
ggplot(data=callCfCX,aes(x=from,y=to,fill=value,label=value)) +
geom_tile(data=subset(callCfCX,variable=="both"),size=1) +
geom_text(data=subset(callCfCX,variable=="both"), size=3,colour="white") +
geom_tile(data=subset(callCfCX,variable=="extended"),aes(x=to,y=from,fill=value*-2),size=1) +
geom_text(data=subset(callCfCX,variable=="extended"),aes(x=to,y=from,label=value), size=3,colour="white") +
facet_grid(. ~ prog) + cxcol + vxlab + vxleg
cxcol <- scale_fill_gradientn(colors = c("black","red","grey","dark green","black"),
values =colscale,na.value = NA,
breaks =c(-1000,-500,0,500,1000),
labels=c(500,250,0,500,1000),
limits=c(-1000,1000))
ggplot(data=callCfCX,aes(x=from,y=to,fill=value,label=value)) +
geom_tile(data=subset(callCfCX,variable=="both"),size=1) +
geom_text(data=subset(callCfCX,variable=="both"), size=3,colour="white") +
geom_tile(data=subset(callCfCX,variable=="extended"),aes(x=to,y=from,fill=value*-2),size=1) +
geom_text(data=subset(callCfCX,variable=="extended"),aes(x=to,y=from,label=value), size=3,colour="white") +
facet_grid(. ~ prog) + cxcol + vxlab + vxleg
iscol <- scale_fill_gradientn(colors = c("black","orange","grey","blue","black"),
values =colscale,na.value = NA,
breaks =c(-500,-200,0,200,500),
labels=c(5000,200,0,200,500),
limits=c(-1500,1500),
na.value="black")
cxcol <- scale_fill_gradientn(colors = c("black","red","grey","dark green","black"),
values =colscale,na.value = NA,
breaks =c(-1000,-500,0,500,1000),
labels=c(500,250,0,500,1000),
limits=c(-1000,1000),
na.value="black")
cxcol <- scale_fill_gradientn(colors = c("black","red","grey","dark green","black"),
values =colscale,na.value = NA,
breaks =c(-1000,-500,0,500,1000),
labels=c(500,250,0,500,1000),
limits=c(-1000,1000),
na.value="black")
cxcol <- scale_fill_gradientn(colors = c("black","red","grey","dark green","black"),
values =colscale,na.value = NA,
breaks =c(-1000,-500,0,500,1000),
labels=c(500,250,0,500,1000),
limits=c(-1000,1000),
na.value="0")
cxcol <- scale_fill_gradientn(colors = c("black","red","grey","dark green","black"),
values =colscale,na.value = NA,
breaks =c(-1000,-500,0,500,1000),
labels=c(500,250,0,500,1000),
limits=c(-1000,1000),
na.value="#000000")
cxcol <- scale_fill_gradientn(na.value="#000000",colors = c("black","red","grey","dark green","black"),
values =colscale,na.value = NA,
breaks =c(-1000,-500,0,500,1000),
labels=c(500,250,0,500,1000),
limits=c(-1000,1000),
)
cxcol <- scale_fill_gradientn(colors = c("black","red","grey","dark green","black"),
values =colscale,na.value = NA,
breaks =c(-1000,-500,0,500,1000),
labels=c(500,250,0,500,1000),
limits=c(-1000,1000),
navalue="#000000")
cxcol <- scale_fill_gradientn(colors = c("black","red","grey","dark green","black"),
values =colscale,na.value = NA,
breaks =c(-1000,-500,0,500,1000),
labels=c(500,250,0,500,1000),
limits=c(-1000,1000),
na.value=0)
cxcol <- scale_fill_gradientn(colors = c("black","red","grey","dark green","black"),
values =colscale,na.value = "black",
breaks =c(-1000,-500,0,500,1000),
labels=c(500,250,0,500,1000),
limits=c(-1000,1000))
ggplot(data=callCfCX,aes(x=from,y=to,fill=value,label=value)) +
geom_tile(data=subset(callCfCX,variable=="both"),size=1) +
geom_text(data=subset(callCfCX,variable=="both"), size=3,colour="white") +
geom_tile(data=subset(callCfCX,variable=="extended"),aes(x=to,y=from,fill=value*-2),size=1) +
geom_text(data=subset(callCfCX,variable=="extended"),aes(x=to,y=from,label=value), size=3,colour="white") +
facet_grid(. ~ prog) + cxcol + vxlab + vxleg
iscol <- scale_fill_gradientn(colors = c("black","orange","grey","blue","black"),
values =colscale,na.value = NA,
breaks =c(-500,-200,0,200,500),
labels=c(5000,200,0,200,500),
limits=c(-1500,1500),
na.value="black")
ggplot(data=callCfSI,aes(x=from,y=to,fill=value,label=value)) +
geom_tile(data=subset(callCfSI,variable=="snp"),size=1) +
geom_text(data=subset(callCfSI,variable=="snp"), size=3,colour="white") +
geom_tile(data=subset(callCfSI,variable=="indel"),aes(x=to,y=from,fill=value*-1),size=1) +
geom_text(data=subset(callCfSI,variable=="indel"),aes(x=to,y=from,label=value), size=3,colour="white") +
facet_grid(. ~ prog) + iscol + vxlab +theme(legend.position="bottom") + vxleg
iscol <- scale_fill_gradientn(colors = c("black","orange","grey","blue","black"),
values =colscale,na.value = "black",
breaks =c(-500,-200,0,250,500),
labels=c(1000,500,0,250,500),
limits=c(-1000,1000),
na.value="black")
iscol <- scale_fill_gradientn(colors = c("black","orange","grey","blue","black"),
values =colscale,na.value = "black",
breaks =c(-500,-200,0,250,500),
labels=c(1000,500,0,250,500),
limits=c(-1000,1000))
ggplot(data=callCfSI,aes(x=from,y=to,fill=value,label=value)) +
geom_tile(data=subset(callCfSI,variable=="snp"),size=1) +
geom_text(data=subset(callCfSI,variable=="snp"), size=3,colour="white") +
geom_tile(data=subset(callCfSI,variable=="indel"),aes(x=to,y=from,fill=value*-1),size=1) +
geom_text(data=subset(callCfSI,variable=="indel"),aes(x=to,y=from,label=value), size=3,colour="white") +
facet_grid(. ~ prog) + iscol + vxlab +theme(legend.position="bottom") + vxleg
colscale <- (c(-500,-0.001,0,0.001,500)+500)/(500+500)
cxcol <- scale_fill_gradientn(colors = c("black","red","grey","dark green","black"),
values =colscale,na.value = "black",
breaks =c(-1000,-500,0,500,1000),
labels=c(500,250,0,500,1000),
limits=c(-1000,1000))
ggplot(data=callCfCX,aes(x=from,y=to,fill=value,label=value)) +
geom_tile(data=subset(callCfCX,variable=="both"),size=1) +
geom_text(data=subset(callCfCX,variable=="both"), size=3,colour="white") +
geom_tile(data=subset(callCfCX,variable=="extended"),aes(x=to,y=from,fill=value*-2),size=1) +
geom_text(data=subset(callCfCX,variable=="extended"),aes(x=to,y=from,label=value), size=3,colour="white") +
facet_grid(. ~ prog) + cxcol + vxlab + vxleg
iscol <- scale_fill_gradientn(colors = c("black","orange","grey","blue","black"),
values =colscale,na.value = "black",
breaks =c(-500,-200,0,250,500),
labels=c(1000,500,0,250,500),
limits=c(-1000,1000))
ggplot(data=callCfSI,aes(x=from,y=to,fill=value,label=value)) +
geom_tile(data=subset(callCfSI,variable=="snp"),size=1) +
geom_text(data=subset(callCfSI,variable=="snp"), size=3,colour="white") +
geom_tile(data=subset(callCfSI,variable=="indel"),aes(x=to,y=from,fill=value*-1),size=1) +
geom_text(data=subset(callCfSI,variable=="indel"),aes(x=to,y=from,label=value), size=3,colour="white") +
facet_grid(. ~ prog) + iscol + vxlab +theme(legend.position="bottom") + vxleg
iscol <- scale_fill_gradientn(colors = c("black","orange","grey","blue","black"),
values =colscale,na.value = "black",
breaks =c(-500,-200,0,250,500),
labels=c(1000,500,0,250,500),
limits=c(-1000,1000))
ggplot(data=callCfSI,aes(x=from,y=to,fill=value,label=value)) +
geom_tile(data=subset(callCfSI,variable=="snp"),size=1) +
geom_text(data=subset(callCfSI,variable=="snp"), size=3,colour="white") +
geom_tile(data=subset(callCfSI,variable=="indel"),aes(x=to,y=from,fill=value*-1),size=1) +
geom_text(data=subset(callCfSI,variable=="indel"),aes(x=to,y=from,label=value), size=3,colour="white") +
facet_grid(. ~ prog) + iscol + vxlab +theme(legend.position="bottom") + vxleg
iscol <- scale_fill_gradientn(colors = c("black","orange","grey","blue","black"),
values =colscale,na.value = "black",
breaks =c(-500,-250,0,250,500),
labels=c(500,250,0,250,500),
limits=c(-500,500))
ggplot(data=callCfSI,aes(x=from,y=to,fill=value,label=value)) +
geom_tile(data=subset(callCfSI,variable=="snp"),size=1) +
geom_text(data=subset(callCfSI,variable=="snp"), size=3,colour="white") +
geom_tile(data=subset(callCfSI,variable=="indel"),aes(x=to,y=from,fill=value*-1),size=1) +
geom_text(data=subset(callCfSI,variable=="indel"),aes(x=to,y=from,label=value), size=3,colour="white") +
facet_grid(. ~ prog) + iscol + vxlab +theme(legend.position="bottom") + vxleg
iscol <- scale_fill_gradientn(colors = c("black","orange","grey","blue","black"),
values =colscale,na.value = "black",
breaks =c(-1000,-250,0,250,1000),
labels=c(1000,250,0,250,1000),
limits=c(-1000,1000))
ggplot(data=callCfSI,aes(x=from,y=to,fill=value,label=value)) +
geom_tile(data=subset(callCfSI,variable=="snp"),size=1) +
geom_text(data=subset(callCfSI,variable=="snp"), size=3,colour="white") +
geom_tile(data=subset(callCfSI,variable=="indel"),aes(x=to,y=from,fill=value*-1),size=1) +
geom_text(data=subset(callCfSI,variable=="indel"),aes(x=to,y=from,label=value), size=3,colour="white") +
facet_grid(. ~ prog) + iscol + vxlab +theme(legend.position="bottom") + vxleg
knit("Correlations.Rmd")
ggplot(data=callCfSI,aes(x=from,y=to,fill=value,label=value)) +
geom_tile(data=subset(callCfSI,variable=="snp"),size=1) +
geom_text(data=subset(callCfSI,variable=="snp"), size=3,colour="white") +
geom_tile(data=subset(callCfSI,variable=="indel"),aes(x=to,y=from,fill=value*-1),size=1) +
geom_text(data=subset(callCfSI,variable=="indel"),aes(x=to,y=from,label=value), size=3,colour="white") +
facet_grid(. ~ prog) + iscol + vxlab +theme(legend.position="bottom", axis.title=NA) + vxleg
ggplot(data=callCfSI,aes(x=from,y=to,fill=value,label=value)) +
geom_tile(data=subset(callCfSI,variable=="snp"),size=1) +
geom_text(data=subset(callCfSI,variable=="snp"), size=3,colour="white") +
geom_tile(data=subset(callCfSI,variable=="indel"),aes(x=to,y=from,fill=value*-1),size=1) +
geom_text(data=subset(callCfSI,variable=="indel"),aes(x=to,y=from,label=value), size=3,colour="white") +
facet_grid(. ~ prog) + iscol + vxlab +theme(legend.position="bottom", axis.title=element_blank()) + vxleg
vxleg <- theme(legend.position="bottom",legend.text = element_text(angle = -90,hjust=-1), axis.title=element_blank())
ggplot(data=callCfSI,aes(x=from,y=to,fill=value,label=value)) +
geom_tile(data=subset(callCfSI,variable=="snp"),size=1) +
geom_text(data=subset(callCfSI,variable=="snp"), size=3,colour="white") +
geom_tile(data=subset(callCfSI,variable=="indel"),aes(x=to,y=from,fill=value*-1),size=1) +
geom_text(data=subset(callCfSI,variable=="indel"),aes(x=to,y=from,label=value), size=3,colour="white") +
facet_grid(. ~ prog) + iscol + vxlab + vxleg
ggplot(data=callCfCX,aes(x=from,y=to,fill=value,label=value)) +
geom_tile(data=subset(callCfCX,variable=="both"),size=1) +
geom_text(data=subset(callCfCX,variable=="both"), size=3,colour="white") +
geom_tile(data=subset(callCfCX,variable=="extended"),aes(x=to,y=from,fill=value*-2),size=1) +
geom_text(data=subset(callCfCX,variable=="extended"),aes(x=to,y=from,label=value), size=3,colour="white") +
facet_grid(. ~ prog) + cxcol + vxlab + vxleg
knit("Correlations.Rmd")
callCf <- subset(callCf,related==T)
discoSI <- cor.test(callCf[callCf$prog=="disco","snp"],callCf[callCf$prog=="disco","indel"])
haplo100SI <- cor.test(callCf[callCf$prog=="haplo100","snp"],callCf[callCf$prog=="haplo100","indel"])
haplo250SI <- cor.test(callCf[callCf$prog=="haplo250","snp"],callCf[callCf$prog=="haplo250","indel"])
discoCM <- cor.test(callCf[callCf$prog=="disco","both"],callCf[callCf$prog=="disco","max"])
haplo100CM <- cor.test(callCf[callCf$prog=="haplo100","both"],callCf[callCf$prog=="haplo100","max"])
haplo250CM <- cor.test(callCf[callCf$prog=="haplo250","both"],callCf[callCf$prog=="haplo250","max"])
discoCE <- cor.test(callCf[callCf$prog=="disco","both"],callCf[callCf$prog=="disco","extended"])
haplo100CE <- cor.test(callCf[callCf$prog=="haplo100","both"],callCf[callCf$prog=="haplo100","extended"])
haplo250CE <- cor.test(callCf[callCf$prog=="haplo250","both"],callCf[callCf$prog=="haplo250","extended"])
corrs <- data.frame("prog"=c("disco","haplo100","haplo250"),
"SI" = c(discoSI$estimate,haplo100SI$estimate,haplo250SI$estimate),
"CM" = c(discoCM$estimate,haplo100CM$estimate,haplo250CM$estimate),
"CE" = c(discoCE$estimate,haplo100CE$estimate,haplo250CE$estimate))
discoSI
ggplot(subset(callCf,prog=="disco"),aes(y=snp,x=indel)) + geom_point() +
geom_label(y=100,x=150,label=paste("r = ",round(discoSI$estimate,2)),size=5) +
ggtitle("Discovar calls - SNP:INDEL correlation")
corrs <- data.frame("prog"=c("disco","haplo100","haplo250"),
"SI" = c(discoSI$estimate,haplo100SI$estimate,haplo250SI$estimate),
"CM" = c(discoCM$estimate,haplo100CM$estimate,haplo250CM$estimate),
"CE" = c(discoCE$estimate,haplo100CE$estimate,haplo250CE$estimate))
ggplot(callCf,aes(y=snp,x=indel)) + geom_point() + geom_smooth(method = lm,se = F,linetype=2) +
facet_grid(. ~ prog)+
ggtitle("SNP:INDEL correlation")+
geom_label(data=corrs,aes(y=100,x=750,label=paste("r = ",round(SI,2))),size=5) +
theme(legend.position="bottom") + xlab("extended genome") + ylab("core genome")
ggplot(callCf,aes(y=both,x=extended)) + geom_point() + geom_smooth(method = lm,se = F,linetype=2) +
facet_grid(. ~ prog)+
ggtitle("CORE:EXTENDED correlation")+
geom_label(data=corrs,aes(y=100,x=250,label=paste("r = ",round(CE,2))),size=5) +
theme(legend.position="bottom") + xlab("extended genome") + ylab("core genome")
setwd("../180223_rocplots_VQSLOD90/")
library(ggplot2)
library(hexbin)
library(hexbin)
library(reshape2)
library(knitr)
library(gridExtra)
library(grid)
library(ggplot2)
library(lattice)
opts_chunk$set(fig.width=12, fig.height=8,dev=c('png'),warning=F)
rocf<-"disco_3D7DD2.FILT.DD2-2D4_callable_disco_LOD_EVAL"
disco <- read.table(paste(rocf,"weighted_roc.tsv.gz",sep="/"),header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names=c("score","true_positives","false_positives","false_negatives","precision","sensitivity","f_measure"))
disco$caller="disco"
disco$region="GENOME"
discoSNPs <- read.table(paste(rocf,"snp_roc.tsv.gz",sep="/"),header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names = c("score","true_positives","false_positives"))
discoINDELs <- read.table(paste(rocf,"non_snp_roc.tsv.gz",sep="/"),header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names = c("score","true_positives","false_positives"))
discoSNPs$type="SNP"
discoINDELs$type="INDEL"
discoType <- rbind(discoSNPs,discoINDELs)
discoType$caller="disco"
discoType$region="GENOME"
rocf<-"disco_3D7DD2.FILT.DD2-2D4_callable_all_LOD_EVAL"
discoCALL <- read.table(paste(rocf,"weighted_roc.tsv.gz",sep="/"),header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names=c("score","true_positives","false_positives","false_negatives","precision","sensitivity","f_measure"))
discoCALL$caller="disco"
discoCALL$region="CALLABLE"
discoCALLSNPs <- read.table(paste(rocf,"snp_roc.tsv.gz",sep="/"),header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names = c("score","true_positives","false_positives"))
discoCALLINDELs <- read.table(paste(rocf,"non_snp_roc.tsv.gz",sep="/"),header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names = c("score","true_positives","false_positives"))
discoCALLSNPs$type="SNP"
discoCALLINDELs$type="INDEL"
discoCALLType <- rbind(discoCALLSNPs,discoCALLINDELs)
discoCALLType$caller="disco"
discoCALLType$region="CALLABLE"
head(disco); head(discoCALL)
head(discoType); head(discoCALLType)
rocf<-"gatkHaplo_3D7DD2_100.VQSR.DD2-2D4_callable_haplo100_LOD_EVAL"
gatk100 <- read.table(paste(rocf,"weighted_roc.tsv.gz",sep="/"),header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names=c("score","true_positives","false_positives","false_negatives","precision","sensitivity","f_measure"))
gatk100$caller="gatk100"
gatk100$region="GENOME"
gatk100SNPs <- read.table(paste(rocf,"snp_roc.tsv.gz",sep="/"),header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names = c("score","true_positives","false_positives"))
gatk100INDELs <- read.table(paste(rocf,"non_snp_roc.tsv.gz",sep="/"),header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names = c("score","true_positives","false_positives"))
gatk100SNPs$type="SNP"
gatk100INDELs$type="INDEL"
gatk100Type <- rbind(gatk100SNPs,gatk100INDELs)
gatk100Type$caller="gatk100"
gatk100Type$region="GENOME"
rocf<-"gatkHaplo_3D7DD2_100.VQSR.DD2-2D4_callable_all_LOD_EVAL"
gatkCALL100 <- read.table(paste(rocf,"weighted_roc.tsv.gz",sep="/"),header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names=c("score","true_positives","false_positives","false_negatives","precision","sensitivity","f_measure"))
gatkCALL100$caller="gatk100"
gatkCALL100$region="CALLABLE"
gatkCALL100SNPs <- read.table(paste(rocf,"snp_roc.tsv.gz",sep="/"),header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names = c("score","true_positives","false_positives"))
gatkCALL100INDELs <- read.table(paste(rocf,"non_snp_roc.tsv.gz",sep="/"),header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names = c("score","true_positives","false_positives"))
gatkCALL100SNPs$type="SNP"
gatkCALL100INDELs$type="INDEL"
gatkCALL100Type <- rbind(gatkCALL100SNPs,gatkCALL100INDELs)
gatkCALL100Type$caller="gatk100"
gatkCALL100Type$region="CALLABLE"
rocf<-"gatkHaplo_3D7DD2_250.VQSR.DD2-2D4_callable_haplo250_LOD_EVAL"
gatk250 <- read.table(paste(rocf,"weighted_roc.tsv.gz",sep="/"),header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names=c("score","true_positives","false_positives","false_negatives","precision","sensitivity","f_measure"))
gatk250$caller="gatk250"
gatk250$region="GENOME"
gatk250SNPs <- read.table(paste(rocf,"snp_roc.tsv.gz",sep="/"),header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names = c("score","true_positives","false_positives"))
gatk250INDELs <- read.table(paste(rocf,"non_snp_roc.tsv.gz",sep="/"),header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names = c("score","true_positives","false_positives"))
gatk250SNPs$type="SNP"
gatk250INDELs$type="INDEL"
gatk250Type <- rbind(gatk250SNPs,gatk250INDELs)
gatk250Type$caller="gatk250"
gatk250Type$region="GENOME"
rocf<-"gatkHaplo_3D7DD2_250.VQSR.DD2-2D4_callable_all_LOD_EVAL"
gatkCALL250 <- read.table(paste(rocf,"weighted_roc.tsv.gz",sep="/"),header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names=c("score","true_positives","false_positives","false_negatives","precision","sensitivity","f_measure"))
gatkCALL250$caller="gatk250"
gatkCALL250$region="CALLABLE"
gatkCALL250SNPs <- read.table(paste(rocf,"snp_roc.tsv.gz",sep="/"),header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names = c("score","true_positives","false_positives"))
gatkCALL250INDELs <- read.table(paste(rocf,"non_snp_roc.tsv.gz",sep="/"),header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names = c("score","true_positives","false_positives"))
gatkCALL250SNPs$type="SNP"
gatkCALL250INDELs$type="INDEL"
gatkCALL250Type <- rbind(gatkCALL250SNPs,gatkCALL250INDELs)
gatkCALL250Type$caller="gatk250"
gatkCALL250Type$region="CALLABLE"
rocf<-"disco_3D7DD2.FILT.DD2-2D4_callable_disco_LOD_FILT_EVAL"
disco <- read.table(paste(rocf,"weighted_roc.tsv.gz",sep="/"),header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names=c("score","true_positives","false_positives","false_negatives","precision","sensitivity","f_measure"))
disco$caller="disco"
disco$region="GENOME"
discoSNPs <- read.table(paste(rocf,"snp_roc.tsv.gz",sep="/"),header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names = c("score","true_positives","false_positives"))
discoINDELs <- read.table(paste(rocf,"non_snp_roc.tsv.gz",sep="/"),header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names = c("score","true_positives","false_positives"))
discoSNPs$type="SNP"
discoINDELs$type="INDEL"
discoFiltType <- rbind(discoSNPs,discoINDELs)
discoFiltType$caller="disco"
discoFiltType$region="GENOME"
rocf<-"disco_3D7DD2.FILT.DD2-2D4_callable_all_LOD_FILT_EVAL"
discoCALL <- read.table(paste(rocf,"weighted_roc.tsv.gz",sep="/"),header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names=c("score","true_positives","false_positives","false_negatives","precision","sensitivity","f_measure"))
discoCALL$caller="disco"
discoCALL$region="CALLABLE"
discoCALLSNPs <- read.table(paste(rocf,"snp_roc.tsv.gz",sep="/"),header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names = c("score","true_positives","false_positives"))
discoCALLINDELs <- read.table(paste(rocf,"non_snp_roc.tsv.gz",sep="/"),header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names = c("score","true_positives","false_positives"))
discoCALLSNPs$type="SNP"
discoCALLINDELs$type="INDEL"
discoCALLFiltType <- rbind(discoCALLSNPs,discoCALLINDELs)
discoCALLFiltType$caller="disco"
discoCALLFiltType$region="CALLABLE"
head(disco); head(discoCALL)
head(discoFiltType); head(discoCALLFiltType)
rocf<-"gatkHaplo_3D7DD2_100.VQSR90.DD2-2D4.nr_callable_haplo100_LOD_FILT_EVAL"
gatk100 <- read.table(paste(rocf,"weighted_roc.tsv.gz",sep="/"),header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names=c("score","true_positives","false_positives","false_negatives","precision","sensitivity","f_measure"))
gatk100$caller="gatk100"
gatk100$region="GENOME"
gatk100SNPs <- read.table(paste(rocf,"snp_roc.tsv.gz",sep="/"),header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names = c("score","true_positives","false_positives"))
gatk100INDELs <- read.table(paste(rocf,"non_snp_roc.tsv.gz",sep="/"),header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names = c("score","true_positives","false_positives"))
gatk100SNPs$type="SNP"
gatk100INDELs$type="INDEL"
gatk100FiltType <- rbind(gatk100SNPs,gatk100INDELs)
gatk100FiltType$caller="gatk100"
gatk100FiltType$region="GENOME"
# posns <- intersect(gatk100SNPs$score,gatk100INDELs$score)
# gatk100FiltType <- subset(gatk100FiltType,score %in% posns)
#rocf<-"gatkHaplo_3D7DD2_100.VQSR.DD2-2D4_callable_all_LOD_FILT_EVAL"
rocf<-"gatkHaplo_3D7DD2_100.VQSR90.DD2-2D4.nr_callable_all_LOD_FILT_EVAL"
gatkCALL100 <- read.table(paste(rocf,"weighted_roc.tsv.gz",sep="/"),header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names=c("score","true_positives","false_positives","false_negatives","precision","sensitivity","f_measure"))
gatkCALL100$caller="gatk100"
gatkCALL100$region="CALLABLE"
gatkCALL100SNPs <- read.table(paste(rocf,"snp_roc.tsv.gz",sep="/"),header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names = c("score","true_positives","false_positives"))
gatkCALL100INDELs <- read.table(paste(rocf,"non_snp_roc.tsv.gz",sep="/"),header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names = c("score","true_positives","false_positives"))
gatkCALL100SNPs$type="SNP"
gatkCALL100INDELs$type="INDEL"
gatkCALL100FiltType <- rbind(gatkCALL100SNPs,gatkCALL100INDELs)
gatkCALL100FiltType$caller="gatk100"
gatkCALL100FiltType$region="CALLABLE"
# posns <- intersect(gatkCALL100SNPs$score,gatkCALL100INDELs$score)
# gatkCALL100FiltType <- subset(gatkCALL100FiltType,score %in% posns)
```
```{r}
#rocf<-"gatkHaplo_3D7DD2_250.VQSR.DD2-2D4_callable_haplo250_LOD_FILT_EVAL"
rocf<-"gatkHaplo_3D7DD2_250.VQSR90.DD2-2D4.nr_callable_haplo250_LOD_FILT_EVAL"
gatk250 <- read.table(paste(rocf,"weighted_roc.tsv.gz",sep="/"),header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names=c("score","true_positives","false_positives","false_negatives","precision","sensitivity","f_measure"))
gatk250$caller="gatk250"
gatk250$region="GENOME"
gatk250SNPs <- read.table(paste(rocf,"snp_roc.tsv.gz",sep="/"),header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names = c("score","true_positives","false_positives"))
gatk250INDELs <- read.table(paste(rocf,"non_snp_roc.tsv.gz",sep="/"),header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names = c("score","true_positives","false_positives"))
gatk250SNPs$type="SNP"
gatk250INDELs$type="INDEL"
gatk250FiltType <- rbind(gatk250SNPs,gatk250INDELs)
gatk250FiltType$caller="gatk250"
gatk250FiltType$region="GENOME"
# posns <- intersect(gatk250SNPs$score,gatk250INDELs$score)
# gatk250FiltType <- subset(gatk250FiltType,score %in% posns)
#rocf<-"gatkHaplo_3D7DD2_250.VQSR.DD2-2D4_callable_all_LOD_FILT_EVAL"
rocf<-"gatkHaplo_3D7DD2_250.VQSR90.DD2-2D4.nr_callable_all_LOD_FILT_EVAL"
gatkCALL250 <- read.table(paste(rocf,"weighted_roc.tsv.gz",sep="/"),header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names=c("score","true_positives","false_positives","false_negatives","precision","sensitivity","f_measure"))
gatkCALL250$caller="gatk250"
gatkCALL250$region="CALLABLE"
gatkCALL250SNPs <- read.table(paste(rocf,"snp_roc.tsv.gz",sep="/"),header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names = c("score","true_positives","false_positives"))
gatkCALL250INDELs <- read.table(paste(rocf,"non_snp_roc.tsv.gz",sep="/"),header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names = c("score","true_positives","false_positives"))
gatkCALL250SNPs$type="SNP"
gatkCALL250INDELs$type="INDEL"
gatkCALL250FiltType <- rbind(gatkCALL250SNPs,gatkCALL250INDELs)
gatkCALL250FiltType$caller="gatk250"
gatkCALL250FiltType$region="CALLABLE"
# posns <- intersect(gatkCALL250SNPs$score,gatkCALL250INDELs$score)
# gatkCALL250FiltType <- subset(gatkCALL250FiltType,score %in% posns)
rocf<-"gatkHaplo_3D7DD2_250.VQSR90.DD2-2D4.nr_callable_haplo250_LOD_FILT_EVAL"
gatk250 <- read.table(paste(rocf,"weighted_roc.tsv.gz",sep="/"),header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names=c("score","true_positives","false_positives","false_negatives","precision","sensitivity","f_measure"))
rocf<-"gatkHaplo_3D7DD2_250.VQSR90.DD2-2D4.nr_callable_haplo250_LOD_FILT_EVAL/"
gatk250 <- read.table(paste(rocf,"weighted_roc.tsv.gz",sep="/"),header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names=c("score","true_positives","false_positives","false_negatives","precision","sensitivity","f_measure"))
getwd()
rocf<-"gatkHaplo_3D7DD2_250.VQSR.DD2-2D4_callable_haplo250_LOD_EVAL"
gatk250 <- read.table(paste(rocf,"weighted_roc.tsv.gz",sep="/"),header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names=c("score","true_positives","false_positives","false_negatives","precision","sensitivity","f_measure"))
gatk250$caller="gatk250"
gatk250$region="GENOME"
gatk250SNPs <- read.table(paste(rocf,"snp_roc.tsv.gz",sep="/"),header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names = c("score","true_positives","false_positives"))
gatk250INDELs <- read.table(paste(rocf,"non_snp_roc.tsv.gz",sep="/"),header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names = c("score","true_positives","false_positives"))
gatk250SNPs$type="SNP"
gatk250INDELs$type="INDEL"
gatk250Type <- rbind(gatk250SNPs,gatk250INDELs)
gatk250Type$caller="gatk250"
gatk250Type$region="GENOME"
rocf<-"gatkHaplo_3D7DD2_250.VQSR.DD2-2D4_callable_all_LOD_EVAL"
gatkCALL250 <- read.table(paste(rocf,"weighted_roc.tsv.gz",sep="/"),header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names=c("score","true_positives","false_positives","false_negatives","precision","sensitivity","f_measure"))
gatkCALL250$caller="gatk250"
gatkCALL250$region="CALLABLE"
gatkCALL250SNPs <- read.table(paste(rocf,"snp_roc.tsv.gz",sep="/"),header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names = c("score","true_positives","false_positives"))
gatkCALL250INDELs <- read.table(paste(rocf,"non_snp_roc.tsv.gz",sep="/"),header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names = c("score","true_positives","false_positives"))
gatkCALL250SNPs$type="SNP"
gatkCALL250INDELs$type="INDEL"
gatkCALL250Type <- rbind(gatkCALL250SNPs,gatkCALL250INDELs)
gatkCALL250Type$caller="gatk250"
gatkCALL250Type$region="CALLABLE"
rocf<-"gatkHaplo_3D7DD2_250.VQSR90.DD2-2D4.nr_callable_haplo250_LOD_FILT_EVAL"
gatk250 <- read.table(paste(rocf,"weighted_roc.tsv.gz",sep="/"),header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names=c("score","true_positives","false_positives","false_negatives","precision","sensitivity","f_measure"))
gatk250$caller="gatk250"
gatk250$region="GENOME"
gatk250SNPs <- read.table(paste(rocf,"snp_roc.tsv.gz",sep="/"),header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names = c("score","true_positives","false_positives"))
gatk250INDELs <- read.table(paste(rocf,"non_snp_roc.tsv.gz",sep="/"),header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names = c("score","true_positives","false_positives"))
gatk250SNPs$type="SNP"
gatk250INDELs$type="INDEL"
gatk250FiltType <- rbind(gatk250SNPs,gatk250INDELs)
gatk250FiltType$caller="gatk250"
gatk250FiltType$region="GENOME"
rocf<-"gatkHaplo_3D7DD2_250.VQSR90.DD2-2D4.nr_callable_all_LOD_FILT_EVAL"
gatkCALL250 <- read.table(paste(rocf,"weighted_roc.tsv.gz",sep="/"),header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names=c("score","true_positives","false_positives","false_negatives","precision","sensitivity","f_measure"))
gatkCALL250$caller="gatk250"
gatkCALL250$region="CALLABLE"
gatkCALL250SNPs <- read.table(paste(rocf,"snp_roc.tsv.gz",sep="/"),header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names = c("score","true_positives","false_positives"))
gatkCALL250INDELs <- read.table(paste(rocf,"non_snp_roc.tsv.gz",sep="/"),header=F,skip = 3,stringsAsFactors =F,sep="\t",col.names = c("score","true_positives","false_positives"))
gatkCALL250SNPs$type="SNP"
gatkCALL250INDELs$type="INDEL"
gatkCALL250FiltType <- rbind(gatkCALL250SNPs,gatkCALL250INDELs)
gatkCALL250FiltType$caller="gatk250"
gatkCALL250FiltType$region="CALLABLE"
rocCf <- rbind(discoCALLType,discoType,gatkCALL100Type,gatk100Type,gatkCALL250Type,gatk250Type)
rocFiltCf <- rbind(discoCALLFiltType,discoFiltType,gatkCALL100FiltType,gatk100FiltType,gatkCALL250FiltType,gatk250FiltType)
rocCf$filtered=F
rocFiltCf$filtered=T
rocCfALL <- rbind(rocCf,rocFiltCf)
g_legend<-function(a.gplot){
tmp <- ggplot_gtable(ggplot_build(a.gplot))
leg <- which(sapply(tmp$grobs, function(x) x$name) == "guide-box")
legend <- tmp$grobs[[leg]]
return(legend)}
ggplot(discoCALLType,aes(x=false_positives,y=true_positives,colour=type)) +
geom_line() + facet_grid(. ~ caller) + theme(legend.position="bottom") + ggtitle("discovar ROC, all-callable genome")
ggplot(discoType,aes(x=false_positives,y=true_positives,colour=type)) +
geom_line() + facet_grid(. ~ caller) + theme(legend.position="bottom") + ggtitle("discovar ROC, discovar-callable genome")
ggplot(rocCf,aes(x=false_positives,y=true_positives,colour=type,linetype=region)) +
geom_line() + facet_grid(. ~ caller) + theme(legend.position="bottom") + ggtitle("ROC plots, core/callable")
ggplot(rocCf,aes(x=false_positives,y=true_positives,colour=type,linetype=region)) +
geom_line() + facet_grid(. ~ caller,scales = "free_x") + theme(legend.position="bottom") + ggtitle("ROC plots, core/callable, free-X")
ggplot(discoCALLFiltType,aes(x=false_positives,y=true_positives,colour=type)) +
geom_line() + facet_grid(. ~ caller) + theme(legend.position="bottom") + ggtitle("discovar ROC, all-callable genome")
ggplot(discoFiltType,aes(x=false_positives,y=true_positives,colour=type)) +
geom_line() + facet_grid(. ~ caller) + theme(legend.position="bottom") + ggtitle("discovar ROC, discovar-callable genome")
ggplot(rocFiltCf,aes(x=false_positives,y=true_positives,colour=type,linetype=region)) +
geom_line() + facet_grid(. ~ caller) + theme(legend.position="bottom") + ggtitle("ROC plots, core/callable")
ggplot(rocFiltCf,aes(x=false_positives,y=true_positives,colour=type,linetype=region)) +
geom_line() + facet_grid(. ~ caller,scales = "free_x") + theme(legend.position="bottom") + ggtitle("ROC plots, core/callable, free-X")
sumcols <- c("threshold","truepos","falsepos","falseneg","precision","sensitivity","F-measure")
discosum <- read.table("disco_3D7DD2.FILT.DD2-2D4_callable_disco_LOD_EVAL/summary.txt",skip=2,col.names = sumcols)
gatk100sum <- read.table("gatkHaplo_3D7DD2_100.VQSR.DD2-2D4_callable_haplo100_LOD_EVAL/summary.txt",skip=2,col.names = sumcols)
gatk250sum <- read.table("gatkHaplo_3D7DD2_250.VQSR.DD2-2D4_callable_haplo250_LOD_EVAL/summary.txt",skip=2,col.names = sumcols)
discosum$caller<-"disco"
gatk100sum$caller<-"gatk100"
gatk250sum$caller<-"gatk250"
callsums <- rbind(discosum,gatk250sum,gatk100sum)
subset(callsums,threshold=="None")
subset(callsums,threshold!="None")
sumcols <- c("threshold","truepos","falsepos","falseneg","precision","sensitivity","F-measure")
discosum <- read.table("disco_3D7DD2.FILT.DD2-2D4_callable_disco_LOD_FILT_EVAL/summary.txt",skip=2,col.names = sumcols)
gatk100sum <- read.table("gatkHaplo_3D7DD2_100.VQSR.DD2-2D4_callable_haplo100_LOD_FILT_EVAL/summary.txt",skip=2,col.names = sumcols)
gatk250sum <- read.table("gatkHaplo_3D7DD2_250.VQSR.DD2-2D4_callable_haplo250_LOD_FILT_EVAL/summary.txt",skip=2,col.names = sumcols)
discosum$caller<-"disco"
gatk100sum$caller<-"gatk100"
gatk250sum$caller<-"gatk250"
callsumsFilt <- rbind(discosum,gatk250sum,gatk100sum)
subset(callsumsFilt,threshold=="None")
subset(callsumsFilt,threshold!="None")
callsums$filtered=F
callsumsFilt$filtered=T
callsumsCf <- rbind(callsums,callsumsFilt)
callsumsCf <- subset(callsumsCf,threshold=="None")
callsumsCf
ggplot(rocCfALL,aes(x=false_positives,y=true_positives,colour=type,linetype=region)) + geom_line() +
geom_text(data=callsumsCf,aes(x=2000,y=8000,label=paste("prec:",precision,"\nsens:",sensitivity)),inherit.aes = F,hjust=0)+
facet_grid(filtered ~ caller) + theme(legend.position="bottom") + ggtitle("ROC plots, core/callable")
ggplot(rocCfALL,aes(x=false_positives,y=true_positives,colour=type,linetype=region)) + geom_line() +
geom_text(data=callsumsCf,aes(x=2000,y=8000,label=paste("prec:",precision,"\nsens:",sensitivity)),inherit.aes = F,hjust=0)+
facet_grid(filtered ~ caller,scales = "free_x") + theme(legend.position="bottom") + ggtitle("ROC plots, core/callable, free-X")
ggplot(rocCfALL,aes(x=false_positives,y=true_positives,colour=type,linetype=region)) + geom_line() +
geom_text(data=callsumsCf,aes(x=2000,y=8000,label=paste("prec:",precision,"\nsens:",sensitivity)),inherit.aes = F,hjust=0)+
facet_grid(filtered ~ caller) + theme(legend.position="bottom") + ggtitle("ROC plots, core/extended genome")
ggplot(rocCfALL,aes(x=false_positives,y=true_positives,colour=type,linetype=region)) + geom_line() +
geom_text(data=callsumsCf,aes(x=2000,y=8000,label=paste("prec:",precision,"\nsens:",sensitivity)),inherit.aes = F,hjust=0)+
facet_grid(filtered ~ caller,scales = "free_x") + theme(legend.position="bottom") + ggtitle("ROC plots, core/callable, free-X")
knit("validation.md")
knit("validation.Rmd")
setwd("../180224_core_callable_VQSLOD90/")
library(ggplot2)
library(hexbin)
library(reshape2)
library(knitr)
library(gridExtra)
library(grid)
library(ggplot2)
library(lattice)
opts_chunk$set(fig.width=20, fig.height=8,dev=c('png','postscript'),warning=F)
#opts_chunk$set(fig.width=20, fig.height=8,dev=c('png'),warning=F)
callbothGATK100 <- read.table("thies_haplo100.callAll.FILT.m0.5.dist.tab.txt",sep="\t")
knit("Correlations.Rmd")
