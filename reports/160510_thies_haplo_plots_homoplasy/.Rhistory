superG <- graph.data.frame(superspreader, directed=T)
E(superG)$weight <- superspreader[,3]
superL <- layout.fruchterman.reingold(superG, weights=E(superG)$weight)
plot(steadyG,layout=superL)
E(superG)$weight
plot(steadyG,layout=steadyL)
plot(superG,layout=superL)
plot(steadyG,layout=steadyL)
superL <- layout.fruchterman.reingold(superG, weights=E(superG)$weight)
superL
g <- graph.ring(10)
E(g)$weight <- 1:2
l <- layout.fruchterman.reingold(g, weights=E(g)$weight)
plot(g, layout=l)
superL <- layout.drl(superG, weights=E(superG)$weight)
plot(superG,layout=superL)
steadyL <- layout.drl(steadyG, weights=E(steadyG)$weight)
plot(steadyG,layout=steadyL)
superL <- layout.drl(superG, weights=E(superG)$weight)
plot(superG,layout=superL)
superspreader <- read.table(text="
0 1 1 T
0 2 2 T
0 3 3 T
0 4 4 T
0 5 5 T
0 6 6 T")
steadystate <- read.table(text="
0 1 2 F
0 2 2 F
1 3 2 F
1 4 2 F
2 5 2 F
2 6 2 F
3 7 2 T
4 8 2 T
4 9 2 T
5 10 2 T
6 11 2 T
6 12 2 T")
steadyG <- graph.data.frame(steadystate, directed=T)
E(steadyG)$weight <- steadystate[,3]
superG <- graph.data.frame(superspreader, directed=T)
E(superG)$weight <- superspreader[,3]
steadyL <- layout.drl(steadyG, weights=E(steadyG)$weight)
plot(steadyG,layout=steadyL)
superL <- layout.drl(superG, weights=E(superG)$weight)
plot(superG,layout=superL)
superL <- layout.sugiyama(superG, weights=E(superG)$weight)
plot(superG,layout=superL)
superL <- layout.sugiyama(superG, weights=E(superG)$weight)
plot(superG,layout=superL)
plot(superG,edge.length=E(superG)$weight)
plot(superG,edge.weight=E(superG)$weight)
plot(superG,edge.width=E(superG)$weight)
steadyL <- layout.fruchterman.reingold(steadyG, params=list(weights=E(g)$weight))
list(weights=E(g)$weight)
steadyL <- layout.fruchterman.reingold(steadyG, params=list(weights=E(g)$weight))
steadyL <- layout.fruchterman.reingold(steadyG, params=list(weights=E(steadyG)$weight))
plot(steadyG,layout=steadyL)
superL <- layout.fruchterman.reingold(superG, params=list(weights=E(superG)$weight))
plot(superG,edge.width=E(superG)$weight)
plot(superG,layout=superL)
steadyL <- layout.fruchterman.reingold(steadyG, params=list(weights=E(steadyG)$weight))
plot(steadyG,layout=steadyL)
?Dendrogram
??Dendrogram
cluster_leading_eigen(steadyG)
cluster_leading_eigen(subgraph(steadyG,v = c(7:12))
\c
plot(subgraph(steadyG,v = c(7:12)))
plot(subgraph(steadyG,v = c(8:13)))
plot(steradyG)
plot(steadyG)
layout(steadyG)
plot(subgraph(steadyG,v = c(8:13)))
plot(subgraph(steadyG,v = c(8:13)),layout=steadyG)
steadyG
steadyL
as.data.frame(steadyL)
ggplot(as.data.frame(steadyL),aes(x=V1,y=V2)) + geom_point()
library(ggplot2)
ggplot(as.data.frame(steadyL),aes(x=V1,y=V2)) + geom_point()
steadyL.df <- as.data.frame(steadyL)
steadyL.df$names <- V(steadyG)
steadyL.df$names <- steadystate[,3]
steadyL.df$names <- steadystate[7:12,3]
steadyL.df$names <- steadystate[,3]
steadyL.df$names <- c(0:12)
ggplot(as.data.frame(steadyL),aes(x=V1,y=V2,label=names)) + geom_text()
ggplot(steadyL.df,aes(x=V1,y=V2,label=names)) + geom_text()
steadyL[8:13,]
subSteadyL <- steadyL[8:13,]
plot(subgraph(steadyG,v = c(8:13)),subSteadyL)
plot(subgraph(steadyG,v = c(8:13)),layout=subSteadyL)
add_layout_(subgraph(steadyG,v = c(8:13)),layout=subSteadyL)
subSteadyL <- steadyL[8:13,]
plot(subgraph(steadyG,v = c(8:13)),layout=subSteadyL)
plot(subgraph(steadyG,v = c(8:13)),layout=subSteadyL)
add_layout_(subgraph(steadyG,v = c(8:13)),layout=subSteadyL)
subSteadyG <- subgraph(steadyG,v = c(8:13))
subSteadyG <- induced_subgraph(steadyG,v = c(8:13))
plot(subSteadyG,layout=subSteadyL)
plot(subSteadyG,layout=subSteadyL)
add_layout_(subSteadyG,layout=subSteadyL)
add_layout_(subSteadyG,layout=subSteadyL)
add_layout_(subSteadyG,subSteadyL)
fastgreedy.community(subSteadyG)
steadyG <- graph.data.frame(steadystate, directed=F)
E(steadyG)$weight <- steadystate[,3]
superG <- graph.data.frame(superspreader, directed=F)
E(superG)$weight <- superspreader[,3]
steadyL <- layout.fruchterman.reingold(steadyG, params=list(weights=E(steadyG)$weight))
plot(steadyG,layout=steadyL)
superL <- layout.fruchterman.reingold(superG, params=list(weights=E(superG)$weight))
plot(superG,layout=superL)
subSteadyL <- steadyL[8:13,]
subSteadyG <- induced_subgraph(steadyG,v = c(8:13))
plot(subSteadyG)
plot(subSteadyG,layout=subSteadyL)
add_layout_(subSteadyG,subSteadyL)
add_layout_(subSteadyG,subSteadyL,overwrite = T)
add_layout_(subSteadyG,layout=subSteadyL,overwrite = T)
layout_
?layout_
add_layout_(subSteadyG,layout=subSteadyL,overwrite = T)
?graph_structure
?graph.structure
fastgreedy.community(superL)
fastgreedy.community(superG)
dendPlot(fastgreedy.community(superG))
dendPlot(fastgreedy.community(steadyG))
steadyC <- fastgreedy.community(steadyG)
steadyC$names
steadyC$membership
steadyC$merges
steadyC$modularity
dendPlot(fastgreedy.community(steadyG),use.modularity=T)
dendPlot(fastgreedy.community(steadyG),use.modularity=F)
as.phylo(fastgreedy.community(steadyG))
to.phylo(fastgreedy.community(steadyG))
dendPlot(fastgreedy.community(steadyG))
?sample
sample(1:10,replace=T)
sppsubs <- read.table("subrate_relaxed_otherspp.txt",sep="\t",header=T)
setwd("~/Scratch/gits/pfdisco/reports/160428_beastSubRate_1/")
sppsubs <- read.table("subrate_relaxed_otherspp.txt",sep="\t",header=T)
colnames(sppsubs)[3:4] <- c("gsize","subrate")
ggplot(sppsubs,aes(x=gsize,y=subrate*gsize,colour=Group)) + geom_point(size=4) + scale_y_log10() + scale_x_log10()
library(ggplot2)
library(reshape2)
sppsubs <- read.table("subrate_relaxed_otherspp.txt",sep="\t",header=T)
colnames(sppsubs)[3:4] <- c("gsize","subrate")
ggplot(sppsubs,aes(x=gsize,y=subrate*gsize,colour=Group)) + geom_point(size=4) + scale_y_log10() + scale_x_log10()
ggplot(sppsubs,aes(x=gsize,y=subrate,colour=Group)) + geom_point(size=4) + scale_y_log10() + scale_x_log10()
gsizes <- seq(1e3,1e8,1e3)
rates <- data.frame("gsize"=gsizes,"years"=1/gsizes,"months"=12/gsizes,"weeks"=52/gsizes)
ratesM <- melt(rates,id.vars = "gsize",value.name ="subrate")
ggplot(sppsubs,aes(x=gsize,y=subrate,colour=Group)) + geom_point(size=4) + geom_line(data=ratesM,aes(colour=variable)) + scale_y_log10() + scale_x_log10()
ggplot(sppsubs,aes(x=gsize,y=subrate,colour=Group)) + geom_point(size=4) + geom_line(data=ratesM,aes(colour=variable)) + xlim(0,0.5e6) + ylim(0,1e-02)
ggplot(sppsubs,aes(x=gsize,y=subrate,colour=Group)) + geom_point(size=4) + geom_line(data=ratesM,aes(colour=variable)) + xlim(0,25e6) + ylim(0,1e-02)
ggplot(sppsubs,aes(x=gsize,y=subrate,colour=Group)) + geom_point(size=4) + geom_line(data=ratesM,aes(colour=variable)) + xlim(0,0.5e6) + ylim(0,1e-02)
ggplot(sppsubs,aes(x=gsize,y=subrate,colour=Group)) + geom_point(size=4) + geom_line(data=ratesM,aes(colour=variable)) + xlim(0,0.5e6) + ylim(0,5e-03)
ggplot(sppsubs,aes(x=gsize,y=subrate,colour=Group)) + geom_point(size=4) + geom_line(data=ratesM,aes(colour=variable)) + xlim(0,0.5e6) + ylim(0,54e-03)
ggplot(sppsubs,aes(x=gsize,y=subrate,colour=Group)) + geom_point(size=4) + geom_line(data=ratesM,aes(colour=variable)) + xlim(0,0.5e6) + ylim(0,4e-03)
ggplot(sppsubs,aes(x=gsize,y=subrate,colour=Group)) + geom_point(size=4) + geom_line(data=ratesM,aes(colour=variable)) + xlim(0,0.5e5) + ylim(0,4e-03)
ggplot(sppsubs,aes(x=gsize,y=subrate,colour=Group)) + geom_point(size=4) + geom_line(data=ratesM,aes(colour=variable)) + xlim(0,0.1e6) + ylim(0,4e-03)
5
ggplot(sppsubs,aes(x=gsize,y=subrate,colour=Group)) + geom_point(size=4) + geom_line(data=ratesM,aes(colour=variable)) + xlim(0,0.5e6) + ylim(0,4e-03)
ggplot(sppsubs,aes(x=gsize,y=subrate,colour=Group)) + geom_point(size=4) + geom_line(data=ratesM,aes(colour=variable)) + scale_y_sqrt() + scale_x_sqrt()
gsizes <- seq(1e3,25e6,1e3)
rates <- data.frame("gsize"=gsizes,"years"=1/gsizes,"months"=12/gsizes,"weeks"=52/gsizes)
ratesM <- melt(rates,id.vars = "gsize",value.name ="subrate")
ggplot(sppsubs,aes(x=gsize,y=subrate,colour=Group)) + geom_point(size=4) + geom_line(data=ratesM,aes(colour=variable)) + scale_y_log10() + scale_x_log10()
ggplot(sppsubs,aes(x=gsize,y=subrate,colour=Group)) + geom_point(size=4) + geom_line(data=ratesM,aes(colour=variable)) + scale_y_sqrt() + scale_x_sqrt()
ratesM[ratesM$subrate<=0.001,]
ratesM <- ratesM[ratesM$subrate<=0.001,]
ggplot(sppsubs,aes(x=gsize,y=subrate,colour=Group)) + geom_point(size=4) + geom_line(data=ratesM,aes(colour=variable)) + scale_y_log10() + scale_x_log10()
rates <- data.frame("gsize"=gsizes,"years"=1/gsizes,"months"=12/gsizes,"weeks"=52/gsizes)
ratesM <- melt(rates,id.vars = "gsize",value.name ="subrate")
ratesM <- ratesM[ratesM$subrate<=0.0015,]
ggplot(sppsubs,aes(x=gsize,y=subrate,colour=Group)) + geom_point(size=4) + geom_line(data=ratesM,aes(colour=variable)) + scale_y_log10() + scale_x_log10()
ratesM <- ratesM[ratesM$subrate<=0.002,]
ggplot(sppsubs,aes(x=gsize,y=subrate,colour=Group)) + geom_point(size=4) + geom_line(data=ratesM,aes(colour=variable)) + scale_y_log10() + scale_x_log10()
ratesM <- melt(rates,id.vars = "gsize",value.name ="subrate")
ratesM <- ratesM[ratesM$subrate<=0.002,]
ggplot(sppsubs,aes(x=gsize,y=subrate,colour=Group)) + geom_point(size=4) + geom_line(data=ratesM,aes(colour=variable)) + scale_y_log10() + scale_x_log10()
ratesM <- ratesM[ratesM$subrate<=0.005,]
ggplot(sppsubs,aes(x=gsize,y=subrate,colour=Group)) + geom_point(size=4) + geom_line(data=ratesM,aes(colour=variable)) + scale_y_log10() + scale_x_log10()
ratesM <- melt(rates,id.vars = "gsize",value.name ="subrate")
ratesM <- ratesM[ratesM$subrate<=0.005,]
ggplot(sppsubs,aes(x=gsize,y=subrate,colour=Group)) + geom_point(size=4) + geom_line(data=ratesM,aes(colour=variable)) + scale_y_log10() + scale_x_log10()
ggplot(sppsubs,aes(x=gsize,y=subrate,colour=Group)) + geom_point(size=4) + geom_line(data=ratesM,aes(colour=variable)) + xlim(0,0.5e6) + ylim(0,4e-03)
ggplot(sppsubs,aes(x=gsize,y=subrate,colour=Group)) + geom_point(size=4) + geom_line(data=ratesM,aes(colour=variable)) + scale_y_sqrt() + scale_x_sqrt()
ggplot(sppsubs,aes(x=gsize,y=subrate,colour=Group)) + geom_point(size=4) + geom_line(data=ratesM,aes(colour=variable)) + scale_y_log10() + scale_x_log10()
ggplot(sppsubs,aes(x=gsize,y=subrate,colour=Group)) + geom_point(size=4) + geom_line(data=ratesM,aes(colour=variable)) + xlim(0,0.5e6) + ylim(0,4e-03)
ggplot(sppsubs,aes(x=gsize,y=subrate,colour=Group)) + geom_point(size=4) + geom_line(data=ratesM,aes(colour=variable)) + scale_y_sqrt() + scale_x_sqrt()
ggplot(sppsubs,aes(x=gsize,y=subrate,colour=Group)) + geom_point(size=4) + geom_line(data=ratesM,aes(colour=variable)) + xlim(0,0.5e6) + ylim(0,4e-03)
ggplot(sppsubs,aes(x=gsize,y=subrate,colour=Group)) + geom_point(size=4) + geom_line(data=ratesM,aes(colour=variable)) + scale_y_sqrt() + scale_x_sqrt()
ggplot(sppsubs,aes(x=gsize,y=subrate,colour=Group)) + geom_point(size=4) + geom_line(data=ratesM,aes(colour=variable)) + scale_y_sqrt() + scale_x_sqrt()
10!/6!
!10/!6
factorial(10)/factorial(6)
factorial(10)
factorial(10)/factorial(6)-factorial(4)
factorial(10)/(factorial(6)-factorial(4))
factorial(10)/(factorial(6)*factorial(4))
factorial(5)/(factorial(5)*factorial(4))
factorial(5)/(factorial(1)*factorial(4))
factorial(10)/(factorial(6)*factorial(4))
setwd("../160510_thies_haplo_plots_homoplasy/")
clade3F <- "Thies_all_manual.PASS.Cls.miss0.5.LMRG.HAP.DISCORDS.clade3.alleles.tab.txt"
library(ggplot2)
library(reshape2)
library(knitr)
```{r setup}
opts_chunk$set(fig.width=13, fig.height=12)
```
```{r}
getGenoTab <- function(filename) {
genotab <- read.table(filename,sep="\t",header=T,stringsAsFactors=F,na.strings=c('.','. '))
genotab <- unique(genotab)
#remove ref calls
#genotab <- genotab[rowSums(genotab[,5:dim(genotab)[2]],na.rm=T)!=0,]
#colnames(genotab)[1:2]<-c("chr","pos")
genotab.m <- melt(genotab,id.vars =c("chr","pos","type","alleles"),variable.name ="indv")
genotab.m$value <- as.factor(genotab.m$value)
#sort levels
genotab.m$indv <- factor(genotab.m$indv,levels=sort(levels(genotab.m$indv)))
genotab.m <- genotab.m[!is.na(genotab.m$value),]
genotab.m$value <- as.numeric(as.character(genotab.m$value))
hNo=0
vlast=0
genotab.m$haplo=0
for (i in c(1:dim(genotab.m)[[1]])) {
if (genotab.m[i,"value"]==0) {haplo=0}
else if (genotab.m[i,"value"]>=1) {
if (vlast==0) {hNo <- hNo+1}
genotab.m[i,"haplo"]<-hNo
}
vlast=genotab.m[i,"value"]
}
genotab.m$value <- factor(genotab.m$value)
genotab.m$haplo <- factor(genotab.m$haplo)
genotab.m
}
clade3F <- "Thies_all_manual.PASS.Cls.miss0.5.LMRG.HAP.DISCORDS.clade3.alleles.tab.txt"
genotab3 <- getGenoTab(clade3F)
genotab3$indv <- factor(genotab3$indv,levels = c("Th134.11","Th117.11","Th106.11","Th196.12","Th162.12","Th132.11","Th074.13","Th230.12","Th106.09","Th086.07"),ordered=T)
clade3NS <- "Thies_all_manual.PASS.Cls.miss0.5.LMRG.HAP.DISCORDS.clade3.NOSNGL.alleles.tab.txt"
genotab3NS <- getGenoTab(clade3F)
genotab3NS$indv <- factor(genotab3$indv,levels = c("Th134.11","Th117.11","Th106.11","Th196.12","Th162.12","Th132.11","Th074.13","Th230.12","Th106.09","Th086.07"),ordered=T)
cols=c("grey","dark green","orange","dark red")
names(cols)<-c(0,1,2,3)
colsc <- scale_color_manual(values = cols)
ggplot(genotab3,aes(x=pos,y=indv,colour=value,group=haplo,shape=type)) + geom_point(size=3) +
geom_line(data=subset(genotab3,value!=0)) + facet_grid(chr ~ .) + xlim(0,3.5e6) +colsc
cols=c("grey","light green","dark green","orange","red","dark red")
names(cols)<-c(0,1,2,3,4,5)
colsc <- scale_color_manual(values = cols)
ggplot(genotab3,aes(x=pos,y=indv,colour=value,group=haplo,shape=type)) + geom_point(size=3) +
geom_line(data=subset(genotab3,value!=0)) + facet_grid(chr ~ .) + xlim(0,3.5e6) +colsc
ggplot(subset(genotab3,type=="SNP"),aes(x=pos,y=indv,colour=value,group=haplo,shape=type)) + geom_point(alpha=0.6,size=3) +
geom_line(data=subset(genotab3,value!=0 & type=="SNP")) + facet_grid(chr ~ type) + xlim(0,3.5e6) +colsc
ggplot(subset(genotab3,type=="INDEL"),aes(x=pos,y=indv,colour=value,group=haplo,shape=type)) + geom_point(alpha=0.6,size=3) +
geom_line(data=subset(genotab3,value!=0 & type=="INDEL")) + facet_grid(chr ~ type) + xlim(0,3.5e6) +colsc
ggplot(genotab3NS,aes(x=pos,y=indv,colour=value,group=haplo,shape=type)) + geom_point(size=3) +
geom_line(data=subset(genotab3,value!=0)) + facet_grid(chr ~ .) + xlim(0,3.5e6) +colsc
ggplot(subset(genotab3NS,type=="SNP"),aes(x=pos,y=indv,colour=value,group=haplo,shape=type)) + geom_point(alpha=0.6,size=3) +
geom_line(data=subset(genotab3,value!=0 & type=="SNP")) + facet_grid(chr ~ type) + xlim(0,3.5e6) +colsc
ggplot(subset(genotab3NS,type=="INDEL"),aes(x=pos,y=indv,colour=value,group=haplo,shape=type)) + geom_point(alpha=0.6,size=3) +
geom_line(data=subset(genotab3,value!=0 & type=="INDEL")) + facet_grid(chr ~ type) + xlim(0,3.5e6) +colsc
ggplot(genotab3NS,aes(x=pos,y=indv,colour=value,group=haplo,shape=type)) + geom_point(size=3) +
geom_line(data=subset(genotab3NS,value!=0)) + facet_grid(chr ~ .) + xlim(0,3.5e6) +colsc
ggplot(subset(genotab3NS,type=="SNP"),aes(x=pos,y=indv,colour=value,group=haplo,shape=type)) + geom_point(alpha=0.6,size=3) +
geom_line(data=subset(genotab3NS,value!=0 & type=="SNP")) + facet_grid(chr ~ type) + xlim(0,3.5e6) +colsc
ggplot(subset(genotab3NS,type=="INDEL"),aes(x=pos,y=indv,colour=value,group=haplo,shape=type)) + geom_point(alpha=0.6,size=3) +
geom_line(data=subset(genotab3NS,value!=0 & type=="INDEL")) + facet_grid(chr ~ type) + xlim(0,3.5e6) +colsc
knit("plotHaplotypes.Rmd")
ggplot(subset(genotab3NS,type=="SNP"),aes(x=pos,y=indv,colour=value,group=haplo,shape=type)) + geom_point(alpha=0.6,size=3) +
geom_line(data=subset(genotab3NS,value!=0 & type=="SNP")) + facet_grid(chr ~ type) + xlim(0,3.5e6) +colsc
treeorder <- c("Th086.07","Th134.11","Th117.11","Th106.11","Th196.12","Th162.12","Th132.11","Th074.13","Th230.12","Th106.09")
clade3F <- "Thies_all_manual.PASS.Cls.miss0.5.LMRG.HAP.DISCORDS.clade3.alleles.tab.txt"
genotab3 <- getGenoTab(clade3F)
genotab3$indv <- factor(genotab3$indv,levels = treeorder,ordered=T)
clade3NS <- "Thies_all_manual.PASS.Cls.miss0.5.LMRG.HAP.DISCORDS.clade3.NOSNGL.alleles.tab.txt"
genotab3NS <- getGenoTab(clade3F)
genotab3NS$indv <- factor(genotab3$indv,levels = treeorder,ordered=T)
ggplot(subset(genotab3NS,type=="SNP"),aes(x=pos,y=indv,colour=value,group=haplo,shape=type)) + geom_point(alpha=0.6,size=3) +
geom_line(data=subset(genotab3NS,value!=0 & type=="SNP")) + facet_grid(chr ~ type) + xlim(0,3.5e6) +colsc
clade3NS <- "Thies_all_manual.PASS.Cls.miss0.5.LMRG.HAP.DISCORDS.clade3.NOSNGL.alleles.tab.txt"
genotab3NS <- getGenoTab(clade3NS)
genotab3NS$indv <- factor(genotab3$indv,levels = treeorder,ordered=T)
clade3F <- "Thies_all_manual.PASS.Cls.miss0.5.LMRG.HAP.DISCORDS.clade3.alleles.tab.txt"
genotab3 <- getGenoTab(clade3F)
genotab3$indv <- factor(genotab3$indv,levels = treeorder,ordered=T)
clade3NS <- "Thies_all_manual.PASS.Cls.miss0.5.LMRG.HAP.DISCORDS.clade3.NOSNGL.alleles.tab.txt"
genotab3NS <- getGenoTab(clade3NS)
genotab3NS$indv <- factor(genotab3$indv,levels = treeorder,ordered=T)
genotab3NS
ggplot(subset(genotab3NS,type=="SNP"),aes(x=pos,y=indv,colour=value,group=haplo,shape=type)) + geom_point(alpha=0.6,size=3) +
geom_line(data=subset(genotab3NS,value!=0 & type=="SNP")) + facet_grid(chr ~ type) + xlim(0,3.5e6) +colsc
getGenoTab(clade3NS)
clade3NS <- "Thies_all_manual.PASS.Cls.miss0.5.LMRG.HAP.DISCORDS.clade3.NOSNGL.alleles.tab.txt"
genotab3NS <- getGenoTab(clade3NS)
filename <- clade3NS
genotab <- read.table(filename,sep="\t",header=T,stringsAsFactors=F,na.strings=c('.','. '))
genotab <- unique(genotab)
genotab
genotab.m <- melt(genotab,id.vars =c("chr","pos","type","alleles"),variable.name ="indv")
genotab.m
genotab.m$value <- as.factor(genotab.m$value)
#sort levels
genotab.m$indv <- factor(genotab.m$indv,levels=sort(levels(genotab.m$indv)))
genotab.m <- genotab.m[!is.na(genotab.m$value),]
genotab.m$value <- as.numeric(as.character(genotab.m$value))
genotab <- read.table(filename,sep="\t",header=T,stringsAsFactors=F,na.strings=c('.','. '))
genotab <- unique(genotab)
#remove ref calls
#genotab <- genotab[rowSums(genotab[,5:dim(genotab)[2]],na.rm=T)!=0,]
#colnames(genotab)[1:2]<-c("chr","pos")
genotab.m <- melt(genotab,id.vars =c("chr","pos","type","alleles"),variable.name ="indv")
genotab.m$value <- as.factor(genotab.m$value)
#sort levels
genotab.m$indv <- factor(genotab.m$indv,levels=sort(levels(genotab.m$indv)))
genotab.m <- genotab.m[!is.na(genotab.m$value),]
as.numeric(as.character(genotab.m$value))
as.character(genotab.m$value)
genotab <- read.table(filename,sep="\t",header=T,stringsAsFactors=F,na.strings=c('.','. '))
genotab <- unique(genotab)
head(genotab)
genotab <- read.table(filename,sep="\t",header=T,stringsAsFactors=F,na.strings=c('.','. '))
genotab
head(genotab)
subset(genotab,chr=="Pf3D7_07_v3")
genotab.m <- melt(genotab,id.vars =c("chr","pos","type","subtype","alleles"),variable.name ="indv")
genotab.m$value <- as.factor(genotab.m$value)
#sort levels
genotab.m$indv <- factor(genotab.m$indv,levels=sort(levels(genotab.m$indv)))
genotab.m <- genotab.m[!is.na(genotab.m$value),]
genotab.m$value <- as.numeric(as.character(genotab.m$value))
hNo=0
vlast=0
genotab.m$haplo=0
for (i in c(1:dim(genotab.m)[[1]])) {
if (genotab.m[i,"value"]==0) {haplo=0}
else if (genotab.m[i,"value"]>=1) {
if (vlast==0) {hNo <- hNo+1}
genotab.m[i,"haplo"]<-hNo
}
vlast=genotab.m[i,"value"]
}
genotab.m$value <- factor(genotab.m$value)
genotab.m$haplo <- factor(genotab.m$haplo)
genotab.m
library(ggplot2)
library(reshape2)
library(knitr)
```{r setup}
opts_chunk$set(fig.width=13, fig.height=12)
```
```{r}
getGenoTab <- function(filename) {
genotab <- read.table(filename,sep="\t",header=T,stringsAsFactors=F,na.strings=c('.','. '))
genotab <- unique(genotab)
#remove ref calls
#genotab <- genotab[rowSums(genotab[,5:dim(genotab)[2]],na.rm=T)!=0,]
#colnames(genotab)[1:2]<-c("chr","pos")
genotab.m <- melt(genotab,id.vars =c("chr","pos","type","subtype","alleles"),variable.name ="indv")
genotab.m$value <- as.factor(genotab.m$value)
#sort levels
genotab.m$indv <- factor(genotab.m$indv,levels=sort(levels(genotab.m$indv)))
genotab.m <- genotab.m[!is.na(genotab.m$value),]
genotab.m$value <- as.numeric(as.character(genotab.m$value))
hNo=0
vlast=0
genotab.m$haplo=0
for (i in c(1:dim(genotab.m)[[1]])) {
if (genotab.m[i,"value"]==0) {haplo=0}
else if (genotab.m[i,"value"]>=1) {
if (vlast==0) {hNo <- hNo+1}
genotab.m[i,"haplo"]<-hNo
}
vlast=genotab.m[i,"value"]
}
genotab.m$value <- factor(genotab.m$value)
genotab.m$haplo <- factor(genotab.m$haplo)
genotab.m
}
treeorder <- c("Th086.07","Th134.11","Th117.11","Th106.11","Th196.12","Th162.12","Th132.11","Th074.13","Th230.12","Th106.09")
clade3F <- "Thies_all_manual.PASS.Cls.miss0.5.LMRG.HAP.DISCORDS.clade3.alleles.tab.txt"
genotab3 <- getGenoTab(clade3F)
genotab3$indv <- factor(genotab3$indv,levels = treeorder,ordered=T)
clade3F <- "Thies_all_manual.PASS.Cls.miss0.5.LMRG.HAP.DISCORDS.clade3.alleles.tab.txt"
genotab3 <- getGenoTab(clade3F)
genotab3$indv <- factor(genotab3$indv,levels = treeorder,ordered=T)
clade3NS <- "Thies_all_manual.PASS.Cls.miss0.5.LMRG.HAP.DISCORDS.clade3.NOSNGL.alleles.tab.txt"
genotab3NS <- getGenoTab(clade3NS)
genotab3NS$indv <- factor(genotab3$indv,levels = treeorder,ordered=T)
genotab3NS$indv <- factor(genotab3NS$indv,levels = treeorder,ordered=T)
cols=c("grey","light green","dark green","orange","red","dark red")
names(cols)<-c(0,1,2,3,4,5)
colsc <- scale_color_manual(values = cols)
ggplot(genotab3,aes(x=pos,y=indv,colour=value,group=haplo,shape=type)) + geom_point(size=3) +
geom_line(data=subset(genotab3,value!=0)) + facet_grid(chr ~ .) + xlim(0,3.5e6) +colsc
ggplot(subset(genotab3,type=="SNP"),aes(x=pos,y=indv,colour=value,group=haplo,shape=type)) + geom_point(alpha=0.6,size=3) +
geom_line(data=subset(genotab3,value!=0 & type=="SNP")) + facet_grid(chr ~ type) + xlim(0,3.5e6) +colsc
ggplot(subset(genotab3,type=="INDEL"),aes(x=pos,y=indv,colour=value,group=haplo,shape=type)) + geom_point(alpha=0.6,size=3) +
geom_line(data=subset(genotab3,value!=0 & type=="INDEL")) + facet_grid(chr ~ type) + xlim(0,3.5e6) +colsc
ggplot(genotab3NS,aes(x=pos,y=indv,colour=value,group=haplo,shape=type)) + geom_point(size=3) +
geom_line(data=subset(genotab3NS,value!=0)) + facet_grid(chr ~ .) + xlim(0,3.5e6) +colsc
ggplot(subset(genotab3NS,type=="SNP"),aes(x=pos,y=indv,colour=value,group=haplo,shape=type)) + geom_point(alpha=0.6,size=3) +
geom_line(data=subset(genotab3NS,value!=0 & type=="SNP")) + facet_grid(chr ~ type) + xlim(0,3.5e6) +colsc
ggplot(subset(genotab3NS,type=="INDEL"),aes(x=pos,y=indv,colour=value,group=haplo,shape=type)) + geom_point(alpha=0.6,size=3) +
geom_line(data=subset(genotab3NS,value!=0 & type=="INDEL")) + facet_grid(chr ~ type) + xlim(0,3.5e6) +colsc
knit("plotHaplotypes.Rmd")
genotab3NS
head(genotab)
knit("plotHaplotypes.Rmd")
genotab <- read.table(filename,sep="\t",header=T,stringsAsFactors=F,na.strings=c('.','. '))
genotab <- unique(genotab)
genotab
genotab$I <- 1:len(genotab$chr)
genotab$I <- 1:length(genotab$chr)
head(genotab)
getGenoTab <- function(filename) {
genotab <- read.table(filename,sep="\t",header=T,stringsAsFactors=F,na.strings=c('.','. '))
genotab <- unique(genotab)
genotab$I <- 1:length(genotab$chr)
#remove ref calls
#genotab <- genotab[rowSums(genotab[,5:dim(genotab)[2]],na.rm=T)!=0,]
#colnames(genotab)[1:2]<-c("chr","pos")
genotab.m <- melt(genotab,id.vars =c("I","chr","pos","type","subtype","alleles"),variable.name ="indv")
genotab.m$value <- as.factor(genotab.m$value)
#sort levels
genotab.m$indv <- factor(genotab.m$indv,levels=sort(levels(genotab.m$indv)))
genotab.m <- genotab.m[!is.na(genotab.m$value),]
genotab.m$value <- as.numeric(as.character(genotab.m$value))
hNo=0
vlast=0
genotab.m$haplo=0
for (i in c(1:dim(genotab.m)[[1]])) {
if (genotab.m[i,"value"]==0) {haplo=0}
else if (genotab.m[i,"value"]>=1) {
if (vlast==0) {hNo <- hNo+1}
genotab.m[i,"haplo"]<-hNo
}
vlast=genotab.m[i,"value"]
}
genotab.m$value <- factor(genotab.m$value)
genotab.m$haplo <- factor(genotab.m$haplo)
genotab.m
}
treeorder <- c("Th086.07","Th134.11","Th117.11","Th106.11","Th196.12","Th162.12","Th132.11","Th074.13","Th230.12","Th106.09")
clade3F <- "Thies_all_manual.PASS.Cls.miss0.5.LMRG.HAP.DISCORDS.clade3.alleles.tab.txt"
genotab3 <- getGenoTab(clade3F)
genotab3$indv <- factor(genotab3$indv,levels = treeorder,ordered=T)
clade3NS <- "Thies_all_manual.PASS.Cls.miss0.5.LMRG.HAP.DISCORDS.clade3.NOSNGL.alleles.tab.txt"
genotab3NS <- getGenoTab(clade3NS)
genotab3NS$indv <- factor(genotab3NS$indv,levels = treeorder,ordered=T)
ggplot(subset(genotab3NS,type=="SNP"),aes(x=pos,y=indv,colour=value,group=haplo,shape=type)) + geom_point(alpha=0.6,size=3) +
geom_line(data=subset(genotab3NS,value!=0 & type=="SNP")) + facet_grid(chr ~ type) + xlim(0,3.5e6) +colsc
ggplot(subset(genotab3NS,type=="SNP"),aes(x=I,y=indv,colour=value,group=haplo,shape=type)) + geom_point(alpha=0.6,size=3) +
geom_line(data=subset(genotab3NS,value!=0 & type=="SNP")) + xlim(0,3.5e6) +colsc
ggplot(subset(genotab3NS,type=="SNP"),aes(x=I,y=indv,colour=value,group=haplo,shape=type)) + geom_point(alpha=0.6,size=3) +
geom_line(data=subset(genotab3NS,value!=0 & type=="SNP")) +colsc
ggplot(subset(genotab3NS,type=="SNP"),aes(x=I,y=indv,colour=value,group=haplo,shape=type)) + geom_point(alpha=0.6,size=3) +
geom_line(data=genotab3NS,group=pos) +colsc
ggplot(subset(genotab3NS,type=="SNP"),aes(x=I,y=indv,colour=value,group=haplo,shape=type)) + geom_point(alpha=0.6,size=3) +
geom_line(data=genotab3NS,group=pos) +colsc
ggplot(subset(genotab3NS,type=="SNP"),aes(x=I,y=indv,colour=value,group=pos,shape=type)) + geom_point(alpha=0.6,size=3) +
geom_line(data=genotab3NS,group=pos) +colsc
ggplot(subset(genotab3NS,type=="SNP"),aes(x=I,y=indv,colour=value,group=pos,shape=type)) + geom_point(alpha=0.6,size=3) +
geom_line(data=genotab3NS) +colsc
ggplot(subset(genotab3NS,type=="SNP"),aes(x=I,y=indv,colour=value,group=pos,shape=type)) + geom_point(alpha=0.6,size=3) +
geom_line() +colsc
ggplot(subset(genotab3NS,type=="INDEL"),aes(x=I,y=indv,colour=value,group=pos,shape=type)) + geom_point(alpha=0.6,size=3) +
geom_line() +colsc
treeorder <- c("Th134.11","Th117.11","Th106.11","Th086.07","Th196.12","Th162.12","Th132.11","Th074.13","Th230.12","Th106.09")
clade3F <- "Thies_all_manual.PASS.Cls.miss0.5.LMRG.HAP.DISCORDS.clade3.alleles.tab.txt"
genotab3 <- getGenoTab(clade3F)
genotab3$indv <- factor(genotab3$indv,levels = treeorder,ordered=T)
clade3NS <- "Thies_all_manual.PASS.Cls.miss0.5.LMRG.HAP.DISCORDS.clade3.NOSNGL.alleles.tab.txt"
genotab3NS <- getGenoTab(clade3NS)
genotab3NS$indv <- factor(genotab3NS$indv,levels = treeorder,ordered=T)
ggplot(subset(genotab3NS,type=="SNP"),aes(x=I,y=indv,colour=value,group=pos,shape=type)) + geom_point(alpha=0.6,size=3) +
geom_line() +colsc
ggplot(subset(genotab3NS,type=="INDEL"),aes(x=I,y=indv,colour=value,group=pos,shape=type)) + geom_point(alpha=0.6,size=3) +
geom_line(subset(genotab3NS,type=="INDEL" & value > 0)) +colsc
ggplot(subset(genotab3NS,type=="INDEL"),aes(x=I,y=indv,colour=value,group=pos,shape=type)) + geom_point(alpha=0.6,size=3) +
geom_line(subset(genotab3NS,type=="INDEL" & value != 0)) +colsc
ggplot(subset(genotab3NS,type=="INDEL"),aes(x=I,y=indv,colour=value,group=pos,shape=type)) + geom_point(alpha=0.6,size=3) +
geom_line(data=subset(genotab3NS,type=="INDEL" & value != 0)) +colsc
ggplot(subset(genotab3NS,type=="SNP"),aes(x=I,y=indv,colour=value,group=pos,shape=type)) + geom_point(alpha=0.6,size=3) +
geom_line(data=subset(genotab3NS,type=="SNP" & value != 0)) +colsc
ggplot(subset(genotab3NS,type=="INDEL"),aes(x=I,y=indv,colour=value,group=pos,shape=type)) + geom_point(alpha=0.6,size=3) +
geom_line(data=subset(genotab3NS,type=="INDEL" & value != 0)) +colsc
ggplot(genotab3NS,aes(x=I,y=indv,colour=value,group=pos,shape=type)) + geom_point(alpha=0.6,size=3) +
geom_line(data=subset(genotab3NS,value != 0)) + facet_grid(type ~ .)  +colsc
knit("plotHaplotypes.Rmd")
networkorder <- c("Th134.11","Th117.11","Th106.11","Th086.07","Th106.09","Th196.12","Th074.13","Th132.11","Th162.12","Th230.12")
clade3F <- "Thies_all_manual.PASS.Cls.miss0.5.LMRG.HAP.DISCORDS.clade3.alleles.tab.txt"
genotab3 <- getGenoTab(clade3F)
genotab3$indv <- factor(genotab3$indv,levels = networkorder,ordered=T)
clade3NS <- "Thies_all_manual.PASS.Cls.miss0.5.LMRG.HAP.DISCORDS.clade3.NOSNGL.alleles.tab.txt"
genotab3NS <- getGenoTab(clade3NS)
genotab3NS$indv <- factor(genotab3NS$indv,levels = networkorder,ordered=T)
ggplot(genotab3NS,aes(x=I,y=indv,colour=value,group=pos,shape=type)) + geom_point(alpha=0.6,size=3) +
geom_line(data=subset(genotab3NS,value != 0)) + facet_grid(type ~ .)  +colsc
knit("plotHaplotypes.Rmd")
ggplot(genotab3NS,aes(x=I,y=indv,colour=value,group=pos,shape=type)) + geom_line(data=subset(genotab3NS,value != 0)) + geom_point(alpha=0.6,size=3) +
facet_grid(type ~ .)  +colsc
