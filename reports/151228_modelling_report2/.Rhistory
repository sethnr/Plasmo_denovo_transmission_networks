geom_line() + ggtitle(outroot) +
facet_grid(variable ~ .,scales="free_y")
blockplot
blockplot <- ggplot(blockmelt,aes(x=block,y=value,colour=variable)) +
geom_line() + ggtitle(paste(outroot," [",locsize,"/",winsize,"]",sep="") +
facet_grid(variable ~ .,scales="free_y")
blockplot
blockplot <- ggplot(blockmelt,aes(x=block,y=value,colour=variable)) +
geom_line() + ggtitle(paste(outroot," [",locsize,"/",winsize,"]",sep="")) +
facet_grid(variable ~ .,scales="free_y")
blockplot
locsize <-  10000
regsize <- 100000
blockplot <- ggplot(blockmelt,aes(x=block,y=value,colour=variable)) +
geom_line() + ggtitle(paste(outroot," [",locsize,"/",winsize,"]",sep="")) +
facet_grid(variable ~ .,scales="free_y")
blockplot
blockplot <- ggplot(blockmelt,aes(x=block,y=value,colour=variable)) +
geom_line() + ggtitle(paste(outroot," [",(locsize/1000),"/",(regsize/1000),"]",sep="")) +
facet_grid(variable ~ .,scales="free_y")
blockplot
?mean
save.pkg.list <- installed.packages()[is.na(installed.packages()[,"priority"]), 1]
is.na(installed.packages()[,"priority"])
installed.packages()
installed.packages()[,"priority"]
installed.packages()[,"Priority"]
save.pkg.list <- installed.packages()[is.na(installed.packages()[,"Priority"]), 1]
save.pkg.list
save(save.pkg.list,file="~/Google Drive/misc/macports_150504/pkglist.Rdata")
library(raster)
library(maptools)
library(rgdal)
library(RColorBrewer)
library (ggplot2)
library(rgeos)
#library(animation)
library(rgeos)
library(myGeoFuncs)
codesTab <- as.data.frame(ccodes())
codesTab
africa.c <- as.vector(subset(codesTab,NAME %in% african.countries))
codesTab <- as.data.frame(ccodes())
codes <- as.character(unlist(subset(codesTab,NAME %in% african.countries,ISO3)))
africa.c <- as.vector(subset(codesTab,NAME %in% african.countries))
calt <- list()
cshapes <- list()
for (code in codes) {
#  write(code,stderr())
#country region data:
cshape<-getData("GADM", country=code, level=1)
#get midpoint of climate data
coords <- coordinates(cshape)
max <- apply(coords,2,FUN=max)
min <- apply(coords,2,FUN=min)
mid <- min + ((max-min)/2)
mid
altdata<-getData("worldclim", var="alt", res=0.5, lon=mid[1], lat=mid[2])
extract(altdata,cshape,fun=mean, na.rm=T)
calt[code] <- altdata
cshapes[code] <- cshape
}
codes
codesTab
subset(codesTab,NAME %in% african.countries,ISO3)
subset(codesTab,NAME %in% african.countries)
african.countries
malpe<-extract(malp,malb,fun=mean, na.rm=T)
malp<-getData("worldclim", var="prec", res=0.5, lon=35, lat=-14)
malpe<-extract(malp,malb,fun=mean, na.rm=T)
?getData
?extract
malp
g <- graph.de.bruijn(2,1)
graph.de.bruijn(2,2)
line.graph(g)
install.packages("igraph")
install.packages("stringr")
install.packages("stringr")
install.packages("igraph")
g <- graph.de.bruijn(2,1)
graph.de.bruijn(2,2)
line.graph(g)
library(igraph)
g <- graph.de.bruijn(2,1)
graph.de.bruijn(2,2)
line.graph(g)
g <- graph.de.bruijn(2,1)
g
g <- graph.de.bruijn(55)
g <- graph.de.bruijn(5,5)
g
line.graph(g)
anyNA
V(g)
E(g)
version()
session.info()
sessioninfo()
sessionInfo()
sessioninfo()
sessionInfo()
anyNA
library(igraph)
g <- graph.de.bruijn(5,5)
E(g)
line.graph(g)
plot(g)
g <- graph.de.bruijn(2,5)
plot(g)
g <- graph.de.bruijn(5,2)
plot(g)
g <- graph.de.bruijn(10,2)
plot(g)
g <- graph.de.bruijn(10,1)
plot(g)
g <- graph.de.bruijn(20,5,)
g <- graph.de.bruijn(20,5)
plot(g)
g <- graph.de.bruijn(20,2)
plot(g)
g <- graph.de.bruijn(10,2)
plot(g)
g <- graph.de.bruijn(6,2)
g <- graph.de.bruijn(6,2)
g <- graph.de.bruijn(5,2)
plot(g)
plot(g,mark.shape=0)
plot(g,mark.shape=1)
plot(g,mark.shape=0.1)
plot(g,shape="none")
plot(g,Shape="none")
plot(g,vertex.shape="none")
plot(g,edge.shape="none")
plot(g,arrow.size=0.2)
g <- graph.de.bruijn(5,10)
g <- graph.de.bruijn(5,3)
plot(g, layout=layout_with_fr)
plot(g, layout='layout_with_fr')
plot(g)
plot(g, layout=layout_with_fr, vertex.size=4,
vertex.label.dist=0.5, vertex.color="red", edge.arrow.size=0.5)
g<-barabasi.game(10)
plot(g, layout=layout_with_fr, vertex.size=4,
vertex.label.dist=0.5, vertex.color="red", edge.arrow.size=0.5)
g <- graph.de.bruijn(5,2)
plot(g)
plot(g,cex.main=0.2)
plot(g,cex.main=0.1)
plot.igraph(g,mark.shape=0)
plot.igraph(g,mark.shape=0,arrow.size=0.3)
g<-barabasi.game(10)
plot(g)
g<-barabasi.game(30)
plot(g)
?igraph
g<-erdos.renyi.game(30)
g<-erdos.renyi.game(n=20,p.or.m=p)
g<-erdos.renyi.game(n=20,p.or.m="p")
g<-erdos.renyi.game(n=20,p.or.m=T)
plot(g)
g<-erdos.renyi.game(n=20,p.or.m=F)
plot(g)
g <- graph.de.bruijn(5,2)
plot(g)
plot(g,xlim(0,10))
plot.igraph(g,mark.expand=20)
plot.igraph(g,mark.expand=30)
plot.igraph(g,mark.expand=10)
g <- graph.kautz(5,2)
plot(g,xlim(0,10))
plot(g\)
plot(g)
g <- graph.kautz(5,1)
plot(g)
read.table("Scratch/gits/pfdisco/analyses/modelling_intraspec/")
read.table("Scratch/gits/pfdisco/analyses/modelling_intraspec/qstages.C1.5m.L0.01mb.G36.mtp.AFs.txt")
afs <- read.table("Scratch/gits/pfdisco/analyses/modelling_intraspec/qstages.C1.5m.L0.01mb.G36.mtp.AFs.txt",sep="\t")
afs <- read.table("Scratch/gits/pfdisco/analyses/modelling_intraspec/qstages.C1.5m.L0.01mb.G36.mtp.AFs.txt",sep="\t")
afs <- read.table("Scratch/gits/pfdisco/analyses/modelling_intraspec/qstages.C1.5m.L0.01mb.G36.mtp.AFs.txt",sep="\t",row.names=1)
library(ggplot2)
ggplot(afs[1,]) + geom_dist()
ggplot(afs[1,]) + geom_density()
ggplot(t(afs),aes(x="14") + geom_density()
\c
ggplot(t(afs),aes(x="14")) + geom_density()
afs <- as.data.frame(t(afs))
ggplot(afs,aes(x="14")) + geom_density()
head(afs)
ggplot(afs,aes(x=14)) + geom_density()
colnames(afs) <- c("month","half_yr","yr")
ggplot(afs,aes(x=month)) + geom_density()
afs_small <- as.data.frame(t(read.table("Scratch/gits/pfdisco/analyses/modelling_intraspec/qstages.C1.5m.L0.01mb.G36.mtp.AFs.txt",sep="\t",row.names=1)),col.names=c("month","halfyr","yr"))
head(afs_small)
afs_small <- data.frame(t(read.table("Scratch/gits/pfdisco/analyses/modelling_intraspec/qstages.C1.5m.L0.01mb.G36.mtp.AFs.txt",sep="\t",row.names=1)),col.names=c("month","halfyr","yr"))
afs_small <- data.frame(t(read.table("Scratch/gits/pfdisco/analyses/modelling_intraspec/qstages.C1.5m.L0.01mb.G36.mtp.AFs.txt",sep="\t",row.names=1)))
colnames(afs_small)<-c("mth","halfyr","yr")
afs_large <- data.frame(t(read.table("Scratch/gits/pfdisco/analyses/modelling_intraspec/qstages.C100.0m.L0.01mb.G36.mtp.AFs.txt",sep="\t",row.names=1)))
colnames(afs_large)<-c("mth","halfyr","yr")
ggplot(afs_small,aes(x="yr")) + geom_density(colour="blue") + geom_density(data=afs_large,aes(x="mth"),colour="red")
ggplot(afs_small,aes(x=yr)) + geom_density(colour="blue") + geom_density(data=afs_large,aes(x=mth),colour="red")
ggplot(afs_small,aes(x=yr)) + geom_density()
ggplot(afs_large,aes(x=mth)) + geom_density()
density(afs_large$mth)
plot(density(afs_large$mth))
plot(density(afs_large$mth),colour="red") + lines(density(afs_small$yr),colour="blue")
plot(density(afs_large$mth),col="red") + lines(density(afs_small$yr),col="blue")
plot(density(afs_small$yr),colour="blue") + lines(density(afs_large$mth),colour="red")
plot(density(afs_small$yr),col="blue") + lines(density(afs_large$mth),col="red")
plot(density(subset(afs_small,yr>0.01,yr),col="blue") + lines(density(afs_large$mth),col="red")
\c
plot(density(subset(afs_small,yr>0.01,yr)),col="blue") + lines(density(afs_large$mth),col="red")
subset(afs_small,yr>0.01,yr)
plot(density(subset(afs_small,yr>0.01,yr)),col="blue") + lines(density(afs_large$mth),col="red")
plot(density(subset(afs_small,yr>0.01,yr)),col="blue")
plot(density(subset(afs_small,yr>0.01)$yr),col="blue")
plot(density(subset(afs_small,yr>0.01)$yr),col="blue") + lines(density(subset(afs_large,mth>0.01)$mth),col="red")
plot(density(subset(afs_small,yr>=0.01)$yr),col="blue") + lines(density(subset(afs_large,mth>=0.01)$mth),col="red")
setwd("~/Scratch/gits/pfdisco/analyses/modelling_intraspec/run2_allele_freqs_fidock/")
read.table("fidock.C100.0m.L0.01mb.G64.btl0.01.mtp.tsk550.txt")
read.table("fidock.C100.0m.L0.01mb.G64.btl0.01.mtp.tsk550.txt",sep="\t")
read.table("all_AFs_180days.txt",sep="\t")
sixmth <- read.table("all_AFs_180days.txt",sep="\t")
setwd("../../../reports/151228_modelling_report2/")
sixmth <- read.table("all_AFs_180days.txt",sep="\t")
sixmth[1:10,1:10]
onemth <- read.table("all_AFs_28days.txt",sep="\t")
onemth[1:10,1:10]
onemth <- read.table("all_AFs_28days.txt",sep="\t")
sixmth <- read.table("all_AFs_180days.txt",sep="\t")
sixmth <- read.table("all_AFs_180days.txt",sep="\t",row.names=1)
sixmth <- read.table("all_AFs_180days.txt",sep="\t",row.names=1)
onemth <- read.table("all_AFs_28days.txt",sep="\t",row.names=1)
afcfs <- cbind(t(sixmth),t(onemth))
head(afcfs)
afcfs_m <- melt(afcfs)
library(ggplot2)
library(reshape2)
library(knitr)
opts_chunk$set(fig.width=12, fig.height=6)
install.packages("knitr")
library(knitr)
afcfs_m <- melt(afcfs)
head(afcfs_m)
dim(afcfs_m)
head(strsplit("_",afcfs_m$Var2))
head(strsplit(afcfs_m$Var2,"_"))
head(strsplit("_",as.character(afcfs_m$Var2)))
strsplit("_",as.character(head(afcfs_m$Var2)))
strsplit(as.character(head(afcfs_m$Var2)),"_")
as.data.frame(strsplit(as.character(head(afcfs_m$Var2)),"_"))
t(as.data.frame(strsplit(as.character(head(afcfs_m$Var2)),"_")))
afcfs_m[,1:2] <- t(as.data.frame(strsplit(as.character(afcfs_m$Var2),"_")))
colnames(afcfs_m)[1:2] <- c("run","days")
colnames(afcfs_m)[1:2] <- c("run","days")
cols<-c("180"="blue","28"="red")
ggplot(afcfs_m,aes(x=value,group=run,colour=days)) + geom_density(adjust=0.5)+scale_colour_manual(values=cols) + xlim(0,0.02) +  ggtitle("sfs short/ long term infections")
ggplot(subset(afcfs_m,value>0.01),aes(x=value,group=Var2,colour=Var2)) + geom_density(adjust=0.8) + xlim(0,0.1)+scale_colour_manual(values=cols) + ggtitle("sfs  short/ long term infections (af > 1pc)")
head(afcfs_m)
afcfs_m[afcfs_m$value==0,]
dim(afcfs_m[afcfs_m$value==0,]0
dim(afcfs_m[afcfs_m$value==0,])
dim(afcfs_m[afcfs_m$value!=0,])
afcfs_m <- afcfs_m[afcfs_m$value!=0,]
ggplot(afcfs_m,aes(x=value,group=run,colour=days)) + geom_density(adjust=0.5)+scale_colour_manual(values=cols) + xlim(0,0.02) +  ggtitle("sfs short/ long term infections")
head(afcfs_m)
warnings()
ggplot(afcfs_m,aes(x=value,group=run,colour=days)) + geom_density(adjust=0.5)+scale_colour_manual(values=cols) + xlim(0,0.02) +  ggtitle("sfs short/ long term infections")
ggplot(subset(afcfs_m,value>0.01),aes(x=value,group=Var2,colour=Var2)) + geom_density(adjust=0.8) + xlim(0,0.1)+scale_colour_manual(values=cols) + ggtitle("sfs  short/ long term infections (af > 1pc)")
ggplot(afcfs_m,aes(x=value,group=run,colour=days)) + geom_density(adjust=0.5)+scale_colour_manual(values=cols) + xlim(0,0.1) +  ggtitle("sfs short/ long term infections")
ggplot(subset(afcfs_m,value>0.01),aes(x=value,group=run,colour=days)) + geom_density(adjust=0.8) + xlim(0,0.1)+scale_colour_manual(values=cols) + ggtitle("sfs  short/ long term infections (af > 1pc)")
ggplot(afcfs_m,aes(x=value,group=run,color=days)) + geom_density(adjust=0.5)+scale_colour_manual(values=cols) + xlim(0,0.1) +  ggtitle("sfs short/ long term infections")
u
ggplot(afcfs_m,aes(x=value,group=run,colour=days)) + geom_density(adjust=0.5)+scale_colour_manual(values=cols) + xlim(0,0.1) +  ggtitle("sfs short/ long term infections")
ggplot(subset(afcfs_m,value>0.01),aes(x=value,group=run,colour=days)) + geom_density(adjust=0.8) + xlim(0,0.1)+scale_colour_manual(values=cols) + ggtitle("sfs  short/ long term infections (af > 1pc)")
ggplot(afcfs_m,aes(x=value,group=run,colour=days)) + geom_density(adjust=0.5)+scale_colour_manual(values=cols) + xlim(0,0.1) +  ggtitle("sfs short/ long term infections")
ggplot(subset(afcfs_m,value>0.01),aes(x=value,group=run,colour=days)) + geom_density(adjust=0.8) + xlim(0,0.1)+scale_colour_manual(values=cols) + ggtitle("sfs  short/ long term infections (af > 1pc)")
cols<-c(180="blue",28="red")
cols<-c(180="blue",28="red")
head(afcfs_m$days)
is.character(head(afcfs_m$days))
cols<-c("90"="blue","14"="red")
ggplot(afcfs_m,aes(x=value,group=run,colour=days)) + geom_density(adjust=0.5)+scale_colour_manual(values=cols) + xlim(0,0.1) +  ggtitle("sfs short/ long term infections")
cols<-c("90"="blue","14"="red")
afcfs_m <- afcfs_m[afcfs_m$value!=0,]
ggplot(afcfs_m,aes(x=value,group=run,colour=days)) + geom_density(adjust=0.5)+scale_colour_manual(values=cols) + xlim(0,0.1) +  ggtitle("sfs short/ long term infections")
ggplot(afcfs_m,aes(x=value,group=run,colour=days)) + geom_density(adjust=0.5)+ xlim(0,0.1) +  ggtitle("sfs short/ long term infections")
ggplot(afcfs_m,aes(x=value,group=run,fill=days)) + geom_density(adjust=0.5)+ xlim(0,0.1) +  ggtitle("sfs short/ long term infections")
ggplot(afcfs_m,aes(x=value,group=run,colour=days)) + geom_density()+ xlim(0,0.1) +  ggtitle("sfs short/ long term infections")
ggplot(afcfs_m,aes(x=value,group=days,colour=days)) + geom_density()+ xlim(0,0.1) +  ggtitle("sfs short/ long term infections")
cols<-c("90"="blue","14"="red")
afcfs_m <- afcfs_m[afcfs_m$value!=0,]
ggplot(afcfs_m,aes(x=value,group=run,colour=days)) + geom_density(adjust=0.5)+scale_colour_manual(values=cols) + xlim(0,0.1) +  ggtitle("sfs short/ long term infections")
ggplot(afcfs_m,aes(x=value,group=run,colour=days)) + geom_density(adjust=0.5) + xlim(0,0.1) +  ggtitle("sfs short/ long term infections") #+ scale_colour_manual(values=cols)
ggplot(afcfs_m,aes(x=value,group=days,colour=days)) + geom_density(adjust=0.5) + xlim(0,0.1) +  ggtitle("sfs short/ long term infections") #+ scale_colour_manual(values=cols)
afcfs_m <- melt(afcfs)
keys <- t(as.data.frame(strsplit(as.character(afcfs_m$Var2),"_")))
afcfs_m <- cbind(keys, afcfs_m[,2:3])
colnames(afcfs_m)[1:2] <- c("run","days","id")
cols<-c("90"="blue","14"="red")
afcfs_m <- afcfs_m[afcfs_m$value!=0,]
unique(afcfs_m[,1:3])
colnames(afcfs_m)[1:3] <- c("run","days","id")
cols<-c("90"="blue","14"="red")
afcfs_m <- afcfs_m[afcfs_m$value!=0,]
unique(afcfs_m[,1:3])
unique(afcfs_m[,3:1])
key <- unique(afcfs_m[,3:1])
key$colour=cols[key$days]
key
idcols <- key$colour
names(idcols) <- key$id
daycols <- key$colour
names(daycols) <- key$day
ggplot(afcfs_m,aes(x=value,group=id,colour=days)) + geom_density(adjust=0.5) + xlim(0,0.1) +  ggtitle("sfs short/ long term infections") + scale_colour_manual(values=idcols)
warnings()
ggplot(afcfs_m,aes(x=value,group=id,colour=id)) + geom_density(adjust=0.5) + xlim(0,0.1) +  ggtitle("sfs short/ long term infections") + scale_colour_manual(values=idcols)
ggplot(afcfs_m,aes(x=value,group=id,colour=days)) + geom_density(adjust=0.5) + xlim(0,0.1) +  ggtitle("sfs short/ long term infections") + scale_colour_manual(values=daycols)
ggplot(subset(afcfs_m,value>0.01),aes(x=value,group=id,colour=days)) + geom_density(adjust=0.8) + xlim(0,0.1)+scale_colour_manual(values=idcols) + ggtitle("sfs  short/ long term infections (af > 1pc)")
ggplot(afcfs_m,aes(x=value,group=id,colour=days)) + geom_density(adjust=0.5) + xlim(0,0.1) +  ggtitle("sfs short/ long term infections") + scale_colour_manual(values=daycols)
ggplot(subset(afcfs_m,value>0.01),aes(x=value,group=id,colour=days)) + geom_density(adjust=0.8) + xlim(0,0.1)+scale_colour_manual(values=daycols) + ggtitle("sfs  short/ long term infections (af > 1pc)")
ggplot(subset(afcfs_m,value>0.001),aes(x=value,group=id,colour=days)) + geom_density(adjust=0.8) + xlim(0,0.1)+scale_colour_manual(values=daycols) + ggtitle("sfs  short/ long term infections (af > 1pc)")
ggplot(subset(afcfs_m,value>0.001),aes(x=value,group=days,colour=days)) + geom_density(adjust=0.8) + xlim(0,0.1)+scale_colour_manual(values=daycols) + ggtitle("sfs  short/ long term infections (af > 1pc)")
ggplot(subset(afcfs_m,value>0.01),aes(x=value,group=id,colour=days)) + geom_density(adjust=0.8) + xlim(0,0.1)+scale_colour_manual(values=daycols) + ggtitle("sfs  short/ long term infections (af > 1pc)")
ggplot(subset(afcfs_m,value>0.01),aes(x=value,group=days,colour=days)) + geom_density(adjust=0.8) + xlim(0,0.1)+scale_colour_manual(values=daycols) + ggtitle("sfs  short/ long term infections (af > 1pc)")
ggplot(subset(afcfs_m,value>0.01),aes(x=value,group=days,colour=days)) + geom_density(adjust=0.5) + xlim(0,0.1)+scale_colour_manual(values=daycols) + ggtitle("sfs  short/ long term infections (af > 1pc)")
ggplot(subset(afcfs_m,value>0.01),aes(x=value,group=days,colour=days)) + geom_density(adjust=1) + xlim(0,0.1)+scale_colour_manual(values=daycols) + ggtitle("sfs  short/ long term infections (af > 1pc)")
ggplot(subset(afcfs_m,value>0.01),aes(x=value,group=days,colour=days)) + geom_density(adjust=1) + xlim(0,0.5)+scale_colour_manual(values=daycols) + ggtitle("sfs  short/ long term infections (af > 1pc)")
ggplot(subset(afcfs_m,value>0.005),aes(x=value,group=days,colour=days)) + geom_density(adjust=1) + xlim(0,0.5)+scale_colour_manual(values=daycols) + ggtitle("sfs  short/ long term infections (af > 1pc)")
ggplot(subset(afcfs_m,value>0.01),aes(x=value,group=days,colour=days)) + geom_density(adjust=1) + xlim(0,0.5)+scale_colour_manual(values=daycols) + ggtitle("sfs  short/ long term infections (af > 1pc)")
colnames(afcfs_m) <- c("run","days","id","AF")
colnames(afcfs_m) <- c("run","days","id","MAF")
cols<-c("90"="blue","14"="red")
afcfs_m <- afcfs_m[afcfs_m$value!=0,]
key <- unique(afcfs_m[,3:1])
key$colour=cols[key$days]
idcols <- key$colour
names(idcols) <- key$id
daycols <- key$colour
names(daycols) <- key$day
ggplot(afcfs_m,aes(x=value,group=id,colour=days)) + geom_density(adjust=0.5) + xlim(0,0.1) +  ggtitle("sfs short/ long term infections") + scale_colour_manual(values=daycols)
ggplot(afcfs_m,aes(x=MAF,group=id,colour=days)) + geom_density(adjust=0.5) + xlim(0,0.1) +  ggtitle("sfs short/ long term infections") + scale_colour_manual(values=daycols)
ggplot(afcfs_m,aes(x=MAF,group=id,colour=days)) + geom_density(adjust=0.5) + xlim(0,0.1) +  ggtitle("sfs short/ long term infections") + scale_colour_manual(values=daycols)
head(afcfs_m)
afcfs_m <- melt(afcfs)
keys <- t(as.data.frame(strsplit(as.character(afcfs_m$Var2),"_")))
afcfs_m <- cbind(keys, afcfs_m[,2:3])
colnames(afcfs_m) <- c("run","days","id","MAF")
cols<-c("90"="blue","14"="red")
afcfs_m <- afcfs_m[afcfs_m$MAF!=0,]
key <- unique(afcfs_m[,3:1])
key$colour=cols[key$days]
idcols <- key$colour
names(idcols) <- key$id
daycols <- key$colour
names(daycols) <- key$day
ggplot(afcfs_m,aes(x=MAF,group=id,colour=days)) + geom_density(adjust=0.5) + xlim(0,0.1) +  ggtitle("sfs short/ long term infections") + scale_colour_manual(values=daycols)
ggplot(subset(afcfs_m,value>0.01),aes(x=MAF,group=id,colour=days)) + geom_density(adjust=0.8) + xlim(0,0.1)+scale_colour_manual(values=daycols) + ggtitle("sfs  short/ long term infections (af > 1pc)")
ggplot(subset(afcfs_m,MAF>0.01),aes(x=MAF,group=id,colour=days)) + geom_density(adjust=0.8) + xlim(0,0.1)+scale_colour_manual(values=daycols) + ggtitle("sfs  short/ long term infections (af > 1pc)")
ggplot(subset(afcfs_m,MAF>0.01),aes(x=MAF,group=days,colour=days)) + geom_density(adjust=1) + xlim(0,0.5)+scale_colour_manual(values=daycols) + ggtitle("sfs  short/ long term infections (af > 1pc)")
ggplot(afcfs_m,aes(x=MAF,group=id,colour=days)) + geom_density(adjust=0.5) + xlim(0,0.1) +  ggtitle("sfs short/ long term infections") + scale_colour_manual(values=daycols)
ggplot(subset(afcfs_m,MAF>0.01),aes(x=MAF,group=id,colour=days)) + geom_density(adjust=0.8) + xlim(0,0.1)+scale_colour_manual(values=daycols) + ggtitle("sfs  short/ long term infections (af > 1pc)")
ggplot(subset(afcfs_m,MAF>0.01),aes(x=MAF,group=days,colour=days)) + geom_density(adjust=1) + xlim(0,0.5)+scale_colour_manual(values=daycols) + ggtitle("sfs  short/ long term infections (af > 1pc)")
key
key$days
key$days <- as.numerical(key$days)
key$days <- as.character(key$days)
key <- unique(afcfs_m[,3:1])
key$days <- as.character(key$days)
key$colour=cols[key$days]
key
idcols <- key$colour
names(idcols) <- key$id
daycols <- key$colour
names(daycols) <- key$day
ggplot(afcfs_m,aes(x=MAF,group=id,colour=days)) + geom_density(adjust=0.5) + xlim(0,0.1) +  ggtitle("sfs short/ long term infections") + scale_colour_manual(values=daycols)
ggplot(subset(afcfs_m,MAF>0.01),aes(x=MAF,group=id,colour=days)) + geom_density(adjust=0.8) + xlim(0,0.1)+scale_colour_manual(values=daycols) + ggtitle("sfs  short/ long term infections (af > 1pc)")
ggplot(subset(afcfs_m,MAF>0.01),aes(x=MAF,group=days,colour=days)) + geom_density(adjust=1) + xlim(0,0.5)+scale_colour_manual(values=daycols) + ggtitle("sfs  short/ long term infections (af > 1pc)")
ggplot(subset(afcfs_m,MAF>0.02),aes(x=MAF,group=days,colour=days)) + geom_density(adjust=1) + xlim(0,0.5)+scale_colour_manual(values=daycols) + ggtitle("sfs  short/ long term infections (af > 1pc)")
ggplot(subset(afcfs_m,MAF>0.02),aes(x=MAF,group=days,colour=days)) + geom_density(adjust=0.8) + xlim(0,0.5)+scale_colour_manual(values=daycols) + ggtitle("sfs  short/ long term infections (af > 1pc)")
ggplot(subset(afcfs_m,MAF>0.01),aes(x=MAF,group=days,colour=days)) + geom_density(adjust=0.8) + xlim(0,0.5)+scale_colour_manual(values=daycols) + ggtitle("sfs  short/ long term infections (af > 1pc)")
ggplot(subset(afcfs_m,MAF>0.01),aes(x=MAF,group=days,colour=days)) + geom_density(adjust=1.5) + xlim(0,0.5)+scale_colour_manual(values=daycols) + ggtitle("sfs  short/ long term infections (af > 1pc)")
histo <- read.table("all_histograms.txt",header=F,sep="\t")
seq(0,0.25,length.out=20)
dim(histo)
head(histo)
edges <- seq(0,0.25,length.out=20)
colnames(histo) <- c("run","gen","N","maxN",edges)
head(histo)
colnames(histo) <- c("run","gen","N","maxN",edges,1)
head(melt(histo,id.vars=c("run","gen","N","maxN")))
apply(histo[,7:25],1,FUN=sum)
histo$2pc <- apply(histo[,7:25],1,FUN=sum)
histo$pc2 <- apply(histo[,7:25],1,FUN=sum)
histo$pc5 <- apply(histo[,9:25],1,FUN=sum)
histo$pc5 <- apply(histo[,13:25],1,FUN=sum)
histo$pc5 <- apply(histo[,9:25],1,FUN=sum)
histo$pc10 <- apply(histo[,13:25],1,FUN=sum)
head(histo)
ggplot(histo,aes(x=gen,y=pc2,colour=run)) + geom_point()
ggplot(histo,aes(x=gen,y=pc2,colour=run)) + geom_boxplot()
ggplot(histo,aes(x=gen,y=pc2)) + geom_boxplot()
ggplot(histo,aes(x=gen,y=pc2,group=gen)) + geom_boxplot()
ggplot(histo,aes(x=gen,y=pc2)) + geom_ribbon()
ggplot(histo,aes(x=gen,y=pc2)) + geom_smooth()
ggplot(histo,aes(x=gen,y=pc2,colour=run)) + geom_point()
aggregate(histo[,c("pc2","pc5","pc10")],histo$gen,FUN=mean)
aggregate(histo[,c("pc2","pc5","pc10")],list(histo$gen),FUN=mean)
aggregate(histo[,c("pc2","pc5","pc10")],list("gen"=histo$gen),FUN=mean)
detects <- aggregate(histo[,c("pc2","pc5","pc10")],list("gen"=histo$gen),FUN=mean)
melt(detects)
melt(detects,id.vars=c("gen"))
detcts <- melt(detects,id.vars=c("gen"))
detects <- aggregate(histo[,c("pc2","pc5","pc10")],list("gen"=histo$gen),FUN=mean)
detects <- melt(detects,id.vars=c("gen"))
ggplot(detects,aes(x=gen,y=value,colour=variable)) + geom_point()
ggplot(detects,aes(x=gen,y=value,colour=variable)) + geom_smooth() + geom_point()
ggplot(detects,aes(x=gen,y=value,colour=variable)) + geom_smooth() + geom_point() +
geom_hline(aes(y=14))
ggplot(detects,aes(x=gen,y=value,colour=variable)) + geom_smooth() + geom_point() +
geom_vline(aes(x=14))
geom_vline(aes(xintersect=14))
ggplot(detects,aes(x=gen,y=value,colour=variable)) + geom_smooth() + geom_point() +
geom_vline(aes(xintersect=14))
ggplot(detects,aes(x=gen,y=value,colour=variable)) + geom_smooth() + geom_point() +
geom_vline(xintersect=14)
ggplot(detects,aes(x=gen,y=value,colour=variable)) + geom_smooth() + geom_point() +
geom_vline(xintersect="14")
head(detects$variable)
head(detects$gen)
is.numeric(head(detects$gen))
ggplot(detects,aes(x=gen,y=value,colour=variable)) + geom_smooth() + geom_point() +
geom_vline(xintersect=14)
ggplot(detects,aes(x=gen,y=value,colour=variable)) + geom_smooth() + geom_point() +
geom_vline(xintersect=20)
ggplot(detects,aes(x=gen,y=value,colour=variable)) + geom_smooth() +
geom_vline(xintersect=20)
g
ggplot(detects,aes(x=gen,y=value,colour=variable)) + geom_smooth() + geom_vline(xintersect=20)
ggplot(detects,aes(x=gen,y=value,colour=variable)) + geom_smooth() + geom_point() +geom_vline(xintersect=20)
ggplot(detects,aes(x=gen,y=value,colour=variable)) +geom_vline(xintersect=20)+ geom_smooth() + geom_point()
ggplot(detects,aes(x=gen,y=value,colour=variable)) +geom_vline(intersect=20)+ geom_smooth() + geom_point()
ggplot(detects,aes(x=gen,y=value,colour=variable)) +geom_vline()+ geom_smooth() + geom_point()
ggplot(detects,aes(x=gen,y=value,colour=variable)) +geom_vline(xintercept=20)+ geom_smooth() + geom_point()
ggplot(detects,aes(x=gen,y=value,colour=variable))+ geom_smooth() + geom_point() +
geom_vline(xintercept=14) + geom_vline(xintercept=90)
ggplot(detects,aes(x=gen,y=value,colour=variable))+ geom_smooth(adjust=0.8) + geom_point() +
geom_vline(xintercept=14) + geom_vline(xintercept=90)
head(detects)
colnames(detects) <- c("gen","MAF","mean")
detects$MAF
levels(detects$MAF)
levels(detects$MAF) <- c(">0.02",">0.05",">0.1")
ggplot(detects,aes(x=gen,y=value,colour=variable))+ geom_smooth(adjust=0.8) + geom_point() +
geom_vline(xintercept=14) + geom_vline(xintercept=90)
ggplot(detects,aes(x=gen,y=mean,colour=MAF))+ geom_smooth(adjust=0.8) + geom_point() +
geom_vline(xintercept=14) + geom_vline(xintercept=90)
ggplot(detects,aes(x=gen,y=mean,colour=MAF))+ geom_smooth(adjust=0.8) + geom_point() +
geom_vline(xintercept=14,linetype=2) + geom_vline(xintercept=90)
ggplot(detects,aes(x=gen,y=mean,colour=MAF))+ geom_smooth(adjust=0.8) + geom_point() +
geom_vline(xintercept=14,linetype=2) + geom_vline(xintercept=90,linetype=2)
detects$days <- detects$gen*2
detects$days <- detects$gen*2
ggplot(detects,aes(x=days,y=mean,colour=MAF))+ geom_smooth(adjust=0.8) + geom_point() +
geom_vline(xintercept=14,linetype=2) + geom_vline(xintercept=90,linetype=2)
ggplot(detects,aes(x=days,y=mean,colour=MAF))+ geom_smooth(adjust=0.8) + geom_point() +
geom_vline(xintercept=28,linetype=2) + geom_vline(xintercept=180,linetype=2)
knit("modelling_report1.Rmd")
knit("modelling_report2.Rmd")
ggplot(afcfs_m,aes(x=MAF,group=id,colour=days)) + geom_density(adjust=0.5) + xlim(0,0.1) +  ggtitle("sfs short/ long term infections") + scale_colour_manual(values=daycols)
onemth <- read.table("all_AFs_28days.txt",sep="\t")
sixmth <- read.table("all_AFs_180days.txt",sep="\t")
afcfs <- cbind(t(sixmth),t(onemth))
afcfs_m <- melt(afcfs)
keys <- t(as.data.frame(strsplit(as.character(afcfs_m$Var2),"_")))
afcfs_m <- cbind(keys, afcfs_m[,2:3])
colnames(afcfs_m) <- c("run","days","id","MAF")
head(afcfs_m)
head(keys)
afcfs_m <- melt(afcfs)
keys <- t(as.data.frame(strsplit(as.character(afcfs_m$Var2),"_")))
head(keys)
head(afcfs_m)
head(afcfs)
onemth <- read.table("all_AFs_28days.txt",sep="\t",row.names=1)
sixmth <- read.table("all_AFs_180days.txt",sep="\t",row.names=1)
afcfs <- cbind(t(sixmth),t(onemth))
afcfs_m <- melt(afcfs)
keys <- t(as.data.frame(strsplit(as.character(afcfs_m$Var2),"_")))
head(keys)
afcfs_m <- cbind(keys, afcfs_m[,2:3])
colnames(afcfs_m) <- c("run","days","id","MAF")
cols<-c("90"="blue","14"="red")
afcfs_m <- afcfs_m[afcfs_m$MAF!=0,]
key <- unique(afcfs_m[,3:1])
key$days <- as.character(key$days)
key$colour=cols[key$days]
idcols <- key$colour
names(idcols) <- key$id
daycols <- key$colour
names(daycols) <- key$day
ggplot(afcfs_m,aes(x=MAF,group=id,colour=days)) + geom_density(adjust=0.5) + xlim(0,0.1) +  ggtitle("sfs short/ long term infections") + scale_colour_manual(values=daycols)
knit("modelling_report2.Rmd")
ggplot(histo,aes(x=gen,y=pc5,colour=run)) + geom_point()
ggplot(histo,aes(x=gen,y=pc2,colour=run)) + geom_point()
ggplot(histo,aes(x=gen,y=N,colour=run)) + geom_point()
ggplot(histo,aes(x=gen,y=N,colour=run)) + geom_point() + scale_y_log10()
ggplot(histo,aes(x=gen,y=N,colour=run)) + geom_line() + scale_y_log10()
ggplot(histo,aes(x=gen,y=N,colour=run)) + geom_smooth() + scale_y_log10()
ggplot(histo,aes(x=gen,y=N,colour=run)) + geom_smooth(adjust=0.8) + scale_y_log10()
ggplot(histo,aes(x=gen,y=N,colour=run)) + geom_smooth(adjust=0.2) + scale_y_log10()
ggplot(histo,aes(x=gen,y=N,colour=run)) + geom_smooth(adjust=0.5) + scale_y_log10()
